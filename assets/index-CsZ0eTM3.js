(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function W6(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var W1={exports:{}},qf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lw;function X6(){if(Lw)return qf;Lw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:i}}return qf.Fragment=e,qf.jsx=r,qf.jsxs=r,qf}var Vw;function $6(){return Vw||(Vw=1,W1.exports=X6()),W1.exports}var _=$6(),X1={exports:{}},gt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bw;function K6(){if(Bw)return gt;Bw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),v=Symbol.iterator;function E(ee){return ee===null||typeof ee!="object"?null:(ee=v&&ee[v]||ee["@@iterator"],typeof ee=="function"?ee:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,A={};function I(ee,B,Q){this.props=ee,this.context=B,this.refs=A,this.updater=Q||w}I.prototype.isReactComponent={},I.prototype.setState=function(ee,B){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,B,"setState")},I.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function O(){}O.prototype=I.prototype;function D(ee,B,Q){this.props=ee,this.context=B,this.refs=A,this.updater=Q||w}var q=D.prototype=new O;q.constructor=D,T(q,I.prototype),q.isPureReactComponent=!0;var Y=Array.isArray;function W(){}var N={H:null,A:null,T:null,S:null},b=Object.prototype.hasOwnProperty;function k(ee,B,Q){var J=Q.ref;return{$$typeof:t,type:ee,key:B,ref:J!==void 0?J:null,props:Q}}function F(ee,B){return k(ee.type,B,ee.props)}function P(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===t}function M(ee){var B={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(Q){return B[Q]})}var j=/\/+/g;function Le(ee,B){return typeof ee=="object"&&ee!==null&&ee.key!=null?M(""+ee.key):B.toString(36)}function De(ee){switch(ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:switch(typeof ee.status=="string"?ee.then(W,W):(ee.status="pending",ee.then(function(B){ee.status==="pending"&&(ee.status="fulfilled",ee.value=B)},function(B){ee.status==="pending"&&(ee.status="rejected",ee.reason=B)})),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}}throw ee}function ne(ee,B,Q,J,te){var ce=typeof ee;(ce==="undefined"||ce==="boolean")&&(ee=null);var Se=!1;if(ee===null)Se=!0;else switch(ce){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(ee.$$typeof){case t:case e:Se=!0;break;case m:return Se=ee._init,ne(Se(ee._payload),B,Q,J,te)}}if(Se)return te=te(ee),Se=J===""?"."+Le(ee,0):J,Y(te)?(Q="",Se!=null&&(Q=Se.replace(j,"$&/")+"/"),ne(te,B,Q,"",function(se){return se})):te!=null&&(P(te)&&(te=F(te,Q+(te.key==null||ee&&ee.key===te.key?"":(""+te.key).replace(j,"$&/")+"/")+Se)),B.push(te)),1;Se=0;var Oe=J===""?".":J+":";if(Y(ee))for(var ke=0;ke<ee.length;ke++)J=ee[ke],ce=Oe+Le(J,ke),Se+=ne(J,B,Q,ce,te);else if(ke=E(ee),typeof ke=="function")for(ee=ke.call(ee),ke=0;!(J=ee.next()).done;)J=J.value,ce=Oe+Le(J,ke++),Se+=ne(J,B,Q,ce,te);else if(ce==="object"){if(typeof ee.then=="function")return ne(De(ee),B,Q,J,te);throw B=String(ee),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.")}return Se}function ae(ee,B,Q){if(ee==null)return ee;var J=[],te=0;return ne(ee,J,"","",function(ce){return B.call(Q,ce,te++)}),J}function fe(ee){if(ee._status===-1){var B=ee._result;B=B(),B.then(function(Q){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=Q)},function(Q){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=Q)}),ee._status===-1&&(ee._status=0,ee._result=B)}if(ee._status===1)return ee._result.default;throw ee._result}var ie=typeof reportError=="function"?reportError:function(ee){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var B=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ee=="object"&&ee!==null&&typeof ee.message=="string"?String(ee.message):String(ee),error:ee});if(!window.dispatchEvent(B))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ee);return}console.error(ee)},Fe={map:ae,forEach:function(ee,B,Q){ae(ee,function(){B.apply(this,arguments)},Q)},count:function(ee){var B=0;return ae(ee,function(){B++}),B},toArray:function(ee){return ae(ee,function(B){return B})||[]},only:function(ee){if(!P(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}};return gt.Activity=x,gt.Children=Fe,gt.Component=I,gt.Fragment=r,gt.Profiler=a,gt.PureComponent=D,gt.StrictMode=n,gt.Suspense=f,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,gt.__COMPILER_RUNTIME={__proto__:null,c:function(ee){return N.H.useMemoCache(ee)}},gt.cache=function(ee){return function(){return ee.apply(null,arguments)}},gt.cacheSignal=function(){return null},gt.cloneElement=function(ee,B,Q){if(ee==null)throw Error("The argument must be a React element, but you passed "+ee+".");var J=T({},ee.props),te=ee.key;if(B!=null)for(ce in B.key!==void 0&&(te=""+B.key),B)!b.call(B,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&B.ref===void 0||(J[ce]=B[ce]);var ce=arguments.length-2;if(ce===1)J.children=Q;else if(1<ce){for(var Se=Array(ce),Oe=0;Oe<ce;Oe++)Se[Oe]=arguments[Oe+2];J.children=Se}return k(ee.type,te,J)},gt.createContext=function(ee){return ee={$$typeof:l,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null},ee.Provider=ee,ee.Consumer={$$typeof:i,_context:ee},ee},gt.createElement=function(ee,B,Q){var J,te={},ce=null;if(B!=null)for(J in B.key!==void 0&&(ce=""+B.key),B)b.call(B,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(te[J]=B[J]);var Se=arguments.length-2;if(Se===1)te.children=Q;else if(1<Se){for(var Oe=Array(Se),ke=0;ke<Se;ke++)Oe[ke]=arguments[ke+2];te.children=Oe}if(ee&&ee.defaultProps)for(J in Se=ee.defaultProps,Se)te[J]===void 0&&(te[J]=Se[J]);return k(ee,ce,te)},gt.createRef=function(){return{current:null}},gt.forwardRef=function(ee){return{$$typeof:u,render:ee}},gt.isValidElement=P,gt.lazy=function(ee){return{$$typeof:m,_payload:{_status:-1,_result:ee},_init:fe}},gt.memo=function(ee,B){return{$$typeof:h,type:ee,compare:B===void 0?null:B}},gt.startTransition=function(ee){var B=N.T,Q={};N.T=Q;try{var J=ee(),te=N.S;te!==null&&te(Q,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(W,ie)}catch(ce){ie(ce)}finally{B!==null&&Q.types!==null&&(B.types=Q.types),N.T=B}},gt.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},gt.use=function(ee){return N.H.use(ee)},gt.useActionState=function(ee,B,Q){return N.H.useActionState(ee,B,Q)},gt.useCallback=function(ee,B){return N.H.useCallback(ee,B)},gt.useContext=function(ee){return N.H.useContext(ee)},gt.useDebugValue=function(){},gt.useDeferredValue=function(ee,B){return N.H.useDeferredValue(ee,B)},gt.useEffect=function(ee,B){return N.H.useEffect(ee,B)},gt.useEffectEvent=function(ee){return N.H.useEffectEvent(ee)},gt.useId=function(){return N.H.useId()},gt.useImperativeHandle=function(ee,B,Q){return N.H.useImperativeHandle(ee,B,Q)},gt.useInsertionEffect=function(ee,B){return N.H.useInsertionEffect(ee,B)},gt.useLayoutEffect=function(ee,B){return N.H.useLayoutEffect(ee,B)},gt.useMemo=function(ee,B){return N.H.useMemo(ee,B)},gt.useOptimistic=function(ee,B){return N.H.useOptimistic(ee,B)},gt.useReducer=function(ee,B,Q){return N.H.useReducer(ee,B,Q)},gt.useRef=function(ee){return N.H.useRef(ee)},gt.useState=function(ee){return N.H.useState(ee)},gt.useSyncExternalStore=function(ee,B,Q){return N.H.useSyncExternalStore(ee,B,Q)},gt.useTransition=function(){return N.H.useTransition()},gt.version="19.2.0",gt}var jw;function $v(){return jw||(jw=1,X1.exports=K6()),X1.exports}var xe=$v();const Y6=W6(xe);var $1={exports:{}},Wf={},K1={exports:{}},Y1={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uw;function Q6(){return Uw||(Uw=1,(function(t){function e(ne,ae){var fe=ne.length;ne.push(ae);e:for(;0<fe;){var ie=fe-1>>>1,Fe=ne[ie];if(0<a(Fe,ae))ne[ie]=ae,ne[fe]=Fe,fe=ie;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var ae=ne[0],fe=ne.pop();if(fe!==ae){ne[0]=fe;e:for(var ie=0,Fe=ne.length,ee=Fe>>>1;ie<ee;){var B=2*(ie+1)-1,Q=ne[B],J=B+1,te=ne[J];if(0>a(Q,fe))J<Fe&&0>a(te,Q)?(ne[ie]=te,ne[J]=fe,ie=J):(ne[ie]=Q,ne[B]=fe,ie=B);else if(J<Fe&&0>a(te,fe))ne[ie]=te,ne[J]=fe,ie=J;else break e}}return ae}function a(ne,ae){var fe=ne.sortIndex-ae.sortIndex;return fe!==0?fe:ne.id-ae.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var f=[],h=[],m=1,x=null,v=3,E=!1,w=!1,T=!1,A=!1,I=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function q(ne){for(var ae=r(h);ae!==null;){if(ae.callback===null)n(h);else if(ae.startTime<=ne)n(h),ae.sortIndex=ae.expirationTime,e(f,ae);else break;ae=r(h)}}function Y(ne){if(T=!1,q(ne),!w)if(r(f)!==null)w=!0,W||(W=!0,M());else{var ae=r(h);ae!==null&&De(Y,ae.startTime-ne)}}var W=!1,N=-1,b=5,k=-1;function F(){return A?!0:!(t.unstable_now()-k<b)}function P(){if(A=!1,W){var ne=t.unstable_now();k=ne;var ae=!0;try{e:{w=!1,T&&(T=!1,O(N),N=-1),E=!0;var fe=v;try{t:{for(q(ne),x=r(f);x!==null&&!(x.expirationTime>ne&&F());){var ie=x.callback;if(typeof ie=="function"){x.callback=null,v=x.priorityLevel;var Fe=ie(x.expirationTime<=ne);if(ne=t.unstable_now(),typeof Fe=="function"){x.callback=Fe,q(ne),ae=!0;break t}x===r(f)&&n(f),q(ne)}else n(f);x=r(f)}if(x!==null)ae=!0;else{var ee=r(h);ee!==null&&De(Y,ee.startTime-ne),ae=!1}}break e}finally{x=null,v=fe,E=!1}ae=void 0}}finally{ae?M():W=!1}}}var M;if(typeof D=="function")M=function(){D(P)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Le=j.port2;j.port1.onmessage=P,M=function(){Le.postMessage(null)}}else M=function(){I(P,0)};function De(ne,ae){N=I(function(){ne(t.unstable_now())},ae)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(ne){switch(v){case 1:case 2:case 3:var ae=3;break;default:ae=v}var fe=v;v=ae;try{return ne()}finally{v=fe}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(ne,ae){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var fe=v;v=ne;try{return ae()}finally{v=fe}},t.unstable_scheduleCallback=function(ne,ae,fe){var ie=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ie+fe:ie):fe=ie,ne){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=fe+Fe,ne={id:m++,callback:ae,priorityLevel:ne,startTime:fe,expirationTime:Fe,sortIndex:-1},fe>ie?(ne.sortIndex=fe,e(h,ne),r(f)===null&&ne===r(h)&&(T?(O(N),N=-1):T=!0,De(Y,fe-ie))):(ne.sortIndex=Fe,e(f,ne),w||E||(w=!0,W||(W=!0,M()))),ne},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(ne){var ae=v;return function(){var fe=v;v=ae;try{return ne.apply(this,arguments)}finally{v=fe}}}})(Y1)),Y1}var zw;function J6(){return zw||(zw=1,K1.exports=Q6()),K1.exports}var Q1={exports:{}},Rn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hw;function Z6(){if(Hw)return Rn;Hw=1;var t=$v();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(f,h,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:f,containerInfo:h,implementation:m}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Rn.createPortal=function(f,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return i(f,h,null,m)},Rn.flushSync=function(f){var h=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=h,n.p=m,n.d.f()}},Rn.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(f,h))},Rn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Rn.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin),v=typeof h.integrity=="string"?h.integrity:void 0,E=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?n.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:E}):m==="script"&&n.d.X(f,{crossOrigin:x,integrity:v,fetchPriority:E,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Rn.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=u(h.as,h.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(f)},Rn.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,x=u(m,h.crossOrigin);n.d.L(f,m,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Rn.preloadModule=function(f,h){if(typeof f=="string")if(h){var m=u(h.as,h.crossOrigin);n.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(f)},Rn.requestFormReset=function(f){n.d.r(f)},Rn.unstable_batchedUpdates=function(f,h){return f(h)},Rn.useFormState=function(f,h,m){return l.H.useFormState(f,h,m)},Rn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Rn.version="19.2.0",Rn}var Gw;function e5(){if(Gw)return Q1.exports;Gw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Q1.exports=Z6(),Q1.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qw;function t5(){if(qw)return Wf;qw=1;var t=J6(),e=$v(),r=e5();function n(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var o=s,c=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(c=o.return),s=o.return;while(s)}return o.tag===3?c:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function u(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function f(s){if(i(s)!==s)throw Error(n(188))}function h(s){var o=s.alternate;if(!o){if(o=i(s),o===null)throw Error(n(188));return o!==s?null:s}for(var c=s,d=o;;){var g=c.return;if(g===null)break;var y=g.alternate;if(y===null){if(d=g.return,d!==null){c=d;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===c)return f(g),s;if(y===d)return f(g),o;y=y.sibling}throw Error(n(188))}if(c.return!==d.return)c=g,d=y;else{for(var C=!1,U=g.child;U;){if(U===c){C=!0,c=g,d=y;break}if(U===d){C=!0,d=g,c=y;break}U=U.sibling}if(!C){for(U=y.child;U;){if(U===c){C=!0,c=y,d=g;break}if(U===d){C=!0,d=y,c=g;break}U=U.sibling}if(!C)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:o}function m(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=m(s),o!==null)return o;s=s.sibling}return null}var x=Object.assign,v=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),O=Symbol.for("react.consumer"),D=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function M(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function Le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case T:return"Fragment";case I:return"Profiler";case A:return"StrictMode";case Y:return"Suspense";case W:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case D:return s.displayName||"Context";case O:return(s._context.displayName||"Context")+".Consumer";case q:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return o=s.displayName||null,o!==null?o:Le(s.type)||"Memo";case b:o=s._payload,s=s._init;try{return Le(s(o))}catch{}}return null}var De=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},ie=[],Fe=-1;function ee(s){return{current:s}}function B(s){0>Fe||(s.current=ie[Fe],ie[Fe]=null,Fe--)}function Q(s,o){Fe++,ie[Fe]=s.current,s.current=o}var J=ee(null),te=ee(null),ce=ee(null),Se=ee(null);function Oe(s,o){switch(Q(ce,o),Q(te,s),Q(J,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?iw(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=iw(o),s=ow(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}B(J),Q(J,s)}function ke(){B(J),B(te),B(ce)}function se(s){s.memoizedState!==null&&Q(Se,s);var o=J.current,c=ow(o,s.type);o!==c&&(Q(te,s),Q(J,c))}function Me(s){te.current===s&&(B(J),B(te)),Se.current===s&&(B(Se),Uf._currentValue=fe)}var V,we;function Ae(s){if(V===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);V=o&&o[1]||"",we=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+V+s+we}var Je=!1;function Ye(s,o){if(!s||Je)return"";Je=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var Ie=function(){throw Error()};if(Object.defineProperty(Ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ie,[])}catch(Te){var _e=Te}Reflect.construct(s,[],Ie)}else{try{Ie.call()}catch(Te){_e=Te}s.call(Ie.prototype)}}else{try{throw Error()}catch(Te){_e=Te}(Ie=s())&&typeof Ie.catch=="function"&&Ie.catch(function(){})}}catch(Te){if(Te&&_e&&typeof Te.stack=="string")return[Te.stack,_e.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),C=y[0],U=y[1];if(C&&U){var re=C.split(`
`),pe=U.split(`
`);for(g=d=0;d<re.length&&!re[d].includes("DetermineComponentFrameRoot");)d++;for(;g<pe.length&&!pe[g].includes("DetermineComponentFrameRoot");)g++;if(d===re.length||g===pe.length)for(d=re.length-1,g=pe.length-1;1<=d&&0<=g&&re[d]!==pe[g];)g--;for(;1<=d&&0<=g;d--,g--)if(re[d]!==pe[g]){if(d!==1||g!==1)do if(d--,g--,0>g||re[d]!==pe[g]){var Ce=`
`+re[d].replace(" at new "," at ");return s.displayName&&Ce.includes("<anonymous>")&&(Ce=Ce.replace("<anonymous>",s.displayName)),Ce}while(1<=d&&0<=g);break}}}finally{Je=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Ae(c):""}function ge(s,o){switch(s.tag){case 26:case 27:case 5:return Ae(s.type);case 16:return Ae("Lazy");case 13:return s.child!==o&&o!==null?Ae("Suspense Fallback"):Ae("Suspense");case 19:return Ae("SuspenseList");case 0:case 15:return Ye(s.type,!1);case 11:return Ye(s.type.render,!1);case 1:return Ye(s.type,!0);case 31:return Ae("Activity");default:return""}}function qe(s){try{var o="",c=null;do o+=ge(s,c),c=s,s=s.return;while(s);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Be=Object.prototype.hasOwnProperty,Qe=t.unstable_scheduleCallback,zt=t.unstable_cancelCallback,Wt=t.unstable_shouldYield,rr=t.unstable_requestPaint,ft=t.unstable_now,lr=t.unstable_getCurrentPriorityLevel,en=t.unstable_ImmediatePriority,ha=t.unstable_UserBlockingPriority,yr=t.unstable_NormalPriority,Zn=t.unstable_LowPriority,vt=t.unstable_IdlePriority,fr=t.log,pn=t.unstable_setDisableYieldValue,Ht=null,hr=null;function Gn(s){if(typeof fr=="function"&&pn(s),hr&&typeof hr.setStrictMode=="function")try{hr.setStrictMode(Ht,s)}catch{}}var wr=Math.clz32?Math.clz32:rl,hc=Math.log,ti=Math.LN2;function rl(s){return s>>>=0,s===0?32:31-(hc(s)/ti|0)|0}var da=256,ri=262144,kr=4194304;function qn(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ra(s,o,c){var d=s.pendingLanes;if(d===0)return 0;var g=0,y=s.suspendedLanes,C=s.pingedLanes;s=s.warmLanes;var U=d&134217727;return U!==0?(d=U&~y,d!==0?g=qn(d):(C&=U,C!==0?g=qn(C):c||(c=U&~s,c!==0&&(g=qn(c))))):(U=d&~y,U!==0?g=qn(U):C!==0?g=qn(C):c||(c=d&~s,c!==0&&(g=qn(c)))),g===0?0:o!==0&&o!==g&&(o&y)===0&&(y=g&-g,c=o&-o,y>=c||y===32&&(c&4194048)!==0)?o:g}function ma(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Yu(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dc(){var s=kr;return kr<<=1,(kr&62914560)===0&&(kr=4194304),s}function Da(s){for(var o=[],c=0;31>c;c++)o.push(s);return o}function ni(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Qu(s,o,c,d,g,y){var C=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var U=s.entanglements,re=s.expirationTimes,pe=s.hiddenUpdates;for(c=C&~c;0<c;){var Ce=31-wr(c),Ie=1<<Ce;U[Ce]=0,re[Ce]=-1;var _e=pe[Ce];if(_e!==null)for(pe[Ce]=null,Ce=0;Ce<_e.length;Ce++){var Te=_e[Ce];Te!==null&&(Te.lane&=-536870913)}c&=~Ie}d!==0&&ai(s,d,0),y!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=y&~(C&~o))}function ai(s,o,c){s.pendingLanes|=o,s.suspendedLanes&=~o;var d=31-wr(o);s.entangledLanes|=o,s.entanglements[d]=s.entanglements[d]|1073741824|c&261930}function si(s,o){var c=s.entangledLanes|=o;for(s=s.entanglements;c;){var d=31-wr(c),g=1<<d;g&o|s[d]&o&&(s[d]|=o),c&=~g}}function nl(s,o){var c=o&-o;return c=(c&42)!==0?1:ii(c),(c&(s.suspendedLanes|o))!==0?0:c}function ii(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function as(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function L(){var s=ae.p;return s!==0?s:(s=window.event,s===void 0?32:Rw(s.type))}function K(s,o){var c=ae.p;try{return ae.p=s,o()}finally{ae.p=c}}var z=Math.random().toString(36).slice(2),G="__reactFiber$"+z,X="__reactProps$"+z,Z="__reactContainer$"+z,de="__reactEvents$"+z,Ne="__reactListeners$"+z,me="__reactHandles$"+z,ye="__reactResources$"+z,ve="__reactMarker$"+z;function ze(s){delete s[G],delete s[X],delete s[de],delete s[Ne],delete s[me]}function He(s){var o=s[G];if(o)return o;for(var c=s.parentNode;c;){if(o=c[Z]||c[G]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(s=mw(s);s!==null;){if(c=s[G])return c;s=mw(s)}return o}s=c,c=s.parentNode}return null}function Ke(s){if(s=s[G]||s[Z]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function je(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(n(33))}function $e(s){var o=s[ye];return o||(o=s[ye]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function tt(s){s[ve]=!0}var $t=new Set,Kt={};function cr(s,o){Cn(s,o),Cn(s+"Capture",o)}function Cn(s,o){for(Kt[s]=o,s=0;s<o.length;s++)$t.add(o[s])}var ss=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),is={},pa={};function Wi(s){return Be.call(pa,s)?!0:Be.call(is,s)?!1:ss.test(s)?pa[s]=!0:(is[s]=!0,!1)}function kn(s,o,c){if(Wi(o))if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+c)}}function ga(s,o,c){if(c===null)s.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+c)}}function Hr(s,o,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(o,c,""+d)}}function ln(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Xi(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ju(s,o,c){var d=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,y=d.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return g.call(this)},set:function(C){c=""+C,y.call(this,C)}}),Object.defineProperty(s,o,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(C){c=""+C},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Yt(s){if(!s._valueTracker){var o=Xi(s)?"checked":"value";s._valueTracker=Ju(s,o,""+s[o])}}function al(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var c=o.getValue(),d="";return s&&(d=Xi(s)?s.checked?"true":"false":s.value),s=d,s!==c?(o.setValue(s),!0):!1}function Ns(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var sl=/[\n"\\]/g;function ea(s){return s.replace(sl,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function mc(s,o,c,d,g,y,C,U){s.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?s.type=C:s.removeAttribute("type"),o!=null?C==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+ln(o)):s.value!==""+ln(o)&&(s.value=""+ln(o)):C!=="submit"&&C!=="reset"||s.removeAttribute("value"),o!=null?Zu(s,C,ln(o)):c!=null?Zu(s,C,ln(c)):d!=null&&s.removeAttribute("value"),g==null&&y!=null&&(s.defaultChecked=!!y),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?s.name=""+ln(U):s.removeAttribute("name")}function N0(s,o,c,d,g,y,C,U){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),o!=null||c!=null){if(!(y!=="submit"&&y!=="reset"||o!=null)){Yt(s);return}c=c!=null?""+ln(c):"",o=o!=null?""+ln(o):c,U||o===s.value||(s.value=o),s.defaultValue=o}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=U?s.checked:!!d,s.defaultChecked=!!d,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(s.name=C),Yt(s)}function Zu(s,o,c){o==="number"&&Ns(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function $i(s,o,c,d){if(s=s.options,o){o={};for(var g=0;g<c.length;g++)o["$"+c[g]]=!0;for(c=0;c<s.length;c++)g=o.hasOwnProperty("$"+s[c].value),s[c].selected!==g&&(s[c].selected=g),g&&d&&(s[c].defaultSelected=!0)}else{for(c=""+ln(c),o=null,g=0;g<s.length;g++){if(s[g].value===c){s[g].selected=!0,d&&(s[g].defaultSelected=!0);return}o!==null||s[g].disabled||(o=s[g])}o!==null&&(o.selected=!0)}}function C0(s,o,c){if(o!=null&&(o=""+ln(o),o!==s.value&&(s.value=o),c==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=c!=null?""+ln(c):""}function Ki(s,o,c,d){if(o==null){if(d!=null){if(c!=null)throw Error(n(92));if(De(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),o=c}c=ln(o),s.defaultValue=c,d=s.textContent,d===c&&d!==""&&d!==null&&(s.value=d),Yt(s)}function ta(s,o){if(o){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=o;return}}s.textContent=o}var k0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ef(s,o,c){var d=o.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":d?s.setProperty(o,c):typeof c!="number"||c===0||k0.has(o)?o==="float"?s.cssFloat=c:s[o]=(""+c).trim():s[o]=c+"px"}function tf(s,o,c){if(o!=null&&typeof o!="object")throw Error(n(62));if(s=s.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var g in o)d=o[g],o.hasOwnProperty(g)&&c[g]!==d&&ef(s,g,d)}else for(var y in o)o.hasOwnProperty(y)&&ef(s,y,o[y])}function pc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var R0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gc(s){return Yi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function os(){}var rf=null;function Ia(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Qi=null,Cs=null;function il(s){var o=Ke(s);if(o&&(s=o.stateNode)){var c=s[X]||null;e:switch(s=o.stateNode,o.type){case"input":if(mc(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),o=c.name,c.type==="radio"&&o!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ea(""+o)+'"][type="radio"]'),o=0;o<c.length;o++){var d=c[o];if(d!==s&&d.form===s.form){var g=d[X]||null;if(!g)throw Error(n(90));mc(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<c.length;o++)d=c[o],d.form===s.form&&al(d)}break e;case"textarea":C0(s,c.value,c.defaultValue);break e;case"select":o=c.value,o!=null&&$i(s,!!c.multiple,o,!1)}}}var xc=!1;function Ji(s,o,c){if(xc)return s(o,c);xc=!0;try{var d=s(o);return d}finally{if(xc=!1,(Qi!==null||Cs!==null)&&(wd(),Qi&&(o=Qi,s=Cs,Cs=Qi=null,il(o),s)))for(o=0;o<s.length;o++)il(s[o])}}function ls(s,o){var c=s.stateNode;if(c===null)return null;var d=c[X]||null;if(d===null)return null;c=d[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var Fa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ol=!1;if(Fa)try{var nr={};Object.defineProperty(nr,"passive",{get:function(){ol=!0}}),window.addEventListener("test",nr,nr),window.removeEventListener("test",nr,nr)}catch{ol=!1}var ks=null,nf=null,ll=null;function af(){if(ll)return ll;var s,o=nf,c=o.length,d,g="value"in ks?ks.value:ks.textContent,y=g.length;for(s=0;s<c&&o[s]===g[s];s++);var C=c-s;for(d=1;d<=C&&o[c-d]===g[y-d];d++);return ll=g.slice(s,1<d?1-d:void 0)}function cl(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function oi(){return!0}function cs(){return!1}function gn(s){function o(c,d,g,y,C){this._reactName=c,this._targetInst=g,this.type=d,this.nativeEvent=y,this.target=C,this.currentTarget=null;for(var U in s)s.hasOwnProperty(U)&&(c=s[U],this[U]=c?c(y):y[U]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?oi:cs,this.isPropagationStopped=cs,this}return x(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=oi)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=oi)},persist:function(){},isPersistent:oi}),o}var li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rs=gn(li),Zi=x({},li,{view:0,detail:0}),sf=gn(Zi),eo,vc,Ds,yc=x({},Zi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:to,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ds&&(Ds&&s.type==="mousemove"?(eo=s.screenX-Ds.screenX,vc=s.screenY-Ds.screenY):vc=eo=0,Ds=s),eo)},movementY:function(s){return"movementY"in s?s.movementY:vc}}),of=gn(yc),ul=x({},yc,{dataTransfer:0}),D0=gn(ul),I0=x({},Zi,{relatedTarget:0}),fl=gn(I0),lf=x({},li,{animationName:0,elapsedTime:0,pseudoElement:0}),F0=gn(lf),_c=x({},li,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),O0=gn(_c),M0=x({},li,{data:0}),Is=gn(M0),P0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},L0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function B0(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=V0[s])?!!o[s]:!1}function to(){return B0}var Wn=x({},Zi,{key:function(s){if(s.key){var o=P0[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=cl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?L0[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:to,charCode:function(s){return s.type==="keypress"?cl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?cl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),j0=gn(Wn),U0=x({},yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ci=gn(U0),p=x({},Zi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:to}),S=gn(p),R=x({},li,{propertyName:0,elapsedTime:0,pseudoElement:0}),H=gn(R),ue=x({},yc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ee=gn(ue),Xe=x({},li,{newState:0,oldState:0}),yt=gn(Xe),Pr=[9,13,27,32],Gt=Fa&&"CompositionEvent"in window,_r=null;Fa&&"documentMode"in document&&(_r=document.documentMode);var Oa=Fa&&"TextEvent"in window&&!_r,Fs=Fa&&(!Gt||_r&&8<_r&&11>=_r),us=" ",fs=!1;function hl(s,o){switch(s){case"keyup":return Pr.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ec(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Tc=!1;function gI(s,o){switch(s){case"compositionend":return Ec(o);case"keypress":return o.which!==32?null:(fs=!0,us);case"textInput":return s=o.data,s===us&&fs?null:s;default:return null}}function xI(s,o){if(Tc)return s==="compositionend"||!Gt&&hl(s,o)?(s=af(),ll=nf=ks=null,Tc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Fs&&o.locale!=="ko"?null:o.data;default:return null}}var vI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x2(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!vI[s.type]:o==="textarea"}function v2(s,o,c,d){Qi?Cs?Cs.push(d):Cs=[d]:Qi=d,o=Rd(o,"onChange"),0<o.length&&(c=new Rs("onChange","change",null,c,d),s.push({event:c,listeners:o}))}var cf=null,uf=null;function yI(s){ew(s,0)}function z0(s){var o=je(s);if(al(o))return s}function y2(s,o){if(s==="change")return o}var _2=!1;if(Fa){var Zp;if(Fa){var eg="oninput"in document;if(!eg){var E2=document.createElement("div");E2.setAttribute("oninput","return;"),eg=typeof E2.oninput=="function"}Zp=eg}else Zp=!1;_2=Zp&&(!document.documentMode||9<document.documentMode)}function T2(){cf&&(cf.detachEvent("onpropertychange",w2),uf=cf=null)}function w2(s){if(s.propertyName==="value"&&z0(uf)){var o=[];v2(o,uf,s,Ia(s)),Ji(yI,o)}}function _I(s,o,c){s==="focusin"?(T2(),cf=o,uf=c,cf.attachEvent("onpropertychange",w2)):s==="focusout"&&T2()}function EI(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return z0(uf)}function TI(s,o){if(s==="click")return z0(o)}function wI(s,o){if(s==="input"||s==="change")return z0(o)}function SI(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var xa=typeof Object.is=="function"?Object.is:SI;function ff(s,o){if(xa(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var c=Object.keys(s),d=Object.keys(o);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var g=c[d];if(!Be.call(o,g)||!xa(s[g],o[g]))return!1}return!0}function S2(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function A2(s,o){var c=S2(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=o&&d>=o)return{node:c,offset:o-s};s=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=S2(c)}}function b2(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?b2(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function N2(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Ns(s.document);o instanceof s.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)s=o.contentWindow;else break;o=Ns(s.document)}return o}function tg(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var AI=Fa&&"documentMode"in document&&11>=document.documentMode,wc=null,rg=null,hf=null,ng=!1;function C2(s,o,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;ng||wc==null||wc!==Ns(d)||(d=wc,"selectionStart"in d&&tg(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),hf&&ff(hf,d)||(hf=d,d=Rd(rg,"onSelect"),0<d.length&&(o=new Rs("onSelect","select",null,o,c),s.push({event:o,listeners:d}),o.target=wc)))}function dl(s,o){var c={};return c[s.toLowerCase()]=o.toLowerCase(),c["Webkit"+s]="webkit"+o,c["Moz"+s]="moz"+o,c}var Sc={animationend:dl("Animation","AnimationEnd"),animationiteration:dl("Animation","AnimationIteration"),animationstart:dl("Animation","AnimationStart"),transitionrun:dl("Transition","TransitionRun"),transitionstart:dl("Transition","TransitionStart"),transitioncancel:dl("Transition","TransitionCancel"),transitionend:dl("Transition","TransitionEnd")},ag={},k2={};Fa&&(k2=document.createElement("div").style,"AnimationEvent"in window||(delete Sc.animationend.animation,delete Sc.animationiteration.animation,delete Sc.animationstart.animation),"TransitionEvent"in window||delete Sc.transitionend.transition);function ml(s){if(ag[s])return ag[s];if(!Sc[s])return s;var o=Sc[s],c;for(c in o)if(o.hasOwnProperty(c)&&c in k2)return ag[s]=o[c];return s}var R2=ml("animationend"),D2=ml("animationiteration"),I2=ml("animationstart"),bI=ml("transitionrun"),NI=ml("transitionstart"),CI=ml("transitioncancel"),F2=ml("transitionend"),O2=new Map,sg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sg.push("scrollEnd");function hs(s,o){O2.set(s,o),cr(o,[s])}var H0=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ma=[],Ac=0,ig=0;function G0(){for(var s=Ac,o=ig=Ac=0;o<s;){var c=Ma[o];Ma[o++]=null;var d=Ma[o];Ma[o++]=null;var g=Ma[o];Ma[o++]=null;var y=Ma[o];if(Ma[o++]=null,d!==null&&g!==null){var C=d.pending;C===null?g.next=g:(g.next=C.next,C.next=g),d.pending=g}y!==0&&M2(c,g,y)}}function q0(s,o,c,d){Ma[Ac++]=s,Ma[Ac++]=o,Ma[Ac++]=c,Ma[Ac++]=d,ig|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function og(s,o,c,d){return q0(s,o,c,d),W0(s)}function pl(s,o){return q0(s,null,null,o),W0(s)}function M2(s,o,c){s.lanes|=c;var d=s.alternate;d!==null&&(d.lanes|=c);for(var g=!1,y=s.return;y!==null;)y.childLanes|=c,d=y.alternate,d!==null&&(d.childLanes|=c),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(g=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,g&&o!==null&&(g=31-wr(c),s=y.hiddenUpdates,d=s[g],d===null?s[g]=[o]:d.push(o),o.lane=c|536870912),y):null}function W0(s){if(50<Of)throw Of=0,g1=null,Error(n(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var bc={};function kI(s,o,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(s,o,c,d){return new kI(s,o,c,d)}function lg(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ui(s,o){var c=s.alternate;return c===null?(c=va(s.tag,o,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=o,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,o=s.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function P2(s,o){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,o=c.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function X0(s,o,c,d,g,y){var C=0;if(d=s,typeof s=="function")lg(s)&&(C=1);else if(typeof s=="string")C=O6(s,c,J.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=va(31,c,o,g),s.elementType=k,s.lanes=y,s;case T:return gl(c.children,g,y,o);case A:C=8,g|=24;break;case I:return s=va(12,c,o,g|2),s.elementType=I,s.lanes=y,s;case Y:return s=va(13,c,o,g),s.elementType=Y,s.lanes=y,s;case W:return s=va(19,c,o,g),s.elementType=W,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:C=10;break e;case O:C=9;break e;case q:C=11;break e;case N:C=14;break e;case b:C=16,d=null;break e}C=29,c=Error(n(130,s===null?"null":typeof s,"")),d=null}return o=va(C,c,o,g),o.elementType=s,o.type=d,o.lanes=y,o}function gl(s,o,c,d){return s=va(7,s,d,o),s.lanes=c,s}function cg(s,o,c){return s=va(6,s,null,o),s.lanes=c,s}function L2(s){var o=va(18,null,null,0);return o.stateNode=s,o}function ug(s,o,c){return o=va(4,s.children!==null?s.children:[],s.key,o),o.lanes=c,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var V2=new WeakMap;function Pa(s,o){if(typeof s=="object"&&s!==null){var c=V2.get(s);return c!==void 0?c:(o={value:s,source:o,stack:qe(o)},V2.set(s,o),o)}return{value:s,source:o,stack:qe(o)}}var Nc=[],Cc=0,$0=null,df=0,La=[],Va=0,ro=null,Os=1,Ms="";function fi(s,o){Nc[Cc++]=df,Nc[Cc++]=$0,$0=s,df=o}function B2(s,o,c){La[Va++]=Os,La[Va++]=Ms,La[Va++]=ro,ro=s;var d=Os;s=Ms;var g=32-wr(d)-1;d&=~(1<<g),c+=1;var y=32-wr(o)+g;if(30<y){var C=g-g%5;y=(d&(1<<C)-1).toString(32),d>>=C,g-=C,Os=1<<32-wr(o)+g|c<<g|d,Ms=y+s}else Os=1<<y|c<<g|d,Ms=s}function fg(s){s.return!==null&&(fi(s,1),B2(s,1,0))}function hg(s){for(;s===$0;)$0=Nc[--Cc],Nc[Cc]=null,df=Nc[--Cc],Nc[Cc]=null;for(;s===ro;)ro=La[--Va],La[Va]=null,Ms=La[--Va],La[Va]=null,Os=La[--Va],La[Va]=null}function j2(s,o){La[Va++]=Os,La[Va++]=Ms,La[Va++]=ro,Os=o.id,Ms=o.overflow,ro=s}var xn=null,dr=null,Ot=!1,no=null,Ba=!1,dg=Error(n(519));function ao(s){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mf(Pa(o,s)),dg}function U2(s){var o=s.stateNode,c=s.type,d=s.memoizedProps;switch(o[G]=s,o[X]=d,c){case"dialog":Ct("cancel",o),Ct("close",o);break;case"iframe":case"object":case"embed":Ct("load",o);break;case"video":case"audio":for(c=0;c<Pf.length;c++)Ct(Pf[c],o);break;case"source":Ct("error",o);break;case"img":case"image":case"link":Ct("error",o),Ct("load",o);break;case"details":Ct("toggle",o);break;case"input":Ct("invalid",o),N0(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Ct("invalid",o);break;case"textarea":Ct("invalid",o),Ki(o,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||o.textContent===""+c||d.suppressHydrationWarning===!0||aw(o.textContent,c)?(d.popover!=null&&(Ct("beforetoggle",o),Ct("toggle",o)),d.onScroll!=null&&Ct("scroll",o),d.onScrollEnd!=null&&Ct("scrollend",o),d.onClick!=null&&(o.onclick=os),o=!0):o=!1,o||ao(s,!0)}function z2(s){for(xn=s.return;xn;)switch(xn.tag){case 5:case 31:case 13:Ba=!1;return;case 27:case 3:Ba=!0;return;default:xn=xn.return}}function kc(s){if(s!==xn)return!1;if(!Ot)return z2(s),Ot=!0,!1;var o=s.tag,c;if((c=o!==3&&o!==27)&&((c=o===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||D1(s.type,s.memoizedProps)),c=!c),c&&dr&&ao(s),z2(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));dr=dw(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));dr=dw(s)}else o===27?(o=dr,yo(s.type)?(s=P1,P1=null,dr=s):dr=o):dr=xn?Ua(s.stateNode.nextSibling):null;return!0}function xl(){dr=xn=null,Ot=!1}function mg(){var s=no;return s!==null&&(sa===null?sa=s:sa.push.apply(sa,s),no=null),s}function mf(s){no===null?no=[s]:no.push(s)}var pg=ee(null),vl=null,hi=null;function so(s,o,c){Q(pg,o._currentValue),o._currentValue=c}function di(s){s._currentValue=pg.current,B(pg)}function gg(s,o,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),s===c)break;s=s.return}}function xg(s,o,c,d){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var y=g.dependencies;if(y!==null){var C=g.child;y=y.firstContext;e:for(;y!==null;){var U=y;y=g;for(var re=0;re<o.length;re++)if(U.context===o[re]){y.lanes|=c,U=y.alternate,U!==null&&(U.lanes|=c),gg(y.return,c,s),d||(C=null);break e}y=U.next}}else if(g.tag===18){if(C=g.return,C===null)throw Error(n(341));C.lanes|=c,y=C.alternate,y!==null&&(y.lanes|=c),gg(C,c,s),C=null}else C=g.child;if(C!==null)C.return=g;else for(C=g;C!==null;){if(C===s){C=null;break}if(g=C.sibling,g!==null){g.return=C.return,C=g;break}C=C.return}g=C}}function Rc(s,o,c,d){s=null;for(var g=o,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var C=g.alternate;if(C===null)throw Error(n(387));if(C=C.memoizedProps,C!==null){var U=g.type;xa(g.pendingProps.value,C.value)||(s!==null?s.push(U):s=[U])}}else if(g===Se.current){if(C=g.alternate,C===null)throw Error(n(387));C.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(Uf):s=[Uf])}g=g.return}s!==null&&xg(o,s,c,d),o.flags|=262144}function K0(s){for(s=s.firstContext;s!==null;){if(!xa(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function yl(s){vl=s,hi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function vn(s){return H2(vl,s)}function Y0(s,o){return vl===null&&yl(s),H2(s,o)}function H2(s,o){var c=o._currentValue;if(o={context:o,memoizedValue:c,next:null},hi===null){if(s===null)throw Error(n(308));hi=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else hi=hi.next=o;return c}var RI=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(c,d){s.push(d)}};this.abort=function(){o.aborted=!0,s.forEach(function(c){return c()})}},DI=t.unstable_scheduleCallback,II=t.unstable_NormalPriority,Gr={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vg(){return{controller:new RI,data:new Map,refCount:0}}function pf(s){s.refCount--,s.refCount===0&&DI(II,function(){s.controller.abort()})}var gf=null,yg=0,Dc=0,Ic=null;function FI(s,o){if(gf===null){var c=gf=[];yg=0,Dc=T1(),Ic={status:"pending",value:void 0,then:function(d){c.push(d)}}}return yg++,o.then(G2,G2),o}function G2(){if(--yg===0&&gf!==null){Ic!==null&&(Ic.status="fulfilled");var s=gf;gf=null,Dc=0,Ic=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function OI(s,o){var c=[],d={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return s.then(function(){d.status="fulfilled",d.value=o;for(var g=0;g<c.length;g++)(0,c[g])(o)},function(g){for(d.status="rejected",d.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),d}var q2=ne.S;ne.S=function(s,o){CT=ft(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&FI(s,o),q2!==null&&q2(s,o)};var _l=ee(null);function _g(){var s=_l.current;return s!==null?s:ur.pooledCache}function Q0(s,o){o===null?Q(_l,_l.current):Q(_l,o.pool)}function W2(){var s=_g();return s===null?null:{parent:Gr._currentValue,pool:s}}var Fc=Error(n(460)),Eg=Error(n(474)),J0=Error(n(542)),Z0={then:function(){}};function X2(s){return s=s.status,s==="fulfilled"||s==="rejected"}function $2(s,o,c){switch(c=s[c],c===void 0?s.push(o):c!==o&&(o.then(os,os),o=c),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Y2(s),s;default:if(typeof o.status=="string")o.then(os,os);else{if(s=ur,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=o,s.status="pending",s.then(function(d){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=d}},function(d){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Y2(s),s}throw Tl=o,Fc}}function El(s){try{var o=s._init;return o(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Tl=c,Fc):c}}var Tl=null;function K2(){if(Tl===null)throw Error(n(459));var s=Tl;return Tl=null,s}function Y2(s){if(s===Fc||s===J0)throw Error(n(483))}var Oc=null,xf=0;function ed(s){var o=xf;return xf+=1,Oc===null&&(Oc=[]),$2(Oc,s,o)}function vf(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function td(s,o){throw o.$$typeof===v?Error(n(525)):(s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function Q2(s){function o(le,oe){if(s){var he=le.deletions;he===null?(le.deletions=[oe],le.flags|=16):he.push(oe)}}function c(le,oe){if(!s)return null;for(;oe!==null;)o(le,oe),oe=oe.sibling;return null}function d(le){for(var oe=new Map;le!==null;)le.key!==null?oe.set(le.key,le):oe.set(le.index,le),le=le.sibling;return oe}function g(le,oe){return le=ui(le,oe),le.index=0,le.sibling=null,le}function y(le,oe,he){return le.index=he,s?(he=le.alternate,he!==null?(he=he.index,he<oe?(le.flags|=67108866,oe):he):(le.flags|=67108866,oe)):(le.flags|=1048576,oe)}function C(le){return s&&le.alternate===null&&(le.flags|=67108866),le}function U(le,oe,he,Re){return oe===null||oe.tag!==6?(oe=cg(he,le.mode,Re),oe.return=le,oe):(oe=g(oe,he),oe.return=le,oe)}function re(le,oe,he,Re){var at=he.type;return at===T?Ce(le,oe,he.props.children,Re,he.key):oe!==null&&(oe.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===b&&El(at)===oe.type)?(oe=g(oe,he.props),vf(oe,he),oe.return=le,oe):(oe=X0(he.type,he.key,he.props,null,le.mode,Re),vf(oe,he),oe.return=le,oe)}function pe(le,oe,he,Re){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==he.containerInfo||oe.stateNode.implementation!==he.implementation?(oe=ug(he,le.mode,Re),oe.return=le,oe):(oe=g(oe,he.children||[]),oe.return=le,oe)}function Ce(le,oe,he,Re,at){return oe===null||oe.tag!==7?(oe=gl(he,le.mode,Re,at),oe.return=le,oe):(oe=g(oe,he),oe.return=le,oe)}function Ie(le,oe,he){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return oe=cg(""+oe,le.mode,he),oe.return=le,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case E:return he=X0(oe.type,oe.key,oe.props,null,le.mode,he),vf(he,oe),he.return=le,he;case w:return oe=ug(oe,le.mode,he),oe.return=le,oe;case b:return oe=El(oe),Ie(le,oe,he)}if(De(oe)||M(oe))return oe=gl(oe,le.mode,he,null),oe.return=le,oe;if(typeof oe.then=="function")return Ie(le,ed(oe),he);if(oe.$$typeof===D)return Ie(le,Y0(le,oe),he);td(le,oe)}return null}function _e(le,oe,he,Re){var at=oe!==null?oe.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return at!==null?null:U(le,oe,""+he,Re);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case E:return he.key===at?re(le,oe,he,Re):null;case w:return he.key===at?pe(le,oe,he,Re):null;case b:return he=El(he),_e(le,oe,he,Re)}if(De(he)||M(he))return at!==null?null:Ce(le,oe,he,Re,null);if(typeof he.then=="function")return _e(le,oe,ed(he),Re);if(he.$$typeof===D)return _e(le,oe,Y0(le,he),Re);td(le,he)}return null}function Te(le,oe,he,Re,at){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return le=le.get(he)||null,U(oe,le,""+Re,at);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case E:return le=le.get(Re.key===null?he:Re.key)||null,re(oe,le,Re,at);case w:return le=le.get(Re.key===null?he:Re.key)||null,pe(oe,le,Re,at);case b:return Re=El(Re),Te(le,oe,he,Re,at)}if(De(Re)||M(Re))return le=le.get(he)||null,Ce(oe,le,Re,at,null);if(typeof Re.then=="function")return Te(le,oe,he,ed(Re),at);if(Re.$$typeof===D)return Te(le,oe,he,Y0(oe,Re),at);td(oe,Re)}return null}function et(le,oe,he,Re){for(var at=null,Bt=null,rt=oe,Tt=oe=0,Rt=null;rt!==null&&Tt<he.length;Tt++){rt.index>Tt?(Rt=rt,rt=null):Rt=rt.sibling;var jt=_e(le,rt,he[Tt],Re);if(jt===null){rt===null&&(rt=Rt);break}s&&rt&&jt.alternate===null&&o(le,rt),oe=y(jt,oe,Tt),Bt===null?at=jt:Bt.sibling=jt,Bt=jt,rt=Rt}if(Tt===he.length)return c(le,rt),Ot&&fi(le,Tt),at;if(rt===null){for(;Tt<he.length;Tt++)rt=Ie(le,he[Tt],Re),rt!==null&&(oe=y(rt,oe,Tt),Bt===null?at=rt:Bt.sibling=rt,Bt=rt);return Ot&&fi(le,Tt),at}for(rt=d(rt);Tt<he.length;Tt++)Rt=Te(rt,le,Tt,he[Tt],Re),Rt!==null&&(s&&Rt.alternate!==null&&rt.delete(Rt.key===null?Tt:Rt.key),oe=y(Rt,oe,Tt),Bt===null?at=Rt:Bt.sibling=Rt,Bt=Rt);return s&&rt.forEach(function(So){return o(le,So)}),Ot&&fi(le,Tt),at}function ot(le,oe,he,Re){if(he==null)throw Error(n(151));for(var at=null,Bt=null,rt=oe,Tt=oe=0,Rt=null,jt=he.next();rt!==null&&!jt.done;Tt++,jt=he.next()){rt.index>Tt?(Rt=rt,rt=null):Rt=rt.sibling;var So=_e(le,rt,jt.value,Re);if(So===null){rt===null&&(rt=Rt);break}s&&rt&&So.alternate===null&&o(le,rt),oe=y(So,oe,Tt),Bt===null?at=So:Bt.sibling=So,Bt=So,rt=Rt}if(jt.done)return c(le,rt),Ot&&fi(le,Tt),at;if(rt===null){for(;!jt.done;Tt++,jt=he.next())jt=Ie(le,jt.value,Re),jt!==null&&(oe=y(jt,oe,Tt),Bt===null?at=jt:Bt.sibling=jt,Bt=jt);return Ot&&fi(le,Tt),at}for(rt=d(rt);!jt.done;Tt++,jt=he.next())jt=Te(rt,le,Tt,jt.value,Re),jt!==null&&(s&&jt.alternate!==null&&rt.delete(jt.key===null?Tt:jt.key),oe=y(jt,oe,Tt),Bt===null?at=jt:Bt.sibling=jt,Bt=jt);return s&&rt.forEach(function(q6){return o(le,q6)}),Ot&&fi(le,Tt),at}function ir(le,oe,he,Re){if(typeof he=="object"&&he!==null&&he.type===T&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case E:e:{for(var at=he.key;oe!==null;){if(oe.key===at){if(at=he.type,at===T){if(oe.tag===7){c(le,oe.sibling),Re=g(oe,he.props.children),Re.return=le,le=Re;break e}}else if(oe.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===b&&El(at)===oe.type){c(le,oe.sibling),Re=g(oe,he.props),vf(Re,he),Re.return=le,le=Re;break e}c(le,oe);break}else o(le,oe);oe=oe.sibling}he.type===T?(Re=gl(he.props.children,le.mode,Re,he.key),Re.return=le,le=Re):(Re=X0(he.type,he.key,he.props,null,le.mode,Re),vf(Re,he),Re.return=le,le=Re)}return C(le);case w:e:{for(at=he.key;oe!==null;){if(oe.key===at)if(oe.tag===4&&oe.stateNode.containerInfo===he.containerInfo&&oe.stateNode.implementation===he.implementation){c(le,oe.sibling),Re=g(oe,he.children||[]),Re.return=le,le=Re;break e}else{c(le,oe);break}else o(le,oe);oe=oe.sibling}Re=ug(he,le.mode,Re),Re.return=le,le=Re}return C(le);case b:return he=El(he),ir(le,oe,he,Re)}if(De(he))return et(le,oe,he,Re);if(M(he)){if(at=M(he),typeof at!="function")throw Error(n(150));return he=at.call(he),ot(le,oe,he,Re)}if(typeof he.then=="function")return ir(le,oe,ed(he),Re);if(he.$$typeof===D)return ir(le,oe,Y0(le,he),Re);td(le,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,oe!==null&&oe.tag===6?(c(le,oe.sibling),Re=g(oe,he),Re.return=le,le=Re):(c(le,oe),Re=cg(he,le.mode,Re),Re.return=le,le=Re),C(le)):c(le,oe)}return function(le,oe,he,Re){try{xf=0;var at=ir(le,oe,he,Re);return Oc=null,at}catch(rt){if(rt===Fc||rt===J0)throw rt;var Bt=va(29,rt,null,le.mode);return Bt.lanes=Re,Bt.return=le,Bt}finally{}}}var wl=Q2(!0),J2=Q2(!1),io=!1;function Tg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wg(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function oo(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function lo(s,o,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(qt&2)!==0){var g=d.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),d.pending=o,o=W0(s),M2(s,null,c),o}return q0(s,d,o,c),W0(s)}function yf(s,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194048)!==0)){var d=o.lanes;d&=s.pendingLanes,c|=d,o.lanes=c,si(s,c)}}function Sg(s,o){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var g=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var C={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};y===null?g=y=C:y=y.next=C,c=c.next}while(c!==null);y===null?g=y=o:y=y.next=o}else g=y=o;c={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=o:s.next=o,c.lastBaseUpdate=o}var Ag=!1;function _f(){if(Ag){var s=Ic;if(s!==null)throw s}}function Ef(s,o,c,d){Ag=!1;var g=s.updateQueue;io=!1;var y=g.firstBaseUpdate,C=g.lastBaseUpdate,U=g.shared.pending;if(U!==null){g.shared.pending=null;var re=U,pe=re.next;re.next=null,C===null?y=pe:C.next=pe,C=re;var Ce=s.alternate;Ce!==null&&(Ce=Ce.updateQueue,U=Ce.lastBaseUpdate,U!==C&&(U===null?Ce.firstBaseUpdate=pe:U.next=pe,Ce.lastBaseUpdate=re))}if(y!==null){var Ie=g.baseState;C=0,Ce=pe=re=null,U=y;do{var _e=U.lane&-536870913,Te=_e!==U.lane;if(Te?(kt&_e)===_e:(d&_e)===_e){_e!==0&&_e===Dc&&(Ag=!0),Ce!==null&&(Ce=Ce.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var et=s,ot=U;_e=o;var ir=c;switch(ot.tag){case 1:if(et=ot.payload,typeof et=="function"){Ie=et.call(ir,Ie,_e);break e}Ie=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=ot.payload,_e=typeof et=="function"?et.call(ir,Ie,_e):et,_e==null)break e;Ie=x({},Ie,_e);break e;case 2:io=!0}}_e=U.callback,_e!==null&&(s.flags|=64,Te&&(s.flags|=8192),Te=g.callbacks,Te===null?g.callbacks=[_e]:Te.push(_e))}else Te={lane:_e,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Ce===null?(pe=Ce=Te,re=Ie):Ce=Ce.next=Te,C|=_e;if(U=U.next,U===null){if(U=g.shared.pending,U===null)break;Te=U,U=Te.next,Te.next=null,g.lastBaseUpdate=Te,g.shared.pending=null}}while(!0);Ce===null&&(re=Ie),g.baseState=re,g.firstBaseUpdate=pe,g.lastBaseUpdate=Ce,y===null&&(g.shared.lanes=0),mo|=C,s.lanes=C,s.memoizedState=Ie}}function Z2(s,o){if(typeof s!="function")throw Error(n(191,s));s.call(o)}function eE(s,o){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Z2(c[s],o)}var Mc=ee(null),rd=ee(0);function tE(s,o){s=Ti,Q(rd,s),Q(Mc,o),Ti=s|o.baseLanes}function bg(){Q(rd,Ti),Q(Mc,Mc.current)}function Ng(){Ti=rd.current,B(Mc),B(rd)}var ya=ee(null),ja=null;function co(s){var o=s.alternate;Q(Lr,Lr.current&1),Q(ya,s),ja===null&&(o===null||Mc.current!==null||o.memoizedState!==null)&&(ja=s)}function Cg(s){Q(Lr,Lr.current),Q(ya,s),ja===null&&(ja=s)}function rE(s){s.tag===22?(Q(Lr,Lr.current),Q(ya,s),ja===null&&(ja=s)):uo()}function uo(){Q(Lr,Lr.current),Q(ya,ya.current)}function _a(s){B(ya),ja===s&&(ja=null),B(Lr)}var Lr=ee(0);function nd(s){for(var o=s;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||O1(c)||M1(c)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var mi=0,_t=null,ar=null,qr=null,ad=!1,Pc=!1,Sl=!1,sd=0,Tf=0,Lc=null,MI=0;function Rr(){throw Error(n(321))}function kg(s,o){if(o===null)return!1;for(var c=0;c<o.length&&c<s.length;c++)if(!xa(s[c],o[c]))return!1;return!0}function Rg(s,o,c,d,g,y){return mi=y,_t=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ne.H=s===null||s.memoizedState===null?BE:qg,Sl=!1,y=c(d,g),Sl=!1,Pc&&(y=aE(o,c,d,g)),nE(s),y}function nE(s){ne.H=Af;var o=ar!==null&&ar.next!==null;if(mi=0,qr=ar=_t=null,ad=!1,Tf=0,Lc=null,o)throw Error(n(300));s===null||Wr||(s=s.dependencies,s!==null&&K0(s)&&(Wr=!0))}function aE(s,o,c,d){_t=s;var g=0;do{if(Pc&&(Lc=null),Tf=0,Pc=!1,25<=g)throw Error(n(301));if(g+=1,qr=ar=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}ne.H=jE,y=o(c,d)}while(Pc);return y}function PI(){var s=ne.H,o=s.useState()[0];return o=typeof o.then=="function"?wf(o):o,s=s.useState()[0],(ar!==null?ar.memoizedState:null)!==s&&(_t.flags|=1024),o}function Dg(){var s=sd!==0;return sd=0,s}function Ig(s,o,c){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~c}function Fg(s){if(ad){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}ad=!1}mi=0,qr=ar=_t=null,Pc=!1,Tf=sd=0,Lc=null}function Xn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qr===null?_t.memoizedState=qr=s:qr=qr.next=s,qr}function Vr(){if(ar===null){var s=_t.alternate;s=s!==null?s.memoizedState:null}else s=ar.next;var o=qr===null?_t.memoizedState:qr.next;if(o!==null)qr=o,ar=s;else{if(s===null)throw _t.alternate===null?Error(n(467)):Error(n(310));ar=s,s={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},qr===null?_t.memoizedState=qr=s:qr=qr.next=s}return qr}function id(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wf(s){var o=Tf;return Tf+=1,Lc===null&&(Lc=[]),s=$2(Lc,s,o),o=_t,(qr===null?o.memoizedState:qr.next)===null&&(o=o.alternate,ne.H=o===null||o.memoizedState===null?BE:qg),s}function od(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return wf(s);if(s.$$typeof===D)return vn(s)}throw Error(n(438,String(s)))}function Og(s){var o=null,c=_t.updateQueue;if(c!==null&&(o=c.memoCache),o==null){var d=_t.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),c===null&&(c=id(),_t.updateQueue=c),c.memoCache=o,c=o.data[o.index],c===void 0)for(c=o.data[o.index]=Array(s),d=0;d<s;d++)c[d]=F;return o.index++,c}function pi(s,o){return typeof o=="function"?o(s):o}function ld(s){var o=Vr();return Mg(o,ar,s)}function Mg(s,o,c){var d=s.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var g=s.baseQueue,y=d.pending;if(y!==null){if(g!==null){var C=g.next;g.next=y.next,y.next=C}o.baseQueue=g=y,d.pending=null}if(y=s.baseState,g===null)s.memoizedState=y;else{o=g.next;var U=C=null,re=null,pe=o,Ce=!1;do{var Ie=pe.lane&-536870913;if(Ie!==pe.lane?(kt&Ie)===Ie:(mi&Ie)===Ie){var _e=pe.revertLane;if(_e===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Ie===Dc&&(Ce=!0);else if((mi&_e)===_e){pe=pe.next,_e===Dc&&(Ce=!0);continue}else Ie={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},re===null?(U=re=Ie,C=y):re=re.next=Ie,_t.lanes|=_e,mo|=_e;Ie=pe.action,Sl&&c(y,Ie),y=pe.hasEagerState?pe.eagerState:c(y,Ie)}else _e={lane:Ie,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},re===null?(U=re=_e,C=y):re=re.next=_e,_t.lanes|=Ie,mo|=Ie;pe=pe.next}while(pe!==null&&pe!==o);if(re===null?C=y:re.next=U,!xa(y,s.memoizedState)&&(Wr=!0,Ce&&(c=Ic,c!==null)))throw c;s.memoizedState=y,s.baseState=C,s.baseQueue=re,d.lastRenderedState=y}return g===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function Pg(s){var o=Vr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var d=c.dispatch,g=c.pending,y=o.memoizedState;if(g!==null){c.pending=null;var C=g=g.next;do y=s(y,C.action),C=C.next;while(C!==g);xa(y,o.memoizedState)||(Wr=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),c.lastRenderedState=y}return[y,d]}function sE(s,o,c){var d=_t,g=Vr(),y=Ot;if(y){if(c===void 0)throw Error(n(407));c=c()}else c=o();var C=!xa((ar||g).memoizedState,c);if(C&&(g.memoizedState=c,Wr=!0),g=g.queue,Bg(lE.bind(null,d,g,s),[s]),g.getSnapshot!==o||C||qr!==null&&qr.memoizedState.tag&1){if(d.flags|=2048,Vc(9,{destroy:void 0},oE.bind(null,d,g,c,o),null),ur===null)throw Error(n(349));y||(mi&127)!==0||iE(d,o,c)}return c}function iE(s,o,c){s.flags|=16384,s={getSnapshot:o,value:c},o=_t.updateQueue,o===null?(o=id(),_t.updateQueue=o,o.stores=[s]):(c=o.stores,c===null?o.stores=[s]:c.push(s))}function oE(s,o,c,d){o.value=c,o.getSnapshot=d,cE(o)&&uE(s)}function lE(s,o,c){return c(function(){cE(o)&&uE(s)})}function cE(s){var o=s.getSnapshot;s=s.value;try{var c=o();return!xa(s,c)}catch{return!0}}function uE(s){var o=pl(s,2);o!==null&&ia(o,s,2)}function Lg(s){var o=Xn();if(typeof s=="function"){var c=s;if(s=c(),Sl){Gn(!0);try{c()}finally{Gn(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pi,lastRenderedState:s},o}function fE(s,o,c,d){return s.baseState=c,Mg(s,ar,typeof d=="function"?d:pi)}function LI(s,o,c,d,g){if(fd(s))throw Error(n(485));if(s=o.action,s!==null){var y={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){y.listeners.push(C)}};ne.T!==null?c(!0):y.isTransition=!1,d(y),c=o.pending,c===null?(y.next=o.pending=y,hE(o,y)):(y.next=c.next,o.pending=c.next=y)}}function hE(s,o){var c=o.action,d=o.payload,g=s.state;if(o.isTransition){var y=ne.T,C={};ne.T=C;try{var U=c(g,d),re=ne.S;re!==null&&re(C,U),dE(s,o,U)}catch(pe){Vg(s,o,pe)}finally{y!==null&&C.types!==null&&(y.types=C.types),ne.T=y}}else try{y=c(g,d),dE(s,o,y)}catch(pe){Vg(s,o,pe)}}function dE(s,o,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){mE(s,o,d)},function(d){return Vg(s,o,d)}):mE(s,o,c)}function mE(s,o,c){o.status="fulfilled",o.value=c,pE(o),s.state=c,o=s.pending,o!==null&&(c=o.next,c===o?s.pending=null:(c=c.next,o.next=c,hE(s,c)))}function Vg(s,o,c){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=c,pE(o),o=o.next;while(o!==d)}s.action=null}function pE(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function gE(s,o){return o}function xE(s,o){if(Ot){var c=ur.formState;if(c!==null){e:{var d=_t;if(Ot){if(dr){t:{for(var g=dr,y=Ba;g.nodeType!==8;){if(!y){g=null;break t}if(g=Ua(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){dr=Ua(g.nextSibling),d=g.data==="F!";break e}}ao(d)}d=!1}d&&(o=c[0])}}return c=Xn(),c.memoizedState=c.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gE,lastRenderedState:o},c.queue=d,c=PE.bind(null,_t,d),d.dispatch=c,d=Lg(!1),y=Gg.bind(null,_t,!1,d.queue),d=Xn(),g={state:o,dispatch:null,action:s,pending:null},d.queue=g,c=LI.bind(null,_t,g,y,c),g.dispatch=c,d.memoizedState=s,[o,c,!1]}function vE(s){var o=Vr();return yE(o,ar,s)}function yE(s,o,c){if(o=Mg(s,o,gE)[0],s=ld(pi)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=wf(o)}catch(C){throw C===Fc?J0:C}else d=o;o=Vr();var g=o.queue,y=g.dispatch;return c!==o.memoizedState&&(_t.flags|=2048,Vc(9,{destroy:void 0},VI.bind(null,g,c),null)),[d,y,s]}function VI(s,o){s.action=o}function _E(s){var o=Vr(),c=ar;if(c!==null)return yE(o,c,s);Vr(),o=o.memoizedState,c=Vr();var d=c.queue.dispatch;return c.memoizedState=s,[o,d,!1]}function Vc(s,o,c,d){return s={tag:s,create:c,deps:d,inst:o,next:null},o=_t.updateQueue,o===null&&(o=id(),_t.updateQueue=o),c=o.lastEffect,c===null?o.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,o.lastEffect=s),s}function EE(){return Vr().memoizedState}function cd(s,o,c,d){var g=Xn();_t.flags|=s,g.memoizedState=Vc(1|o,{destroy:void 0},c,d===void 0?null:d)}function ud(s,o,c,d){var g=Vr();d=d===void 0?null:d;var y=g.memoizedState.inst;ar!==null&&d!==null&&kg(d,ar.memoizedState.deps)?g.memoizedState=Vc(o,y,c,d):(_t.flags|=s,g.memoizedState=Vc(1|o,y,c,d))}function TE(s,o){cd(8390656,8,s,o)}function Bg(s,o){ud(2048,8,s,o)}function BI(s){_t.flags|=4;var o=_t.updateQueue;if(o===null)o=id(),_t.updateQueue=o,o.events=[s];else{var c=o.events;c===null?o.events=[s]:c.push(s)}}function wE(s){var o=Vr().memoizedState;return BI({ref:o,nextImpl:s}),function(){if((qt&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function SE(s,o){return ud(4,2,s,o)}function AE(s,o){return ud(4,4,s,o)}function bE(s,o){if(typeof o=="function"){s=s();var c=o(s);return function(){typeof c=="function"?c():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function NE(s,o,c){c=c!=null?c.concat([s]):null,ud(4,4,bE.bind(null,o,s),c)}function jg(){}function CE(s,o){var c=Vr();o=o===void 0?null:o;var d=c.memoizedState;return o!==null&&kg(o,d[1])?d[0]:(c.memoizedState=[s,o],s)}function kE(s,o){var c=Vr();o=o===void 0?null:o;var d=c.memoizedState;if(o!==null&&kg(o,d[1]))return d[0];if(d=s(),Sl){Gn(!0);try{s()}finally{Gn(!1)}}return c.memoizedState=[d,o],d}function Ug(s,o,c){return c===void 0||(mi&1073741824)!==0&&(kt&261930)===0?s.memoizedState=o:(s.memoizedState=c,s=RT(),_t.lanes|=s,mo|=s,c)}function RE(s,o,c,d){return xa(c,o)?c:Mc.current!==null?(s=Ug(s,c,d),xa(s,o)||(Wr=!0),s):(mi&42)===0||(mi&1073741824)!==0&&(kt&261930)===0?(Wr=!0,s.memoizedState=c):(s=RT(),_t.lanes|=s,mo|=s,o)}function DE(s,o,c,d,g){var y=ae.p;ae.p=y!==0&&8>y?y:8;var C=ne.T,U={};ne.T=U,Gg(s,!1,o,c);try{var re=g(),pe=ne.S;if(pe!==null&&pe(U,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ce=OI(re,d);Sf(s,o,Ce,wa(s))}else Sf(s,o,d,wa(s))}catch(Ie){Sf(s,o,{then:function(){},status:"rejected",reason:Ie},wa())}finally{ae.p=y,C!==null&&U.types!==null&&(C.types=U.types),ne.T=C}}function jI(){}function zg(s,o,c,d){if(s.tag!==5)throw Error(n(476));var g=IE(s).queue;DE(s,g,o,fe,c===null?jI:function(){return FE(s),c(d)})}function IE(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pi,lastRenderedState:fe},next:null};var c={};return o.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pi,lastRenderedState:c},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function FE(s){var o=IE(s);o.next===null&&(o=s.alternate.memoizedState),Sf(s,o.next.queue,{},wa())}function Hg(){return vn(Uf)}function OE(){return Vr().memoizedState}function ME(){return Vr().memoizedState}function UI(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var c=wa();s=oo(c);var d=lo(o,s,c);d!==null&&(ia(d,o,c),yf(d,o,c)),o={cache:vg()},s.payload=o;return}o=o.return}}function zI(s,o,c){var d=wa();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},fd(s)?LE(o,c):(c=og(s,o,c,d),c!==null&&(ia(c,s,d),VE(c,o,d)))}function PE(s,o,c){var d=wa();Sf(s,o,c,d)}function Sf(s,o,c,d){var g={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(fd(s))LE(o,g);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var C=o.lastRenderedState,U=y(C,c);if(g.hasEagerState=!0,g.eagerState=U,xa(U,C))return q0(s,o,g,0),ur===null&&G0(),!1}catch{}finally{}if(c=og(s,o,g,d),c!==null)return ia(c,s,d),VE(c,o,d),!0}return!1}function Gg(s,o,c,d){if(d={lane:2,revertLane:T1(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},fd(s)){if(o)throw Error(n(479))}else o=og(s,c,d,2),o!==null&&ia(o,s,2)}function fd(s){var o=s.alternate;return s===_t||o!==null&&o===_t}function LE(s,o){Pc=ad=!0;var c=s.pending;c===null?o.next=o:(o.next=c.next,c.next=o),s.pending=o}function VE(s,o,c){if((c&4194048)!==0){var d=o.lanes;d&=s.pendingLanes,c|=d,o.lanes=c,si(s,c)}}var Af={readContext:vn,use:od,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useLayoutEffect:Rr,useInsertionEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useSyncExternalStore:Rr,useId:Rr,useHostTransitionStatus:Rr,useFormState:Rr,useActionState:Rr,useOptimistic:Rr,useMemoCache:Rr,useCacheRefresh:Rr};Af.useEffectEvent=Rr;var BE={readContext:vn,use:od,useCallback:function(s,o){return Xn().memoizedState=[s,o===void 0?null:o],s},useContext:vn,useEffect:TE,useImperativeHandle:function(s,o,c){c=c!=null?c.concat([s]):null,cd(4194308,4,bE.bind(null,o,s),c)},useLayoutEffect:function(s,o){return cd(4194308,4,s,o)},useInsertionEffect:function(s,o){cd(4,2,s,o)},useMemo:function(s,o){var c=Xn();o=o===void 0?null:o;var d=s();if(Sl){Gn(!0);try{s()}finally{Gn(!1)}}return c.memoizedState=[d,o],d},useReducer:function(s,o,c){var d=Xn();if(c!==void 0){var g=c(o);if(Sl){Gn(!0);try{c(o)}finally{Gn(!1)}}}else g=o;return d.memoizedState=d.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},d.queue=s,s=s.dispatch=zI.bind(null,_t,s),[d.memoizedState,s]},useRef:function(s){var o=Xn();return s={current:s},o.memoizedState=s},useState:function(s){s=Lg(s);var o=s.queue,c=PE.bind(null,_t,o);return o.dispatch=c,[s.memoizedState,c]},useDebugValue:jg,useDeferredValue:function(s,o){var c=Xn();return Ug(c,s,o)},useTransition:function(){var s=Lg(!1);return s=DE.bind(null,_t,s.queue,!0,!1),Xn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,c){var d=_t,g=Xn();if(Ot){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),ur===null)throw Error(n(349));(kt&127)!==0||iE(d,o,c)}g.memoizedState=c;var y={value:c,getSnapshot:o};return g.queue=y,TE(lE.bind(null,d,y,s),[s]),d.flags|=2048,Vc(9,{destroy:void 0},oE.bind(null,d,y,c,o),null),c},useId:function(){var s=Xn(),o=ur.identifierPrefix;if(Ot){var c=Ms,d=Os;c=(d&~(1<<32-wr(d)-1)).toString(32)+c,o="_"+o+"R_"+c,c=sd++,0<c&&(o+="H"+c.toString(32)),o+="_"}else c=MI++,o="_"+o+"r_"+c.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:Hg,useFormState:xE,useActionState:xE,useOptimistic:function(s){var o=Xn();o.memoizedState=o.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=c,o=Gg.bind(null,_t,!0,c),c.dispatch=o,[s,o]},useMemoCache:Og,useCacheRefresh:function(){return Xn().memoizedState=UI.bind(null,_t)},useEffectEvent:function(s){var o=Xn(),c={impl:s};return o.memoizedState=c,function(){if((qt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},qg={readContext:vn,use:od,useCallback:CE,useContext:vn,useEffect:Bg,useImperativeHandle:NE,useInsertionEffect:SE,useLayoutEffect:AE,useMemo:kE,useReducer:ld,useRef:EE,useState:function(){return ld(pi)},useDebugValue:jg,useDeferredValue:function(s,o){var c=Vr();return RE(c,ar.memoizedState,s,o)},useTransition:function(){var s=ld(pi)[0],o=Vr().memoizedState;return[typeof s=="boolean"?s:wf(s),o]},useSyncExternalStore:sE,useId:OE,useHostTransitionStatus:Hg,useFormState:vE,useActionState:vE,useOptimistic:function(s,o){var c=Vr();return fE(c,ar,s,o)},useMemoCache:Og,useCacheRefresh:ME};qg.useEffectEvent=wE;var jE={readContext:vn,use:od,useCallback:CE,useContext:vn,useEffect:Bg,useImperativeHandle:NE,useInsertionEffect:SE,useLayoutEffect:AE,useMemo:kE,useReducer:Pg,useRef:EE,useState:function(){return Pg(pi)},useDebugValue:jg,useDeferredValue:function(s,o){var c=Vr();return ar===null?Ug(c,s,o):RE(c,ar.memoizedState,s,o)},useTransition:function(){var s=Pg(pi)[0],o=Vr().memoizedState;return[typeof s=="boolean"?s:wf(s),o]},useSyncExternalStore:sE,useId:OE,useHostTransitionStatus:Hg,useFormState:_E,useActionState:_E,useOptimistic:function(s,o){var c=Vr();return ar!==null?fE(c,ar,s,o):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:Og,useCacheRefresh:ME};jE.useEffectEvent=wE;function Wg(s,o,c,d){o=s.memoizedState,c=c(d,o),c=c==null?o:x({},o,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Xg={enqueueSetState:function(s,o,c){s=s._reactInternals;var d=wa(),g=oo(d);g.payload=o,c!=null&&(g.callback=c),o=lo(s,g,d),o!==null&&(ia(o,s,d),yf(o,s,d))},enqueueReplaceState:function(s,o,c){s=s._reactInternals;var d=wa(),g=oo(d);g.tag=1,g.payload=o,c!=null&&(g.callback=c),o=lo(s,g,d),o!==null&&(ia(o,s,d),yf(o,s,d))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var c=wa(),d=oo(c);d.tag=2,o!=null&&(d.callback=o),o=lo(s,d,c),o!==null&&(ia(o,s,c),yf(o,s,c))}};function UE(s,o,c,d,g,y,C){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,y,C):o.prototype&&o.prototype.isPureReactComponent?!ff(c,d)||!ff(g,y):!0}function zE(s,o,c,d){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,d),o.state!==s&&Xg.enqueueReplaceState(o,o.state,null)}function Al(s,o){var c=o;if("ref"in o){c={};for(var d in o)d!=="ref"&&(c[d]=o[d])}if(s=s.defaultProps){c===o&&(c=x({},c));for(var g in s)c[g]===void 0&&(c[g]=s[g])}return c}function HE(s){H0(s)}function GE(s){console.error(s)}function qE(s){H0(s)}function hd(s,o){try{var c=s.onUncaughtError;c(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function WE(s,o,c){try{var d=s.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function $g(s,o,c){return c=oo(c),c.tag=3,c.payload={element:null},c.callback=function(){hd(s,o)},c}function XE(s){return s=oo(s),s.tag=3,s}function $E(s,o,c,d){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var y=d.value;s.payload=function(){return g(y)},s.callback=function(){WE(o,c,d)}}var C=c.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(s.callback=function(){WE(o,c,d),typeof g!="function"&&(po===null?po=new Set([this]):po.add(this));var U=d.stack;this.componentDidCatch(d.value,{componentStack:U!==null?U:""})})}function HI(s,o,c,d,g){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=c.alternate,o!==null&&Rc(o,c,g,!0),c=ya.current,c!==null){switch(c.tag){case 31:case 13:return ja===null?Sd():c.alternate===null&&Dr===0&&(Dr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,d===Z0?c.flags|=16384:(o=c.updateQueue,o===null?c.updateQueue=new Set([d]):o.add(d),y1(s,d,g)),!1;case 22:return c.flags|=65536,d===Z0?c.flags|=16384:(o=c.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=o):(c=o.retryQueue,c===null?o.retryQueue=new Set([d]):c.add(d)),y1(s,d,g)),!1}throw Error(n(435,c.tag))}return y1(s,d,g),Sd(),!1}if(Ot)return o=ya.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,d!==dg&&(s=Error(n(422),{cause:d}),mf(Pa(s,c)))):(d!==dg&&(o=Error(n(423),{cause:d}),mf(Pa(o,c))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,d=Pa(d,c),g=$g(s.stateNode,d,g),Sg(s,g),Dr!==4&&(Dr=2)),!1;var y=Error(n(520),{cause:d});if(y=Pa(y,c),Ff===null?Ff=[y]:Ff.push(y),Dr!==4&&(Dr=2),o===null)return!0;d=Pa(d,c),c=o;do{switch(c.tag){case 3:return c.flags|=65536,s=g&-g,c.lanes|=s,s=$g(c.stateNode,d,s),Sg(c,s),!1;case 1:if(o=c.type,y=c.stateNode,(c.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(po===null||!po.has(y))))return c.flags|=65536,g&=-g,c.lanes|=g,g=XE(g),$E(g,s,c,d),Sg(c,g),!1}c=c.return}while(c!==null);return!1}var Kg=Error(n(461)),Wr=!1;function yn(s,o,c,d){o.child=s===null?J2(o,null,c,d):wl(o,s.child,c,d)}function KE(s,o,c,d,g){c=c.render;var y=o.ref;if("ref"in d){var C={};for(var U in d)U!=="ref"&&(C[U]=d[U])}else C=d;return yl(o),d=Rg(s,o,c,C,y,g),U=Dg(),s!==null&&!Wr?(Ig(s,o,g),gi(s,o,g)):(Ot&&U&&fg(o),o.flags|=1,yn(s,o,d,g),o.child)}function YE(s,o,c,d,g){if(s===null){var y=c.type;return typeof y=="function"&&!lg(y)&&y.defaultProps===void 0&&c.compare===null?(o.tag=15,o.type=y,QE(s,o,y,d,g)):(s=X0(c.type,null,d,o,o.mode,g),s.ref=o.ref,s.return=o,o.child=s)}if(y=s.child,!n1(s,g)){var C=y.memoizedProps;if(c=c.compare,c=c!==null?c:ff,c(C,d)&&s.ref===o.ref)return gi(s,o,g)}return o.flags|=1,s=ui(y,d),s.ref=o.ref,s.return=o,o.child=s}function QE(s,o,c,d,g){if(s!==null){var y=s.memoizedProps;if(ff(y,d)&&s.ref===o.ref)if(Wr=!1,o.pendingProps=d=y,n1(s,g))(s.flags&131072)!==0&&(Wr=!0);else return o.lanes=s.lanes,gi(s,o,g)}return Yg(s,o,c,d,g)}function JE(s,o,c,d){var g=d.children,y=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((o.flags&128)!==0){if(y=y!==null?y.baseLanes|c:c,s!==null){for(d=o.child=s.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;d=g&~y}else d=0,o.child=null;return ZE(s,o,y,c,d)}if((c&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Q0(o,y!==null?y.cachePool:null),y!==null?tE(o,y):bg(),rE(o);else return d=o.lanes=536870912,ZE(s,o,y!==null?y.baseLanes|c:c,c,d)}else y!==null?(Q0(o,y.cachePool),tE(o,y),uo(),o.memoizedState=null):(s!==null&&Q0(o,null),bg(),uo());return yn(s,o,g,c),o.child}function bf(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function ZE(s,o,c,d,g){var y=_g();return y=y===null?null:{parent:Gr._currentValue,pool:y},o.memoizedState={baseLanes:c,cachePool:y},s!==null&&Q0(o,null),bg(),rE(o),s!==null&&Rc(s,o,d,!0),o.childLanes=g,null}function dd(s,o){return o=pd({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function eT(s,o,c){return wl(o,s.child,null,c),s=dd(o,o.pendingProps),s.flags|=2,_a(o),o.memoizedState=null,s}function GI(s,o,c){var d=o.pendingProps,g=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(Ot){if(d.mode==="hidden")return s=dd(o,d),o.lanes=536870912,bf(null,s);if(Cg(o),(s=dr)?(s=hw(s,Ba),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ro!==null?{id:Os,overflow:Ms}:null,retryLane:536870912,hydrationErrors:null},c=L2(s),c.return=o,o.child=c,xn=o,dr=null)):s=null,s===null)throw ao(o);return o.lanes=536870912,null}return dd(o,d)}var y=s.memoizedState;if(y!==null){var C=y.dehydrated;if(Cg(o),g)if(o.flags&256)o.flags&=-257,o=eT(s,o,c);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(n(558));else if(Wr||Rc(s,o,c,!1),g=(c&s.childLanes)!==0,Wr||g){if(d=ur,d!==null&&(C=nl(d,c),C!==0&&C!==y.retryLane))throw y.retryLane=C,pl(s,C),ia(d,s,C),Kg;Sd(),o=eT(s,o,c)}else s=y.treeContext,dr=Ua(C.nextSibling),xn=o,Ot=!0,no=null,Ba=!1,s!==null&&j2(o,s),o=dd(o,d),o.flags|=4096;return o}return s=ui(s.child,{mode:d.mode,children:d.children}),s.ref=o.ref,o.child=s,s.return=o,s}function md(s,o){var c=o.ref;if(c===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(o.flags|=4194816)}}function Yg(s,o,c,d,g){return yl(o),c=Rg(s,o,c,d,void 0,g),d=Dg(),s!==null&&!Wr?(Ig(s,o,g),gi(s,o,g)):(Ot&&d&&fg(o),o.flags|=1,yn(s,o,c,g),o.child)}function tT(s,o,c,d,g,y){return yl(o),o.updateQueue=null,c=aE(o,d,c,g),nE(s),d=Dg(),s!==null&&!Wr?(Ig(s,o,y),gi(s,o,y)):(Ot&&d&&fg(o),o.flags|=1,yn(s,o,c,y),o.child)}function rT(s,o,c,d,g){if(yl(o),o.stateNode===null){var y=bc,C=c.contextType;typeof C=="object"&&C!==null&&(y=vn(C)),y=new c(d,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Xg,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=d,y.state=o.memoizedState,y.refs={},Tg(o),C=c.contextType,y.context=typeof C=="object"&&C!==null?vn(C):bc,y.state=o.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(Wg(o,c,C,d),y.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(C=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),C!==y.state&&Xg.enqueueReplaceState(y,y.state,null),Ef(o,d,y,g),_f(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(s===null){y=o.stateNode;var U=o.memoizedProps,re=Al(c,U);y.props=re;var pe=y.context,Ce=c.contextType;C=bc,typeof Ce=="object"&&Ce!==null&&(C=vn(Ce));var Ie=c.getDerivedStateFromProps;Ce=typeof Ie=="function"||typeof y.getSnapshotBeforeUpdate=="function",U=o.pendingProps!==U,Ce||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(U||pe!==C)&&zE(o,y,d,C),io=!1;var _e=o.memoizedState;y.state=_e,Ef(o,d,y,g),_f(),pe=o.memoizedState,U||_e!==pe||io?(typeof Ie=="function"&&(Wg(o,c,Ie,d),pe=o.memoizedState),(re=io||UE(o,c,re,d,_e,pe,C))?(Ce||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=pe),y.props=d,y.state=pe,y.context=C,d=re):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{y=o.stateNode,wg(s,o),C=o.memoizedProps,Ce=Al(c,C),y.props=Ce,Ie=o.pendingProps,_e=y.context,pe=c.contextType,re=bc,typeof pe=="object"&&pe!==null&&(re=vn(pe)),U=c.getDerivedStateFromProps,(pe=typeof U=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C!==Ie||_e!==re)&&zE(o,y,d,re),io=!1,_e=o.memoizedState,y.state=_e,Ef(o,d,y,g),_f();var Te=o.memoizedState;C!==Ie||_e!==Te||io||s!==null&&s.dependencies!==null&&K0(s.dependencies)?(typeof U=="function"&&(Wg(o,c,U,d),Te=o.memoizedState),(Ce=io||UE(o,c,Ce,d,_e,Te,re)||s!==null&&s.dependencies!==null&&K0(s.dependencies))?(pe||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,Te,re),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,Te,re)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||C===s.memoizedProps&&_e===s.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&_e===s.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=Te),y.props=d,y.state=Te,y.context=re,d=Ce):(typeof y.componentDidUpdate!="function"||C===s.memoizedProps&&_e===s.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&_e===s.memoizedState||(o.flags|=1024),d=!1)}return y=d,md(s,o),d=(o.flags&128)!==0,y||d?(y=o.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,s!==null&&d?(o.child=wl(o,s.child,null,g),o.child=wl(o,null,c,g)):yn(s,o,c,g),o.memoizedState=y.state,s=o.child):s=gi(s,o,g),s}function nT(s,o,c,d){return xl(),o.flags|=256,yn(s,o,c,d),o.child}var Qg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jg(s){return{baseLanes:s,cachePool:W2()}}function Zg(s,o,c){return s=s!==null?s.childLanes&~c:0,o&&(s|=Ta),s}function aT(s,o,c){var d=o.pendingProps,g=!1,y=(o.flags&128)!==0,C;if((C=y)||(C=s!==null&&s.memoizedState===null?!1:(Lr.current&2)!==0),C&&(g=!0,o.flags&=-129),C=(o.flags&32)!==0,o.flags&=-33,s===null){if(Ot){if(g?co(o):uo(),(s=dr)?(s=hw(s,Ba),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:ro!==null?{id:Os,overflow:Ms}:null,retryLane:536870912,hydrationErrors:null},c=L2(s),c.return=o,o.child=c,xn=o,dr=null)):s=null,s===null)throw ao(o);return M1(s)?o.lanes=32:o.lanes=536870912,null}var U=d.children;return d=d.fallback,g?(uo(),g=o.mode,U=pd({mode:"hidden",children:U},g),d=gl(d,g,c,null),U.return=o,d.return=o,U.sibling=d,o.child=U,d=o.child,d.memoizedState=Jg(c),d.childLanes=Zg(s,C,c),o.memoizedState=Qg,bf(null,d)):(co(o),e1(o,U))}var re=s.memoizedState;if(re!==null&&(U=re.dehydrated,U!==null)){if(y)o.flags&256?(co(o),o.flags&=-257,o=t1(s,o,c)):o.memoizedState!==null?(uo(),o.child=s.child,o.flags|=128,o=null):(uo(),U=d.fallback,g=o.mode,d=pd({mode:"visible",children:d.children},g),U=gl(U,g,c,null),U.flags|=2,d.return=o,U.return=o,d.sibling=U,o.child=d,wl(o,s.child,null,c),d=o.child,d.memoizedState=Jg(c),d.childLanes=Zg(s,C,c),o.memoizedState=Qg,o=bf(null,d));else if(co(o),M1(U)){if(C=U.nextSibling&&U.nextSibling.dataset,C)var pe=C.dgst;C=pe,d=Error(n(419)),d.stack="",d.digest=C,mf({value:d,source:null,stack:null}),o=t1(s,o,c)}else if(Wr||Rc(s,o,c,!1),C=(c&s.childLanes)!==0,Wr||C){if(C=ur,C!==null&&(d=nl(C,c),d!==0&&d!==re.retryLane))throw re.retryLane=d,pl(s,d),ia(C,s,d),Kg;O1(U)||Sd(),o=t1(s,o,c)}else O1(U)?(o.flags|=192,o.child=s.child,o=null):(s=re.treeContext,dr=Ua(U.nextSibling),xn=o,Ot=!0,no=null,Ba=!1,s!==null&&j2(o,s),o=e1(o,d.children),o.flags|=4096);return o}return g?(uo(),U=d.fallback,g=o.mode,re=s.child,pe=re.sibling,d=ui(re,{mode:"hidden",children:d.children}),d.subtreeFlags=re.subtreeFlags&65011712,pe!==null?U=ui(pe,U):(U=gl(U,g,c,null),U.flags|=2),U.return=o,d.return=o,d.sibling=U,o.child=d,bf(null,d),d=o.child,U=s.child.memoizedState,U===null?U=Jg(c):(g=U.cachePool,g!==null?(re=Gr._currentValue,g=g.parent!==re?{parent:re,pool:re}:g):g=W2(),U={baseLanes:U.baseLanes|c,cachePool:g}),d.memoizedState=U,d.childLanes=Zg(s,C,c),o.memoizedState=Qg,bf(s.child,d)):(co(o),c=s.child,s=c.sibling,c=ui(c,{mode:"visible",children:d.children}),c.return=o,c.sibling=null,s!==null&&(C=o.deletions,C===null?(o.deletions=[s],o.flags|=16):C.push(s)),o.child=c,o.memoizedState=null,c)}function e1(s,o){return o=pd({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function pd(s,o){return s=va(22,s,null,o),s.lanes=0,s}function t1(s,o,c){return wl(o,s.child,null,c),s=e1(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function sT(s,o,c){s.lanes|=o;var d=s.alternate;d!==null&&(d.lanes|=o),gg(s.return,o,c)}function r1(s,o,c,d,g,y){var C=s.memoizedState;C===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:g,treeForkCount:y}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=d,C.tail=c,C.tailMode=g,C.treeForkCount=y)}function iT(s,o,c){var d=o.pendingProps,g=d.revealOrder,y=d.tail;d=d.children;var C=Lr.current,U=(C&2)!==0;if(U?(C=C&1|2,o.flags|=128):C&=1,Q(Lr,C),yn(s,o,d,c),d=Ot?df:0,!U&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&sT(s,c,o);else if(s.tag===19)sT(s,c,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(g){case"forwards":for(c=o.child,g=null;c!==null;)s=c.alternate,s!==null&&nd(s)===null&&(g=c),c=c.sibling;c=g,c===null?(g=o.child,o.child=null):(g=c.sibling,c.sibling=null),r1(o,!1,g,c,y,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,g=o.child,o.child=null;g!==null;){if(s=g.alternate,s!==null&&nd(s)===null){o.child=g;break}s=g.sibling,g.sibling=c,c=g,g=s}r1(o,!0,c,null,y,d);break;case"together":r1(o,!1,null,null,void 0,d);break;default:o.memoizedState=null}return o.child}function gi(s,o,c){if(s!==null&&(o.dependencies=s.dependencies),mo|=o.lanes,(c&o.childLanes)===0)if(s!==null){if(Rc(s,o,c,!1),(c&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,c=ui(s,s.pendingProps),o.child=c,c.return=o;s.sibling!==null;)s=s.sibling,c=c.sibling=ui(s,s.pendingProps),c.return=o;c.sibling=null}return o.child}function n1(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&K0(s)))}function qI(s,o,c){switch(o.tag){case 3:Oe(o,o.stateNode.containerInfo),so(o,Gr,s.memoizedState.cache),xl();break;case 27:case 5:se(o);break;case 4:Oe(o,o.stateNode.containerInfo);break;case 10:so(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Cg(o),null;break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(co(o),o.flags|=128,null):(c&o.child.childLanes)!==0?aT(s,o,c):(co(o),s=gi(s,o,c),s!==null?s.sibling:null);co(o);break;case 19:var g=(s.flags&128)!==0;if(d=(c&o.childLanes)!==0,d||(Rc(s,o,c,!1),d=(c&o.childLanes)!==0),g){if(d)return iT(s,o,c);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Q(Lr,Lr.current),d)break;return null;case 22:return o.lanes=0,JE(s,o,c,o.pendingProps);case 24:so(o,Gr,s.memoizedState.cache)}return gi(s,o,c)}function oT(s,o,c){if(s!==null)if(s.memoizedProps!==o.pendingProps)Wr=!0;else{if(!n1(s,c)&&(o.flags&128)===0)return Wr=!1,qI(s,o,c);Wr=(s.flags&131072)!==0}else Wr=!1,Ot&&(o.flags&1048576)!==0&&B2(o,df,o.index);switch(o.lanes=0,o.tag){case 16:e:{var d=o.pendingProps;if(s=El(o.elementType),o.type=s,typeof s=="function")lg(s)?(d=Al(s,d),o.tag=1,o=rT(null,o,s,d,c)):(o.tag=0,o=Yg(null,o,s,d,c));else{if(s!=null){var g=s.$$typeof;if(g===q){o.tag=11,o=KE(null,o,s,d,c);break e}else if(g===N){o.tag=14,o=YE(null,o,s,d,c);break e}}throw o=Le(s)||s,Error(n(306,o,""))}}return o;case 0:return Yg(s,o,o.type,o.pendingProps,c);case 1:return d=o.type,g=Al(d,o.pendingProps),rT(s,o,d,g,c);case 3:e:{if(Oe(o,o.stateNode.containerInfo),s===null)throw Error(n(387));d=o.pendingProps;var y=o.memoizedState;g=y.element,wg(s,o),Ef(o,d,null,c);var C=o.memoizedState;if(d=C.cache,so(o,Gr,d),d!==y.cache&&xg(o,[Gr],c,!0),_f(),d=C.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:C.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=nT(s,o,d,c);break e}else if(d!==g){g=Pa(Error(n(424)),o),mf(g),o=nT(s,o,d,c);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(dr=Ua(s.firstChild),xn=o,Ot=!0,no=null,Ba=!0,c=J2(o,null,d,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(xl(),d===g){o=gi(s,o,c);break e}yn(s,o,d,c)}o=o.child}return o;case 26:return md(s,o),s===null?(c=vw(o.type,null,o.pendingProps,null))?o.memoizedState=c:Ot||(c=o.type,s=o.pendingProps,d=Dd(ce.current).createElement(c),d[G]=o,d[X]=s,_n(d,c,s),tt(d),o.stateNode=d):o.memoizedState=vw(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return se(o),s===null&&Ot&&(d=o.stateNode=pw(o.type,o.pendingProps,ce.current),xn=o,Ba=!0,g=dr,yo(o.type)?(P1=g,dr=Ua(d.firstChild)):dr=g),yn(s,o,o.pendingProps.children,c),md(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Ot&&((g=d=dr)&&(d=E6(d,o.type,o.pendingProps,Ba),d!==null?(o.stateNode=d,xn=o,dr=Ua(d.firstChild),Ba=!1,g=!0):g=!1),g||ao(o)),se(o),g=o.type,y=o.pendingProps,C=s!==null?s.memoizedProps:null,d=y.children,D1(g,y)?d=null:C!==null&&D1(g,C)&&(o.flags|=32),o.memoizedState!==null&&(g=Rg(s,o,PI,null,null,c),Uf._currentValue=g),md(s,o),yn(s,o,d,c),o.child;case 6:return s===null&&Ot&&((s=c=dr)&&(c=T6(c,o.pendingProps,Ba),c!==null?(o.stateNode=c,xn=o,dr=null,s=!0):s=!1),s||ao(o)),null;case 13:return aT(s,o,c);case 4:return Oe(o,o.stateNode.containerInfo),d=o.pendingProps,s===null?o.child=wl(o,null,d,c):yn(s,o,d,c),o.child;case 11:return KE(s,o,o.type,o.pendingProps,c);case 7:return yn(s,o,o.pendingProps,c),o.child;case 8:return yn(s,o,o.pendingProps.children,c),o.child;case 12:return yn(s,o,o.pendingProps.children,c),o.child;case 10:return d=o.pendingProps,so(o,o.type,d.value),yn(s,o,d.children,c),o.child;case 9:return g=o.type._context,d=o.pendingProps.children,yl(o),g=vn(g),d=d(g),o.flags|=1,yn(s,o,d,c),o.child;case 14:return YE(s,o,o.type,o.pendingProps,c);case 15:return QE(s,o,o.type,o.pendingProps,c);case 19:return iT(s,o,c);case 31:return GI(s,o,c);case 22:return JE(s,o,c,o.pendingProps);case 24:return yl(o),d=vn(Gr),s===null?(g=_g(),g===null&&(g=ur,y=vg(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=c),g=y),o.memoizedState={parent:d,cache:g},Tg(o),so(o,Gr,g)):((s.lanes&c)!==0&&(wg(s,o),Ef(o,null,null,c),_f()),g=s.memoizedState,y=o.memoizedState,g.parent!==d?(g={parent:d,cache:d},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),so(o,Gr,d)):(d=y.cache,so(o,Gr,d),d!==g.cache&&xg(o,[Gr],c,!0))),yn(s,o,o.pendingProps.children,c),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function xi(s){s.flags|=4}function a1(s,o,c,d,g){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(g&335544128)===g)if(s.stateNode.complete)s.flags|=8192;else if(OT())s.flags|=8192;else throw Tl=Z0,Eg}else s.flags&=-16777217}function lT(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!ww(o))if(OT())s.flags|=8192;else throw Tl=Z0,Eg}function gd(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?dc():536870912,s.lanes|=o,zc|=o)}function Nf(s,o){if(!Ot)switch(s.tailMode){case"hidden":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function mr(s){var o=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(o)for(var g=s.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)c|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=d,s.childLanes=c,o}function WI(s,o,c){var d=o.pendingProps;switch(hg(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(o),null;case 1:return mr(o),null;case 3:return c=o.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),di(Gr),ke(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(kc(o)?xi(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,mg())),mr(o),null;case 26:var g=o.type,y=o.memoizedState;return s===null?(xi(o),y!==null?(mr(o),lT(o,y)):(mr(o),a1(o,g,null,d,c))):y?y!==s.memoizedState?(xi(o),mr(o),lT(o,y)):(mr(o),o.flags&=-16777217):(s=s.memoizedProps,s!==d&&xi(o),mr(o),a1(o,g,s,d,c)),null;case 27:if(Me(o),c=ce.current,g=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==d&&xi(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return mr(o),null}s=J.current,kc(o)?U2(o):(s=pw(g,d,c),o.stateNode=s,xi(o))}return mr(o),null;case 5:if(Me(o),g=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==d&&xi(o);else{if(!d){if(o.stateNode===null)throw Error(n(166));return mr(o),null}if(y=J.current,kc(o))U2(o);else{var C=Dd(ce.current);switch(y){case 1:y=C.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=C.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=C.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=C.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=C.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof d.is=="string"?C.createElement("select",{is:d.is}):C.createElement("select"),d.multiple?y.multiple=!0:d.size&&(y.size=d.size);break;default:y=typeof d.is=="string"?C.createElement(g,{is:d.is}):C.createElement(g)}}y[G]=o,y[X]=d;e:for(C=o.child;C!==null;){if(C.tag===5||C.tag===6)y.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===o)break e;for(;C.sibling===null;){if(C.return===null||C.return===o)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}o.stateNode=y;e:switch(_n(y,g,d),g){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&xi(o)}}return mr(o),a1(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,c),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==d&&xi(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(n(166));if(s=ce.current,kc(o)){if(s=o.stateNode,c=o.memoizedProps,d=null,g=xn,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}s[G]=o,s=!!(s.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||aw(s.nodeValue,c)),s||ao(o,!0)}else s=Dd(s).createTextNode(d),s[G]=o,o.stateNode=s}return mr(o),null;case 31:if(c=o.memoizedState,s===null||s.memoizedState!==null){if(d=kc(o),c!==null){if(s===null){if(!d)throw Error(n(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[G]=o}else xl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;mr(o),s=!1}else c=mg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return o.flags&256?(_a(o),o):(_a(o),null);if((o.flags&128)!==0)throw Error(n(558))}return mr(o),null;case 13:if(d=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=kc(o),d!==null&&d.dehydrated!==null){if(s===null){if(!g)throw Error(n(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[G]=o}else xl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;mr(o),g=!1}else g=mg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(_a(o),o):(_a(o),null)}return _a(o),(o.flags&128)!==0?(o.lanes=c,o):(c=d!==null,s=s!==null&&s.memoizedState!==null,c&&(d=o.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==g&&(d.flags|=2048)),c!==s&&c&&(o.child.flags|=8192),gd(o,o.updateQueue),mr(o),null);case 4:return ke(),s===null&&b1(o.stateNode.containerInfo),mr(o),null;case 10:return di(o.type),mr(o),null;case 19:if(B(Lr),d=o.memoizedState,d===null)return mr(o),null;if(g=(o.flags&128)!==0,y=d.rendering,y===null)if(g)Nf(d,!1);else{if(Dr!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(y=nd(s),y!==null){for(o.flags|=128,Nf(d,!1),s=y.updateQueue,o.updateQueue=s,gd(o,s),o.subtreeFlags=0,s=c,c=o.child;c!==null;)P2(c,s),c=c.sibling;return Q(Lr,Lr.current&1|2),Ot&&fi(o,d.treeForkCount),o.child}s=s.sibling}d.tail!==null&&ft()>Ed&&(o.flags|=128,g=!0,Nf(d,!1),o.lanes=4194304)}else{if(!g)if(s=nd(y),s!==null){if(o.flags|=128,g=!0,s=s.updateQueue,o.updateQueue=s,gd(o,s),Nf(d,!0),d.tail===null&&d.tailMode==="hidden"&&!y.alternate&&!Ot)return mr(o),null}else 2*ft()-d.renderingStartTime>Ed&&c!==536870912&&(o.flags|=128,g=!0,Nf(d,!1),o.lanes=4194304);d.isBackwards?(y.sibling=o.child,o.child=y):(s=d.last,s!==null?s.sibling=y:o.child=y,d.last=y)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=ft(),s.sibling=null,c=Lr.current,Q(Lr,g?c&1|2:c&1),Ot&&fi(o,d.treeForkCount),s):(mr(o),null);case 22:case 23:return _a(o),Ng(),d=o.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(c&536870912)!==0&&(o.flags&128)===0&&(mr(o),o.subtreeFlags&6&&(o.flags|=8192)):mr(o),c=o.updateQueue,c!==null&&gd(o,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==c&&(o.flags|=2048),s!==null&&B(_l),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),di(Gr),mr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function XI(s,o){switch(hg(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return di(Gr),ke(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Me(o),null;case 31:if(o.memoizedState!==null){if(_a(o),o.alternate===null)throw Error(n(340));xl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(_a(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));xl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return B(Lr),null;case 4:return ke(),null;case 10:return di(o.type),null;case 22:case 23:return _a(o),Ng(),s!==null&&B(_l),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return di(Gr),null;case 25:return null;default:return null}}function cT(s,o){switch(hg(o),o.tag){case 3:di(Gr),ke();break;case 26:case 27:case 5:Me(o);break;case 4:ke();break;case 31:o.memoizedState!==null&&_a(o);break;case 13:_a(o);break;case 19:B(Lr);break;case 10:di(o.type);break;case 22:case 23:_a(o),Ng(),s!==null&&B(_l);break;case 24:di(Gr)}}function Cf(s,o){try{var c=o.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var g=d.next;c=g;do{if((c.tag&s)===s){d=void 0;var y=c.create,C=c.inst;d=y(),C.destroy=d}c=c.next}while(c!==g)}}catch(U){Jt(o,o.return,U)}}function fo(s,o,c){try{var d=o.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var y=g.next;d=y;do{if((d.tag&s)===s){var C=d.inst,U=C.destroy;if(U!==void 0){C.destroy=void 0,g=o;var re=c,pe=U;try{pe()}catch(Ce){Jt(g,re,Ce)}}}d=d.next}while(d!==y)}}catch(Ce){Jt(o,o.return,Ce)}}function uT(s){var o=s.updateQueue;if(o!==null){var c=s.stateNode;try{eE(o,c)}catch(d){Jt(s,s.return,d)}}}function fT(s,o,c){c.props=Al(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(d){Jt(s,o,d)}}function kf(s,o){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof c=="function"?s.refCleanup=c(d):c.current=d}}catch(g){Jt(s,o,g)}}function Ps(s,o){var c=s.ref,d=s.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(g){Jt(s,o,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){Jt(s,o,g)}else c.current=null}function hT(s){var o=s.type,c=s.memoizedProps,d=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(g){Jt(s,s.return,g)}}function s1(s,o,c){try{var d=s.stateNode;p6(d,s.type,c,o),d[X]=o}catch(g){Jt(s,s.return,g)}}function dT(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&yo(s.type)||s.tag===4}function i1(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||dT(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&yo(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function o1(s,o,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,o):(o=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,o.appendChild(s),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=os));else if(d!==4&&(d===27&&yo(s.type)&&(c=s.stateNode,o=null),s=s.child,s!==null))for(o1(s,o,c),s=s.sibling;s!==null;)o1(s,o,c),s=s.sibling}function xd(s,o,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?c.insertBefore(s,o):c.appendChild(s);else if(d!==4&&(d===27&&yo(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(xd(s,o,c),s=s.sibling;s!==null;)xd(s,o,c),s=s.sibling}function mT(s){var o=s.stateNode,c=s.memoizedProps;try{for(var d=s.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);_n(o,d,c),o[G]=s,o[X]=c}catch(y){Jt(s,s.return,y)}}var vi=!1,Xr=!1,l1=!1,pT=typeof WeakSet=="function"?WeakSet:Set,cn=null;function $I(s,o){if(s=s.containerInfo,k1=Vd,s=N2(s),tg(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var g=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var C=0,U=-1,re=-1,pe=0,Ce=0,Ie=s,_e=null;t:for(;;){for(var Te;Ie!==c||g!==0&&Ie.nodeType!==3||(U=C+g),Ie!==y||d!==0&&Ie.nodeType!==3||(re=C+d),Ie.nodeType===3&&(C+=Ie.nodeValue.length),(Te=Ie.firstChild)!==null;)_e=Ie,Ie=Te;for(;;){if(Ie===s)break t;if(_e===c&&++pe===g&&(U=C),_e===y&&++Ce===d&&(re=C),(Te=Ie.nextSibling)!==null)break;Ie=_e,_e=Ie.parentNode}Ie=Te}c=U===-1||re===-1?null:{start:U,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(R1={focusedElem:s,selectionRange:c},Vd=!1,cn=o;cn!==null;)if(o=cn,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,cn=s;else for(;cn!==null;){switch(o=cn,y=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)g=s[c],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,c=o,g=y.memoizedProps,y=y.memoizedState,d=c.stateNode;try{var et=Al(c.type,g);s=d.getSnapshotBeforeUpdate(et,y),d.__reactInternalSnapshotBeforeUpdate=s}catch(ot){Jt(c,c.return,ot)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,c=s.nodeType,c===9)F1(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":F1(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=o.sibling,s!==null){s.return=o.return,cn=s;break}cn=o.return}}function gT(s,o,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:_i(s,c),d&4&&Cf(5,c);break;case 1:if(_i(s,c),d&4)if(s=c.stateNode,o===null)try{s.componentDidMount()}catch(C){Jt(c,c.return,C)}else{var g=Al(c.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(g,o,s.__reactInternalSnapshotBeforeUpdate)}catch(C){Jt(c,c.return,C)}}d&64&&uT(c),d&512&&kf(c,c.return);break;case 3:if(_i(s,c),d&64&&(s=c.updateQueue,s!==null)){if(o=null,c.child!==null)switch(c.child.tag){case 27:case 5:o=c.child.stateNode;break;case 1:o=c.child.stateNode}try{eE(s,o)}catch(C){Jt(c,c.return,C)}}break;case 27:o===null&&d&4&&mT(c);case 26:case 5:_i(s,c),o===null&&d&4&&hT(c),d&512&&kf(c,c.return);break;case 12:_i(s,c);break;case 31:_i(s,c),d&4&&yT(s,c);break;case 13:_i(s,c),d&4&&_T(s,c),d&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=n6.bind(null,c),w6(s,c))));break;case 22:if(d=c.memoizedState!==null||vi,!d){o=o!==null&&o.memoizedState!==null||Xr,g=vi;var y=Xr;vi=d,(Xr=o)&&!y?Ei(s,c,(c.subtreeFlags&8772)!==0):_i(s,c),vi=g,Xr=y}break;case 30:break;default:_i(s,c)}}function xT(s){var o=s.alternate;o!==null&&(s.alternate=null,xT(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&ze(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Er=null,ra=!1;function yi(s,o,c){for(c=c.child;c!==null;)vT(s,o,c),c=c.sibling}function vT(s,o,c){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(Ht,c)}catch{}switch(c.tag){case 26:Xr||Ps(c,o),yi(s,o,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Xr||Ps(c,o);var d=Er,g=ra;yo(c.type)&&(Er=c.stateNode,ra=!1),yi(s,o,c),Vf(c.stateNode),Er=d,ra=g;break;case 5:Xr||Ps(c,o);case 6:if(d=Er,g=ra,Er=null,yi(s,o,c),Er=d,ra=g,Er!==null)if(ra)try{(Er.nodeType===9?Er.body:Er.nodeName==="HTML"?Er.ownerDocument.body:Er).removeChild(c.stateNode)}catch(y){Jt(c,o,y)}else try{Er.removeChild(c.stateNode)}catch(y){Jt(c,o,y)}break;case 18:Er!==null&&(ra?(s=Er,uw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Yc(s)):uw(Er,c.stateNode));break;case 4:d=Er,g=ra,Er=c.stateNode.containerInfo,ra=!0,yi(s,o,c),Er=d,ra=g;break;case 0:case 11:case 14:case 15:fo(2,c,o),Xr||fo(4,c,o),yi(s,o,c);break;case 1:Xr||(Ps(c,o),d=c.stateNode,typeof d.componentWillUnmount=="function"&&fT(c,o,d)),yi(s,o,c);break;case 21:yi(s,o,c);break;case 22:Xr=(d=Xr)||c.memoizedState!==null,yi(s,o,c),Xr=d;break;default:yi(s,o,c)}}function yT(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Yc(s)}catch(c){Jt(o,o.return,c)}}}function _T(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Yc(s)}catch(c){Jt(o,o.return,c)}}function KI(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new pT),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new pT),o;default:throw Error(n(435,s.tag))}}function vd(s,o){var c=KI(s);o.forEach(function(d){if(!c.has(d)){c.add(d);var g=a6.bind(null,s,d);d.then(g,g)}})}function na(s,o){var c=o.deletions;if(c!==null)for(var d=0;d<c.length;d++){var g=c[d],y=s,C=o,U=C;e:for(;U!==null;){switch(U.tag){case 27:if(yo(U.type)){Er=U.stateNode,ra=!1;break e}break;case 5:Er=U.stateNode,ra=!1;break e;case 3:case 4:Er=U.stateNode.containerInfo,ra=!0;break e}U=U.return}if(Er===null)throw Error(n(160));vT(y,C,g),Er=null,ra=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)ET(o,s),o=o.sibling}var ds=null;function ET(s,o){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:na(o,s),aa(s),d&4&&(fo(3,s,s.return),Cf(3,s),fo(5,s,s.return));break;case 1:na(o,s),aa(s),d&512&&(Xr||c===null||Ps(c,c.return)),d&64&&vi&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var g=ds;if(na(o,s),aa(s),d&512&&(Xr||c===null||Ps(c,c.return)),d&4){var y=c!==null?c.memoizedState:null;if(d=s.memoizedState,c===null)if(d===null)if(s.stateNode===null){e:{d=s.type,c=s.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":y=g.getElementsByTagName("title")[0],(!y||y[ve]||y[G]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(d),g.head.insertBefore(y,g.querySelector("head > title"))),_n(y,d,c),y[G]=s,tt(y),d=y;break e;case"link":var C=Ew("link","href",g).get(d+(c.href||""));if(C){for(var U=0;U<C.length;U++)if(y=C[U],y.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&y.getAttribute("rel")===(c.rel==null?null:c.rel)&&y.getAttribute("title")===(c.title==null?null:c.title)&&y.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){C.splice(U,1);break t}}y=g.createElement(d),_n(y,d,c),g.head.appendChild(y);break;case"meta":if(C=Ew("meta","content",g).get(d+(c.content||""))){for(U=0;U<C.length;U++)if(y=C[U],y.getAttribute("content")===(c.content==null?null:""+c.content)&&y.getAttribute("name")===(c.name==null?null:c.name)&&y.getAttribute("property")===(c.property==null?null:c.property)&&y.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&y.getAttribute("charset")===(c.charSet==null?null:c.charSet)){C.splice(U,1);break t}}y=g.createElement(d),_n(y,d,c),g.head.appendChild(y);break;default:throw Error(n(468,d))}y[G]=s,tt(y),d=y}s.stateNode=d}else Tw(g,s.type,s.stateNode);else s.stateNode=_w(g,d,s.memoizedProps);else y!==d?(y===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):y.count--,d===null?Tw(g,s.type,s.stateNode):_w(g,d,s.memoizedProps)):d===null&&s.stateNode!==null&&s1(s,s.memoizedProps,c.memoizedProps)}break;case 27:na(o,s),aa(s),d&512&&(Xr||c===null||Ps(c,c.return)),c!==null&&d&4&&s1(s,s.memoizedProps,c.memoizedProps);break;case 5:if(na(o,s),aa(s),d&512&&(Xr||c===null||Ps(c,c.return)),s.flags&32){g=s.stateNode;try{ta(g,"")}catch(et){Jt(s,s.return,et)}}d&4&&s.stateNode!=null&&(g=s.memoizedProps,s1(s,g,c!==null?c.memoizedProps:g)),d&1024&&(l1=!0);break;case 6:if(na(o,s),aa(s),d&4){if(s.stateNode===null)throw Error(n(162));d=s.memoizedProps,c=s.stateNode;try{c.nodeValue=d}catch(et){Jt(s,s.return,et)}}break;case 3:if(Od=null,g=ds,ds=Id(o.containerInfo),na(o,s),ds=g,aa(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Yc(o.containerInfo)}catch(et){Jt(s,s.return,et)}l1&&(l1=!1,TT(s));break;case 4:d=ds,ds=Id(s.stateNode.containerInfo),na(o,s),aa(s),ds=d;break;case 12:na(o,s),aa(s);break;case 31:na(o,s),aa(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,vd(s,d)));break;case 13:na(o,s),aa(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(_d=ft()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,vd(s,d)));break;case 22:g=s.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,pe=vi,Ce=Xr;if(vi=pe||g,Xr=Ce||re,na(o,s),Xr=Ce,vi=pe,aa(s),d&8192)e:for(o=s.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(c===null||re||vi||Xr||bl(s)),c=null,o=s;;){if(o.tag===5||o.tag===26){if(c===null){re=c=o;try{if(y=re.stateNode,g)C=y.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{U=re.stateNode;var Ie=re.memoizedProps.style,_e=Ie!=null&&Ie.hasOwnProperty("display")?Ie.display:null;U.style.display=_e==null||typeof _e=="boolean"?"":(""+_e).trim()}}catch(et){Jt(re,re.return,et)}}}else if(o.tag===6){if(c===null){re=o;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(et){Jt(re,re.return,et)}}}else if(o.tag===18){if(c===null){re=o;try{var Te=re.stateNode;g?fw(Te,!0):fw(re.stateNode,!1)}catch(et){Jt(re,re.return,et)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;c===o&&(c=null),o=o.return}c===o&&(c=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=s.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,vd(s,c))));break;case 19:na(o,s),aa(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,vd(s,d)));break;case 30:break;case 21:break;default:na(o,s),aa(s)}}function aa(s){var o=s.flags;if(o&2){try{for(var c,d=s.return;d!==null;){if(dT(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,y=i1(s);xd(s,y,g);break;case 5:var C=c.stateNode;c.flags&32&&(ta(C,""),c.flags&=-33);var U=i1(s);xd(s,U,C);break;case 3:case 4:var re=c.stateNode.containerInfo,pe=i1(s);o1(s,pe,re);break;default:throw Error(n(161))}}catch(Ce){Jt(s,s.return,Ce)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function TT(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;TT(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function _i(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)gT(s,o.alternate,o),o=o.sibling}function bl(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:fo(4,o,o.return),bl(o);break;case 1:Ps(o,o.return);var c=o.stateNode;typeof c.componentWillUnmount=="function"&&fT(o,o.return,c),bl(o);break;case 27:Vf(o.stateNode);case 26:case 5:Ps(o,o.return),bl(o);break;case 22:o.memoizedState===null&&bl(o);break;case 30:bl(o);break;default:bl(o)}s=s.sibling}}function Ei(s,o,c){for(c=c&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,g=s,y=o,C=y.flags;switch(y.tag){case 0:case 11:case 15:Ei(g,y,c),Cf(4,y);break;case 1:if(Ei(g,y,c),d=y,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(pe){Jt(d,d.return,pe)}if(d=y,g=d.updateQueue,g!==null){var U=d.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)Z2(re[g],U)}catch(pe){Jt(d,d.return,pe)}}c&&C&64&&uT(y),kf(y,y.return);break;case 27:mT(y);case 26:case 5:Ei(g,y,c),c&&d===null&&C&4&&hT(y),kf(y,y.return);break;case 12:Ei(g,y,c);break;case 31:Ei(g,y,c),c&&C&4&&yT(g,y);break;case 13:Ei(g,y,c),c&&C&4&&_T(g,y);break;case 22:y.memoizedState===null&&Ei(g,y,c),kf(y,y.return);break;case 30:break;default:Ei(g,y,c)}o=o.sibling}}function c1(s,o){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&pf(c))}function u1(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&pf(s))}function ms(s,o,c,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)wT(s,o,c,d),o=o.sibling}function wT(s,o,c,d){var g=o.flags;switch(o.tag){case 0:case 11:case 15:ms(s,o,c,d),g&2048&&Cf(9,o);break;case 1:ms(s,o,c,d);break;case 3:ms(s,o,c,d),g&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&pf(s)));break;case 12:if(g&2048){ms(s,o,c,d),s=o.stateNode;try{var y=o.memoizedProps,C=y.id,U=y.onPostCommit;typeof U=="function"&&U(C,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(re){Jt(o,o.return,re)}}else ms(s,o,c,d);break;case 31:ms(s,o,c,d);break;case 13:ms(s,o,c,d);break;case 23:break;case 22:y=o.stateNode,C=o.alternate,o.memoizedState!==null?y._visibility&2?ms(s,o,c,d):Rf(s,o):y._visibility&2?ms(s,o,c,d):(y._visibility|=2,Bc(s,o,c,d,(o.subtreeFlags&10256)!==0||!1)),g&2048&&c1(C,o);break;case 24:ms(s,o,c,d),g&2048&&u1(o.alternate,o);break;default:ms(s,o,c,d)}}function Bc(s,o,c,d,g){for(g=g&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var y=s,C=o,U=c,re=d,pe=C.flags;switch(C.tag){case 0:case 11:case 15:Bc(y,C,U,re,g),Cf(8,C);break;case 23:break;case 22:var Ce=C.stateNode;C.memoizedState!==null?Ce._visibility&2?Bc(y,C,U,re,g):Rf(y,C):(Ce._visibility|=2,Bc(y,C,U,re,g)),g&&pe&2048&&c1(C.alternate,C);break;case 24:Bc(y,C,U,re,g),g&&pe&2048&&u1(C.alternate,C);break;default:Bc(y,C,U,re,g)}o=o.sibling}}function Rf(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var c=s,d=o,g=d.flags;switch(d.tag){case 22:Rf(c,d),g&2048&&c1(d.alternate,d);break;case 24:Rf(c,d),g&2048&&u1(d.alternate,d);break;default:Rf(c,d)}o=o.sibling}}var Df=8192;function jc(s,o,c){if(s.subtreeFlags&Df)for(s=s.child;s!==null;)ST(s,o,c),s=s.sibling}function ST(s,o,c){switch(s.tag){case 26:jc(s,o,c),s.flags&Df&&s.memoizedState!==null&&M6(c,ds,s.memoizedState,s.memoizedProps);break;case 5:jc(s,o,c);break;case 3:case 4:var d=ds;ds=Id(s.stateNode.containerInfo),jc(s,o,c),ds=d;break;case 22:s.memoizedState===null&&(d=s.alternate,d!==null&&d.memoizedState!==null?(d=Df,Df=16777216,jc(s,o,c),Df=d):jc(s,o,c));break;default:jc(s,o,c)}}function AT(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function If(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];cn=d,NT(d,s)}AT(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)bT(s),s=s.sibling}function bT(s){switch(s.tag){case 0:case 11:case 15:If(s),s.flags&2048&&fo(9,s,s.return);break;case 3:If(s);break;case 12:If(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,yd(s)):If(s);break;default:If(s)}}function yd(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var c=0;c<o.length;c++){var d=o[c];cn=d,NT(d,s)}AT(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:fo(8,o,o.return),yd(o);break;case 22:c=o.stateNode,c._visibility&2&&(c._visibility&=-3,yd(o));break;default:yd(o)}s=s.sibling}}function NT(s,o){for(;cn!==null;){var c=cn;switch(c.tag){case 0:case 11:case 15:fo(8,c,o);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:pf(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,cn=d;else e:for(c=s;cn!==null;){d=cn;var g=d.sibling,y=d.return;if(xT(d),d===c){cn=null;break e}if(g!==null){g.return=y,cn=g;break e}cn=y}}}var YI={getCacheForType:function(s){var o=vn(Gr),c=o.data.get(s);return c===void 0&&(c=s(),o.data.set(s,c)),c},cacheSignal:function(){return vn(Gr).controller.signal}},QI=typeof WeakMap=="function"?WeakMap:Map,qt=0,ur=null,Nt=null,kt=0,Qt=0,Ea=null,ho=!1,Uc=!1,f1=!1,Ti=0,Dr=0,mo=0,Nl=0,h1=0,Ta=0,zc=0,Ff=null,sa=null,d1=!1,_d=0,CT=0,Ed=1/0,Td=null,po=null,tn=0,go=null,Hc=null,wi=0,m1=0,p1=null,kT=null,Of=0,g1=null;function wa(){return(qt&2)!==0&&kt!==0?kt&-kt:ne.T!==null?T1():L()}function RT(){if(Ta===0)if((kt&536870912)===0||Ot){var s=ri;ri<<=1,(ri&3932160)===0&&(ri=262144),Ta=s}else Ta=536870912;return s=ya.current,s!==null&&(s.flags|=32),Ta}function ia(s,o,c){(s===ur&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)&&(Gc(s,0),xo(s,kt,Ta,!1)),ni(s,c),((qt&2)===0||s!==ur)&&(s===ur&&((qt&2)===0&&(Nl|=c),Dr===4&&xo(s,kt,Ta,!1)),Ls(s))}function DT(s,o,c){if((qt&6)!==0)throw Error(n(327));var d=!c&&(o&127)===0&&(o&s.expiredLanes)===0||ma(s,o),g=d?e6(s,o):v1(s,o,!0),y=d;do{if(g===0){Uc&&!d&&xo(s,o,0,!1);break}else{if(c=s.current.alternate,y&&!JI(c)){g=v1(s,o,!1),y=!1;continue}if(g===2){if(y=o,s.errorRecoveryDisabledLanes&y)var C=0;else C=s.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){o=C;e:{var U=s;g=Ff;var re=U.current.memoizedState.isDehydrated;if(re&&(Gc(U,C).flags|=256),C=v1(U,C,!1),C!==2){if(f1&&!re){U.errorRecoveryDisabledLanes|=y,Nl|=y,g=4;break e}y=sa,sa=g,y!==null&&(sa===null?sa=y:sa.push.apply(sa,y))}g=C}if(y=!1,g!==2)continue}}if(g===1){Gc(s,0),xo(s,o,0,!0);break}e:{switch(d=s,y=g,y){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:xo(d,o,Ta,!ho);break e;case 2:sa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(g=_d+300-ft(),10<g)){if(xo(d,o,Ta,!ho),Ra(d,0,!0)!==0)break e;wi=o,d.timeoutHandle=lw(IT.bind(null,d,c,sa,Td,d1,o,Ta,Nl,zc,ho,y,"Throttled",-0,0),g);break e}IT(d,c,sa,Td,d1,o,Ta,Nl,zc,ho,y,null,-0,0)}}break}while(!0);Ls(s)}function IT(s,o,c,d,g,y,C,U,re,pe,Ce,Ie,_e,Te){if(s.timeoutHandle=-1,Ie=o.subtreeFlags,Ie&8192||(Ie&16785408)===16785408){Ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:os},ST(o,y,Ie);var et=(y&62914560)===y?_d-ft():(y&4194048)===y?CT-ft():0;if(et=P6(Ie,et),et!==null){wi=y,s.cancelPendingCommit=et(jT.bind(null,s,o,y,c,d,g,C,U,re,Ce,Ie,null,_e,Te)),xo(s,y,C,!pe);return}}jT(s,o,y,c,d,g,C,U,re)}function JI(s){for(var o=s;;){var c=o.tag;if((c===0||c===11||c===15)&&o.flags&16384&&(c=o.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var g=c[d],y=g.getSnapshot;g=g.value;try{if(!xa(y(),g))return!1}catch{return!1}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function xo(s,o,c,d){o&=~h1,o&=~Nl,s.suspendedLanes|=o,s.pingedLanes&=~o,d&&(s.warmLanes|=o),d=s.expirationTimes;for(var g=o;0<g;){var y=31-wr(g),C=1<<y;d[y]=-1,g&=~C}c!==0&&ai(s,c,o)}function wd(){return(qt&6)===0?(Mf(0),!1):!0}function x1(){if(Nt!==null){if(Qt===0)var s=Nt.return;else s=Nt,hi=vl=null,Fg(s),Oc=null,xf=0,s=Nt;for(;s!==null;)cT(s.alternate,s),s=s.return;Nt=null}}function Gc(s,o){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,v6(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),wi=0,x1(),ur=s,Nt=c=ui(s.current,null),kt=o,Qt=0,Ea=null,ho=!1,Uc=ma(s,o),f1=!1,zc=Ta=h1=Nl=mo=Dr=0,sa=Ff=null,d1=!1,(o&8)!==0&&(o|=o&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=o;0<d;){var g=31-wr(d),y=1<<g;o|=s[g],d&=~y}return Ti=o,G0(),c}function FT(s,o){_t=null,ne.H=Af,o===Fc||o===J0?(o=K2(),Qt=3):o===Eg?(o=K2(),Qt=4):Qt=o===Kg?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ea=o,Nt===null&&(Dr=1,hd(s,Pa(o,s.current)))}function OT(){var s=ya.current;return s===null?!0:(kt&4194048)===kt?ja===null:(kt&62914560)===kt||(kt&536870912)!==0?s===ja:!1}function MT(){var s=ne.H;return ne.H=Af,s===null?Af:s}function PT(){var s=ne.A;return ne.A=YI,s}function Sd(){Dr=4,ho||(kt&4194048)!==kt&&ya.current!==null||(Uc=!0),(mo&134217727)===0&&(Nl&134217727)===0||ur===null||xo(ur,kt,Ta,!1)}function v1(s,o,c){var d=qt;qt|=2;var g=MT(),y=PT();(ur!==s||kt!==o)&&(Td=null,Gc(s,o)),o=!1;var C=Dr;e:do try{if(Qt!==0&&Nt!==null){var U=Nt,re=Ea;switch(Qt){case 8:x1(),C=6;break e;case 3:case 2:case 9:case 6:ya.current===null&&(o=!0);var pe=Qt;if(Qt=0,Ea=null,qc(s,U,re,pe),c&&Uc){C=0;break e}break;default:pe=Qt,Qt=0,Ea=null,qc(s,U,re,pe)}}ZI(),C=Dr;break}catch(Ce){FT(s,Ce)}while(!0);return o&&s.shellSuspendCounter++,hi=vl=null,qt=d,ne.H=g,ne.A=y,Nt===null&&(ur=null,kt=0,G0()),C}function ZI(){for(;Nt!==null;)LT(Nt)}function e6(s,o){var c=qt;qt|=2;var d=MT(),g=PT();ur!==s||kt!==o?(Td=null,Ed=ft()+500,Gc(s,o)):Uc=ma(s,o);e:do try{if(Qt!==0&&Nt!==null){o=Nt;var y=Ea;t:switch(Qt){case 1:Qt=0,Ea=null,qc(s,o,y,1);break;case 2:case 9:if(X2(y)){Qt=0,Ea=null,VT(o);break}o=function(){Qt!==2&&Qt!==9||ur!==s||(Qt=7),Ls(s)},y.then(o,o);break e;case 3:Qt=7;break e;case 4:Qt=5;break e;case 7:X2(y)?(Qt=0,Ea=null,VT(o)):(Qt=0,Ea=null,qc(s,o,y,7));break;case 5:var C=null;switch(Nt.tag){case 26:C=Nt.memoizedState;case 5:case 27:var U=Nt;if(C?ww(C):U.stateNode.complete){Qt=0,Ea=null;var re=U.sibling;if(re!==null)Nt=re;else{var pe=U.return;pe!==null?(Nt=pe,Ad(pe)):Nt=null}break t}}Qt=0,Ea=null,qc(s,o,y,5);break;case 6:Qt=0,Ea=null,qc(s,o,y,6);break;case 8:x1(),Dr=6;break e;default:throw Error(n(462))}}t6();break}catch(Ce){FT(s,Ce)}while(!0);return hi=vl=null,ne.H=d,ne.A=g,qt=c,Nt!==null?0:(ur=null,kt=0,G0(),Dr)}function t6(){for(;Nt!==null&&!Wt();)LT(Nt)}function LT(s){var o=oT(s.alternate,s,Ti);s.memoizedProps=s.pendingProps,o===null?Ad(s):Nt=o}function VT(s){var o=s,c=o.alternate;switch(o.tag){case 15:case 0:o=tT(c,o,o.pendingProps,o.type,void 0,kt);break;case 11:o=tT(c,o,o.pendingProps,o.type.render,o.ref,kt);break;case 5:Fg(o);default:cT(c,o),o=Nt=P2(o,Ti),o=oT(c,o,Ti)}s.memoizedProps=s.pendingProps,o===null?Ad(s):Nt=o}function qc(s,o,c,d){hi=vl=null,Fg(o),Oc=null,xf=0;var g=o.return;try{if(HI(s,g,o,c,kt)){Dr=1,hd(s,Pa(c,s.current)),Nt=null;return}}catch(y){if(g!==null)throw Nt=g,y;Dr=1,hd(s,Pa(c,s.current)),Nt=null;return}o.flags&32768?(Ot||d===1?s=!0:Uc||(kt&536870912)!==0?s=!1:(ho=s=!0,(d===2||d===9||d===3||d===6)&&(d=ya.current,d!==null&&d.tag===13&&(d.flags|=16384))),BT(o,s)):Ad(o)}function Ad(s){var o=s;do{if((o.flags&32768)!==0){BT(o,ho);return}s=o.return;var c=WI(o.alternate,o,Ti);if(c!==null){Nt=c;return}if(o=o.sibling,o!==null){Nt=o;return}Nt=o=s}while(o!==null);Dr===0&&(Dr=5)}function BT(s,o){do{var c=XI(s.alternate,s);if(c!==null){c.flags&=32767,Nt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!o&&(s=s.sibling,s!==null)){Nt=s;return}Nt=s=c}while(s!==null);Dr=6,Nt=null}function jT(s,o,c,d,g,y,C,U,re){s.cancelPendingCommit=null;do bd();while(tn!==0);if((qt&6)!==0)throw Error(n(327));if(o!==null){if(o===s.current)throw Error(n(177));if(y=o.lanes|o.childLanes,y|=ig,Qu(s,c,y,C,U,re),s===ur&&(Nt=ur=null,kt=0),Hc=o,go=s,wi=c,m1=y,p1=g,kT=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,s6(yr,function(){return qT(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=ne.T,ne.T=null,g=ae.p,ae.p=2,C=qt,qt|=4;try{$I(s,o,c)}finally{qt=C,ae.p=g,ne.T=d}}tn=1,UT(),zT(),HT()}}function UT(){if(tn===1){tn=0;var s=go,o=Hc,c=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var d=ae.p;ae.p=2;var g=qt;qt|=4;try{ET(o,s);var y=R1,C=N2(s.containerInfo),U=y.focusedElem,re=y.selectionRange;if(C!==U&&U&&U.ownerDocument&&b2(U.ownerDocument.documentElement,U)){if(re!==null&&tg(U)){var pe=re.start,Ce=re.end;if(Ce===void 0&&(Ce=pe),"selectionStart"in U)U.selectionStart=pe,U.selectionEnd=Math.min(Ce,U.value.length);else{var Ie=U.ownerDocument||document,_e=Ie&&Ie.defaultView||window;if(_e.getSelection){var Te=_e.getSelection(),et=U.textContent.length,ot=Math.min(re.start,et),ir=re.end===void 0?ot:Math.min(re.end,et);!Te.extend&&ot>ir&&(C=ir,ir=ot,ot=C);var le=A2(U,ot),oe=A2(U,ir);if(le&&oe&&(Te.rangeCount!==1||Te.anchorNode!==le.node||Te.anchorOffset!==le.offset||Te.focusNode!==oe.node||Te.focusOffset!==oe.offset)){var he=Ie.createRange();he.setStart(le.node,le.offset),Te.removeAllRanges(),ot>ir?(Te.addRange(he),Te.extend(oe.node,oe.offset)):(he.setEnd(oe.node,oe.offset),Te.addRange(he))}}}}for(Ie=[],Te=U;Te=Te.parentNode;)Te.nodeType===1&&Ie.push({element:Te,left:Te.scrollLeft,top:Te.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Ie.length;U++){var Re=Ie[U];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}Vd=!!k1,R1=k1=null}finally{qt=g,ae.p=d,ne.T=c}}s.current=o,tn=2}}function zT(){if(tn===2){tn=0;var s=go,o=Hc,c=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var d=ae.p;ae.p=2;var g=qt;qt|=4;try{gT(s,o.alternate,o)}finally{qt=g,ae.p=d,ne.T=c}}tn=3}}function HT(){if(tn===4||tn===3){tn=0,rr();var s=go,o=Hc,c=wi,d=kT;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?tn=5:(tn=0,Hc=go=null,GT(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(po=null),as(c),o=o.stateNode,hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(Ht,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=ne.T,g=ae.p,ae.p=2,ne.T=null;try{for(var y=s.onRecoverableError,C=0;C<d.length;C++){var U=d[C];y(U.value,{componentStack:U.stack})}}finally{ne.T=o,ae.p=g}}(wi&3)!==0&&bd(),Ls(s),g=s.pendingLanes,(c&261930)!==0&&(g&42)!==0?s===g1?Of++:(Of=0,g1=s):Of=0,Mf(0)}}function GT(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,pf(o)))}function bd(){return UT(),zT(),HT(),qT()}function qT(){if(tn!==5)return!1;var s=go,o=m1;m1=0;var c=as(wi),d=ne.T,g=ae.p;try{ae.p=32>c?32:c,ne.T=null,c=p1,p1=null;var y=go,C=wi;if(tn=0,Hc=go=null,wi=0,(qt&6)!==0)throw Error(n(331));var U=qt;if(qt|=4,bT(y.current),wT(y,y.current,C,c),qt=U,Mf(0,!1),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(Ht,y)}catch{}return!0}finally{ae.p=g,ne.T=d,GT(s,o)}}function WT(s,o,c){o=Pa(c,o),o=$g(s.stateNode,o,2),s=lo(s,o,2),s!==null&&(ni(s,2),Ls(s))}function Jt(s,o,c){if(s.tag===3)WT(s,s,c);else for(;o!==null;){if(o.tag===3){WT(o,s,c);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(po===null||!po.has(d))){s=Pa(c,s),c=XE(2),d=lo(o,c,2),d!==null&&($E(c,d,o,s),ni(d,2),Ls(d));break}}o=o.return}}function y1(s,o,c){var d=s.pingCache;if(d===null){d=s.pingCache=new QI;var g=new Set;d.set(o,g)}else g=d.get(o),g===void 0&&(g=new Set,d.set(o,g));g.has(c)||(f1=!0,g.add(c),s=r6.bind(null,s,o,c),o.then(s,s))}function r6(s,o,c){var d=s.pingCache;d!==null&&d.delete(o),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,ur===s&&(kt&c)===c&&(Dr===4||Dr===3&&(kt&62914560)===kt&&300>ft()-_d?(qt&2)===0&&Gc(s,0):h1|=c,zc===kt&&(zc=0)),Ls(s)}function XT(s,o){o===0&&(o=dc()),s=pl(s,o),s!==null&&(ni(s,o),Ls(s))}function n6(s){var o=s.memoizedState,c=0;o!==null&&(c=o.retryLane),XT(s,c)}function a6(s,o){var c=0;switch(s.tag){case 31:case 13:var d=s.stateNode,g=s.memoizedState;g!==null&&(c=g.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(o),XT(s,c)}function s6(s,o){return Qe(s,o)}var Nd=null,Wc=null,_1=!1,Cd=!1,E1=!1,vo=0;function Ls(s){s!==Wc&&s.next===null&&(Wc===null?Nd=Wc=s:Wc=Wc.next=s),Cd=!0,_1||(_1=!0,o6())}function Mf(s,o){if(!E1&&Cd){E1=!0;do for(var c=!1,d=Nd;d!==null;){if(s!==0){var g=d.pendingLanes;if(g===0)var y=0;else{var C=d.suspendedLanes,U=d.pingedLanes;y=(1<<31-wr(42|s)+1)-1,y&=g&~(C&~U),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(c=!0,QT(d,y))}else y=kt,y=Ra(d,d===ur?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||ma(d,y)||(c=!0,QT(d,y));d=d.next}while(c);E1=!1}}function i6(){$T()}function $T(){Cd=_1=!1;var s=0;vo!==0&&x6()&&(s=vo);for(var o=ft(),c=null,d=Nd;d!==null;){var g=d.next,y=KT(d,o);y===0?(d.next=null,c===null?Nd=g:c.next=g,g===null&&(Wc=c)):(c=d,(s!==0||(y&3)!==0)&&(Cd=!0)),d=g}tn!==0&&tn!==5||Mf(s),vo!==0&&(vo=0)}function KT(s,o){for(var c=s.suspendedLanes,d=s.pingedLanes,g=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var C=31-wr(y),U=1<<C,re=g[C];re===-1?((U&c)===0||(U&d)!==0)&&(g[C]=Yu(U,o)):re<=o&&(s.expiredLanes|=U),y&=~U}if(o=ur,c=kt,c=Ra(s,s===o?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,c===0||s===o&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&zt(d),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||ma(s,c)){if(o=c&-c,o===s.callbackPriority)return o;switch(d!==null&&zt(d),as(c)){case 2:case 8:c=ha;break;case 32:c=yr;break;case 268435456:c=vt;break;default:c=yr}return d=YT.bind(null,s),c=Qe(c,d),s.callbackPriority=o,s.callbackNode=c,o}return d!==null&&d!==null&&zt(d),s.callbackPriority=2,s.callbackNode=null,2}function YT(s,o){if(tn!==0&&tn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(bd()&&s.callbackNode!==c)return null;var d=kt;return d=Ra(s,s===ur?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(DT(s,d,o),KT(s,ft()),s.callbackNode!=null&&s.callbackNode===c?YT.bind(null,s):null)}function QT(s,o){if(bd())return null;DT(s,o,!0)}function o6(){y6(function(){(qt&6)!==0?Qe(en,i6):$T()})}function T1(){if(vo===0){var s=Dc;s===0&&(s=da,da<<=1,(da&261888)===0&&(da=256)),vo=s}return vo}function JT(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:gc(""+s)}function ZT(s,o){var c=o.ownerDocument.createElement("input");return c.name=o.name,c.value=o.value,s.id&&c.setAttribute("form",s.id),o.parentNode.insertBefore(c,o),s=new FormData(s),c.parentNode.removeChild(c),s}function l6(s,o,c,d,g){if(o==="submit"&&c&&c.stateNode===g){var y=JT((g[X]||null).action),C=d.submitter;C&&(o=(o=C[X]||null)?JT(o.formAction):C.getAttribute("formAction"),o!==null&&(y=o,C=null));var U=new Rs("action","action",null,d,g);s.push({event:U,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(vo!==0){var re=C?ZT(g,C):new FormData(g);zg(c,{pending:!0,data:re,method:g.method,action:y},null,re)}}else typeof y=="function"&&(U.preventDefault(),re=C?ZT(g,C):new FormData(g),zg(c,{pending:!0,data:re,method:g.method,action:y},y,re))},currentTarget:g}]})}}for(var w1=0;w1<sg.length;w1++){var S1=sg[w1],c6=S1.toLowerCase(),u6=S1[0].toUpperCase()+S1.slice(1);hs(c6,"on"+u6)}hs(R2,"onAnimationEnd"),hs(D2,"onAnimationIteration"),hs(I2,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(bI,"onTransitionRun"),hs(NI,"onTransitionStart"),hs(CI,"onTransitionCancel"),hs(F2,"onTransitionEnd"),Cn("onMouseEnter",["mouseout","mouseover"]),Cn("onMouseLeave",["mouseout","mouseover"]),Cn("onPointerEnter",["pointerout","pointerover"]),Cn("onPointerLeave",["pointerout","pointerover"]),cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pf));function ew(s,o){o=(o&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],g=d.event;d=d.listeners;e:{var y=void 0;if(o)for(var C=d.length-1;0<=C;C--){var U=d[C],re=U.instance,pe=U.currentTarget;if(U=U.listener,re!==y&&g.isPropagationStopped())break e;y=U,g.currentTarget=pe;try{y(g)}catch(Ce){H0(Ce)}g.currentTarget=null,y=re}else for(C=0;C<d.length;C++){if(U=d[C],re=U.instance,pe=U.currentTarget,U=U.listener,re!==y&&g.isPropagationStopped())break e;y=U,g.currentTarget=pe;try{y(g)}catch(Ce){H0(Ce)}g.currentTarget=null,y=re}}}}function Ct(s,o){var c=o[de];c===void 0&&(c=o[de]=new Set);var d=s+"__bubble";c.has(d)||(tw(o,s,2,!1),c.add(d))}function A1(s,o,c){var d=0;o&&(d|=4),tw(c,s,d,o)}var kd="_reactListening"+Math.random().toString(36).slice(2);function b1(s){if(!s[kd]){s[kd]=!0,$t.forEach(function(c){c!=="selectionchange"&&(f6.has(c)||A1(c,!1,s),A1(c,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[kd]||(o[kd]=!0,A1("selectionchange",!1,o))}}function tw(s,o,c,d){switch(Rw(o)){case 2:var g=B6;break;case 8:g=j6;break;default:g=U1}c=g.bind(null,o,c,s),g=void 0,!ol||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),d?g!==void 0?s.addEventListener(o,c,{capture:!0,passive:g}):s.addEventListener(o,c,!0):g!==void 0?s.addEventListener(o,c,{passive:g}):s.addEventListener(o,c,!1)}function N1(s,o,c,d,g){var y=d;if((o&1)===0&&(o&2)===0&&d!==null)e:for(;;){if(d===null)return;var C=d.tag;if(C===3||C===4){var U=d.stateNode.containerInfo;if(U===g)break;if(C===4)for(C=d.return;C!==null;){var re=C.tag;if((re===3||re===4)&&C.stateNode.containerInfo===g)return;C=C.return}for(;U!==null;){if(C=He(U),C===null)return;if(re=C.tag,re===5||re===6||re===26||re===27){d=y=C;continue e}U=U.parentNode}}d=d.return}Ji(function(){var pe=y,Ce=Ia(c),Ie=[];e:{var _e=O2.get(s);if(_e!==void 0){var Te=Rs,et=s;switch(s){case"keypress":if(cl(c)===0)break e;case"keydown":case"keyup":Te=j0;break;case"focusin":et="focus",Te=fl;break;case"focusout":et="blur",Te=fl;break;case"beforeblur":case"afterblur":Te=fl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=of;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=D0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=S;break;case R2:case D2:case I2:Te=F0;break;case F2:Te=H;break;case"scroll":case"scrollend":Te=sf;break;case"wheel":Te=Ee;break;case"copy":case"cut":case"paste":Te=O0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=ci;break;case"toggle":case"beforetoggle":Te=yt}var ot=(o&4)!==0,ir=!ot&&(s==="scroll"||s==="scrollend"),le=ot?_e!==null?_e+"Capture":null:_e;ot=[];for(var oe=pe,he;oe!==null;){var Re=oe;if(he=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||he===null||le===null||(Re=ls(oe,le),Re!=null&&ot.push(Lf(oe,Re,he))),ir)break;oe=oe.return}0<ot.length&&(_e=new Te(_e,et,null,c,Ce),Ie.push({event:_e,listeners:ot}))}}if((o&7)===0){e:{if(_e=s==="mouseover"||s==="pointerover",Te=s==="mouseout"||s==="pointerout",_e&&c!==rf&&(et=c.relatedTarget||c.fromElement)&&(He(et)||et[Z]))break e;if((Te||_e)&&(_e=Ce.window===Ce?Ce:(_e=Ce.ownerDocument)?_e.defaultView||_e.parentWindow:window,Te?(et=c.relatedTarget||c.toElement,Te=pe,et=et?He(et):null,et!==null&&(ir=i(et),ot=et.tag,et!==ir||ot!==5&&ot!==27&&ot!==6)&&(et=null)):(Te=null,et=pe),Te!==et)){if(ot=of,Re="onMouseLeave",le="onMouseEnter",oe="mouse",(s==="pointerout"||s==="pointerover")&&(ot=ci,Re="onPointerLeave",le="onPointerEnter",oe="pointer"),ir=Te==null?_e:je(Te),he=et==null?_e:je(et),_e=new ot(Re,oe+"leave",Te,c,Ce),_e.target=ir,_e.relatedTarget=he,Re=null,He(Ce)===pe&&(ot=new ot(le,oe+"enter",et,c,Ce),ot.target=he,ot.relatedTarget=ir,Re=ot),ir=Re,Te&&et)t:{for(ot=h6,le=Te,oe=et,he=0,Re=le;Re;Re=ot(Re))he++;Re=0;for(var at=oe;at;at=ot(at))Re++;for(;0<he-Re;)le=ot(le),he--;for(;0<Re-he;)oe=ot(oe),Re--;for(;he--;){if(le===oe||oe!==null&&le===oe.alternate){ot=le;break t}le=ot(le),oe=ot(oe)}ot=null}else ot=null;Te!==null&&rw(Ie,_e,Te,ot,!1),et!==null&&ir!==null&&rw(Ie,ir,et,ot,!0)}}e:{if(_e=pe?je(pe):window,Te=_e.nodeName&&_e.nodeName.toLowerCase(),Te==="select"||Te==="input"&&_e.type==="file")var Bt=y2;else if(x2(_e))if(_2)Bt=wI;else{Bt=EI;var rt=_I}else Te=_e.nodeName,!Te||Te.toLowerCase()!=="input"||_e.type!=="checkbox"&&_e.type!=="radio"?pe&&pc(pe.elementType)&&(Bt=y2):Bt=TI;if(Bt&&(Bt=Bt(s,pe))){v2(Ie,Bt,c,Ce);break e}rt&&rt(s,_e,pe),s==="focusout"&&pe&&_e.type==="number"&&pe.memoizedProps.value!=null&&Zu(_e,"number",_e.value)}switch(rt=pe?je(pe):window,s){case"focusin":(x2(rt)||rt.contentEditable==="true")&&(wc=rt,rg=pe,hf=null);break;case"focusout":hf=rg=wc=null;break;case"mousedown":ng=!0;break;case"contextmenu":case"mouseup":case"dragend":ng=!1,C2(Ie,c,Ce);break;case"selectionchange":if(AI)break;case"keydown":case"keyup":C2(Ie,c,Ce)}var Tt;if(Gt)e:{switch(s){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else Tc?hl(s,c)&&(Rt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Rt="onCompositionStart");Rt&&(Fs&&c.locale!=="ko"&&(Tc||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&Tc&&(Tt=af()):(ks=Ce,nf="value"in ks?ks.value:ks.textContent,Tc=!0)),rt=Rd(pe,Rt),0<rt.length&&(Rt=new Is(Rt,s,null,c,Ce),Ie.push({event:Rt,listeners:rt}),Tt?Rt.data=Tt:(Tt=Ec(c),Tt!==null&&(Rt.data=Tt)))),(Tt=Oa?gI(s,c):xI(s,c))&&(Rt=Rd(pe,"onBeforeInput"),0<Rt.length&&(rt=new Is("onBeforeInput","beforeinput",null,c,Ce),Ie.push({event:rt,listeners:Rt}),rt.data=Tt)),l6(Ie,s,pe,c,Ce)}ew(Ie,o)})}function Lf(s,o,c){return{instance:s,listener:o,currentTarget:c}}function Rd(s,o){for(var c=o+"Capture",d=[];s!==null;){var g=s,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=ls(s,c),g!=null&&d.unshift(Lf(s,g,y)),g=ls(s,o),g!=null&&d.push(Lf(s,g,y))),s.tag===3)return d;s=s.return}return[]}function h6(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function rw(s,o,c,d,g){for(var y=o._reactName,C=[];c!==null&&c!==d;){var U=c,re=U.alternate,pe=U.stateNode;if(U=U.tag,re!==null&&re===d)break;U!==5&&U!==26&&U!==27||pe===null||(re=pe,g?(pe=ls(c,y),pe!=null&&C.unshift(Lf(c,pe,re))):g||(pe=ls(c,y),pe!=null&&C.push(Lf(c,pe,re)))),c=c.return}C.length!==0&&s.push({event:o,listeners:C})}var d6=/\r\n?/g,m6=/\u0000|\uFFFD/g;function nw(s){return(typeof s=="string"?s:""+s).replace(d6,`
`).replace(m6,"")}function aw(s,o){return o=nw(o),nw(s)===o}function sr(s,o,c,d,g,y){switch(c){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||ta(s,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&ta(s,""+d);break;case"className":ga(s,"class",d);break;case"tabIndex":ga(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ga(s,c,d);break;case"style":tf(s,d,y);break;case"data":if(o!=="object"){ga(s,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||c!=="href")){s.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=gc(""+d),s.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(c==="formAction"?(o!=="input"&&sr(s,o,"name",g.name,g,null),sr(s,o,"formEncType",g.formEncType,g,null),sr(s,o,"formMethod",g.formMethod,g,null),sr(s,o,"formTarget",g.formTarget,g,null)):(sr(s,o,"encType",g.encType,g,null),sr(s,o,"method",g.method,g,null),sr(s,o,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=gc(""+d),s.setAttribute(c,d);break;case"onClick":d!=null&&(s.onclick=os);break;case"onScroll":d!=null&&Ct("scroll",s);break;case"onScrollEnd":d!=null&&Ct("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}c=gc(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""+d):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":d===!0?s.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,d):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(c,d):s.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(c):s.setAttribute(c,d);break;case"popover":Ct("beforetoggle",s),Ct("toggle",s),kn(s,"popover",d);break;case"xlinkActuate":Hr(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Hr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Hr(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Hr(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Hr(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Hr(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Hr(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Hr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Hr(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":kn(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=R0.get(c)||c,kn(s,c,d))}}function C1(s,o,c,d,g,y){switch(c){case"style":tf(s,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(g.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof d=="string"?ta(s,d):(typeof d=="number"||typeof d=="bigint")&&ta(s,""+d);break;case"onScroll":d!=null&&Ct("scroll",s);break;case"onScrollEnd":d!=null&&Ct("scrollend",s);break;case"onClick":d!=null&&(s.onclick=os);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),o=c.slice(2,g?c.length-7:void 0),y=s[X]||null,y=y!=null?y[c]:null,typeof y=="function"&&s.removeEventListener(o,y,g),typeof d=="function")){typeof y!="function"&&y!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(o,d,g);break e}c in s?s[c]=d:d===!0?s.setAttribute(c,""):kn(s,c,d)}}}function _n(s,o,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ct("error",s),Ct("load",s);var d=!1,g=!1,y;for(y in c)if(c.hasOwnProperty(y)){var C=c[y];if(C!=null)switch(y){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:sr(s,o,y,C,c,null)}}g&&sr(s,o,"srcSet",c.srcSet,c,null),d&&sr(s,o,"src",c.src,c,null);return;case"input":Ct("invalid",s);var U=y=C=g=null,re=null,pe=null;for(d in c)if(c.hasOwnProperty(d)){var Ce=c[d];if(Ce!=null)switch(d){case"name":g=Ce;break;case"type":C=Ce;break;case"checked":re=Ce;break;case"defaultChecked":pe=Ce;break;case"value":y=Ce;break;case"defaultValue":U=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(n(137,o));break;default:sr(s,o,d,Ce,c,null)}}N0(s,y,U,re,pe,C,g,!1);return;case"select":Ct("invalid",s),d=C=y=null;for(g in c)if(c.hasOwnProperty(g)&&(U=c[g],U!=null))switch(g){case"value":y=U;break;case"defaultValue":C=U;break;case"multiple":d=U;default:sr(s,o,g,U,c,null)}o=y,c=C,s.multiple=!!d,o!=null?$i(s,!!d,o,!1):c!=null&&$i(s,!!d,c,!0);return;case"textarea":Ct("invalid",s),y=g=d=null;for(C in c)if(c.hasOwnProperty(C)&&(U=c[C],U!=null))switch(C){case"value":d=U;break;case"defaultValue":g=U;break;case"children":y=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:sr(s,o,C,U,c,null)}Ki(s,d,g,y);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(d=c[re],d!=null))switch(re){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:sr(s,o,re,d,c,null)}return;case"dialog":Ct("beforetoggle",s),Ct("toggle",s),Ct("cancel",s),Ct("close",s);break;case"iframe":case"object":Ct("load",s);break;case"video":case"audio":for(d=0;d<Pf.length;d++)Ct(Pf[d],s);break;case"image":Ct("error",s),Ct("load",s);break;case"details":Ct("toggle",s);break;case"embed":case"source":case"link":Ct("error",s),Ct("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(d=c[pe],d!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:sr(s,o,pe,d,c,null)}return;default:if(pc(o)){for(Ce in c)c.hasOwnProperty(Ce)&&(d=c[Ce],d!==void 0&&C1(s,o,Ce,d,c,void 0));return}}for(U in c)c.hasOwnProperty(U)&&(d=c[U],d!=null&&sr(s,o,U,d,c,null))}function p6(s,o,c,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,C=null,U=null,re=null,pe=null,Ce=null;for(Te in c){var Ie=c[Te];if(c.hasOwnProperty(Te)&&Ie!=null)switch(Te){case"checked":break;case"value":break;case"defaultValue":re=Ie;default:d.hasOwnProperty(Te)||sr(s,o,Te,null,d,Ie)}}for(var _e in d){var Te=d[_e];if(Ie=c[_e],d.hasOwnProperty(_e)&&(Te!=null||Ie!=null))switch(_e){case"type":y=Te;break;case"name":g=Te;break;case"checked":pe=Te;break;case"defaultChecked":Ce=Te;break;case"value":C=Te;break;case"defaultValue":U=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(n(137,o));break;default:Te!==Ie&&sr(s,o,_e,Te,d,Ie)}}mc(s,C,U,re,pe,Ce,y,g);return;case"select":Te=C=U=_e=null;for(y in c)if(re=c[y],c.hasOwnProperty(y)&&re!=null)switch(y){case"value":break;case"multiple":Te=re;default:d.hasOwnProperty(y)||sr(s,o,y,null,d,re)}for(g in d)if(y=d[g],re=c[g],d.hasOwnProperty(g)&&(y!=null||re!=null))switch(g){case"value":_e=y;break;case"defaultValue":U=y;break;case"multiple":C=y;default:y!==re&&sr(s,o,g,y,d,re)}o=U,c=C,d=Te,_e!=null?$i(s,!!c,_e,!1):!!d!=!!c&&(o!=null?$i(s,!!c,o,!0):$i(s,!!c,c?[]:"",!1));return;case"textarea":Te=_e=null;for(U in c)if(g=c[U],c.hasOwnProperty(U)&&g!=null&&!d.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:sr(s,o,U,null,d,g)}for(C in d)if(g=d[C],y=c[C],d.hasOwnProperty(C)&&(g!=null||y!=null))switch(C){case"value":_e=g;break;case"defaultValue":Te=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==y&&sr(s,o,C,g,d,y)}C0(s,_e,Te);return;case"option":for(var et in c)if(_e=c[et],c.hasOwnProperty(et)&&_e!=null&&!d.hasOwnProperty(et))switch(et){case"selected":s.selected=!1;break;default:sr(s,o,et,null,d,_e)}for(re in d)if(_e=d[re],Te=c[re],d.hasOwnProperty(re)&&_e!==Te&&(_e!=null||Te!=null))switch(re){case"selected":s.selected=_e&&typeof _e!="function"&&typeof _e!="symbol";break;default:sr(s,o,re,_e,d,Te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in c)_e=c[ot],c.hasOwnProperty(ot)&&_e!=null&&!d.hasOwnProperty(ot)&&sr(s,o,ot,null,d,_e);for(pe in d)if(_e=d[pe],Te=c[pe],d.hasOwnProperty(pe)&&_e!==Te&&(_e!=null||Te!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,o));break;default:sr(s,o,pe,_e,d,Te)}return;default:if(pc(o)){for(var ir in c)_e=c[ir],c.hasOwnProperty(ir)&&_e!==void 0&&!d.hasOwnProperty(ir)&&C1(s,o,ir,void 0,d,_e);for(Ce in d)_e=d[Ce],Te=c[Ce],!d.hasOwnProperty(Ce)||_e===Te||_e===void 0&&Te===void 0||C1(s,o,Ce,_e,d,Te);return}}for(var le in c)_e=c[le],c.hasOwnProperty(le)&&_e!=null&&!d.hasOwnProperty(le)&&sr(s,o,le,null,d,_e);for(Ie in d)_e=d[Ie],Te=c[Ie],!d.hasOwnProperty(Ie)||_e===Te||_e==null&&Te==null||sr(s,o,Ie,_e,d,Te)}function sw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function g6(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var g=c[d],y=g.transferSize,C=g.initiatorType,U=g.duration;if(y&&U&&sw(C)){for(C=0,U=g.responseEnd,d+=1;d<c.length;d++){var re=c[d],pe=re.startTime;if(pe>U)break;var Ce=re.transferSize,Ie=re.initiatorType;Ce&&sw(Ie)&&(re=re.responseEnd,C+=Ce*(re<U?1:(U-pe)/(re-pe)))}if(--d,o+=8*(y+C)/(g.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var k1=null,R1=null;function Dd(s){return s.nodeType===9?s:s.ownerDocument}function iw(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ow(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function D1(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var I1=null;function x6(){var s=window.event;return s&&s.type==="popstate"?s===I1?!1:(I1=s,!0):(I1=null,!1)}var lw=typeof setTimeout=="function"?setTimeout:void 0,v6=typeof clearTimeout=="function"?clearTimeout:void 0,cw=typeof Promise=="function"?Promise:void 0,y6=typeof queueMicrotask=="function"?queueMicrotask:typeof cw<"u"?function(s){return cw.resolve(null).then(s).catch(_6)}:lw;function _6(s){setTimeout(function(){throw s})}function yo(s){return s==="head"}function uw(s,o){var c=o,d=0;do{var g=c.nextSibling;if(s.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"||c==="/&"){if(d===0){s.removeChild(g),Yc(o);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Vf(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Vf(c);for(var y=c.firstChild;y;){var C=y.nextSibling,U=y.nodeName;y[ve]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&y.rel.toLowerCase()==="stylesheet"||c.removeChild(y),y=C}}else c==="body"&&Vf(s.ownerDocument.body);c=g}while(c);Yc(o)}function fw(s,o){var c=s;s=0;do{var d=c.nextSibling;if(c.nodeType===1?o?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(o?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=d}while(c)}function F1(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var c=o;switch(o=o.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":F1(c),ze(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function E6(s,o,c,d){for(;s.nodeType===1;){var g=c;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[ve])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Ua(s.nextSibling),s===null)break}return null}function T6(s,o,c){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Ua(s.nextSibling),s===null))return null;return s}function hw(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Ua(s.nextSibling),s===null))return null;return s}function O1(s){return s.data==="$?"||s.data==="$~"}function M1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function w6(s,o){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||c.readyState!=="loading")o();else{var d=function(){o(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Ua(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var P1=null;function dw(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(o===0)return Ua(s.nextSibling);o--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||o++}s=s.nextSibling}return null}function mw(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(o===0)return s;o--}else c!=="/$"&&c!=="/&"||o++}s=s.previousSibling}return null}function pw(s,o,c){switch(o=Dd(c),s){case"html":if(s=o.documentElement,!s)throw Error(n(452));return s;case"head":if(s=o.head,!s)throw Error(n(453));return s;case"body":if(s=o.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Vf(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);ze(s)}var za=new Map,gw=new Set;function Id(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Si=ae.d;ae.d={f:S6,r:A6,D:b6,C:N6,L:C6,m:k6,X:D6,S:R6,M:I6};function S6(){var s=Si.f(),o=wd();return s||o}function A6(s){var o=Ke(s);o!==null&&o.tag===5&&o.type==="form"?FE(o):Si.r(s)}var Xc=typeof document>"u"?null:document;function xw(s,o,c){var d=Xc;if(d&&typeof o=="string"&&o){var g=ea(o);g='link[rel="'+s+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),gw.has(g)||(gw.add(g),s={rel:s,crossOrigin:c,href:o},d.querySelector(g)===null&&(o=d.createElement("link"),_n(o,"link",s),tt(o),d.head.appendChild(o)))}}function b6(s){Si.D(s),xw("dns-prefetch",s,null)}function N6(s,o){Si.C(s,o),xw("preconnect",s,o)}function C6(s,o,c){Si.L(s,o,c);var d=Xc;if(d&&s&&o){var g='link[rel="preload"][as="'+ea(o)+'"]';o==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+ea(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+ea(c.imageSizes)+'"]')):g+='[href="'+ea(s)+'"]';var y=g;switch(o){case"style":y=$c(s);break;case"script":y=Kc(s)}za.has(y)||(s=x({rel:"preload",href:o==="image"&&c&&c.imageSrcSet?void 0:s,as:o},c),za.set(y,s),d.querySelector(g)!==null||o==="style"&&d.querySelector(Bf(y))||o==="script"&&d.querySelector(jf(y))||(o=d.createElement("link"),_n(o,"link",s),tt(o),d.head.appendChild(o)))}}function k6(s,o){Si.m(s,o);var c=Xc;if(c&&s){var d=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+ea(d)+'"][href="'+ea(s)+'"]',y=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Kc(s)}if(!za.has(y)&&(s=x({rel:"modulepreload",href:s},o),za.set(y,s),c.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(jf(y)))return}d=c.createElement("link"),_n(d,"link",s),tt(d),c.head.appendChild(d)}}}function R6(s,o,c){Si.S(s,o,c);var d=Xc;if(d&&s){var g=$e(d).hoistableStyles,y=$c(s);o=o||"default";var C=g.get(y);if(!C){var U={loading:0,preload:null};if(C=d.querySelector(Bf(y)))U.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":o},c),(c=za.get(y))&&L1(s,c);var re=C=d.createElement("link");tt(re),_n(re,"link",s),re._p=new Promise(function(pe,Ce){re.onload=pe,re.onerror=Ce}),re.addEventListener("load",function(){U.loading|=1}),re.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Fd(C,o,d)}C={type:"stylesheet",instance:C,count:1,state:U},g.set(y,C)}}}function D6(s,o){Si.X(s,o);var c=Xc;if(c&&s){var d=$e(c).hoistableScripts,g=Kc(s),y=d.get(g);y||(y=c.querySelector(jf(g)),y||(s=x({src:s,async:!0},o),(o=za.get(g))&&V1(s,o),y=c.createElement("script"),tt(y),_n(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function I6(s,o){Si.M(s,o);var c=Xc;if(c&&s){var d=$e(c).hoistableScripts,g=Kc(s),y=d.get(g);y||(y=c.querySelector(jf(g)),y||(s=x({src:s,async:!0,type:"module"},o),(o=za.get(g))&&V1(s,o),y=c.createElement("script"),tt(y),_n(y,"link",s),c.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function vw(s,o,c,d){var g=(g=ce.current)?Id(g):null;if(!g)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(o=$c(c.href),c=$e(g).hoistableStyles,d=c.get(o),d||(d={type:"style",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=$c(c.href);var y=$e(g).hoistableStyles,C=y.get(s);if(C||(g=g.ownerDocument||g,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,C),(y=g.querySelector(Bf(s)))&&!y._p&&(C.instance=y,C.state.loading=5),za.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},za.set(s,c),y||F6(g,s,c,C.state))),o&&d===null)throw Error(n(528,""));return C}if(o&&d!==null)throw Error(n(529,""));return null;case"script":return o=c.async,c=c.src,typeof c=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Kc(c),c=$e(g).hoistableScripts,d=c.get(o),d||(d={type:"script",instance:null,count:0,state:null},c.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function $c(s){return'href="'+ea(s)+'"'}function Bf(s){return'link[rel="stylesheet"]['+s+"]"}function yw(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function F6(s,o,c,d){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=s.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),_n(o,"link",c),tt(o),s.head.appendChild(o))}function Kc(s){return'[src="'+ea(s)+'"]'}function jf(s){return"script[async]"+s}function _w(s,o,c){if(o.count++,o.instance===null)switch(o.type){case"style":var d=s.querySelector('style[data-href~="'+ea(c.href)+'"]');if(d)return o.instance=d,tt(d),d;var g=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),tt(d),_n(d,"style",g),Fd(d,c.precedence,s),o.instance=d;case"stylesheet":g=$c(c.href);var y=s.querySelector(Bf(g));if(y)return o.state.loading|=4,o.instance=y,tt(y),y;d=yw(c),(g=za.get(g))&&L1(d,g),y=(s.ownerDocument||s).createElement("link"),tt(y);var C=y;return C._p=new Promise(function(U,re){C.onload=U,C.onerror=re}),_n(y,"link",d),o.state.loading|=4,Fd(y,c.precedence,s),o.instance=y;case"script":return y=Kc(c.src),(g=s.querySelector(jf(y)))?(o.instance=g,tt(g),g):(d=c,(g=za.get(y))&&(d=x({},c),V1(d,g)),s=s.ownerDocument||s,g=s.createElement("script"),tt(g),_n(g,"link",d),s.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,Fd(d,c.precedence,s));return o.instance}function Fd(s,o,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,y=g,C=0;C<d.length;C++){var U=d[C];if(U.dataset.precedence===o)y=U;else if(y!==g)break}y?y.parentNode.insertBefore(s,y.nextSibling):(o=c.nodeType===9?c.head:c,o.insertBefore(s,o.firstChild))}function L1(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function V1(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Od=null;function Ew(s,o,c){if(Od===null){var d=new Map,g=Od=new Map;g.set(c,d)}else g=Od,d=g.get(c),d||(d=new Map,g.set(c,d));if(d.has(s))return d;for(d.set(s,null),c=c.getElementsByTagName(s),g=0;g<c.length;g++){var y=c[g];if(!(y[ve]||y[G]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var C=y.getAttribute(o)||"";C=s+C;var U=d.get(C);U?U.push(y):d.set(C,[y])}}return d}function Tw(s,o,c){s=s.ownerDocument||s,s.head.insertBefore(c,o==="title"?s.querySelector("head > title"):null)}function O6(s,o,c){if(c===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function ww(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function M6(s,o,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var g=$c(d.href),y=o.querySelector(Bf(g));if(y){o=y._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=Md.bind(s),o.then(s,s)),c.state.loading|=4,c.instance=y,tt(y);return}y=o.ownerDocument||o,d=yw(d),(g=za.get(g))&&L1(d,g),y=y.createElement("link"),tt(y);var C=y;C._p=new Promise(function(U,re){C.onload=U,C.onerror=re}),_n(y,"link",d),c.instance=y}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=Md.bind(s),o.addEventListener("load",c),o.addEventListener("error",c))}}var B1=0;function P6(s,o){return s.stylesheets&&s.count===0&&Ld(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var d=setTimeout(function(){if(s.stylesheets&&Ld(s,s.stylesheets),s.unsuspend){var y=s.unsuspend;s.unsuspend=null,y()}},6e4+o);0<s.imgBytes&&B1===0&&(B1=62500*g6());var g=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Ld(s,s.stylesheets),s.unsuspend)){var y=s.unsuspend;s.unsuspend=null,y()}},(s.imgBytes>B1?50:800)+o);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(d),clearTimeout(g)}}:null}function Md(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ld(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Pd=null;function Ld(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Pd=new Map,o.forEach(L6,s),Pd=null,Md.call(s))}function L6(s,o){if(!(o.state.loading&4)){var c=Pd.get(s);if(c)var d=c.get(null);else{c=new Map,Pd.set(s,c);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var C=g[y];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(c.set(C.dataset.precedence,C),d=C)}d&&c.set(null,d)}g=o.instance,C=g.getAttribute("data-precedence"),y=c.get(C)||d,y===d&&c.set(null,g),c.set(C,g),this.count++,d=Md.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),y?y.parentNode.insertBefore(g,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),o.state.loading|=4}}var Uf={$$typeof:D,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function V6(s,o,c,d,g,y,C,U,re){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Da(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Da(0),this.hiddenUpdates=Da(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function Sw(s,o,c,d,g,y,C,U,re,pe,Ce,Ie){return s=new V6(s,o,c,C,re,pe,Ce,Ie,U),o=1,y===!0&&(o|=24),y=va(3,null,null,o),s.current=y,y.stateNode=s,o=vg(),o.refCount++,s.pooledCache=o,o.refCount++,y.memoizedState={element:d,isDehydrated:c,cache:o},Tg(y),s}function Aw(s){return s?(s=bc,s):bc}function bw(s,o,c,d,g,y){g=Aw(g),d.context===null?d.context=g:d.pendingContext=g,d=oo(o),d.payload={element:c},y=y===void 0?null:y,y!==null&&(d.callback=y),c=lo(s,d,o),c!==null&&(ia(c,s,o),yf(c,s,o))}function Nw(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<o?c:o}}function j1(s,o){Nw(s,o),(s=s.alternate)&&Nw(s,o)}function Cw(s){if(s.tag===13||s.tag===31){var o=pl(s,67108864);o!==null&&ia(o,s,67108864),j1(s,67108864)}}function kw(s){if(s.tag===13||s.tag===31){var o=wa();o=ii(o);var c=pl(s,o);c!==null&&ia(c,s,o),j1(s,o)}}var Vd=!0;function B6(s,o,c,d){var g=ne.T;ne.T=null;var y=ae.p;try{ae.p=2,U1(s,o,c,d)}finally{ae.p=y,ne.T=g}}function j6(s,o,c,d){var g=ne.T;ne.T=null;var y=ae.p;try{ae.p=8,U1(s,o,c,d)}finally{ae.p=y,ne.T=g}}function U1(s,o,c,d){if(Vd){var g=z1(d);if(g===null)N1(s,o,d,Bd,c),Dw(s,d);else if(z6(g,s,o,c,d))d.stopPropagation();else if(Dw(s,d),o&4&&-1<U6.indexOf(s)){for(;g!==null;){var y=Ke(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var C=qn(y.pendingLanes);if(C!==0){var U=y;for(U.pendingLanes|=2,U.entangledLanes|=2;C;){var re=1<<31-wr(C);U.entanglements[1]|=re,C&=~re}Ls(y),(qt&6)===0&&(Ed=ft()+500,Mf(0))}}break;case 31:case 13:U=pl(y,2),U!==null&&ia(U,y,2),wd(),j1(y,2)}if(y=z1(d),y===null&&N1(s,o,d,Bd,c),y===g)break;g=y}g!==null&&d.stopPropagation()}else N1(s,o,d,null,c)}}function z1(s){return s=Ia(s),H1(s)}var Bd=null;function H1(s){if(Bd=null,s=He(s),s!==null){var o=i(s);if(o===null)s=null;else{var c=o.tag;if(c===13){if(s=l(o),s!==null)return s;s=null}else if(c===31){if(s=u(o),s!==null)return s;s=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Bd=s,null}function Rw(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lr()){case en:return 2;case ha:return 8;case yr:case Zn:return 32;case vt:return 268435456;default:return 32}default:return 32}}var G1=!1,_o=null,Eo=null,To=null,zf=new Map,Hf=new Map,wo=[],U6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dw(s,o){switch(s){case"focusin":case"focusout":_o=null;break;case"dragenter":case"dragleave":Eo=null;break;case"mouseover":case"mouseout":To=null;break;case"pointerover":case"pointerout":zf.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hf.delete(o.pointerId)}}function Gf(s,o,c,d,g,y){return s===null||s.nativeEvent!==y?(s={blockedOn:o,domEventName:c,eventSystemFlags:d,nativeEvent:y,targetContainers:[g]},o!==null&&(o=Ke(o),o!==null&&Cw(o)),s):(s.eventSystemFlags|=d,o=s.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),s)}function z6(s,o,c,d,g){switch(o){case"focusin":return _o=Gf(_o,s,o,c,d,g),!0;case"dragenter":return Eo=Gf(Eo,s,o,c,d,g),!0;case"mouseover":return To=Gf(To,s,o,c,d,g),!0;case"pointerover":var y=g.pointerId;return zf.set(y,Gf(zf.get(y)||null,s,o,c,d,g)),!0;case"gotpointercapture":return y=g.pointerId,Hf.set(y,Gf(Hf.get(y)||null,s,o,c,d,g)),!0}return!1}function Iw(s){var o=He(s.target);if(o!==null){var c=i(o);if(c!==null){if(o=c.tag,o===13){if(o=l(c),o!==null){s.blockedOn=o,K(s.priority,function(){kw(c)});return}}else if(o===31){if(o=u(c),o!==null){s.blockedOn=o,K(s.priority,function(){kw(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function jd(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var c=z1(s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);rf=d,c.target.dispatchEvent(d),rf=null}else return o=Ke(c),o!==null&&Cw(o),s.blockedOn=c,!1;o.shift()}return!0}function Fw(s,o,c){jd(s)&&c.delete(o)}function H6(){G1=!1,_o!==null&&jd(_o)&&(_o=null),Eo!==null&&jd(Eo)&&(Eo=null),To!==null&&jd(To)&&(To=null),zf.forEach(Fw),Hf.forEach(Fw)}function Ud(s,o){s.blockedOn===o&&(s.blockedOn=null,G1||(G1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,H6)))}var zd=null;function Ow(s){zd!==s&&(zd=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){zd===s&&(zd=null);for(var o=0;o<s.length;o+=3){var c=s[o],d=s[o+1],g=s[o+2];if(typeof d!="function"){if(H1(d||c)===null)continue;break}var y=Ke(c);y!==null&&(s.splice(o,3),o-=3,zg(y,{pending:!0,data:g,method:c.method,action:d},d,g))}}))}function Yc(s){function o(re){return Ud(re,s)}_o!==null&&Ud(_o,s),Eo!==null&&Ud(Eo,s),To!==null&&Ud(To,s),zf.forEach(o),Hf.forEach(o);for(var c=0;c<wo.length;c++){var d=wo[c];d.blockedOn===s&&(d.blockedOn=null)}for(;0<wo.length&&(c=wo[0],c.blockedOn===null);)Iw(c),c.blockedOn===null&&wo.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var g=c[d],y=c[d+1],C=g[X]||null;if(typeof y=="function")C||Ow(c);else if(C){var U=null;if(y&&y.hasAttribute("formAction")){if(g=y,C=y[X]||null)U=C.formAction;else if(H1(g)!==null)continue}else U=C.action;typeof U=="function"?c[d+1]=U:(c.splice(d,3),d-=3),Ow(c)}}}function Mw(){function s(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(C){return g=C})},focusReset:"manual",scroll:"manual"})}function o(){g!==null&&(g(),g=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,g=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),g!==null&&(g(),g=null)}}}function q1(s){this._internalRoot=s}Hd.prototype.render=q1.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));var c=o.current,d=wa();bw(c,d,s,o,null,null)},Hd.prototype.unmount=q1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;bw(s.current,2,null,s,null,null),wd(),o[Z]=null}};function Hd(s){this._internalRoot=s}Hd.prototype.unstable_scheduleHydration=function(s){if(s){var o=L();s={blockedOn:null,target:s,priority:o};for(var c=0;c<wo.length&&o!==0&&o<wo[c].priority;c++);wo.splice(c,0,s),c===0&&Iw(s)}};var Pw=e.version;if(Pw!=="19.2.0")throw Error(n(527,Pw,"19.2.0"));ae.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=h(o),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var G6={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gd.isDisabled&&Gd.supportsFiber)try{Ht=Gd.inject(G6),hr=Gd}catch{}}return Wf.createRoot=function(s,o){if(!a(s))throw Error(n(299));var c=!1,d="",g=HE,y=GE,C=qE;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(C=o.onRecoverableError)),o=Sw(s,1,!1,null,null,c,d,null,g,y,C,Mw),s[Z]=o.current,b1(s),new q1(o)},Wf.hydrateRoot=function(s,o,c){if(!a(s))throw Error(n(299));var d=!1,g="",y=HE,C=GE,U=qE,re=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(y=c.onUncaughtError),c.onCaughtError!==void 0&&(C=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.formState!==void 0&&(re=c.formState)),o=Sw(s,1,!0,o,c??null,d,g,re,y,C,U,Mw),o.context=Aw(null),c=o.current,d=wa(),d=ii(d),g=oo(d),g.callback=null,lo(c,g,d),c=d,o.current.lanes=c,ni(o,c),Ls(o),s[Z]=o.current,b1(s),new Hd(o)},Wf.version="19.2.0",Wf}var Ww;function r5(){if(Ww)return $1.exports;Ww=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),$1.exports=t5(),$1.exports}var n5=r5();const Kv=xe.createContext({});function Yv(t){const e=xe.useRef(null);return e.current===null&&(e.current=t()),e.current}const Qv=typeof window<"u",q4=Qv?xe.useLayoutEffect:xe.useEffect,Tp=xe.createContext(null);function Jv(t,e){t.indexOf(e)===-1&&t.push(e)}function Zv(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const Oi=(t,e,r)=>r>e?e:r<t?t:r;let ey=()=>{};const Mi={},W4=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function X4(t){return typeof t=="object"&&t!==null}const $4=t=>/^0[^.\s]+$/u.test(t);function ty(t){let e;return()=>(e===void 0&&(e=t()),e)}const Za=t=>t,a5=(t,e)=>r=>e(t(r)),n0=(...t)=>t.reduce(a5),Sh=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class ry{constructor(){this.subscriptions=[]}add(e){return Jv(this.subscriptions,e),()=>Zv(this.subscriptions,e)}notify(e,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](e,r,n);else for(let i=0;i<a;i++){const l=this.subscriptions[i];l&&l(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Hs=t=>t*1e3,Ja=t=>t/1e3;function K4(t,e){return e?t*(1e3/e):0}const Y4=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,s5=1e-7,i5=12;function o5(t,e,r,n,a){let i,l,u=0;do l=e+(r-e)/2,i=Y4(l,n,a)-t,i>0?r=l:e=l;while(Math.abs(i)>s5&&++u<i5);return l}function a0(t,e,r,n){if(t===e&&r===n)return Za;const a=i=>o5(i,0,1,t,r);return i=>i===0||i===1?i:Y4(a(i),e,n)}const Q4=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,J4=t=>e=>1-t(1-e),Z4=a0(.33,1.53,.69,.99),ny=J4(Z4),eN=Q4(ny),tN=t=>(t*=2)<1?.5*ny(t):.5*(2-Math.pow(2,-10*(t-1))),ay=t=>1-Math.sin(Math.acos(t)),rN=J4(ay),nN=Q4(ay),l5=a0(.42,0,1,1),c5=a0(0,0,.58,1),aN=a0(.42,0,.58,1),u5=t=>Array.isArray(t)&&typeof t[0]!="number",sN=t=>Array.isArray(t)&&typeof t[0]=="number",f5={linear:Za,easeIn:l5,easeInOut:aN,easeOut:c5,circIn:ay,circInOut:nN,circOut:rN,backIn:ny,backInOut:eN,backOut:Z4,anticipate:tN},h5=t=>typeof t=="string",Xw=t=>{if(sN(t)){ey(t.length===4);const[e,r,n,a]=t;return a0(e,r,n,a)}else if(h5(t))return f5[t];return t},qd=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function d5(t,e){let r=new Set,n=new Set,a=!1,i=!1;const l=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function f(m){l.has(m)&&(h.schedule(m),t()),m(u)}const h={schedule:(m,x=!1,v=!1)=>{const w=v&&a?r:n;return x&&l.add(m),w.has(m)||w.add(m),m},cancel:m=>{n.delete(m),l.delete(m)},process:m=>{if(u=m,a){i=!0;return}a=!0,[r,n]=[n,r],r.forEach(f),r.clear(),a=!1,i&&(i=!1,h.process(m))}};return h}const m5=40;function iN(t,e){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,l=qd.reduce((D,q)=>(D[q]=d5(i),D),{}),{setup:u,read:f,resolveKeyframes:h,preUpdate:m,update:x,preRender:v,render:E,postRender:w}=l,T=()=>{const D=Mi.useManualTiming?a.timestamp:performance.now();r=!1,Mi.useManualTiming||(a.delta=n?1e3/60:Math.max(Math.min(D-a.timestamp,m5),1)),a.timestamp=D,a.isProcessing=!0,u.process(a),f.process(a),h.process(a),m.process(a),x.process(a),v.process(a),E.process(a),w.process(a),a.isProcessing=!1,r&&e&&(n=!1,t(T))},A=()=>{r=!0,n=!0,a.isProcessing||t(T)};return{schedule:qd.reduce((D,q)=>{const Y=l[q];return D[q]=(W,N=!1,b=!1)=>(r||A(),Y.schedule(W,N,b)),D},{}),cancel:D=>{for(let q=0;q<qd.length;q++)l[qd[q]].cancel(D)},state:a,steps:l}}const{schedule:Tr,cancel:Bo,state:Tn,steps:J1}=iN(typeof requestAnimationFrame<"u"?requestAnimationFrame:Za,!0);let mm;function p5(){mm=void 0}const ca={now:()=>(mm===void 0&&ca.set(Tn.isProcessing||Mi.useManualTiming?Tn.timestamp:performance.now()),mm),set:t=>{mm=t,queueMicrotask(p5)}},oN=t=>e=>typeof e=="string"&&e.startsWith(t),sy=oN("--"),g5=oN("var(--"),iy=t=>g5(t)?x5.test(t.split("/*")[0].trim()):!1,x5=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Fu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ah={...Fu,transform:t=>Oi(0,1,t)},Wd={...Fu,default:1},nh=t=>Math.round(t*1e5)/1e5,oy=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function v5(t){return t==null}const y5=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ly=(t,e)=>r=>!!(typeof r=="string"&&y5.test(r)&&r.startsWith(t)||e&&!v5(r)&&Object.prototype.hasOwnProperty.call(r,e)),lN=(t,e,r)=>n=>{if(typeof n!="string")return n;const[a,i,l,u]=n.match(oy);return{[t]:parseFloat(a),[e]:parseFloat(i),[r]:parseFloat(l),alpha:u!==void 0?parseFloat(u):1}},_5=t=>Oi(0,255,t),Z1={...Fu,transform:t=>Math.round(_5(t))},Il={test:ly("rgb","red"),parse:lN("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+Z1.transform(t)+", "+Z1.transform(e)+", "+Z1.transform(r)+", "+nh(Ah.transform(n))+")"};function E5(t){let e="",r="",n="",a="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),a=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),a=t.substring(4,5),e+=e,r+=r,n+=n,a+=a),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const Ux={test:ly("#"),parse:E5,transform:Il.transform},s0=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),No=s0("deg"),Gs=s0("%"),ht=s0("px"),T5=s0("vh"),w5=s0("vw"),$w={...Gs,parse:t=>Gs.parse(t)/100,transform:t=>Gs.transform(t*100)},su={test:ly("hsl","hue"),parse:lN("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+Gs.transform(nh(e))+", "+Gs.transform(nh(r))+", "+nh(Ah.transform(n))+")"},Jr={test:t=>Il.test(t)||Ux.test(t)||su.test(t),parse:t=>Il.test(t)?Il.parse(t):su.test(t)?su.parse(t):Ux.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Il.transform(t):su.transform(t),getAnimatableNone:t=>{const e=Jr.parse(t);return e.alpha=0,Jr.transform(e)}},S5=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function A5(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(oy))==null?void 0:e.length)||0)+(((r=t.match(S5))==null?void 0:r.length)||0)>0}const cN="number",uN="color",b5="var",N5="var(",Kw="${}",C5=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function bh(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},a=[];let i=0;const u=e.replace(C5,f=>(Jr.test(f)?(n.color.push(i),a.push(uN),r.push(Jr.parse(f))):f.startsWith(N5)?(n.var.push(i),a.push(b5),r.push(f)):(n.number.push(i),a.push(cN),r.push(parseFloat(f))),++i,Kw)).split(Kw);return{values:r,split:u,indexes:n,types:a}}function fN(t){return bh(t).values}function hN(t){const{split:e,types:r}=bh(t),n=e.length;return a=>{let i="";for(let l=0;l<n;l++)if(i+=e[l],a[l]!==void 0){const u=r[l];u===cN?i+=nh(a[l]):u===uN?i+=Jr.transform(a[l]):i+=a[l]}return i}}const k5=t=>typeof t=="number"?0:Jr.test(t)?Jr.getAnimatableNone(t):t;function R5(t){const e=fN(t);return hN(t)(e.map(k5))}const jo={test:A5,parse:fN,createTransformer:hN,getAnimatableNone:R5};function ex(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function D5({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let a=0,i=0,l=0;if(!e)a=i=l=r;else{const u=r<.5?r*(1+e):r+e-r*e,f=2*r-u;a=ex(f,u,t+1/3),i=ex(f,u,t),l=ex(f,u,t-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(l*255),alpha:n}}function Rm(t,e){return r=>r>0?e:t}const Ar=(t,e,r)=>t+(e-t)*r,tx=(t,e,r)=>{const n=t*t,a=r*(e*e-n)+n;return a<0?0:Math.sqrt(a)},I5=[Ux,Il,su],F5=t=>I5.find(e=>e.test(t));function Yw(t){const e=F5(t);if(!e)return!1;let r=e.parse(t);return e===su&&(r=D5(r)),r}const Qw=(t,e)=>{const r=Yw(t),n=Yw(e);if(!r||!n)return Rm(t,e);const a={...r};return i=>(a.red=tx(r.red,n.red,i),a.green=tx(r.green,n.green,i),a.blue=tx(r.blue,n.blue,i),a.alpha=Ar(r.alpha,n.alpha,i),Il.transform(a))},zx=new Set(["none","hidden"]);function O5(t,e){return zx.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function M5(t,e){return r=>Ar(t,e,r)}function cy(t){return typeof t=="number"?M5:typeof t=="string"?iy(t)?Rm:Jr.test(t)?Qw:V5:Array.isArray(t)?dN:typeof t=="object"?Jr.test(t)?Qw:P5:Rm}function dN(t,e){const r=[...t],n=r.length,a=t.map((i,l)=>cy(i)(i,e[l]));return i=>{for(let l=0;l<n;l++)r[l]=a[l](i);return r}}function P5(t,e){const r={...t,...e},n={};for(const a in r)t[a]!==void 0&&e[a]!==void 0&&(n[a]=cy(t[a])(t[a],e[a]));return a=>{for(const i in n)r[i]=n[i](a);return r}}function L5(t,e){const r=[],n={color:0,var:0,number:0};for(let a=0;a<e.values.length;a++){const i=e.types[a],l=t.indexes[i][n[i]],u=t.values[l]??0;r[a]=u,n[i]++}return r}const V5=(t,e)=>{const r=jo.createTransformer(e),n=bh(t),a=bh(e);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?zx.has(t)&&!a.values.length||zx.has(e)&&!n.values.length?O5(t,e):n0(dN(L5(n,a),a.values),r):Rm(t,e)};function mN(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?Ar(t,e,r):cy(t)(t,e)}const B5=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>Tr.update(e,r),stop:()=>Bo(e),now:()=>Tn.isProcessing?Tn.timestamp:ca.now()}},pN=(t,e,r=10)=>{let n="";const a=Math.max(Math.round(e/r),2);for(let i=0;i<a;i++)n+=Math.round(t(i/(a-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Dm=2e4;function uy(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<Dm;)e+=r,n=t.next(e);return e>=Dm?1/0:e}function j5(t,e=100,r){const n=r({...t,keyframes:[0,e]}),a=Math.min(uy(n),Dm);return{type:"keyframes",ease:i=>n.next(a*i).value/e,duration:Ja(a)}}const U5=5;function gN(t,e,r){const n=Math.max(e-U5,0);return K4(r-t(n),e-n)}const Ir={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},rx=.001;function z5({duration:t=Ir.duration,bounce:e=Ir.bounce,velocity:r=Ir.velocity,mass:n=Ir.mass}){let a,i,l=1-e;l=Oi(Ir.minDamping,Ir.maxDamping,l),t=Oi(Ir.minDuration,Ir.maxDuration,Ja(t)),l<1?(a=h=>{const m=h*l,x=m*t,v=m-r,E=Hx(h,l),w=Math.exp(-x);return rx-v/E*w},i=h=>{const x=h*l*t,v=x*r+r,E=Math.pow(l,2)*Math.pow(h,2)*t,w=Math.exp(-x),T=Hx(Math.pow(h,2),l);return(-a(h)+rx>0?-1:1)*((v-E)*w)/T}):(a=h=>{const m=Math.exp(-h*t),x=(h-r)*t+1;return-rx+m*x},i=h=>{const m=Math.exp(-h*t),x=(r-h)*(t*t);return m*x});const u=5/t,f=G5(a,i,u);if(t=Hs(t),isNaN(f))return{stiffness:Ir.stiffness,damping:Ir.damping,duration:t};{const h=Math.pow(f,2)*n;return{stiffness:h,damping:l*2*Math.sqrt(n*h),duration:t}}}const H5=12;function G5(t,e,r){let n=r;for(let a=1;a<H5;a++)n=n-t(n)/e(n);return n}function Hx(t,e){return t*Math.sqrt(1-e*e)}const q5=["duration","bounce"],W5=["stiffness","damping","mass"];function Jw(t,e){return e.some(r=>t[r]!==void 0)}function X5(t){let e={velocity:Ir.velocity,stiffness:Ir.stiffness,damping:Ir.damping,mass:Ir.mass,isResolvedFromDuration:!1,...t};if(!Jw(t,W5)&&Jw(t,q5))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),a=n*n,i=2*Oi(.05,1,1-(t.bounce||0))*Math.sqrt(a);e={...e,mass:Ir.mass,stiffness:a,damping:i}}else{const r=z5(t);e={...e,...r,mass:Ir.mass},e.isResolvedFromDuration=!0}return e}function Im(t=Ir.visualDuration,e=Ir.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:a}=r;const i=r.keyframes[0],l=r.keyframes[r.keyframes.length-1],u={done:!1,value:i},{stiffness:f,damping:h,mass:m,duration:x,velocity:v,isResolvedFromDuration:E}=X5({...r,velocity:-Ja(r.velocity||0)}),w=v||0,T=h/(2*Math.sqrt(f*m)),A=l-i,I=Ja(Math.sqrt(f/m)),O=Math.abs(A)<5;n||(n=O?Ir.restSpeed.granular:Ir.restSpeed.default),a||(a=O?Ir.restDelta.granular:Ir.restDelta.default);let D;if(T<1){const Y=Hx(I,T);D=W=>{const N=Math.exp(-T*I*W);return l-N*((w+T*I*A)/Y*Math.sin(Y*W)+A*Math.cos(Y*W))}}else if(T===1)D=Y=>l-Math.exp(-I*Y)*(A+(w+I*A)*Y);else{const Y=I*Math.sqrt(T*T-1);D=W=>{const N=Math.exp(-T*I*W),b=Math.min(Y*W,300);return l-N*((w+T*I*A)*Math.sinh(b)+Y*A*Math.cosh(b))/Y}}const q={calculatedDuration:E&&x||null,next:Y=>{const W=D(Y);if(E)u.done=Y>=x;else{let N=Y===0?w:0;T<1&&(N=Y===0?Hs(w):gN(D,Y,W));const b=Math.abs(N)<=n,k=Math.abs(l-W)<=a;u.done=b&&k}return u.value=u.done?l:W,u},toString:()=>{const Y=Math.min(uy(q),Dm),W=pN(N=>q.next(Y*N).value,Y,30);return Y+"ms "+W},toTransition:()=>{}};return q}Im.applyToOptions=t=>{const e=j5(t,100,Im);return t.ease=e.ease,t.duration=Hs(e.duration),t.type="keyframes",t};function Gx({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:l,min:u,max:f,restDelta:h=.5,restSpeed:m}){const x=t[0],v={done:!1,value:x},E=b=>u!==void 0&&b<u||f!==void 0&&b>f,w=b=>u===void 0?f:f===void 0||Math.abs(u-b)<Math.abs(f-b)?u:f;let T=r*e;const A=x+T,I=l===void 0?A:l(A);I!==A&&(T=I-x);const O=b=>-T*Math.exp(-b/n),D=b=>I+O(b),q=b=>{const k=O(b),F=D(b);v.done=Math.abs(k)<=h,v.value=v.done?I:F};let Y,W;const N=b=>{E(v.value)&&(Y=b,W=Im({keyframes:[v.value,w(v.value)],velocity:gN(D,b,v.value),damping:a,stiffness:i,restDelta:h,restSpeed:m}))};return N(0),{calculatedDuration:null,next:b=>{let k=!1;return!W&&Y===void 0&&(k=!0,q(b),N(b)),Y!==void 0&&b>=Y?W.next(b-Y):(!k&&q(b),v)}}}function $5(t,e,r){const n=[],a=r||Mi.mix||mN,i=t.length-1;for(let l=0;l<i;l++){let u=a(t[l],t[l+1]);if(e){const f=Array.isArray(e)?e[l]||Za:e;u=n0(f,u)}n.push(u)}return n}function K5(t,e,{clamp:r=!0,ease:n,mixer:a}={}){const i=t.length;if(ey(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const l=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const u=$5(e,n,a),f=u.length,h=m=>{if(l&&m<t[0])return e[0];let x=0;if(f>1)for(;x<t.length-2&&!(m<t[x+1]);x++);const v=Sh(t[x],t[x+1],m);return u[x](v)};return r?m=>h(Oi(t[0],t[i-1],m)):h}function Y5(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const a=Sh(0,e,n);t.push(Ar(r,1,a))}}function Q5(t){const e=[0];return Y5(e,t.length-1),e}function J5(t,e){return t.map(r=>r*e)}function Z5(t,e){return t.map(()=>e||aN).splice(0,t.length-1)}function ah({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const a=u5(n)?n.map(Xw):Xw(n),i={done:!1,value:e[0]},l=J5(r&&r.length===e.length?r:Q5(e),t),u=K5(l,e,{ease:Array.isArray(a)?a:Z5(e,a)});return{calculatedDuration:t,next:f=>(i.value=u(f),i.done=f>=t,i)}}const eF=t=>t!==null;function fy(t,{repeat:e,repeatType:r="loop"},n,a=1){const i=t.filter(eF),u=a<0||e&&r!=="loop"&&e%2===1?0:i.length-1;return!u||n===void 0?i[u]:n}const tF={decay:Gx,inertia:Gx,tween:ah,keyframes:ah,spring:Im};function xN(t){typeof t.type=="string"&&(t.type=tF[t.type])}class hy{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const rF=t=>t/100;class dy extends hy{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,a;const{motionValue:r}=this.options;r&&r.updatedAt!==ca.now()&&this.tick(ca.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(a=(n=this.options).onStop)==null||a.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;xN(e);const{type:r=ah,repeat:n=0,repeatDelay:a=0,repeatType:i,velocity:l=0}=e;let{keyframes:u}=e;const f=r||ah;f!==ah&&typeof u[0]!="number"&&(this.mixKeyframes=n0(rF,mN(u[0],u[1])),u=[0,100]);const h=f({...e,keyframes:u});i==="mirror"&&(this.mirroredGenerator=f({...e,keyframes:[...u].reverse(),velocity:-l})),h.calculatedDuration===null&&(h.calculatedDuration=uy(h));const{calculatedDuration:m}=h;this.calculatedDuration=m,this.resolvedDuration=m+a,this.totalDuration=this.resolvedDuration*(n+1)-a,this.generator=h}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:a,mixKeyframes:i,mirroredGenerator:l,resolvedDuration:u,calculatedDuration:f}=this;if(this.startTime===null)return n.next(0);const{delay:h=0,keyframes:m,repeat:x,repeatType:v,repeatDelay:E,type:w,onUpdate:T,finalKeyframe:A}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-a/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const I=this.currentTime-h*(this.playbackSpeed>=0?1:-1),O=this.playbackSpeed>=0?I<0:I>a;this.currentTime=Math.max(I,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let D=this.currentTime,q=n;if(x){const b=Math.min(this.currentTime,a)/u;let k=Math.floor(b),F=b%1;!F&&b>=1&&(F=1),F===1&&k--,k=Math.min(k,x+1),!!(k%2)&&(v==="reverse"?(F=1-F,E&&(F-=E/u)):v==="mirror"&&(q=l)),D=Oi(0,1,F)*u}const Y=O?{done:!1,value:m[0]}:q.next(D);i&&(Y.value=i(Y.value));let{done:W}=Y;!O&&f!==null&&(W=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const N=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return N&&w!==Gx&&(Y.value=fy(m,this.options,A,this.speed)),T&&T(Y.value),N&&this.finish(),Y}then(e,r){return this.finished.then(e,r)}get duration(){return Ja(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ja(e)}get time(){return Ja(this.currentTime)}set time(e){var r;e=Hs(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ca.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Ja(this.currentTime))}play(){var a,i;if(this.isStopped)return;const{driver:e=B5,startTime:r}=this.options;this.driver||(this.driver=e(l=>this.tick(l))),(i=(a=this.options).onPlay)==null||i.call(a);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ca.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function nF(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Fl=t=>t*180/Math.PI,qx=t=>{const e=Fl(Math.atan2(t[1],t[0]));return Wx(e)},aF={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:qx,rotateZ:qx,skewX:t=>Fl(Math.atan(t[1])),skewY:t=>Fl(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Wx=t=>(t=t%360,t<0&&(t+=360),t),Zw=qx,eS=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),tS=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),sF={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:eS,scaleY:tS,scale:t=>(eS(t)+tS(t))/2,rotateX:t=>Wx(Fl(Math.atan2(t[6],t[5]))),rotateY:t=>Wx(Fl(Math.atan2(-t[2],t[0]))),rotateZ:Zw,rotate:Zw,skewX:t=>Fl(Math.atan(t[4])),skewY:t=>Fl(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Xx(t){return t.includes("scale")?1:0}function $x(t,e){if(!t||t==="none")return Xx(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,a;if(r)n=sF,a=r;else{const u=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=aF,a=u}if(!a)return Xx(e);const i=n[e],l=a[1].split(",").map(oF);return typeof i=="function"?i(l):l[i]}const iF=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return $x(r,e)};function oF(t){return parseFloat(t.trim())}const Ou=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Mu=new Set(Ou),rS=t=>t===Fu||t===ht,lF=new Set(["x","y","z"]),cF=Ou.filter(t=>!lF.has(t));function uF(t){const e=[];return cF.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const Ll={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>$x(e,"x"),y:(t,{transform:e})=>$x(e,"y")};Ll.translateX=Ll.x;Ll.translateY=Ll.y;const Vl=new Set;let Kx=!1,Yx=!1,Qx=!1;function vN(){if(Yx){const t=Array.from(Vl).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const a=uF(n);a.length&&(r.set(n,a),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const a=r.get(n);a&&a.forEach(([i,l])=>{var u;(u=n.getValue(i))==null||u.set(l)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Yx=!1,Kx=!1,Vl.forEach(t=>t.complete(Qx)),Vl.clear()}function yN(){Vl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Yx=!0)})}function fF(){Qx=!0,yN(),vN(),Qx=!1}class my{constructor(e,r,n,a,i,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=a,this.element=i,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(Vl.add(this),Kx||(Kx=!0,Tr.read(yN),Tr.resolveKeyframes(vN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:a}=this;if(e[0]===null){const i=a==null?void 0:a.get(),l=e[e.length-1];if(i!==void 0)e[0]=i;else if(n&&r){const u=n.readValue(r,l);u!=null&&(e[0]=u)}e[0]===void 0&&(e[0]=l),a&&i===void 0&&a.set(e[0])}nF(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Vl.delete(this)}cancel(){this.state==="scheduled"&&(Vl.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const hF=t=>t.startsWith("--");function dF(t,e,r){hF(e)?t.style.setProperty(e,r):t.style[e]=r}const mF=ty(()=>window.ScrollTimeline!==void 0),pF={};function gF(t,e){const r=ty(t);return()=>pF[e]??r()}const _N=gF(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Kf=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,nS={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Kf([0,.65,.55,1]),circOut:Kf([.55,0,1,.45]),backIn:Kf([.31,.01,.66,-.59]),backOut:Kf([.33,1.53,.69,.99])};function EN(t,e){if(t)return typeof t=="function"?_N()?pN(t,e):"ease-out":sN(t)?Kf(t):Array.isArray(t)?t.map(r=>EN(r,e)||nS.easeOut):nS[t]}function xF(t,e,r,{delay:n=0,duration:a=300,repeat:i=0,repeatType:l="loop",ease:u="easeOut",times:f}={},h=void 0){const m={[e]:r};f&&(m.offset=f);const x=EN(u,a);Array.isArray(x)&&(m.easing=x);const v={delay:n,duration:a,easing:Array.isArray(x)?"linear":x,fill:"both",iterations:i+1,direction:l==="reverse"?"alternate":"normal"};return h&&(v.pseudoElement=h),t.animate(m,v)}function TN(t){return typeof t=="function"&&"applyToOptions"in t}function vF({type:t,...e}){return TN(t)&&_N()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class yF extends hy{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:a,pseudoElement:i,allowFlatten:l=!1,finalKeyframe:u,onComplete:f}=e;this.isPseudoElement=!!i,this.allowFlatten=l,this.options=e,ey(typeof e.type!="string");const h=vF(e);this.animation=xF(r,n,a,h,i),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const m=fy(a,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(m):dF(r,n,m),this.animation.cancel()}f==null||f(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Ja(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Ja(e)}get time(){return Ja(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Hs(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&mF()?(this.animation.timeline=e,Za):r(this)}}const wN={anticipate:tN,backInOut:eN,circInOut:nN};function _F(t){return t in wN}function EF(t){typeof t.ease=="string"&&_F(t.ease)&&(t.ease=wN[t.ease])}const aS=10;class TF extends yF{constructor(e){EF(e),xN(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:a,element:i,...l}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const u=new dy({...l,autoplay:!1}),f=Hs(this.finishedTime??this.time);r.setWithVelocity(u.sample(f-aS).value,u.sample(f).value,aS),u.stop()}}const sS=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(jo.test(t)||t==="0")&&!t.startsWith("url("));function wF(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function SF(t,e,r,n){const a=t[0];if(a===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],l=sS(a,e),u=sS(i,e);return!l||!u?!1:wF(t)||(r==="spring"||TN(r))&&n}function Jx(t){t.duration=0,t.type="keyframes"}const AF=new Set(["opacity","clipPath","filter","transform"]),bF=ty(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function NF(t){var m;const{motionValue:e,name:r,repeatDelay:n,repeatType:a,damping:i,type:l}=t;if(!(((m=e==null?void 0:e.owner)==null?void 0:m.current)instanceof HTMLElement))return!1;const{onUpdate:f,transformTemplate:h}=e.owner.getProps();return bF()&&r&&AF.has(r)&&(r!=="transform"||!h)&&!f&&!n&&a!=="mirror"&&i!==0&&l!=="inertia"}const CF=40;class kF extends hy{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:a=0,repeatDelay:i=0,repeatType:l="loop",keyframes:u,name:f,motionValue:h,element:m,...x}){var w;super(),this.stop=()=>{var T,A;this._animation&&(this._animation.stop(),(T=this.stopTimeline)==null||T.call(this)),(A=this.keyframeResolver)==null||A.cancel()},this.createdAt=ca.now();const v={autoplay:e,delay:r,type:n,repeat:a,repeatDelay:i,repeatType:l,name:f,motionValue:h,element:m,...x},E=(m==null?void 0:m.KeyframeResolver)||my;this.keyframeResolver=new E(u,(T,A,I)=>this.onKeyframesResolved(T,A,v,!I),f,h,m),(w=this.keyframeResolver)==null||w.scheduleResolve()}onKeyframesResolved(e,r,n,a){this.keyframeResolver=void 0;const{name:i,type:l,velocity:u,delay:f,isHandoff:h,onUpdate:m}=n;this.resolvedAt=ca.now(),SF(e,i,l,u)||((Mi.instantAnimations||!f)&&(m==null||m(fy(e,n,r))),e[0]=e[e.length-1],Jx(n),n.repeat=0);const v={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>CF?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},E=!h&&NF(v)?new TF({...v,element:v.motionValue.owner.current}):new dy(v);E.finished.then(()=>this.notifyFinished()).catch(Za),this.pendingTimeline&&(this.stopTimeline=E.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=E}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),fF()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const RF=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function DF(t){const e=RF.exec(t);if(!e)return[,];const[,r,n,a]=e;return[`--${r??n}`,a]}function SN(t,e,r=1){const[n,a]=DF(t);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const l=i.trim();return W4(l)?parseFloat(l):l}return iy(a)?SN(a,e,r+1):a}function py(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const AN=new Set(["width","height","top","left","right","bottom",...Ou]),IF={test:t=>t==="auto",parse:t=>t},bN=t=>e=>e.test(t),NN=[Fu,ht,Gs,No,w5,T5,IF],iS=t=>NN.find(bN(t));function FF(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||$4(t):!0}const OF=new Set(["brightness","contrast","saturate","opacity"]);function MF(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(oy)||[];if(!n)return t;const a=r.replace(n,"");let i=OF.has(e)?1:0;return n!==r&&(i*=100),e+"("+i+a+")"}const PF=/\b([a-z-]*)\(.*?\)/gu,Zx={...jo,getAnimatableNone:t=>{const e=t.match(PF);return e?e.map(MF).join(" "):t}},oS={...Fu,transform:Math.round},LF={rotate:No,rotateX:No,rotateY:No,rotateZ:No,scale:Wd,scaleX:Wd,scaleY:Wd,scaleZ:Wd,skew:No,skewX:No,skewY:No,distance:ht,translateX:ht,translateY:ht,translateZ:ht,x:ht,y:ht,z:ht,perspective:ht,transformPerspective:ht,opacity:Ah,originX:$w,originY:$w,originZ:ht},gy={borderWidth:ht,borderTopWidth:ht,borderRightWidth:ht,borderBottomWidth:ht,borderLeftWidth:ht,borderRadius:ht,radius:ht,borderTopLeftRadius:ht,borderTopRightRadius:ht,borderBottomRightRadius:ht,borderBottomLeftRadius:ht,width:ht,maxWidth:ht,height:ht,maxHeight:ht,top:ht,right:ht,bottom:ht,left:ht,padding:ht,paddingTop:ht,paddingRight:ht,paddingBottom:ht,paddingLeft:ht,margin:ht,marginTop:ht,marginRight:ht,marginBottom:ht,marginLeft:ht,backgroundPositionX:ht,backgroundPositionY:ht,...LF,zIndex:oS,fillOpacity:Ah,strokeOpacity:Ah,numOctaves:oS},VF={...gy,color:Jr,backgroundColor:Jr,outlineColor:Jr,fill:Jr,stroke:Jr,borderColor:Jr,borderTopColor:Jr,borderRightColor:Jr,borderBottomColor:Jr,borderLeftColor:Jr,filter:Zx,WebkitFilter:Zx},CN=t=>VF[t];function kN(t,e){let r=CN(t);return r!==Zx&&(r=jo),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const BF=new Set(["auto","none","0"]);function jF(t,e,r){let n=0,a;for(;n<t.length&&!a;){const i=t[n];typeof i=="string"&&!BF.has(i)&&bh(i).values.length&&(a=t[n]),n++}if(a&&r)for(const i of e)t[i]=kN(r,a)}class UF extends my{constructor(e,r,n,a,i){super(e,r,n,a,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let f=0;f<e.length;f++){let h=e[f];if(typeof h=="string"&&(h=h.trim(),iy(h))){const m=SN(h,r.current);m!==void 0&&(e[f]=m),f===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!AN.has(n)||e.length!==2)return;const[a,i]=e,l=iS(a),u=iS(i);if(l!==u)if(rS(l)&&rS(u))for(let f=0;f<e.length;f++){const h=e[f];typeof h=="string"&&(e[f]=parseFloat(h))}else Ll[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let a=0;a<e.length;a++)(e[a]===null||FF(e[a]))&&n.push(a);n.length&&jF(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ll[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&e.getValue(n,a).jump(a,!1)}measureEndState(){var u;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const a=e.getValue(r);a&&a.jump(this.measuredOrigin,!1);const i=n.length-1,l=n[i];n[i]=Ll[r](e.measureViewportBox(),window.getComputedStyle(e.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),(u=this.removedTransforms)!=null&&u.length&&this.removedTransforms.forEach(([f,h])=>{e.getValue(f).set(h)}),this.resolveNoneKeyframes()}}function zF(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const a=(r==null?void 0:r[t])??n.querySelectorAll(t);return a?Array.from(a):[]}return Array.from(t)}const RN=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function DN(t){return X4(t)&&"offsetHeight"in t}const lS=30,HF=t=>!isNaN(parseFloat(t));class GF{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var i;const a=ca.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=ca.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=HF(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new ry);const n=this.events[e].add(r);return e==="change"?()=>{n(),Tr.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ca.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>lS)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,lS);return K4(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function _u(t,e){return new GF(t,e)}const{schedule:xy}=iN(queueMicrotask,!1),xs={x:!1,y:!1};function IN(){return xs.x||xs.y}function qF(t){return t==="x"||t==="y"?xs[t]?null:(xs[t]=!0,()=>{xs[t]=!1}):xs.x||xs.y?null:(xs.x=xs.y=!0,()=>{xs.x=xs.y=!1})}function FN(t,e){const r=zF(t),n=new AbortController,a={passive:!0,...e,signal:n.signal};return[r,a,()=>n.abort()]}function cS(t){return!(t.pointerType==="touch"||IN())}function WF(t,e,r={}){const[n,a,i]=FN(t,r),l=u=>{if(!cS(u))return;const{target:f}=u,h=e(f,u);if(typeof h!="function"||!f)return;const m=x=>{cS(x)&&(h(x),f.removeEventListener("pointerleave",m))};f.addEventListener("pointerleave",m,a)};return n.forEach(u=>{u.addEventListener("pointerenter",l,a)}),i}const ON=(t,e)=>e?t===e?!0:ON(t,e.parentElement):!1,vy=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,XF=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function $F(t){return XF.has(t.tagName)||t.tabIndex!==-1}const pm=new WeakSet;function uS(t){return e=>{e.key==="Enter"&&t(e)}}function nx(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const KF=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=uS(()=>{if(pm.has(r))return;nx(r,"down");const a=uS(()=>{nx(r,"up")}),i=()=>nx(r,"cancel");r.addEventListener("keyup",a,e),r.addEventListener("blur",i,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function fS(t){return vy(t)&&!IN()}function YF(t,e,r={}){const[n,a,i]=FN(t,r),l=u=>{const f=u.currentTarget;if(!fS(u))return;pm.add(f);const h=e(f,u),m=(E,w)=>{window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",v),pm.has(f)&&pm.delete(f),fS(E)&&typeof h=="function"&&h(E,{success:w})},x=E=>{m(E,f===window||f===document||r.useGlobalTarget||ON(f,E.target))},v=E=>{m(E,!1)};window.addEventListener("pointerup",x,a),window.addEventListener("pointercancel",v,a)};return n.forEach(u=>{(r.useGlobalTarget?window:u).addEventListener("pointerdown",l,a),DN(u)&&(u.addEventListener("focus",h=>KF(h,a)),!$F(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),i}function MN(t){return X4(t)&&"ownerSVGElement"in t}function QF(t){return MN(t)&&t.tagName==="svg"}const Bn=t=>!!(t&&t.getVelocity),JF=[...NN,Jr,jo],ZF=t=>JF.find(bN(t)),yy=xe.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function hS(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function eO(...t){return e=>{let r=!1;const n=t.map(a=>{const i=hS(a,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():hS(t[a],null)}}}}function tO(...t){return xe.useCallback(eO(...t),t)}class rO extends xe.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,a=DN(n)&&n.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=a-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function nO({children:t,isPresent:e,anchorX:r,root:n}){const a=xe.useId(),i=xe.useRef(null),l=xe.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=xe.useContext(yy),f=tO(i,t==null?void 0:t.ref);return xe.useInsertionEffect(()=>{const{width:h,height:m,top:x,left:v,right:E}=l.current;if(e||!i.current||!h||!m)return;const w=r==="left"?`left: ${v}`:`right: ${E}`;i.current.dataset.motionPopId=a;const T=document.createElement("style");u&&(T.nonce=u);const A=n??document.head;return A.appendChild(T),T.sheet&&T.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${m}px !important;
            ${w}px !important;
            top: ${x}px !important;
          }
        `),()=>{A.contains(T)&&A.removeChild(T)}},[e]),_.jsx(rO,{isPresent:e,childRef:i,sizeRef:l,children:xe.cloneElement(t,{ref:f})})}const aO=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:i,mode:l,anchorX:u,root:f})=>{const h=Yv(sO),m=xe.useId();let x=!0,v=xe.useMemo(()=>(x=!1,{id:m,initial:e,isPresent:r,custom:a,onExitComplete:E=>{h.set(E,!0);for(const w of h.values())if(!w)return;n&&n()},register:E=>(h.set(E,!1),()=>h.delete(E))}),[r,h,n]);return i&&x&&(v={...v}),xe.useMemo(()=>{h.forEach((E,w)=>h.set(w,!1))},[r]),xe.useEffect(()=>{!r&&!h.size&&n&&n()},[r]),l==="popLayout"&&(t=_.jsx(nO,{isPresent:r,anchorX:u,root:f,children:t})),_.jsx(Tp.Provider,{value:v,children:t})};function sO(){return new Map}function PN(t=!0){const e=xe.useContext(Tp);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:a}=e,i=xe.useId();xe.useEffect(()=>{if(t)return a(i)},[t]);const l=xe.useCallback(()=>t&&n&&n(i),[i,n,t]);return!r&&n?[!1,l]:[!0]}const Xd=t=>t.key||"";function dS(t){const e=[];return xe.Children.forEach(t,r=>{xe.isValidElement(r)&&e.push(r)}),e}const ws=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:a=!0,mode:i="sync",propagate:l=!1,anchorX:u="left",root:f})=>{const[h,m]=PN(l),x=xe.useMemo(()=>dS(t),[t]),v=l&&!h?[]:x.map(Xd),E=xe.useRef(!0),w=xe.useRef(x),T=Yv(()=>new Map),[A,I]=xe.useState(x),[O,D]=xe.useState(x);q4(()=>{E.current=!1,w.current=x;for(let W=0;W<O.length;W++){const N=Xd(O[W]);v.includes(N)?T.delete(N):T.get(N)!==!0&&T.set(N,!1)}},[O,v.length,v.join("-")]);const q=[];if(x!==A){let W=[...x];for(let N=0;N<O.length;N++){const b=O[N],k=Xd(b);v.includes(k)||(W.splice(N,0,b),q.push(b))}return i==="wait"&&q.length&&(W=q),D(dS(W)),I(x),null}const{forceRender:Y}=xe.useContext(Kv);return _.jsx(_.Fragment,{children:O.map(W=>{const N=Xd(W),b=l&&!h?!1:x===O||v.includes(N),k=()=>{if(T.has(N))T.set(N,!0);else return;let F=!0;T.forEach(P=>{P||(F=!1)}),F&&(Y==null||Y(),D(w.current),l&&(m==null||m()),n&&n())};return _.jsx(aO,{isPresent:b,initial:!E.current||r?void 0:!1,custom:e,presenceAffectsLayout:a,mode:i,root:f,onExitComplete:b?void 0:k,anchorX:u,children:W},N)})})},LN=xe.createContext({strict:!1}),mS={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Eu={};for(const t in mS)Eu[t]={isEnabled:e=>mS[t].some(r=>!!e[r])};function iO(t){for(const e in t)Eu[e]={...Eu[e],...t[e]}}const oO=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Fm(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||oO.has(t)}let VN=t=>!Fm(t);function lO(t){typeof t=="function"&&(VN=e=>e.startsWith("on")?!Fm(e):t(e))}try{lO(require("@emotion/is-prop-valid").default)}catch{}function cO(t,e,r){const n={};for(const a in t)a==="values"&&typeof t.values=="object"||(VN(a)||r===!0&&Fm(a)||!e&&!Fm(a)||t.draggable&&a.startsWith("onDrag"))&&(n[a]=t[a]);return n}const wp=xe.createContext({});function Sp(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Nh(t){return typeof t=="string"||Array.isArray(t)}const _y=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ey=["initial",..._y];function Ap(t){return Sp(t.animate)||Ey.some(e=>Nh(t[e]))}function BN(t){return!!(Ap(t)||t.variants)}function uO(t,e){if(Ap(t)){const{initial:r,animate:n}=t;return{initial:r===!1||Nh(r)?r:void 0,animate:Nh(n)?n:void 0}}return t.inherit!==!1?e:{}}function fO(t){const{initial:e,animate:r}=uO(t,xe.useContext(wp));return xe.useMemo(()=>({initial:e,animate:r}),[pS(e),pS(r)])}function pS(t){return Array.isArray(t)?t.join(" "):t}const Ch={};function hO(t){for(const e in t)Ch[e]=t[e],sy(e)&&(Ch[e].isCSSVariable=!0)}function jN(t,{layout:e,layoutId:r}){return Mu.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Ch[t]||t==="opacity")}const dO={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},mO=Ou.length;function pO(t,e,r){let n="",a=!0;for(let i=0;i<mO;i++){const l=Ou[i],u=t[l];if(u===void 0)continue;let f=!0;if(typeof u=="number"?f=u===(l.startsWith("scale")?1:0):f=parseFloat(u)===0,!f||r){const h=RN(u,gy[l]);if(!f){a=!1;const m=dO[l]||l;n+=`${m}(${h}) `}r&&(e[l]=h)}}return n=n.trim(),r?n=r(e,a?"":n):a&&(n="none"),n}function Ty(t,e,r){const{style:n,vars:a,transformOrigin:i}=t;let l=!1,u=!1;for(const f in e){const h=e[f];if(Mu.has(f)){l=!0;continue}else if(sy(f)){a[f]=h;continue}else{const m=RN(h,gy[f]);f.startsWith("origin")?(u=!0,i[f]=m):n[f]=m}}if(e.transform||(l||r?n.transform=pO(e,t.transform,r):n.transform&&(n.transform="none")),u){const{originX:f="50%",originY:h="50%",originZ:m=0}=i;n.transformOrigin=`${f} ${h} ${m}`}}const wy=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function UN(t,e,r){for(const n in e)!Bn(e[n])&&!jN(n,r)&&(t[n]=e[n])}function gO({transformTemplate:t},e){return xe.useMemo(()=>{const r=wy();return Ty(r,e,t),Object.assign({},r.vars,r.style)},[e])}function xO(t,e){const r=t.style||{},n={};return UN(n,r,t),Object.assign(n,gO(t,e)),n}function vO(t,e){const r={},n=xO(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const yO={offset:"stroke-dashoffset",array:"stroke-dasharray"},_O={offset:"strokeDashoffset",array:"strokeDasharray"};function EO(t,e,r=1,n=0,a=!0){t.pathLength=1;const i=a?yO:_O;t[i.offset]=ht.transform(-n);const l=ht.transform(e),u=ht.transform(r);t[i.array]=`${l} ${u}`}function zN(t,{attrX:e,attrY:r,attrScale:n,pathLength:a,pathSpacing:i=1,pathOffset:l=0,...u},f,h,m){if(Ty(t,u,h),f){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:x,style:v}=t;x.transform&&(v.transform=x.transform,delete x.transform),(v.transform||x.transformOrigin)&&(v.transformOrigin=x.transformOrigin??"50% 50%",delete x.transformOrigin),v.transform&&(v.transformBox=(m==null?void 0:m.transformBox)??"fill-box",delete x.transformBox),e!==void 0&&(x.x=e),r!==void 0&&(x.y=r),n!==void 0&&(x.scale=n),a!==void 0&&EO(x,a,i,l,!1)}const HN=()=>({...wy(),attrs:{}}),GN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function TO(t,e,r,n){const a=xe.useMemo(()=>{const i=HN();return zN(i,e,GN(n),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};UN(i,t.style,t),a.style={...i,...a.style}}return a}const wO=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Sy(t){return typeof t!="string"||t.includes("-")?!1:!!(wO.indexOf(t)>-1||/[A-Z]/u.test(t))}function SO(t,e,r,{latestValues:n},a,i=!1){const u=(Sy(t)?TO:vO)(e,n,a,t),f=cO(e,typeof t=="string",i),h=t!==xe.Fragment?{...f,...u,ref:r}:{},{children:m}=e,x=xe.useMemo(()=>Bn(m)?m.get():m,[m]);return xe.createElement(t,{...h,children:x})}function gS(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function Ay(t,e,r,n){if(typeof e=="function"){const[a,i]=gS(n);e=e(r!==void 0?r:t.custom,a,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[a,i]=gS(n);e=e(r!==void 0?r:t.custom,a,i)}return e}function gm(t){return Bn(t)?t.get():t}function AO({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,a){return{latestValues:bO(r,n,a,t),renderState:e()}}function bO(t,e,r,n){const a={},i=n(t,{});for(const v in i)a[v]=gm(i[v]);let{initial:l,animate:u}=t;const f=Ap(t),h=BN(t);e&&h&&!f&&t.inherit!==!1&&(l===void 0&&(l=e.initial),u===void 0&&(u=e.animate));let m=r?r.initial===!1:!1;m=m||l===!1;const x=m?u:l;if(x&&typeof x!="boolean"&&!Sp(x)){const v=Array.isArray(x)?x:[x];for(let E=0;E<v.length;E++){const w=Ay(t,v[E]);if(w){const{transitionEnd:T,transition:A,...I}=w;for(const O in I){let D=I[O];if(Array.isArray(D)){const q=m?D.length-1:0;D=D[q]}D!==null&&(a[O]=D)}for(const O in T)a[O]=T[O]}}}return a}const qN=t=>(e,r)=>{const n=xe.useContext(wp),a=xe.useContext(Tp),i=()=>AO(t,e,n,a);return r?i():Yv(i)};function by(t,e,r){var i;const{style:n}=t,a={};for(const l in n)(Bn(n[l])||e.style&&Bn(e.style[l])||jN(l,t)||((i=r==null?void 0:r.getValue(l))==null?void 0:i.liveStyle)!==void 0)&&(a[l]=n[l]);return a}const NO=qN({scrapeMotionValuesFromProps:by,createRenderState:wy});function WN(t,e,r){const n=by(t,e,r);for(const a in t)if(Bn(t[a])||Bn(e[a])){const i=Ou.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;n[i]=t[a]}return n}const CO=qN({scrapeMotionValuesFromProps:WN,createRenderState:HN}),kO=Symbol.for("motionComponentSymbol");function iu(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function RO(t,e,r){return xe.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):iu(r)&&(r.current=n))},[e])}const Ny=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),DO="framerAppearId",XN="data-"+Ny(DO),$N=xe.createContext({});function IO(t,e,r,n,a){var T,A;const{visualElement:i}=xe.useContext(wp),l=xe.useContext(LN),u=xe.useContext(Tp),f=xe.useContext(yy).reducedMotion,h=xe.useRef(null);n=n||l.renderer,!h.current&&n&&(h.current=n(t,{visualState:e,parent:i,props:r,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:f}));const m=h.current,x=xe.useContext($N);m&&!m.projection&&a&&(m.type==="html"||m.type==="svg")&&FO(h.current,r,a,x);const v=xe.useRef(!1);xe.useInsertionEffect(()=>{m&&v.current&&m.update(r,u)});const E=r[XN],w=xe.useRef(!!E&&!((T=window.MotionHandoffIsComplete)!=null&&T.call(window,E))&&((A=window.MotionHasOptimisedAnimation)==null?void 0:A.call(window,E)));return q4(()=>{m&&(v.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),w.current&&m.animationState&&m.animationState.animateChanges())}),xe.useEffect(()=>{m&&(!w.current&&m.animationState&&m.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var I;(I=window.MotionHandoffMarkAsComplete)==null||I.call(window,E)}),w.current=!1),m.enteringChildren=void 0)}),m}function FO(t,e,r,n){const{layoutId:a,layout:i,drag:l,dragConstraints:u,layoutScroll:f,layoutRoot:h,layoutCrossfade:m}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:KN(t.parent)),t.projection.setOptions({layoutId:a,layout:i,alwaysMeasureLayout:!!l||u&&iu(u),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,crossfade:m,layoutScroll:f,layoutRoot:h})}function KN(t){if(t)return t.options.allowProjection!==!1?t.projection:KN(t.parent)}function ax(t,{forwardMotionProps:e=!1}={},r,n){r&&iO(r);const a=Sy(t)?CO:NO;function i(u,f){let h;const m={...xe.useContext(yy),...u,layoutId:OO(u)},{isStatic:x}=m,v=fO(u),E=a(u,x);if(!x&&Qv){MO();const w=PO(m);h=w.MeasureLayout,v.visualElement=IO(t,E,m,n,w.ProjectionNode)}return _.jsxs(wp.Provider,{value:v,children:[h&&v.visualElement?_.jsx(h,{visualElement:v.visualElement,...m}):null,SO(t,u,RO(E,v.visualElement,f),E,x,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const l=xe.forwardRef(i);return l[kO]=t,l}function OO({layoutId:t}){const e=xe.useContext(Kv).id;return e&&t!==void 0?e+"-"+t:t}function MO(t,e){xe.useContext(LN).strict}function PO(t){const{drag:e,layout:r}=Eu;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function LO(t,e){if(typeof Proxy>"u")return ax;const r=new Map,n=(i,l)=>ax(i,l,t,e),a=(i,l)=>n(i,l);return new Proxy(a,{get:(i,l)=>l==="create"?n:(r.has(l)||r.set(l,ax(l,void 0,t,e)),r.get(l))})}function YN({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function VO({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function BO(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function sx(t){return t===void 0||t===1}function ev({scale:t,scaleX:e,scaleY:r}){return!sx(t)||!sx(e)||!sx(r)}function kl(t){return ev(t)||QN(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function QN(t){return xS(t.x)||xS(t.y)}function xS(t){return t&&t!=="0%"}function Om(t,e,r){const n=t-r,a=e*n;return r+a}function vS(t,e,r,n,a){return a!==void 0&&(t=Om(t,a,n)),Om(t,r,n)+e}function tv(t,e=0,r=1,n,a){t.min=vS(t.min,e,r,n,a),t.max=vS(t.max,e,r,n,a)}function JN(t,{x:e,y:r}){tv(t.x,e.translate,e.scale,e.originPoint),tv(t.y,r.translate,r.scale,r.originPoint)}const yS=.999999999999,_S=1.0000000000001;function jO(t,e,r,n=!1){const a=r.length;if(!a)return;e.x=e.y=1;let i,l;for(let u=0;u<a;u++){i=r[u],l=i.projectionDelta;const{visualElement:f}=i.options;f&&f.props.style&&f.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&lu(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),l&&(e.x*=l.x.scale,e.y*=l.y.scale,JN(t,l)),n&&kl(i.latestValues)&&lu(t,i.latestValues))}e.x<_S&&e.x>yS&&(e.x=1),e.y<_S&&e.y>yS&&(e.y=1)}function ou(t,e){t.min=t.min+e,t.max=t.max+e}function ES(t,e,r,n,a=.5){const i=Ar(t.min,t.max,a);tv(t,e,r,i,n)}function lu(t,e){ES(t.x,e.x,e.scaleX,e.scale,e.originX),ES(t.y,e.y,e.scaleY,e.scale,e.originY)}function ZN(t,e){return YN(BO(t.getBoundingClientRect(),e))}function UO(t,e,r){const n=ZN(t,r),{scroll:a}=e;return a&&(ou(n.x,a.offset.x),ou(n.y,a.offset.y)),n}const TS=()=>({translate:0,scale:1,origin:0,originPoint:0}),cu=()=>({x:TS(),y:TS()}),wS=()=>({min:0,max:0}),rn=()=>({x:wS(),y:wS()}),rv={current:null},eC={current:!1};function zO(){if(eC.current=!0,!!Qv)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>rv.current=t.matches;t.addEventListener("change",e),e()}else rv.current=!1}const HO=new WeakMap;function GO(t,e,r){for(const n in e){const a=e[n],i=r[n];if(Bn(a))t.addValue(n,a);else if(Bn(i))t.addValue(n,_u(a,{owner:t}));else if(i!==a)if(t.hasValue(n)){const l=t.getValue(n);l.liveStyle===!0?l.jump(a):l.hasAnimated||l.set(a)}else{const l=t.getStaticValue(n);t.addValue(n,_u(l!==void 0?l:a,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const SS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class qO{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:a,blockInitialAnimation:i,visualState:l},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=my,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=ca.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Tr.render(this.render,!1,!0))};const{latestValues:f,renderState:h}=l;this.latestValues=f,this.baseTarget={...f},this.initialValues=r.initial?{...f}:{},this.renderState=h,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=a,this.options=u,this.blockInitialAnimation=!!i,this.isControllingVariants=Ap(r),this.isVariantNode=BN(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:m,...x}=this.scrapeMotionValuesFromProps(r,{},this);for(const v in x){const E=x[v];f[v]!==void 0&&Bn(E)&&E.set(f[v])}}mount(e){var r;this.current=e,HO.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,a)=>this.bindToMotionValue(a,n)),eC.current||zO(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:rv.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Bo(this.notifyUpdate),Bo(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=Mu.has(e);n&&this.onBindTransform&&this.onBindTransform();const a=r.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&Tr.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{a(),i&&i(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Eu){const r=Eu[e];if(!r)continue;const{isEnabled:n,Feature:a}=r;if(!this.features[e]&&a&&n(this.props)&&(this.features[e]=new a(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):rn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<SS.length;n++){const a=SS[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i="on"+a,l=e[i];l&&(this.propEventSubscriptions[a]=this.on(a,l))}this.prevMotionValues=GO(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=_u(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(W4(n)||$4(n))?n=parseFloat(n):!ZF(n)&&jo.test(r)&&(n=kN(e,r)),this.setBaseTarget(e,Bn(n)?n.get():n)),Bn(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var i;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const l=Ay(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);l&&(n=l[e])}if(r&&n!==void 0)return n;const a=this.getBaseTargetFromProps(this.props,e);return a!==void 0&&!Bn(a)?a:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new ry),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){xy.render(this.render)}}class tC extends qO{constructor(){super(...arguments),this.KeyframeResolver=UF}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Bn(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function rC(t,{style:e,vars:r},n,a){const i=t.style;let l;for(l in e)i[l]=e[l];a==null||a.applyProjectionStyles(i,n);for(l in r)i.setProperty(l,r[l])}function WO(t){return window.getComputedStyle(t)}class XO extends tC{constructor(){super(...arguments),this.type="html",this.renderInstance=rC}readValueFromInstance(e,r){var n;if(Mu.has(r))return(n=this.projection)!=null&&n.isProjecting?Xx(r):iF(e,r);{const a=WO(e),i=(sy(r)?a.getPropertyValue(r):a[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:r}){return ZN(e,r)}build(e,r,n){Ty(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return by(e,r,n)}}const nC=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function $O(t,e,r,n){rC(t,e,void 0,n);for(const a in e.attrs)t.setAttribute(nC.has(a)?a:Ny(a),e.attrs[a])}class KO extends tC{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=rn}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(Mu.has(r)){const n=CN(r);return n&&n.default||0}return r=nC.has(r)?r:Ny(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return WN(e,r,n)}build(e,r,n){zN(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,a){$O(e,r,n,a)}mount(e){this.isSVGTag=GN(e.tagName),super.mount(e)}}const YO=(t,e)=>Sy(t)?new KO(e):new XO(e,{allowProjection:t!==xe.Fragment});function fu(t,e,r){const n=t.getProps();return Ay(n,e,r!==void 0?r:n.custom,t)}const nv=t=>Array.isArray(t);function QO(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,_u(r))}function JO(t){return nv(t)?t[t.length-1]||0:t}function ZO(t,e){const r=fu(t,e);let{transitionEnd:n={},transition:a={},...i}=r||{};i={...i,...n};for(const l in i){const u=JO(i[l]);QO(t,l,u)}}function eM(t){return!!(Bn(t)&&t.add)}function av(t,e){const r=t.getValue("willChange");if(eM(r))return r.add(e);if(!r&&Mi.WillChange){const n=new Mi.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function aC(t){return t.props[XN]}const tM=t=>t!==null;function rM(t,{repeat:e,repeatType:r="loop"},n){const a=t.filter(tM),i=e&&r!=="loop"&&e%2===1?0:a.length-1;return a[i]}const nM={type:"spring",stiffness:500,damping:25,restSpeed:10},aM=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),sM={type:"keyframes",duration:.8},iM={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},oM=(t,{keyframes:e})=>e.length>2?sM:Mu.has(t)?t.startsWith("scale")?aM(e[1]):nM:iM;function lM({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:i,repeatType:l,repeatDelay:u,from:f,elapsed:h,...m}){return!!Object.keys(m).length}const Cy=(t,e,r,n={},a,i)=>l=>{const u=py(n,t)||{},f=u.delay||n.delay||0;let{elapsed:h=0}=n;h=h-Hs(f);const m={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...u,delay:-h,onUpdate:v=>{e.set(v),u.onUpdate&&u.onUpdate(v)},onComplete:()=>{l(),u.onComplete&&u.onComplete()},name:t,motionValue:e,element:i?void 0:a};lM(u)||Object.assign(m,oM(t,m)),m.duration&&(m.duration=Hs(m.duration)),m.repeatDelay&&(m.repeatDelay=Hs(m.repeatDelay)),m.from!==void 0&&(m.keyframes[0]=m.from);let x=!1;if((m.type===!1||m.duration===0&&!m.repeatDelay)&&(Jx(m),m.delay===0&&(x=!0)),(Mi.instantAnimations||Mi.skipAnimations)&&(x=!0,Jx(m),m.delay=0),m.allowFlatten=!u.type&&!u.ease,x&&!i&&e.get()!==void 0){const v=rM(m.keyframes,u);if(v!==void 0){Tr.update(()=>{m.onUpdate(v),m.onComplete()});return}}return u.isSync?new dy(m):new kF(m)};function cM({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function sC(t,e,{delay:r=0,transitionOverride:n,type:a}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:l,...u}=e;n&&(i=n);const f=[],h=a&&t.animationState&&t.animationState.getState()[a];for(const m in u){const x=t.getValue(m,t.latestValues[m]??null),v=u[m];if(v===void 0||h&&cM(h,m))continue;const E={delay:r,...py(i||{},m)},w=x.get();if(w!==void 0&&!x.isAnimating&&!Array.isArray(v)&&v===w&&!E.velocity)continue;let T=!1;if(window.MotionHandoffAnimation){const I=aC(t);if(I){const O=window.MotionHandoffAnimation(I,m,Tr);O!==null&&(E.startTime=O,T=!0)}}av(t,m),x.start(Cy(m,x,v,t.shouldReduceMotion&&AN.has(m)?{type:!1}:E,t,T));const A=x.animation;A&&f.push(A)}return l&&Promise.all(f).then(()=>{Tr.update(()=>{l&&ZO(t,l)})}),f}function iC(t,e,r,n=0,a=1){const i=Array.from(t).sort((h,m)=>h.sortNodePosition(m)).indexOf(e),l=t.size,u=(l-1)*n;return typeof r=="function"?r(i,l):a===1?i*n:u-i*n}function sv(t,e,r={}){var f;const n=fu(t,e,r.type==="exit"?(f=t.presenceContext)==null?void 0:f.custom:void 0);let{transition:a=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(a=r.transitionOverride);const i=n?()=>Promise.all(sC(t,n,r)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(h=0)=>{const{delayChildren:m=0,staggerChildren:x,staggerDirection:v}=a;return uM(t,e,h,m,x,v,r)}:()=>Promise.resolve(),{when:u}=a;if(u){const[h,m]=u==="beforeChildren"?[i,l]:[l,i];return h().then(()=>m())}else return Promise.all([i(),l(r.delay)])}function uM(t,e,r=0,n=0,a=0,i=1,l){const u=[];for(const f of t.variantChildren)f.notify("AnimationStart",e),u.push(sv(f,e,{...l,delay:r+(typeof n=="function"?0:n)+iC(t.variantChildren,f,n,a,i)}).then(()=>f.notify("AnimationComplete",e)));return Promise.all(u)}function fM(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const a=e.map(i=>sv(t,i,r));n=Promise.all(a)}else if(typeof e=="string")n=sv(t,e,r);else{const a=typeof e=="function"?fu(t,e,r.custom):e;n=Promise.all(sC(t,a,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function oC(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const hM=Ey.length;function lC(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?lC(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<hM;r++){const n=Ey[r],a=t.props[n];(Nh(a)||a===!1)&&(e[n]=a)}return e}const dM=[..._y].reverse(),mM=_y.length;function pM(t){return e=>Promise.all(e.map(({animation:r,options:n})=>fM(t,r,n)))}function gM(t){let e=pM(t),r=AS(),n=!0;const a=f=>(h,m)=>{var v;const x=fu(t,m,f==="exit"?(v=t.presenceContext)==null?void 0:v.custom:void 0);if(x){const{transition:E,transitionEnd:w,...T}=x;h={...h,...T,...w}}return h};function i(f){e=f(t)}function l(f){const{props:h}=t,m=lC(t.parent)||{},x=[],v=new Set;let E={},w=1/0;for(let A=0;A<mM;A++){const I=dM[A],O=r[I],D=h[I]!==void 0?h[I]:m[I],q=Nh(D),Y=I===f?O.isActive:null;Y===!1&&(w=A);let W=D===m[I]&&D!==h[I]&&q;if(W&&n&&t.manuallyAnimateOnMount&&(W=!1),O.protectedKeys={...E},!O.isActive&&Y===null||!D&&!O.prevProp||Sp(D)||typeof D=="boolean")continue;const N=xM(O.prevProp,D);let b=N||I===f&&O.isActive&&!W&&q||A>w&&q,k=!1;const F=Array.isArray(D)?D:[D];let P=F.reduce(a(I),{});Y===!1&&(P={});const{prevResolvedValues:M={}}=O,j={...M,...P},Le=ae=>{b=!0,v.has(ae)&&(k=!0,v.delete(ae)),O.needsAnimating[ae]=!0;const fe=t.getValue(ae);fe&&(fe.liveStyle=!1)};for(const ae in j){const fe=P[ae],ie=M[ae];if(E.hasOwnProperty(ae))continue;let Fe=!1;nv(fe)&&nv(ie)?Fe=!oC(fe,ie):Fe=fe!==ie,Fe?fe!=null?Le(ae):v.add(ae):fe!==void 0&&v.has(ae)?Le(ae):O.protectedKeys[ae]=!0}O.prevProp=D,O.prevResolvedValues=P,O.isActive&&(E={...E,...P}),n&&t.blockInitialAnimation&&(b=!1);const De=W&&N;b&&(!De||k)&&x.push(...F.map(ae=>{const fe={type:I};if(typeof ae=="string"&&n&&!De&&t.manuallyAnimateOnMount&&t.parent){const{parent:ie}=t,Fe=fu(ie,ae);if(ie.enteringChildren&&Fe){const{delayChildren:ee}=Fe.transition||{};fe.delay=iC(ie.enteringChildren,t,ee)}}return{animation:ae,options:fe}}))}if(v.size){const A={};if(typeof h.initial!="boolean"){const I=fu(t,Array.isArray(h.initial)?h.initial[0]:h.initial);I&&I.transition&&(A.transition=I.transition)}v.forEach(I=>{const O=t.getBaseTarget(I),D=t.getValue(I);D&&(D.liveStyle=!0),A[I]=O??null}),x.push({animation:A})}let T=!!x.length;return n&&(h.initial===!1||h.initial===h.animate)&&!t.manuallyAnimateOnMount&&(T=!1),n=!1,T?e(x):Promise.resolve()}function u(f,h){var x;if(r[f].isActive===h)return Promise.resolve();(x=t.variantChildren)==null||x.forEach(v=>{var E;return(E=v.animationState)==null?void 0:E.setActive(f,h)}),r[f].isActive=h;const m=l(f);for(const v in r)r[v].protectedKeys={};return m}return{animateChanges:l,setActive:u,setAnimateFunction:i,getState:()=>r,reset:()=>{r=AS()}}}function xM(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!oC(e,t):!1}function Cl(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function AS(){return{animate:Cl(!0),whileInView:Cl(),whileHover:Cl(),whileTap:Cl(),whileDrag:Cl(),whileFocus:Cl(),exit:Cl()}}class Qo{constructor(e){this.isMounted=!1,this.node=e}update(){}}class vM extends Qo{constructor(e){super(e),e.animationState||(e.animationState=gM(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Sp(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let yM=0;class _M extends Qo{constructor(){super(...arguments),this.id=yM++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const a=this.node.animationState.setActive("exit",!e);r&&!e&&a.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const EM={animation:{Feature:vM},exit:{Feature:_M}};function kh(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function i0(t){return{point:{x:t.pageX,y:t.pageY}}}const TM=t=>e=>vy(e)&&t(e,i0(e));function sh(t,e,r,n){return kh(t,e,TM(r),n)}const cC=1e-4,wM=1-cC,SM=1+cC,uC=.01,AM=0-uC,bM=0+uC;function Yn(t){return t.max-t.min}function NM(t,e,r){return Math.abs(t-e)<=r}function bS(t,e,r,n=.5){t.origin=n,t.originPoint=Ar(e.min,e.max,t.origin),t.scale=Yn(r)/Yn(e),t.translate=Ar(r.min,r.max,t.origin)-t.originPoint,(t.scale>=wM&&t.scale<=SM||isNaN(t.scale))&&(t.scale=1),(t.translate>=AM&&t.translate<=bM||isNaN(t.translate))&&(t.translate=0)}function ih(t,e,r,n){bS(t.x,e.x,r.x,n?n.originX:void 0),bS(t.y,e.y,r.y,n?n.originY:void 0)}function NS(t,e,r){t.min=r.min+e.min,t.max=t.min+Yn(e)}function CM(t,e,r){NS(t.x,e.x,r.x),NS(t.y,e.y,r.y)}function CS(t,e,r){t.min=e.min-r.min,t.max=t.min+Yn(e)}function Mm(t,e,r){CS(t.x,e.x,r.x),CS(t.y,e.y,r.y)}function Xa(t){return[t("x"),t("y")]}const fC=({current:t})=>t?t.ownerDocument.defaultView:null,kS=(t,e)=>Math.abs(t-e);function kM(t,e){const r=kS(t.x,e.x),n=kS(t.y,e.y);return Math.sqrt(r**2+n**2)}class hC{constructor(e,r,{transformPagePoint:n,contextWindow:a=window,dragSnapToOrigin:i=!1,distanceThreshold:l=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=ox(this.lastMoveEventInfo,this.history),E=this.startEvent!==null,w=kM(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!E&&!w)return;const{point:T}=v,{timestamp:A}=Tn;this.history.push({...T,timestamp:A});const{onStart:I,onMove:O}=this.handlers;E||(I&&I(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),O&&O(this.lastMoveEvent,v)},this.handlePointerMove=(v,E)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=ix(E,this.transformPagePoint),Tr.update(this.updatePoint,!0)},this.handlePointerUp=(v,E)=>{this.end();const{onEnd:w,onSessionEnd:T,resumeAnimation:A}=this.handlers;if(this.dragSnapToOrigin&&A&&A(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const I=ox(v.type==="pointercancel"?this.lastMoveEventInfo:ix(E,this.transformPagePoint),this.history);this.startEvent&&w&&w(v,I),T&&T(v,I)},!vy(e))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=l,this.contextWindow=a||window;const u=i0(e),f=ix(u,this.transformPagePoint),{point:h}=f,{timestamp:m}=Tn;this.history=[{...h,timestamp:m}];const{onSessionStart:x}=r;x&&x(e,ox(f,this.history)),this.removeListeners=n0(sh(this.contextWindow,"pointermove",this.handlePointerMove),sh(this.contextWindow,"pointerup",this.handlePointerUp),sh(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Bo(this.updatePoint)}}function ix(t,e){return e?{point:e(t.point)}:t}function RS(t,e){return{x:t.x-e.x,y:t.y-e.y}}function ox({point:t},e){return{point:t,delta:RS(t,dC(e)),offset:RS(t,RM(e)),velocity:DM(e,.1)}}function RM(t){return t[0]}function dC(t){return t[t.length-1]}function DM(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const a=dC(t);for(;r>=0&&(n=t[r],!(a.timestamp-n.timestamp>Hs(e)));)r--;if(!n)return{x:0,y:0};const i=Ja(a.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const l={x:(a.x-n.x)/i,y:(a.y-n.y)/i};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function IM(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?Ar(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?Ar(r,t,n.max):Math.min(t,r)),t}function DS(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function FM(t,{top:e,left:r,bottom:n,right:a}){return{x:DS(t.x,r,a),y:DS(t.y,e,n)}}function IS(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function OM(t,e){return{x:IS(t.x,e.x),y:IS(t.y,e.y)}}function MM(t,e){let r=.5;const n=Yn(t),a=Yn(e);return a>n?r=Sh(e.min,e.max-n,t.min):n>a&&(r=Sh(t.min,t.max-a,e.min)),Oi(0,1,r)}function PM(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const iv=.35;function LM(t=iv){return t===!1?t=0:t===!0&&(t=iv),{x:FS(t,"left","right"),y:FS(t,"top","bottom")}}function FS(t,e,r){return{min:OS(t,e),max:OS(t,r)}}function OS(t,e){return typeof t=="number"?t:t[e]||0}const VM=new WeakMap;class BM{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=rn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const i=x=>{const{dragSnapToOrigin:v}=this.getProps();v?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(i0(x).point)},l=(x,v)=>{const{drag:E,dragPropagation:w,onDragStart:T}=this.getProps();if(E&&!w&&(this.openDragLock&&this.openDragLock(),this.openDragLock=qF(E),!this.openDragLock))return;this.latestPointerEvent=x,this.latestPanInfo=v,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xa(I=>{let O=this.getAxisMotionValue(I).get()||0;if(Gs.test(O)){const{projection:D}=this.visualElement;if(D&&D.layout){const q=D.layout.layoutBox[I];q&&(O=Yn(q)*(parseFloat(O)/100))}}this.originPoint[I]=O}),T&&Tr.postRender(()=>T(x,v)),av(this.visualElement,"transform");const{animationState:A}=this.visualElement;A&&A.setActive("whileDrag",!0)},u=(x,v)=>{this.latestPointerEvent=x,this.latestPanInfo=v;const{dragPropagation:E,dragDirectionLock:w,onDirectionLock:T,onDrag:A}=this.getProps();if(!E&&!this.openDragLock)return;const{offset:I}=v;if(w&&this.currentDirection===null){this.currentDirection=jM(I),this.currentDirection!==null&&T&&T(this.currentDirection);return}this.updateAxis("x",v.point,I),this.updateAxis("y",v.point,I),this.visualElement.render(),A&&A(x,v)},f=(x,v)=>{this.latestPointerEvent=x,this.latestPanInfo=v,this.stop(x,v),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>Xa(x=>{var v;return this.getAnimationState(x)==="paused"&&((v=this.getAxisMotionValue(x).animation)==null?void 0:v.play())}),{dragSnapToOrigin:m}=this.getProps();this.panSession=new hC(e,{onSessionStart:i,onStart:l,onMove:u,onSessionEnd:f,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:m,distanceThreshold:n,contextWindow:fC(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,a=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!a||!n)return;const{velocity:l}=a;this.startAnimation(l);const{onDragEnd:u}=this.getProps();u&&Tr.postRender(()=>u(n,a))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:a}=this.getProps();if(!n||!$d(e,a,this.currentDirection))return;const i=this.getAxisMotionValue(e);let l=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(l=IM(l,this.constraints[e],this.elastic[e])),i.set(l)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,a=this.constraints;e&&iu(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=FM(n.layoutBox,e):this.constraints=!1,this.elastic=LM(r),a!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Xa(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=PM(n.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!iu(e))return!1;const n=e.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=UO(n,a.root,this.visualElement.getTransformPagePoint());let l=OM(a.layout.layoutBox,i);if(r){const u=r(VO(l));this.hasMutatedConstraints=!!u,u&&(l=YN(u))}return l}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:i,dragSnapToOrigin:l,onDragTransitionEnd:u}=this.getProps(),f=this.constraints||{},h=Xa(m=>{if(!$d(m,r,this.currentDirection))return;let x=f&&f[m]||{};l&&(x={min:0,max:0});const v=a?200:1e6,E=a?40:1e7,w={type:"inertia",velocity:n?e[m]:0,bounceStiffness:v,bounceDamping:E,timeConstant:750,restDelta:1,restSpeed:10,...i,...x};return this.startAxisValueAnimation(m,w)});return Promise.all(h).then(u)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return av(this.visualElement,e),n.start(Cy(e,n,0,r,this.visualElement,!1))}stopAnimation(){Xa(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Xa(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Xa(r=>{const{drag:n}=this.getProps();if(!$d(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:l,max:u}=a.layout.layoutBox[r];i.set(e[r]-Ar(l,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!iu(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Xa(l=>{const u=this.getAxisMotionValue(l);if(u&&this.constraints!==!1){const f=u.get();a[l]=MM({min:f,max:f},this.constraints[l])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Xa(l=>{if(!$d(l,e,null))return;const u=this.getAxisMotionValue(l),{min:f,max:h}=this.constraints[l];u.set(Ar(f,h,a[l]))})}addListeners(){if(!this.visualElement.current)return;VM.set(this.visualElement,this);const e=this.visualElement.current,r=sh(e,"pointerdown",f=>{const{drag:h,dragListener:m=!0}=this.getProps();h&&m&&this.start(f)}),n=()=>{const{dragConstraints:f}=this.getProps();iu(f)&&f.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),Tr.read(n);const l=kh(window,"resize",()=>this.scalePositionWithinConstraints()),u=a.addEventListener("didUpdate",(({delta:f,hasLayoutChanged:h})=>{this.isDragging&&h&&(Xa(m=>{const x=this.getAxisMotionValue(m);x&&(this.originPoint[m]+=f[m].translate,x.set(x.get()+f[m].translate))}),this.visualElement.render())}));return()=>{l(),r(),i(),u&&u()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:l=iv,dragMomentum:u=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:i,dragElastic:l,dragMomentum:u}}}function $d(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function jM(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class UM extends Qo{constructor(e){super(e),this.removeGroupControls=Za,this.removeListeners=Za,this.controls=new BM(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Za}unmount(){this.removeGroupControls(),this.removeListeners()}}const MS=t=>(e,r)=>{t&&Tr.postRender(()=>t(e,r))};class zM extends Qo{constructor(){super(...arguments),this.removePointerDownListener=Za}onPointerDown(e){this.session=new hC(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:fC(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:MS(e),onStart:MS(r),onMove:n,onEnd:(i,l)=>{delete this.session,a&&Tr.postRender(()=>a(i,l))}}}mount(){this.removePointerDownListener=sh(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const xm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function PS(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Xf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(ht.test(t))t=parseFloat(t);else return t;const r=PS(t,e.target.x),n=PS(t,e.target.y);return`${r}% ${n}%`}},HM={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,a=jo.parse(t);if(a.length>5)return n;const i=jo.createTransformer(t),l=typeof a[0]!="number"?1:0,u=r.x.scale*e.x,f=r.y.scale*e.y;a[0+l]/=u,a[1+l]/=f;const h=Ar(u,f,.5);return typeof a[2+l]=="number"&&(a[2+l]/=h),typeof a[3+l]=="number"&&(a[3+l]/=h),i(a)}};let lx=!1;class GM extends xe.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:i}=e;hO(qM),i&&(r.group&&r.group.add(i),n&&n.register&&a&&n.register(i),lx&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),xm.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:a,isPresent:i}=this.props,{projection:l}=n;return l&&(l.isPresent=i,lx=!0,a||e.layoutDependency!==r||r===void 0||e.isPresent!==i?l.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?l.promote():l.relegate()||Tr.postRender(()=>{const u=l.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),xy.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=e;lx=!0,a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function mC(t){const[e,r]=PN(),n=xe.useContext(Kv);return _.jsx(GM,{...t,layoutGroup:n,switchLayoutGroup:xe.useContext($N),isPresent:e,safeToRemove:r})}const qM={borderRadius:{...Xf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Xf,borderTopRightRadius:Xf,borderBottomLeftRadius:Xf,borderBottomRightRadius:Xf,boxShadow:HM};function WM(t,e,r){const n=Bn(t)?t:_u(t);return n.start(Cy("",n,e,r)),n.animation}const XM=(t,e)=>t.depth-e.depth;class $M{constructor(){this.children=[],this.isDirty=!1}add(e){Jv(this.children,e),this.isDirty=!0}remove(e){Zv(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(XM),this.isDirty=!1,this.children.forEach(e)}}function KM(t,e){const r=ca.now(),n=({timestamp:a})=>{const i=a-r;i>=e&&(Bo(n),t(i-e))};return Tr.setup(n,!0),()=>Bo(n)}const pC=["TopLeft","TopRight","BottomLeft","BottomRight"],YM=pC.length,LS=t=>typeof t=="string"?parseFloat(t):t,VS=t=>typeof t=="number"||ht.test(t);function QM(t,e,r,n,a,i){a?(t.opacity=Ar(0,r.opacity??1,JM(n)),t.opacityExit=Ar(e.opacity??1,0,ZM(n))):i&&(t.opacity=Ar(e.opacity??1,r.opacity??1,n));for(let l=0;l<YM;l++){const u=`border${pC[l]}Radius`;let f=BS(e,u),h=BS(r,u);if(f===void 0&&h===void 0)continue;f||(f=0),h||(h=0),f===0||h===0||VS(f)===VS(h)?(t[u]=Math.max(Ar(LS(f),LS(h),n),0),(Gs.test(h)||Gs.test(f))&&(t[u]+="%")):t[u]=h}(e.rotate||r.rotate)&&(t.rotate=Ar(e.rotate||0,r.rotate||0,n))}function BS(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const JM=gC(0,.5,rN),ZM=gC(.5,.95,Za);function gC(t,e,r){return n=>n<t?0:n>e?1:r(Sh(t,e,n))}function jS(t,e){t.min=e.min,t.max=e.max}function ps(t,e){jS(t.x,e.x),jS(t.y,e.y)}function US(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function zS(t,e,r,n,a){return t-=e,t=Om(t,1/r,n),a!==void 0&&(t=Om(t,1/a,n)),t}function e8(t,e=0,r=1,n=.5,a,i=t,l=t){if(Gs.test(e)&&(e=parseFloat(e),e=Ar(l.min,l.max,e/100)-l.min),typeof e!="number")return;let u=Ar(i.min,i.max,n);t===i&&(u-=e),t.min=zS(t.min,e,r,u,a),t.max=zS(t.max,e,r,u,a)}function HS(t,e,[r,n,a],i,l){e8(t,e[r],e[n],e[a],e.scale,i,l)}const t8=["x","scaleX","originX"],r8=["y","scaleY","originY"];function GS(t,e,r,n){HS(t.x,e,t8,r?r.x:void 0,n?n.x:void 0),HS(t.y,e,r8,r?r.y:void 0,n?n.y:void 0)}function qS(t){return t.translate===0&&t.scale===1}function xC(t){return qS(t.x)&&qS(t.y)}function WS(t,e){return t.min===e.min&&t.max===e.max}function n8(t,e){return WS(t.x,e.x)&&WS(t.y,e.y)}function XS(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function vC(t,e){return XS(t.x,e.x)&&XS(t.y,e.y)}function $S(t){return Yn(t.x)/Yn(t.y)}function KS(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class a8{constructor(){this.members=[]}add(e){Jv(this.members,e),e.scheduleRender()}remove(e){if(Zv(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(a=>e===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:a}=e.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function s8(t,e,r){let n="";const a=t.x.translate/e.x,i=t.y.translate/e.y,l=(r==null?void 0:r.z)||0;if((a||i||l)&&(n=`translate3d(${a}px, ${i}px, ${l}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:h,rotate:m,rotateX:x,rotateY:v,skewX:E,skewY:w}=r;h&&(n=`perspective(${h}px) ${n}`),m&&(n+=`rotate(${m}deg) `),x&&(n+=`rotateX(${x}deg) `),v&&(n+=`rotateY(${v}deg) `),E&&(n+=`skewX(${E}deg) `),w&&(n+=`skewY(${w}deg) `)}const u=t.x.scale*e.x,f=t.y.scale*e.y;return(u!==1||f!==1)&&(n+=`scale(${u}, ${f})`),n||"none"}const cx=["","X","Y","Z"],i8=1e3;let o8=0;function ux(t,e,r,n){const{latestValues:a}=e;a[t]&&(r[t]=a[t],e.setStaticValue(t,0),n&&(n[t]=0))}function yC(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=aC(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",Tr,!(a||i))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&yC(n)}function _C({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(l={},u=e==null?void 0:e()){this.id=o8++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(u8),this.nodes.forEach(m8),this.nodes.forEach(p8),this.nodes.forEach(f8)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let f=0;f<this.path.length;f++)this.path[f].shouldResetTransform=!0;this.root===this&&(this.nodes=new $M)}addEventListener(l,u){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new ry),this.eventHandlers.get(l).add(u)}notifyListeners(l,...u){const f=this.eventHandlers.get(l);f&&f.notify(...u)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=MN(l)&&!QF(l),this.instance=l;const{layoutId:u,layout:f,visualElement:h}=this.options;if(h&&!h.current&&h.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(f||u)&&(this.isLayoutDirty=!0),t){let m,x=0;const v=()=>this.root.updateBlockedByResize=!1;Tr.read(()=>{x=window.innerWidth}),t(l,()=>{const E=window.innerWidth;E!==x&&(x=E,this.root.updateBlockedByResize=!0,m&&m(),m=KM(v,250),xm.hasAnimatedSinceResize&&(xm.hasAnimatedSinceResize=!1,this.nodes.forEach(JS)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&h&&(u||f)&&this.addEventListener("didUpdate",({delta:m,hasLayoutChanged:x,hasRelativeLayoutChanged:v,layout:E})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const w=this.options.transition||h.getDefaultTransition()||_8,{onLayoutAnimationStart:T,onLayoutAnimationComplete:A}=h.getProps(),I=!this.targetLayout||!vC(this.targetLayout,E),O=!x&&v;if(this.options.layoutRoot||this.resumeFrom||O||x&&(I||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const D={...py(w,"layout"),onPlay:T,onComplete:A};(h.shouldReduceMotion||this.options.layoutRoot)&&(D.delay=0,D.type=!1),this.startAnimation(D),this.setAnimationOrigin(m,O)}else x||JS(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=E})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Bo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(g8),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&yC(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let m=0;m<this.path.length;m++){const x=this.path[m];x.shouldResetTransform=!0,x.updateScroll("snapshot"),x.options.layoutRoot&&x.willUpdate(!1)}const{layoutId:u,layout:f}=this.options;if(u===void 0&&!f)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(YS);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(QS);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(d8),this.nodes.forEach(l8),this.nodes.forEach(c8)):this.nodes.forEach(QS),this.clearAllSnapshots();const u=ca.now();Tn.delta=Oi(0,1e3/60,u-Tn.timestamp),Tn.timestamp=u,Tn.isProcessing=!0,J1.update.process(Tn),J1.preRender.process(Tn),J1.render.process(Tn),Tn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,xy.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(h8),this.sharedNodes.forEach(x8)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Tr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Tr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Yn(this.snapshot.measuredBox.x)&&!Yn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let f=0;f<this.path.length;f++)this.path[f].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=rn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(u=!1),u&&this.instance){const f=n(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:f,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:f}}}resetTransform(){if(!a)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!xC(this.projectionDelta),f=this.getTransformTemplate(),h=f?f(this.latestValues,""):void 0,m=h!==this.prevTransformTemplateValue;l&&this.instance&&(u||kl(this.latestValues)||m)&&(a(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const u=this.measurePageBox();let f=this.removeElementScroll(u);return l&&(f=this.removeTransform(f)),E8(f),{animationId:this.root.animationId,measuredBox:u,layoutBox:f,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:l}=this.options;if(!l)return rn();const u=l.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(T8))){const{scroll:m}=this.root;m&&(ou(u.x,m.offset.x),ou(u.y,m.offset.y))}return u}removeElementScroll(l){var f;const u=rn();if(ps(u,l),(f=this.scroll)!=null&&f.wasRoot)return u;for(let h=0;h<this.path.length;h++){const m=this.path[h],{scroll:x,options:v}=m;m!==this.root&&x&&v.layoutScroll&&(x.wasRoot&&ps(u,l),ou(u.x,x.offset.x),ou(u.y,x.offset.y))}return u}applyTransform(l,u=!1){const f=rn();ps(f,l);for(let h=0;h<this.path.length;h++){const m=this.path[h];!u&&m.options.layoutScroll&&m.scroll&&m!==m.root&&lu(f,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),kl(m.latestValues)&&lu(f,m.latestValues)}return kl(this.latestValues)&&lu(f,this.latestValues),f}removeTransform(l){const u=rn();ps(u,l);for(let f=0;f<this.path.length;f++){const h=this.path[f];if(!h.instance||!kl(h.latestValues))continue;ev(h.latestValues)&&h.updateSnapshot();const m=rn(),x=h.measurePageBox();ps(m,x),GS(u,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,m)}return kl(this.latestValues)&&GS(u,this.latestValues),u}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Tn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var E;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const f=!!this.resumingFrom||this!==u;if(!(l||f&&this.isSharedProjectionDirty||this.isProjectionDirty||(E=this.parent)!=null&&E.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:m,layoutId:x}=this.options;if(!this.layout||!(m||x))return;this.resolvedRelativeTargetAt=Tn.timestamp;const v=this.getClosestProjectingParent();v&&this.linkedParentVersion!==v.layoutVersion&&!v.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(v&&v.layout?this.createRelativeTarget(v,this.layout.layoutBox,v.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=rn(),this.targetWithTransforms=rn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),CM(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ps(this.target,this.layout.layoutBox),JN(this.target,this.targetDelta)):ps(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?this.createRelativeTarget(v,this.target,v.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||ev(this.parent.latestValues)||QN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(l,u,f){this.relativeParent=l,this.linkedParentVersion=l.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rn(),this.relativeTargetOrigin=rn(),Mm(this.relativeTargetOrigin,u,f),ps(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var w;const l=this.getLead(),u=!!this.resumingFrom||this!==l;let f=!0;if((this.isProjectionDirty||(w=this.parent)!=null&&w.isProjectionDirty)&&(f=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(f=!1),this.resolvedRelativeTargetAt===Tn.timestamp&&(f=!1),f)return;const{layout:h,layoutId:m}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||m))return;ps(this.layoutCorrected,this.layout.layoutBox);const x=this.treeScale.x,v=this.treeScale.y;jO(this.layoutCorrected,this.treeScale,this.path,u),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=rn());const{target:E}=l;if(!E){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(US(this.prevProjectionDelta.x,this.projectionDelta.x),US(this.prevProjectionDelta.y,this.projectionDelta.y)),ih(this.projectionDelta,this.layoutCorrected,E,this.latestValues),(this.treeScale.x!==x||this.treeScale.y!==v||!KS(this.projectionDelta.x,this.prevProjectionDelta.x)||!KS(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",E))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var u;if((u=this.options.visualElement)==null||u.scheduleRender(),l){const f=this.getStack();f&&f.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=cu(),this.projectionDelta=cu(),this.projectionDeltaWithTransform=cu()}setAnimationOrigin(l,u=!1){const f=this.snapshot,h=f?f.latestValues:{},m={...this.latestValues},x=cu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const v=rn(),E=f?f.source:void 0,w=this.layout?this.layout.source:void 0,T=E!==w,A=this.getStack(),I=!A||A.members.length<=1,O=!!(T&&!I&&this.options.crossfade===!0&&!this.path.some(y8));this.animationProgress=0;let D;this.mixTargetDelta=q=>{const Y=q/1e3;ZS(x.x,l.x,Y),ZS(x.y,l.y,Y),this.setTargetDelta(x),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Mm(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),v8(this.relativeTarget,this.relativeTargetOrigin,v,Y),D&&n8(this.relativeTarget,D)&&(this.isProjectionDirty=!1),D||(D=rn()),ps(D,this.relativeTarget)),T&&(this.animationValues=m,QM(m,h,this.latestValues,Y,O,I)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Y},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){var u,f,h;this.notifyListeners("animationStart"),(u=this.currentAnimation)==null||u.stop(),(h=(f=this.resumingFrom)==null?void 0:f.currentAnimation)==null||h.stop(),this.pendingAnimation&&(Bo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Tr.update(()=>{xm.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=_u(0)),this.currentAnimation=WM(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:m=>{this.mixTargetDelta(m),l.onUpdate&&l.onUpdate(m)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(i8),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:u,target:f,layout:h,latestValues:m}=l;if(!(!u||!f||!h)){if(this!==l&&this.layout&&h&&EC(this.options.animationType,this.layout.layoutBox,h.layoutBox)){f=this.target||rn();const x=Yn(this.layout.layoutBox.x);f.x.min=l.target.x.min,f.x.max=f.x.min+x;const v=Yn(this.layout.layoutBox.y);f.y.min=l.target.y.min,f.y.max=f.y.min+v}ps(u,f),lu(u,m),ih(this.projectionDeltaWithTransform,this.layoutCorrected,u,m)}}registerSharedNode(l,u){this.sharedNodes.has(l)||this.sharedNodes.set(l,new a8),this.sharedNodes.get(l).add(u);const h=u.options.initialPromotionConfig;u.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(u):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var u;const{layoutId:l}=this.options;return l?((u=this.getStack())==null?void 0:u.lead)||this:this}getPrevLead(){var u;const{layoutId:l}=this.options;return l?(u=this.getStack())==null?void 0:u.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:u,preserveFollowOpacity:f}={}){const h=this.getStack();h&&h.promote(this,f),l&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let u=!1;const{latestValues:f}=l;if((f.z||f.rotate||f.rotateX||f.rotateY||f.rotateZ||f.skewX||f.skewY)&&(u=!0),!u)return;const h={};f.z&&ux("z",l,h,this.animationValues);for(let m=0;m<cx.length;m++)ux(`rotate${cx[m]}`,l,h,this.animationValues),ux(`skew${cx[m]}`,l,h,this.animationValues);l.render();for(const m in h)l.setStaticValue(m,h[m]),this.animationValues&&(this.animationValues[m]=h[m]);l.scheduleRender()}applyProjectionStyles(l,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const f=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=gm(u==null?void 0:u.pointerEvents)||"",l.transform=f?f(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=gm(u==null?void 0:u.pointerEvents)||""),this.hasProjected&&!kl(this.latestValues)&&(l.transform=f?f({},""):"none",this.hasProjected=!1);return}l.visibility="";const m=h.animationValues||h.latestValues;this.applyTransformsToTarget();let x=s8(this.projectionDeltaWithTransform,this.treeScale,m);f&&(x=f(m,x)),l.transform=x;const{x:v,y:E}=this.projectionDelta;l.transformOrigin=`${v.origin*100}% ${E.origin*100}% 0`,h.animationValues?l.opacity=h===this?m.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:l.opacity=h===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const w in Ch){if(m[w]===void 0)continue;const{correct:T,applyTo:A,isCSSVariable:I}=Ch[w],O=x==="none"?m[w]:T(m[w],h);if(A){const D=A.length;for(let q=0;q<D;q++)l[A[q]]=O}else I?this.options.visualElement.renderState.vars[w]=O:l[w]=O}this.options.layoutId&&(l.pointerEvents=h===this?gm(u==null?void 0:u.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var u;return(u=l.currentAnimation)==null?void 0:u.stop()}),this.root.nodes.forEach(YS),this.root.sharedNodes.clear()}}}function l8(t){t.updateLayout()}function c8(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=t.layout,{animationType:i}=t.options,l=e.source!==t.layout.source;i==="size"?Xa(x=>{const v=l?e.measuredBox[x]:e.layoutBox[x],E=Yn(v);v.min=n[x].min,v.max=v.min+E}):EC(i,e.layoutBox,n)&&Xa(x=>{const v=l?e.measuredBox[x]:e.layoutBox[x],E=Yn(n[x]);v.max=v.min+E,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[x].max=t.relativeTarget[x].min+E)});const u=cu();ih(u,n,e.layoutBox);const f=cu();l?ih(f,t.applyTransform(a,!0),e.measuredBox):ih(f,n,e.layoutBox);const h=!xC(u);let m=!1;if(!t.resumeFrom){const x=t.getClosestProjectingParent();if(x&&!x.resumeFrom){const{snapshot:v,layout:E}=x;if(v&&E){const w=rn();Mm(w,e.layoutBox,v.layoutBox);const T=rn();Mm(T,n,E.layoutBox),vC(w,T)||(m=!0),x.options.layoutRoot&&(t.relativeTarget=T,t.relativeTargetOrigin=w,t.relativeParent=x)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:f,layoutDelta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:m})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function u8(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function f8(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function h8(t){t.clearSnapshot()}function YS(t){t.clearMeasurements()}function QS(t){t.isLayoutDirty=!1}function d8(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function JS(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function m8(t){t.resolveTargetDelta()}function p8(t){t.calcProjection()}function g8(t){t.resetSkewAndRotation()}function x8(t){t.removeLeadSnapshot()}function ZS(t,e,r){t.translate=Ar(e.translate,0,r),t.scale=Ar(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function eA(t,e,r,n){t.min=Ar(e.min,r.min,n),t.max=Ar(e.max,r.max,n)}function v8(t,e,r,n){eA(t.x,e.x,r.x,n),eA(t.y,e.y,r.y,n)}function y8(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const _8={duration:.45,ease:[.4,0,.1,1]},tA=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),rA=tA("applewebkit/")&&!tA("chrome/")?Math.round:Za;function nA(t){t.min=rA(t.min),t.max=rA(t.max)}function E8(t){nA(t.x),nA(t.y)}function EC(t,e,r){return t==="position"||t==="preserve-aspect"&&!NM($S(e),$S(r),.2)}function T8(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const w8=_C({attachResizeListener:(t,e)=>kh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),fx={current:void 0},TC=_C({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!fx.current){const t=new w8({});t.mount(window),t.setOptions({layoutScroll:!0}),fx.current=t}return fx.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),S8={pan:{Feature:zM},drag:{Feature:UM,ProjectionNode:TC,MeasureLayout:mC}};function aA(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const a="onHover"+r,i=n[a];i&&Tr.postRender(()=>i(e,i0(e)))}class A8 extends Qo{mount(){const{current:e}=this.node;e&&(this.unmount=WF(e,(r,n)=>(aA(this.node,n,"Start"),a=>aA(this.node,a,"End"))))}unmount(){}}class b8 extends Qo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=n0(kh(this.node.current,"focus",()=>this.onFocus()),kh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function sA(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const a="onTap"+(r==="End"?"":r),i=n[a];i&&Tr.postRender(()=>i(e,i0(e)))}class N8 extends Qo{mount(){const{current:e}=this.node;e&&(this.unmount=YF(e,(r,n)=>(sA(this.node,n,"Start"),(a,{success:i})=>sA(this.node,a,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const ov=new WeakMap,hx=new WeakMap,C8=t=>{const e=ov.get(t.target);e&&e(t)},k8=t=>{t.forEach(C8)};function R8({root:t,...e}){const r=t||document;hx.has(r)||hx.set(r,{});const n=hx.get(r),a=JSON.stringify(e);return n[a]||(n[a]=new IntersectionObserver(k8,{root:t,...e})),n[a]}function D8(t,e,r){const n=R8(e);return ov.set(t,r),n.observe(t),()=>{ov.delete(t),n.unobserve(t)}}const I8={some:0,all:1};class F8 extends Qo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:i}=e,l={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:I8[a]},u=f=>{const{isIntersecting:h}=f;if(this.isInView===h||(this.isInView=h,i&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:m,onViewportLeave:x}=this.node.getProps(),v=h?m:x;v&&v(f)};return D8(this.node.current,l,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(O8(e,r))&&this.startObserver()}unmount(){}}function O8({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const M8={inView:{Feature:F8},tap:{Feature:N8},focus:{Feature:b8},hover:{Feature:A8}},P8={layout:{ProjectionNode:TC,MeasureLayout:mC}},L8={...EM,...M8,...S8,...P8},Pt=LO(L8,YO);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),B8=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),iA=t=>{const e=B8(t);return e.charAt(0).toUpperCase()+e.slice(1)},wC=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),j8=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var U8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=xe.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...u},f)=>xe.createElement("svg",{ref:f,...U8,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:wC("lucide",a),...!i&&!j8(u)&&{"aria-hidden":"true"},...u},[...l.map(([h,m])=>xe.createElement(h,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=(t,e)=>{const r=xe.forwardRef(({className:n,...a},i)=>xe.createElement(z8,{ref:i,iconNode:e,className:wC(`lucide-${V8(iA(t))}`,`lucide-${t}`,n),...a}));return r.displayName=iA(t),r};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Pm=bt("arrow-right",H8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],q8=bt("building",G8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Rh=bt("calendar",W8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],oA=bt("chart-column",X8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],lv=bt("check",$8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Lm=bt("chevron-down",K8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],lA=bt("chevron-right",Y8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ky=bt("chevron-up",Q8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],SC=bt("circle-alert",J8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z8=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],AC=bt("clock",Z8);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],tP=bt("database",eP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],bp=bt("dollar-sign",rP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Vm=bt("download",nP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],sP=bt("file-spreadsheet",aP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],oh=bt("file-text",iP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Bm=bt("history",oP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],cA=bt("loader-circle",lP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],uP=bt("log-in",cP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],hP=bt("log-out",fP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],mP=bt("pen",dP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],gP=bt("pencil",pP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],bC=bt("percent",xP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ry=bt("plus",vP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yP=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],_P=bt("receipt",yP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Dy=bt("refresh-cw",EP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],wP=bt("save",TP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],cv=bt("search",SP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],bP=bt("settings-2",AP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Iy=bt("settings",NP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],kP=bt("tag",CP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Np=bt("trash-2",RP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],NC=bt("trending-up",DP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],uv=bt("triangle-alert",IP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],OP=bt("trophy",FP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],CC=bt("upload",MP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Fy=bt("user",PP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],jm=bt("users",LP);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Dh=bt("x",VP);function kC(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=kC(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function vm(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=kC(t))&&(n&&(n+=" "),n+=e);return n}const BP=({onFileSelect:t})=>{const[e,r]=xe.useState(!1),[n,a]=xe.useState(null),i=xe.useRef(null),l=xe.useCallback(x=>{x.preventDefault(),r(!0)},[]),u=xe.useCallback(x=>{x.preventDefault(),r(!1)},[]),f=x=>{a(null);const v=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"],E=[];let w=!1;return Array.from(x).forEach(T=>{var O;const A=(O=T.name.split(".").pop())==null?void 0:O.toLowerCase(),I=["xlsx","xls","csv"].includes(A||"");v.includes(T.type)||I?E.push(T):w=!0}),w&&a("Some files were skipped. Please upload valid Excel (.xlsx, .xls) or CSV files."),E},h=xe.useCallback(x=>{if(x.preventDefault(),r(!1),x.dataTransfer.files&&x.dataTransfer.files.length>0){const v=f(x.dataTransfer.files);v.length>0&&t(v)}},[t]),m=x=>{if(x.target.files&&x.target.files.length>0){const v=f(x.target.files);v.length>0&&t(v)}};return _.jsxs("div",{className:"w-full max-w-xl mx-auto",children:[_.jsxs(Pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:vm("relative border-2 border-dashed rounded-3xl p-12 text-center transition-all duration-300 ease-in-out cursor-pointer overflow-hidden group",e?"border-primary-500 bg-primary-50/50 scale-[1.02] shadow-xl shadow-primary-500/10":"border-slate-200 hover:border-primary-400 hover:bg-slate-50"),onDragOver:l,onDragLeave:u,onDrop:h,role:"button",tabIndex:0,onClick:()=>{var x;return(x=i.current)==null?void 0:x.click()},onKeyDown:x=>{var v;(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),(v=i.current)==null||v.click())},children:[_.jsx("input",{type:"file",id:"file-input",className:"hidden",accept:".csv,.xlsx,.xls",multiple:!0,ref:i,onChange:m}),_.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-4",children:[_.jsx("div",{className:vm("p-4 rounded-full transition-colors duration-300",e?"bg-primary-100 text-primary-600":"bg-slate-100 text-slate-400 group-hover:bg-primary-50 group-hover:text-primary-500"),children:e?_.jsx(sP,{className:"w-10 h-10 animate-bounce"}):_.jsx(CC,{className:"w-10 h-10"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"text-xl font-semibold text-slate-800 mb-2",children:e?"Drop files here":"Upload Schedules"}),_.jsx("p",{className:"text-slate-500 text-sm max-w-xs mx-auto",children:"Drag and drop your Excel or CSV files here, or click to browse."})]})]}),_.jsx("div",{className:vm("absolute inset-0 bg-gradient-to-br from-primary-500/5 to-purple-500/5 transition-opacity duration-500",e?"opacity-100":"opacity-0")})]}),_.jsx(ws,{children:n&&_.jsxs(Pt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 p-4 bg-red-50 text-red-600 rounded-xl flex items-center gap-3 text-sm font-medium",children:[_.jsx(SC,{className:"w-5 h-5 flex-shrink-0"}),n]})})]})},jP=({categories:t,onConfirm:e,initialRates:r={}})=>{const[n,a]=xe.useState(r);xe.useEffect(()=>{const u={...n};let f=!1;t.forEach(h=>{u[h]===void 0&&(u[h]=0,f=!0)}),f&&a(u)},[t]);const i=(u,f)=>{const h=parseFloat(f)||0;a(m=>({...m,[u]:h}))},l=u=>{u.preventDefault(),e(n)};return _.jsxs(Pt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"w-full max-w-4xl mx-auto bg-white rounded-3xl shadow-xl shadow-slate-200/50 overflow-hidden border border-slate-100",children:[_.jsxs("div",{className:"p-8 border-b border-slate-100 bg-slate-50/50 flex items-center gap-4",children:[_.jsx("div",{className:"p-3 bg-primary-100 text-primary-600 rounded-xl",children:_.jsx(bP,{className:"w-6 h-6"})}),_.jsxs("div",{children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Configure Rates"}),_.jsx("p",{className:"text-slate-500",children:"Assign payment rates for each category found in the schedule."})]})]}),_.jsxs("form",{onSubmit:l,className:"p-8",children:[_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((u,f)=>_.jsxs(Pt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:f*.05},className:"group",children:[_.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2 group-hover:text-primary-600 transition-colors",children:u}),_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400 group-focus-within:text-primary-500 transition-colors",children:_.jsx(bp,{className:"w-4 h-4"})}),_.jsx("input",{type:"number",min:"0",step:"0.01",value:n[u]||"",onChange:h=>i(u,h.target.value),className:"block w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none font-medium text-slate-800",placeholder:"0.00"})]})]},u))}),_.jsx("div",{className:"mt-10 flex justify-end",children:_.jsxs("button",{type:"submit",className:"flex items-center gap-2 bg-primary-600 hover:bg-primary-700 text-white px-8 py-3 rounded-xl font-semibold shadow-lg shadow-primary-600/20 hover:shadow-primary-600/30 transform hover:-translate-y-0.5 transition-all",children:["Generate Report",_.jsx(Pm,{className:"w-5 h-5"})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Um={};Um.version="0.18.5";var RC=1252,UP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Oy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},My=function(t){UP.indexOf(t)!=-1&&(RC=Oy[0]=t)};function zP(){My(1252)}var ys=function(t){My(t)};function Py(){ys(1200),zP()}function uA(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function HP(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function DC(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Yf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?HP(t.slice(2)):e==254&&r==255?DC(t.slice(2)):e==65279?t.slice(1):t},Kd=function(e){return String.fromCharCode(e)},fA=function(e){return String.fromCharCode(e)},Ih,Do="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fh(t){for(var e="",r=0,n=0,a=0,i=0,l=0,u=0,f=0,h=0;h<t.length;)r=t.charCodeAt(h++),i=r>>2,n=t.charCodeAt(h++),l=(r&3)<<4|n>>4,a=t.charCodeAt(h++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=Do.charAt(i)+Do.charAt(l)+Do.charAt(u)+Do.charAt(f);return e}function ka(t){var e="",r=0,n=0,a=0,i=0,l=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)i=Do.indexOf(t.charAt(h++)),l=Do.indexOf(t.charAt(h++)),r=i<<2|l>>4,e+=String.fromCharCode(r),u=Do.indexOf(t.charAt(h++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=Do.indexOf(t.charAt(h++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var St=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),zi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Uo(t){return St?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function hA(t){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Na=function(e){return St?zi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Cp(t){if(typeof ArrayBuffer>"u")return Na(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Jo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function GP(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Ly(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Ly(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var hn=St?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:zi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function qP(t){for(var e=[],r=0,n=t.length+250,a=Uo(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++i)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Uo(65535),n=65530)}return e.push(a.slice(0,r)),hn(e)}var Qn=/\u0000/g,Qf=/[\u0001-\u0006]/g;function hu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function _s(t,e){var r=""+t;return r.length>=e?r:Fr("0",e-r.length)+r}function Vy(t,e){var r=""+t;return r.length>=e?r:Fr(" ",e-r.length)+r}function zm(t,e){var r=""+t;return r.length>=e?r:r+Fr(" ",e-r.length)}function WP(t,e){var r=""+Math.round(t);return r.length>=e?r:Fr("0",e-r.length)+r}function XP(t,e){var r=""+t;return r.length>=e?r:Fr("0",e-r.length)+r}var dA=Math.pow(2,32);function Qc(t,e){if(t>dA||t<-dA)return WP(t,e);var r=Math.round(t);return XP(r,e)}function Hm(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var mA=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $P(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},pA={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},KP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gm(t,e,r){for(var n=t<0?-1:1,a=t*n,i=0,l=1,u=0,f=1,h=0,m=0,x=Math.floor(a);h<e&&(x=Math.floor(a),u=x*l+i,m=x*h+f,!(a-x<5e-8));)a=1/(a-x),i=l,l=u,f=h,h=m;if(m>e&&(h>e?(m=f,u=i):(m=h,u=l)),!r)return[0,n*u,m];var v=Math.floor(n*u/m);return[v,n*u-v*m,m]}function Ol(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),i=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=tL(f,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var IC=new Date(1899,11,31,0,0,0),YP=IC.getTime(),QP=new Date(1900,2,1,0,0,0);function FC(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=QP&&(r+=1440*60*1e3),(r-(YP+(t.getTimezoneOffset()-IC.getTimezoneOffset())*6e4))/(1440*60*1e3)}function By(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function JP(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function ZP(t){var e=t<0?12:11,r=By(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function eL(t){var e=By(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Oh(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=ZP(t):e===10?r=t.toFixed(10).substr(0,12):r=eL(t),By(JP(r.toUpperCase()))}function ql(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Oh(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ts(14,FC(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function tL(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function rL(t,e,r,n){var a="",i=0,l=0,u=r.y,f,h=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,h=2;break;default:f=u%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,h=e.length;break;case 3:return dx[r.m-1][1];case 5:return dx[r.m-1][0];default:return dx[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,h=e.length;break;case 3:return mA[r.q][0];default:return mA[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?_s(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),e==="s"?i===0?"0":""+i/l:(a=_s(i,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:f=u,h=1;break}var m=h>0?_s(f,h):"";return m}function Io(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var OC=/%/g;function nL(t,e,r){var n=e.replace(OC,""),a=e.length-n.length;return ki(t,n,r*Math.pow(10,2*a))+Fr("%",a)}function aL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function MC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+MC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,m){return f+h+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var PC=/# (\?+)( ?)\/( ?)(\d+)/;function sL(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),i=Math.floor(a/n),l=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(l===0?Fr(" ",t[1].length+1+t[4].length):Vy(l,t[1].length)+t[2]+"/"+t[3]+_s(u,t[4].length))}function iL(t,e,r){return r+(e===0?"":""+e)+Fr(" ",t[1].length+2+t[4].length)}var LC=/^#*0*\.([0#]+)/,VC=/\).*[0#]/,BC=/\(###\) ###\\?-####/;function $n(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function gA(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function xA(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function oL(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function lL(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ga(t,e,r){if(t.charCodeAt(0)===40&&!e.match(VC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ga("n",n,r):"("+Ga("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return aL(t,e,r);if(e.indexOf("%")!==-1)return nL(t,e,r);if(e.indexOf("E")!==-1)return MC(e,r);if(e.charCodeAt(0)===36)return"$"+Ga(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,l,u,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Qc(f,e.length);if(e.match(/^[#?]+$/))return a=Qc(r,0),a==="0"&&(a=""),a.length>e.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(PC))return sL(i,f,h);if(e.match(/^#+0+$/))return h+Qc(f,e.length-e.indexOf("0"));if(i=e.match(LC))return a=gA(r,i[1].length).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])).replace(/\.(\d*)$/,function(w,T){return"."+T+Fr("0",$n(i[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+gA(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+Io(Qc(f,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ga(t,e,-r):Io(""+(Math.floor(r)+oL(r,i[1].length)))+"."+_s(xA(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Ga(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hu(Ga(t,e.replace(/[\\-]/g,""),r)),l=0,hu(hu(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(e.match(BC))return a=Ga(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),u=Gm(f,Math.pow(10,l)-1,!1),a=""+h,m=ki("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=zm(u[2],l),m.length<i[4].length&&(m=$n(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),u=Gm(f,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Vy(u[1],l)+i[2]+"/"+i[3]+zm(u[2],l):Fr(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Qc(r,0),e.length<=a.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=e.indexOf(".")-l,v=e.length-a.length-x;return $n(e.substr(0,x)+a+e.substr(e.length-v))}if(i=e.match(/^00,000\.([#0]*0)$/))return l=xA(r,i[1].length),r<0?"-"+Ga(t,e,-r):Io(lL(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?_s(0,3-w.length):"")+w})+"."+_s(l,i[1].length);switch(e){case"###,##0.00":return Ga(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var E=Io(Qc(f,0));return E!=="0"?h+E:"";case"###,###.00":return Ga(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ga(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function cL(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uL(t,e,r){var n=e.replace(OC,""),a=e.length-n.length;return ki(t,n,r*Math.pow(10,2*a))+Fr("%",a)}function jC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+jC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,m){return f+h+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Bs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(VC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bs("n",n,r):"("+Bs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return cL(t,e,r);if(e.indexOf("%")!==-1)return uL(t,e,r);if(e.indexOf("E")!==-1)return jC(e,r);if(e.charCodeAt(0)===36)return"$"+Bs(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,l,u,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+_s(f,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(PC))return iL(i,f,h);if(e.match(/^#+0+$/))return h+_s(f,e.length-e.indexOf("0"));if(i=e.match(LC))return a=(""+r).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])),a=a.replace(/\.(\d*)$/,function(w,T){return"."+T+Fr("0",$n(i[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+Io(""+f);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bs(t,e,-r):Io(""+r)+"."+Fr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Bs(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hu(Bs(t,e.replace(/[\\-]/g,""),r)),l=0,hu(hu(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(e.match(BC))return a=Bs(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),u=Gm(f,Math.pow(10,l)-1,!1),a=""+h,m=ki("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=zm(u[2],l),m.length<i[4].length&&(m=$n(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),u=Gm(f,Math.pow(10,l)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Vy(u[1],l)+i[2]+"/"+i[3]+zm(u[2],l):Fr(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var x=e.indexOf(".")-l,v=e.length-a.length-x;return $n(e.substr(0,x)+a+e.substr(e.length-v))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Bs(t,e,-r):Io(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?_s(0,3-w.length):"")+w})+"."+_s(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=Io(""+f);return E!=="0"?h+E:"";default:if(e.match(/\.[0#?]*$/))return Bs(t,e.slice(0,e.lastIndexOf(".")),r)+$n(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ki(t,e,r){return(r|0)===r?Bs(t,e,r):Ga(t,e,r)}function fL(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var UC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Hm(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(UC))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function hL(t,e,r,n){for(var a=[],i="",l=0,u="",f="t",h,m,x,v="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!Hm(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(x=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(x);a[a.length]={t:"t",v:i},++l;break;case"\\":var E=t.charAt(++l),w=E==="("||E===")"?E:"t";a[a.length]={t:w,v:E},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(h==null&&(h=Ol(e,r,t.charAt(l+1)==="2"),h==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},f=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Ol(e,r),h==null))return"";for(i=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)i+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),a[a.length]={t:u,v:i},f=u;break;case"A":case"a":case"":var T={t:u,v:u};if(h==null&&(h=Ol(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(h!=null&&(T.v=h.H>=12?"P":"A"),T.t="T",v="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(h!=null&&(T.v=h.H>=12?"PM":"AM"),T.t="T",l+=5,v="h"):t.substr(l,5).toUpperCase()==="/"?(h!=null&&(T.v=h.H>=12?"":""),T.t="T",l+=5,v="h"):(T.t="t",++l),h==null&&T.t==="T")return"";a[a.length]=T,f=u;break;case"[":for(i=u;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(UC)){if(h==null&&(h=Ol(e,r),h==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pu(t)||(a[a.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=u;++l<t.length&&(u=t.charAt(l))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;t.charAt(++l)===u;)i+=u;a[a.length]={t:u,v:i},f=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var A=0,I=0,O;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=v,f="h",A<1&&(A=1);break;case"s":(O=a[l].v.match(/\.0+$/))&&(I=Math.max(I,O[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&a[l].v.match(/[Hh]/)&&(A=1),A<2&&a[l].v.match(/[Mm]/)&&(A=2),A<3&&a[l].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var D="",q;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=rL(a[l].t.charCodeAt(0),a[l].v,h,I),a[l].t="t";break;case"n":case"?":for(q=l+1;a[q]!=null&&((u=a[q].t)==="?"||u==="D"||(u===" "||u==="t")&&a[q+1]!=null&&(a[q+1].t==="?"||a[q+1].t==="t"&&a[q+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[q].v==="/"||a[q].v===" "&&a[q+1]!=null&&a[q+1].t=="?"));)a[l].v+=a[q].v,a[q]={v:"",t:";"},++q;D+=a[l].v,l=q-1;break;case"G":a[l].t="t",a[l].v=ql(e,r);break}var Y="",W,N;if(D.length>0){D.charCodeAt(0)==40?(W=e<0&&D.charCodeAt(0)===45?-e:e,N=ki("n",D,W)):(W=e<0&&n>1?-e:e,N=ki("n",D,W),W<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),q=N.length-1;var b=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){b=l;break}var k=a.length;if(b===a.length&&N.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(q>=a[l].v.length-1?(q-=a[l].v.length,a[l].v=N.substr(q+1,a[l].v.length)):q<0?a[l].v="":(a[l].v=N.substr(0,q+1),q=-1),a[l].t="t",k=l);q>=0&&k<a.length&&(a[k].v=N.substr(0,q+1)+a[k].v)}else if(b!==a.length&&N.indexOf("E")===-1){for(q=N.indexOf(".")-1,l=b;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===b?a[l].v.indexOf(".")-1:a[l].v.length-1,Y=a[l].v.substr(m+1);m>=0;--m)q>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(Y=N.charAt(q--)+Y);a[l].v=Y,a[l].t="t",k=l}for(q>=0&&k<a.length&&(a[k].v=N.substr(0,q+1)+a[k].v),q=N.indexOf(".")+1,l=b;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==b)){for(m=a[l].v.indexOf(".")>-1&&l===b?a[l].v.indexOf(".")+1:0,Y=a[l].v.substr(0,m);m<a[l].v.length;++m)q<N.length&&(Y+=N.charAt(q++));a[l].v=Y,a[l].t="t",k=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(W=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=ki(a[l].t,a[l].v,W),a[l].t="t");var F="";for(l=0;l!==a.length;++l)a[l]!=null&&(F+=a[l].v);return F}var vA=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yA(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function dL(t,e){var r=fL(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(vA),u=r[1].match(vA);return yA(e,l)?[n,r[0]]:yA(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,i]}function ts(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:lt)[t],n==null&&(n=r.table&&r.table[pA[t]]||lt[pA[t]]),n==null&&(n=KP[t]||"General");break}if(Hm(n,0))return ql(e,r);e instanceof Date&&(e=FC(e,r.date1904));var a=dL(n,e);if(Hm(a[1]))return ql(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return hL(a[1],e,r,a[0])}function Ri(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(lt[r]==null){e<0&&(e=r);continue}if(lt[r]==t){e=r;break}}e<0&&(e=391)}return lt[e]=t,e}function kp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ri(t[e],e)}function Lu(){lt=$P()}var mL={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},zC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pL(t){var e=typeof t=="number"?lt[t]:t;return e=e.replace(zC,"(\\d+)"),new RegExp("^"+e+"$")}function gL(t,e,r){var n=-1,a=-1,i=-1,l=-1,u=-1,f=-1;(e.match(zC)||[]).forEach(function(x,v){var E=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=E;break;case"d":i=E;break;case"h":l=E;break;case"s":f=E;break;case"m":l>=0?u=E:a=E;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&u==-1&&f==-1?h:n==-1&&a==-1&&i==-1?m:h+"T"+m}var xL=(function(){var t={};t.version="1.2.0";function e(){for(var N=0,b=new Array(256),k=0;k!=256;++k)N=k,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,b[k]=N;return typeof Int32Array<"u"?new Int32Array(b):b}var r=e();function n(N){var b=0,k=0,F=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)P[F]=N[F];for(F=0;F!=256;++F)for(k=N[F],b=256+F;b<4096;b+=256)k=P[b]=k>>>8^N[k&255];var M=[];for(F=1;F!=16;++F)M[F-1]=typeof Int32Array<"u"?P.subarray(F*256,F*256+256):P.slice(F*256,F*256+256);return M}var a=n(r),i=a[0],l=a[1],u=a[2],f=a[3],h=a[4],m=a[5],x=a[6],v=a[7],E=a[8],w=a[9],T=a[10],A=a[11],I=a[12],O=a[13],D=a[14];function q(N,b){for(var k=b^-1,F=0,P=N.length;F<P;)k=k>>>8^r[(k^N.charCodeAt(F++))&255];return~k}function Y(N,b){for(var k=b^-1,F=N.length-15,P=0;P<F;)k=D[N[P++]^k&255]^O[N[P++]^k>>8&255]^I[N[P++]^k>>16&255]^A[N[P++]^k>>>24]^T[N[P++]]^w[N[P++]]^E[N[P++]]^v[N[P++]]^x[N[P++]]^m[N[P++]]^h[N[P++]]^f[N[P++]]^u[N[P++]]^l[N[P++]]^i[N[P++]]^r[N[P++]];for(F+=15;P<F;)k=k>>>8^r[(k^N[P++])&255];return~k}function W(N,b){for(var k=b^-1,F=0,P=N.length,M=0,j=0;F<P;)M=N.charCodeAt(F++),M<128?k=k>>>8^r[(k^M)&255]:M<2048?(k=k>>>8^r[(k^(192|M>>6&31))&255],k=k>>>8^r[(k^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,j=N.charCodeAt(F++)&1023,k=k>>>8^r[(k^(240|M>>8&7))&255],k=k>>>8^r[(k^(128|M>>2&63))&255],k=k>>>8^r[(k^(128|j>>6&15|(M&3)<<4))&255],k=k>>>8^r[(k^(128|j&63))&255]):(k=k>>>8^r[(k^(224|M>>12&15))&255],k=k>>>8^r[(k^(128|M>>6&63))&255],k=k>>>8^r[(k^(128|M&63))&255]);return~k}return t.table=r,t.bstr=q,t.buf=Y,t.str=W,t})(),st=(function(){var e={};e.version="1.2.1";function r(L,K){for(var z=L.split("/"),G=K.split("/"),X=0,Z=0,de=Math.min(z.length,G.length);X<de;++X){if(Z=z[X].length-G[X].length)return Z;if(z[X]!=G[X])return z[X]<G[X]?-1:1}return z.length-G.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var K=L.lastIndexOf("/");return K===-1?L:L.slice(0,K+1)}function a(L){if(L.charAt(L.length-1)=="/")return a(L.slice(0,-1));var K=L.lastIndexOf("/");return K===-1?L:L.slice(K+1)}function i(L,K){typeof K=="string"&&(K=new Date(K));var z=K.getHours();z=z<<6|K.getMinutes(),z=z<<5|K.getSeconds()>>>1,L.write_shift(2,z);var G=K.getFullYear()-1980;G=G<<4|K.getMonth()+1,G=G<<5|K.getDate(),L.write_shift(2,G)}function l(L){var K=L.read_shift(2)&65535,z=L.read_shift(2)&65535,G=new Date,X=z&31;z>>>=5;var Z=z&15;z>>>=4,G.setMilliseconds(0),G.setFullYear(z+1980),G.setMonth(Z-1),G.setDate(X);var de=K&31;K>>>=5;var Ne=K&63;return K>>>=6,G.setHours(K),G.setMinutes(Ne),G.setSeconds(de<<1),G}function u(L){Sn(L,0);for(var K={},z=0;L.l<=L.length-4;){var G=L.read_shift(2),X=L.read_shift(2),Z=L.l+X,de={};switch(G){case 21589:z=L.read_shift(1),z&1&&(de.mtime=L.read_shift(4)),X>5&&(z&2&&(de.atime=L.read_shift(4)),z&4&&(de.ctime=L.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}L.l=Z,K[G]=de}return K}var f;function h(){return f||(f={})}function m(L,K){if(L[0]==80&&L[1]==75)return da(L,K);if((L[0]|32)==109&&(L[1]|32)==105)return ni(L,K);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var z=3,G=512,X=0,Z=0,de=0,Ne=0,me=0,ye=[],ve=L.slice(0,512);Sn(ve,0);var ze=x(ve);switch(z=ze[0],z){case 3:G=512;break;case 4:G=4096;break;case 0:if(ze[1]==0)return da(L,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}G!==512&&(ve=L.slice(0,G),Sn(ve,28));var He=L.slice(0,G);v(ve,z);var Ke=ve.read_shift(4,"i");if(z===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);ve.l+=4,de=ve.read_shift(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),Ne=ve.read_shift(4,"i"),X=ve.read_shift(4,"i"),me=ve.read_shift(4,"i"),Z=ve.read_shift(4,"i");for(var je=-1,$e=0;$e<109&&(je=ve.read_shift(4,"i"),!(je<0));++$e)ye[$e]=je;var tt=E(L,G);A(me,Z,tt,G,ye);var $t=O(tt,de,ye,G);$t[de].name="!Directory",X>0&&Ne!==j&&($t[Ne].name="!MiniFAT"),$t[ye[0]].name="!FAT",$t.fat_addrs=ye,$t.ssz=G;var Kt={},cr=[],Cn=[],ss=[];D(de,$t,tt,cr,X,Kt,Cn,Ne),w(Cn,ss,cr),cr.shift();var is={FileIndex:Cn,FullPaths:ss};return K&&K.raw&&(is.raw={header:He,sectors:tt}),is}function x(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(Le,"Header Signature: "),L.l+=16;var K=L.read_shift(2,"u");return[L.read_shift(2,"u"),K]}function v(L,K){var z=9;switch(L.l+=2,z=L.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function E(L,K){for(var z=Math.ceil(L.length/K)-1,G=[],X=1;X<z;++X)G[X-1]=L.slice(X*K,(X+1)*K);return G[z-1]=L.slice(z*K),G}function w(L,K,z){for(var G=0,X=0,Z=0,de=0,Ne=0,me=z.length,ye=[],ve=[];G<me;++G)ye[G]=ve[G]=G,K[G]=z[G];for(;Ne<ve.length;++Ne)G=ve[Ne],X=L[G].L,Z=L[G].R,de=L[G].C,ye[G]===G&&(X!==-1&&ye[X]!==X&&(ye[G]=ye[X]),Z!==-1&&ye[Z]!==Z&&(ye[G]=ye[Z])),de!==-1&&(ye[de]=G),X!==-1&&G!=ye[G]&&(ye[X]=ye[G],ve.lastIndexOf(X)<Ne&&ve.push(X)),Z!==-1&&G!=ye[G]&&(ye[Z]=ye[G],ve.lastIndexOf(Z)<Ne&&ve.push(Z));for(G=1;G<me;++G)ye[G]===G&&(Z!==-1&&ye[Z]!==Z?ye[G]=ye[Z]:X!==-1&&ye[X]!==X&&(ye[G]=ye[X]));for(G=1;G<me;++G)if(L[G].type!==0){if(Ne=G,Ne!=ye[Ne])do Ne=ye[Ne],K[G]=K[Ne]+"/"+K[G];while(Ne!==0&&ye[Ne]!==-1&&Ne!=ye[Ne]);ye[G]=-1}for(K[0]+="/",G=1;G<me;++G)L[G].type!==2&&(K[G]+="/")}function T(L,K,z){for(var G=L.start,X=L.size,Z=[],de=G;z&&X>0&&de>=0;)Z.push(K.slice(de*M,de*M+M)),X-=M,de=Dl(z,de*4);return Z.length===0?be(0):hn(Z).slice(0,L.size)}function A(L,K,z,G,X){var Z=j;if(L===j){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var de=z[L],Ne=(G>>>2)-1;if(!de)return;for(var me=0;me<Ne&&(Z=Dl(de,me*4))!==j;++me)X.push(Z);A(Dl(de,G-4),K-1,z,G,X)}}function I(L,K,z,G,X){var Z=[],de=[];X||(X=[]);var Ne=G-1,me=0,ye=0;for(me=K;me>=0;){X[me]=!0,Z[Z.length]=me,de.push(L[me]);var ve=z[Math.floor(me*4/G)];if(ye=me*4&Ne,G<4+ye)throw new Error("FAT boundary crossed: "+me+" 4 "+G);if(!L[ve])break;me=Dl(L[ve],ye)}return{nodes:Z,data:DA([de])}}function O(L,K,z,G){var X=L.length,Z=[],de=[],Ne=[],me=[],ye=G-1,ve=0,ze=0,He=0,Ke=0;for(ve=0;ve<X;++ve)if(Ne=[],He=ve+K,He>=X&&(He-=X),!de[He]){me=[];var je=[];for(ze=He;ze>=0;){je[ze]=!0,de[ze]=!0,Ne[Ne.length]=ze,me.push(L[ze]);var $e=z[Math.floor(ze*4/G)];if(Ke=ze*4&ye,G<4+Ke)throw new Error("FAT boundary crossed: "+ze+" 4 "+G);if(!L[$e]||(ze=Dl(L[$e],Ke),je[ze]))break}Z[He]={nodes:Ne,data:DA([me])}}return Z}function D(L,K,z,G,X,Z,de,Ne){for(var me=0,ye=G.length?2:0,ve=K[L].data,ze=0,He=0,Ke;ze<ve.length;ze+=128){var je=ve.slice(ze,ze+128);Sn(je,64),He=je.read_shift(2),Ke=Wy(je,0,He-ye),G.push(Ke);var $e={name:Ke,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},tt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);tt!==0&&($e.ct=q(je,je.l-8));var $t=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);$t!==0&&($e.mt=q(je,je.l-8)),$e.start=je.read_shift(4,"i"),$e.size=je.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=j,$e.name=""),$e.type===5?(me=$e.start,X>0&&me!==j&&(K[me].name="!StreamData")):$e.size>=4096?($e.storage="fat",K[$e.start]===void 0&&(K[$e.start]=I(z,$e.start,K.fat_addrs,K.ssz)),K[$e.start].name=$e.name,$e.content=K[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:me!==j&&$e.start!==j&&K[me]&&($e.content=T($e,K[me].data,(K[Ne]||{}).data))),$e.content&&Sn($e.content,0),Z[Ke]=$e,de.push($e)}}function q(L,K){return new Date((Aa(L,K+4)/1e7*Math.pow(2,32)+Aa(L,K)/1e7-11644473600)*1e3)}function Y(L,K){return h(),m(f.readFileSync(L),K)}function W(L,K){var z=K&&K.type;switch(z||St&&Buffer.isBuffer(L)&&(z="buffer"),z||"base64"){case"file":return Y(L,K);case"base64":return m(Na(ka(L)),K);case"binary":return m(Na(L),K)}return m(L,K)}function N(L,K){var z=K||{},G=z.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=G+"/",L.FileIndex[0]={name:G,type:5}),z.CLSID&&(L.FileIndex[0].clsid=z.CLSID),b(L)}function b(L){var K="Sh33tJ5";if(!st.find(L,"/"+K)){var z=be(4);z[0]=55,z[1]=z[3]=50,z[2]=54,L.FileIndex.push({name:K,type:2,content:z,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+K),k(L)}}function k(L,K){N(L);for(var z=!1,G=!1,X=L.FullPaths.length-1;X>=0;--X){var Z=L.FileIndex[X];switch(Z.type){case 0:G?z=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(Z.R*Z.L*Z.C)&&(z=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!K)){var de=new Date(1987,1,19),Ne=0,me=Object.create?Object.create(null):{},ye=[];for(X=0;X<L.FullPaths.length;++X)me[L.FullPaths[X]]=!0,L.FileIndex[X].type!==0&&ye.push([L.FullPaths[X],L.FileIndex[X]]);for(X=0;X<ye.length;++X){var ve=n(ye[X][0]);G=me[ve],G||(ye.push([ve,{name:a(ve).replace("/",""),type:1,clsid:ne,ct:de,mt:de,content:null}]),me[ve]=!0)}for(ye.sort(function(Ke,je){return r(Ke[0],je[0])}),L.FullPaths=[],L.FileIndex=[],X=0;X<ye.length;++X)L.FullPaths[X]=ye[X][0],L.FileIndex[X]=ye[X][1];for(X=0;X<ye.length;++X){var ze=L.FileIndex[X],He=L.FullPaths[X];if(ze.name=a(He).replace("/",""),ze.L=ze.R=ze.C=-(ze.color=1),ze.size=ze.content?ze.content.length:0,ze.start=0,ze.clsid=ze.clsid||ne,X===0)ze.C=ye.length>1?1:-1,ze.size=0,ze.type=5;else if(He.slice(-1)=="/"){for(Ne=X+1;Ne<ye.length&&n(L.FullPaths[Ne])!=He;++Ne);for(ze.C=Ne>=ye.length?-1:Ne,Ne=X+1;Ne<ye.length&&n(L.FullPaths[Ne])!=n(He);++Ne);ze.R=Ne>=ye.length?-1:Ne,ze.type=1}else n(L.FullPaths[X+1]||"")==n(He)&&(ze.R=X+1),ze.type=2}}}function F(L,K){var z=K||{};if(z.fileType=="mad")return Qu(L,z);switch(k(L),z.fileType){case"zip":return kr(L,z)}var G=(function(Ke){for(var je=0,$e=0,tt=0;tt<Ke.FileIndex.length;++tt){var $t=Ke.FileIndex[tt];if($t.content){var Kt=$t.content.length;Kt>0&&(Kt<4096?je+=Kt+63>>6:$e+=Kt+511>>9)}}for(var cr=Ke.FullPaths.length+3>>2,Cn=je+7>>3,ss=je+127>>7,is=Cn+$e+cr+ss,pa=is+127>>7,Wi=pa<=109?0:Math.ceil((pa-109)/127);is+pa+Wi+127>>7>pa;)Wi=++pa<=109?0:Math.ceil((pa-109)/127);var kn=[1,Wi,pa,ss,cr,$e,je,0];return Ke.FileIndex[0].size=je<<6,kn[7]=(Ke.FileIndex[0].start=kn[0]+kn[1]+kn[2]+kn[3]+kn[4]+kn[5])+(kn[6]+7>>3),kn})(L),X=be(G[7]<<9),Z=0,de=0;{for(Z=0;Z<8;++Z)X.write_shift(1,De[Z]);for(Z=0;Z<8;++Z)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),Z=0;Z<3;++Z)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,G[2]),X.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:j),X.write_shift(4,G[3]),X.write_shift(-4,G[1]?G[0]-1:j),X.write_shift(4,G[1]),Z=0;Z<109;++Z)X.write_shift(-4,Z<G[2]?G[1]+Z:-1)}if(G[1])for(de=0;de<G[1];++de){for(;Z<236+de*127;++Z)X.write_shift(-4,Z<G[2]?G[1]+Z:-1);X.write_shift(-4,de===G[1]-1?j:de+1)}var Ne=function(Ke){for(de+=Ke;Z<de-1;++Z)X.write_shift(-4,Z+1);Ke&&(++Z,X.write_shift(-4,j))};for(de=Z=0,de+=G[1];Z<de;++Z)X.write_shift(-4,ae.DIFSECT);for(de+=G[2];Z<de;++Z)X.write_shift(-4,ae.FATSECT);Ne(G[3]),Ne(G[4]);for(var me=0,ye=0,ve=L.FileIndex[0];me<L.FileIndex.length;++me)ve=L.FileIndex[me],ve.content&&(ye=ve.content.length,!(ye<4096)&&(ve.start=de,Ne(ye+511>>9)));for(Ne(G[6]+7>>3);X.l&511;)X.write_shift(-4,ae.ENDOFCHAIN);for(de=Z=0,me=0;me<L.FileIndex.length;++me)ve=L.FileIndex[me],ve.content&&(ye=ve.content.length,!(!ye||ye>=4096)&&(ve.start=de,Ne(ye+63>>6)));for(;X.l&511;)X.write_shift(-4,ae.ENDOFCHAIN);for(Z=0;Z<G[4]<<2;++Z){var ze=L.FullPaths[Z];if(!ze||ze.length===0){for(me=0;me<17;++me)X.write_shift(4,0);for(me=0;me<3;++me)X.write_shift(4,-1);for(me=0;me<12;++me)X.write_shift(4,0);continue}ve=L.FileIndex[Z],Z===0&&(ve.start=ve.size?ve.start-1:j);var He=Z===0&&z.root||ve.name;if(ye=2*(He.length+1),X.write_shift(64,He,"utf16le"),X.write_shift(2,ye),X.write_shift(1,ve.type),X.write_shift(1,ve.color),X.write_shift(-4,ve.L),X.write_shift(-4,ve.R),X.write_shift(-4,ve.C),ve.clsid)X.write_shift(16,ve.clsid,"hex");else for(me=0;me<4;++me)X.write_shift(4,0);X.write_shift(4,ve.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,ve.start),X.write_shift(4,ve.size),X.write_shift(4,0)}for(Z=1;Z<L.FileIndex.length;++Z)if(ve=L.FileIndex[Z],ve.size>=4096)if(X.l=ve.start+1<<9,St&&Buffer.isBuffer(ve.content))ve.content.copy(X,X.l,0,ve.size),X.l+=ve.size+511&-512;else{for(me=0;me<ve.size;++me)X.write_shift(1,ve.content[me]);for(;me&511;++me)X.write_shift(1,0)}for(Z=1;Z<L.FileIndex.length;++Z)if(ve=L.FileIndex[Z],ve.size>0&&ve.size<4096)if(St&&Buffer.isBuffer(ve.content))ve.content.copy(X,X.l,0,ve.size),X.l+=ve.size+63&-64;else{for(me=0;me<ve.size;++me)X.write_shift(1,ve.content[me]);for(;me&63;++me)X.write_shift(1,0)}if(St)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function P(L,K){var z=L.FullPaths.map(function(me){return me.toUpperCase()}),G=z.map(function(me){var ye=me.split("/");return ye[ye.length-(me.slice(-1)=="/"?2:1)]}),X=!1;K.charCodeAt(0)===47?(X=!0,K=z[0].slice(0,-1)+K):X=K.indexOf("/")!==-1;var Z=K.toUpperCase(),de=X===!0?z.indexOf(Z):G.indexOf(Z);if(de!==-1)return L.FileIndex[de];var Ne=!Z.match(Qf);for(Z=Z.replace(Qn,""),Ne&&(Z=Z.replace(Qf,"!")),de=0;de<z.length;++de)if((Ne?z[de].replace(Qf,"!"):z[de]).replace(Qn,"")==Z||(Ne?G[de].replace(Qf,"!"):G[de]).replace(Qn,"")==Z)return L.FileIndex[de];return null}var M=64,j=-2,Le="d0cf11e0a1b11ae1",De=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:j,FREESECT:-1,HEADER_SIGNATURE:Le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(L,K,z){h();var G=F(L,z);f.writeFileSync(K,G)}function ie(L){for(var K=new Array(L.length),z=0;z<L.length;++z)K[z]=String.fromCharCode(L[z]);return K.join("")}function Fe(L,K){var z=F(L,K);switch(K&&K.type||"buffer"){case"file":return h(),f.writeFileSync(K.filename,z),z;case"binary":return typeof z=="string"?z:ie(z);case"base64":return Fh(typeof z=="string"?z:ie(z));case"buffer":if(St)return Buffer.isBuffer(z)?z:zi(z);case"array":return typeof z=="string"?Na(z):z}return z}var ee;function B(L){try{var K=L.InflateRaw,z=new K;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)ee=L;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function Q(L,K){if(!ee)return ti(L,K);var z=ee.InflateRaw,G=new z,X=G._processChunk(L.slice(L.l),G._finishFlushFlag);return L.l+=G.bytesRead,X}function J(L){return ee?ee.deflateRawSync(L):vt(L)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Oe(L){var K=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(K>>16|K>>8|K)&255}for(var ke=typeof Uint8Array<"u",se=ke?new Uint8Array(256):[],Me=0;Me<256;++Me)se[Me]=Oe(Me);function V(L,K){var z=se[L&255];return K<=8?z>>>8-K:(z=z<<8|se[L>>8&255],K<=16?z>>>16-K:(z=z<<8|se[L>>16&255],z>>>24-K))}function we(L,K){var z=K&7,G=K>>>3;return(L[G]|(z<=6?0:L[G+1]<<8))>>>z&3}function Ae(L,K){var z=K&7,G=K>>>3;return(L[G]|(z<=5?0:L[G+1]<<8))>>>z&7}function Je(L,K){var z=K&7,G=K>>>3;return(L[G]|(z<=4?0:L[G+1]<<8))>>>z&15}function Ye(L,K){var z=K&7,G=K>>>3;return(L[G]|(z<=3?0:L[G+1]<<8))>>>z&31}function ge(L,K){var z=K&7,G=K>>>3;return(L[G]|(z<=1?0:L[G+1]<<8))>>>z&127}function qe(L,K,z){var G=K&7,X=K>>>3,Z=(1<<z)-1,de=L[X]>>>G;return z<8-G||(de|=L[X+1]<<8-G,z<16-G)||(de|=L[X+2]<<16-G,z<24-G)||(de|=L[X+3]<<24-G),de&Z}function Be(L,K,z){var G=K&7,X=K>>>3;return G<=5?L[X]|=(z&7)<<G:(L[X]|=z<<G&255,L[X+1]=(z&7)>>8-G),K+3}function Qe(L,K,z){var G=K&7,X=K>>>3;return z=(z&1)<<G,L[X]|=z,K+1}function zt(L,K,z){var G=K&7,X=K>>>3;return z<<=G,L[X]|=z&255,z>>>=8,L[X+1]=z,K+8}function Wt(L,K,z){var G=K&7,X=K>>>3;return z<<=G,L[X]|=z&255,z>>>=8,L[X+1]=z&255,L[X+2]=z>>>8,K+16}function rr(L,K){var z=L.length,G=2*z>K?2*z:K+5,X=0;if(z>=K)return L;if(St){var Z=hA(G);if(L.copy)L.copy(Z);else for(;X<L.length;++X)Z[X]=L[X];return Z}else if(ke){var de=new Uint8Array(G);if(de.set)de.set(L);else for(;X<z;++X)de[X]=L[X];return de}return L.length=G,L}function ft(L){for(var K=new Array(L),z=0;z<L;++z)K[z]=0;return K}function lr(L,K,z){var G=1,X=0,Z=0,de=0,Ne=0,me=L.length,ye=ke?new Uint16Array(32):ft(32);for(Z=0;Z<32;++Z)ye[Z]=0;for(Z=me;Z<z;++Z)L[Z]=0;me=L.length;var ve=ke?new Uint16Array(me):ft(me);for(Z=0;Z<me;++Z)ye[X=L[Z]]++,G<X&&(G=X),ve[Z]=0;for(ye[0]=0,Z=1;Z<=G;++Z)ye[Z+16]=Ne=Ne+ye[Z-1]<<1;for(Z=0;Z<me;++Z)Ne=L[Z],Ne!=0&&(ve[Z]=ye[Ne+16]++);var ze=0;for(Z=0;Z<me;++Z)if(ze=L[Z],ze!=0)for(Ne=V(ve[Z],G)>>G-ze,de=(1<<G+4-ze)-1;de>=0;--de)K[Ne|de<<ze]=ze&15|Z<<4;return G}var en=ke?new Uint16Array(512):ft(512),ha=ke?new Uint16Array(32):ft(32);if(!ke){for(var yr=0;yr<512;++yr)en[yr]=0;for(yr=0;yr<32;++yr)ha[yr]=0}(function(){for(var L=[],K=0;K<32;K++)L.push(5);lr(L,ha,32);var z=[];for(K=0;K<=143;K++)z.push(8);for(;K<=255;K++)z.push(9);for(;K<=279;K++)z.push(7);for(;K<=287;K++)z.push(8);lr(z,en,288)})();var Zn=(function(){for(var K=ke?new Uint8Array(32768):[],z=0,G=0;z<Se.length-1;++z)for(;G<Se[z+1];++G)K[G]=z;for(;G<32768;++G)K[G]=29;var X=ke?new Uint8Array(259):[];for(z=0,G=0;z<ce.length-1;++z)for(;G<ce[z+1];++G)X[G]=z;function Z(Ne,me){for(var ye=0;ye<Ne.length;){var ve=Math.min(65535,Ne.length-ye),ze=ye+ve==Ne.length;for(me.write_shift(1,+ze),me.write_shift(2,ve),me.write_shift(2,~ve&65535);ve-- >0;)me[me.l++]=Ne[ye++]}return me.l}function de(Ne,me){for(var ye=0,ve=0,ze=ke?new Uint16Array(32768):[];ve<Ne.length;){var He=Math.min(65535,Ne.length-ve);if(He<10){for(ye=Be(me,ye,+(ve+He==Ne.length)),ye&7&&(ye+=8-(ye&7)),me.l=ye/8|0,me.write_shift(2,He),me.write_shift(2,~He&65535);He-- >0;)me[me.l++]=Ne[ve++];ye=me.l*8;continue}ye=Be(me,ye,+(ve+He==Ne.length)+2);for(var Ke=0;He-- >0;){var je=Ne[ve];Ke=(Ke<<5^je)&32767;var $e=-1,tt=0;if(($e=ze[Ke])&&($e|=ve&-32768,$e>ve&&($e-=32768),$e<ve))for(;Ne[$e+tt]==Ne[ve+tt]&&tt<250;)++tt;if(tt>2){je=X[tt],je<=22?ye=zt(me,ye,se[je+1]>>1)-1:(zt(me,ye,3),ye+=5,zt(me,ye,se[je-23]>>5),ye+=3);var $t=je<8?0:je-4>>2;$t>0&&(Wt(me,ye,tt-ce[je]),ye+=$t),je=K[ve-$e],ye=zt(me,ye,se[je]>>3),ye-=3;var Kt=je<4?0:je-2>>1;Kt>0&&(Wt(me,ye,ve-$e-Se[je]),ye+=Kt);for(var cr=0;cr<tt;++cr)ze[Ke]=ve&32767,Ke=(Ke<<5^Ne[ve])&32767,++ve;He-=tt-1}else je<=143?je=je+48:ye=Qe(me,ye,1),ye=zt(me,ye,se[je]),ze[Ke]=ve&32767,++ve}ye=zt(me,ye,0)-1}return me.l=(ye+7)/8|0,me.l}return function(me,ye){return me.length<8?Z(me,ye):de(me,ye)}})();function vt(L){var K=be(50+Math.floor(L.length*1.1)),z=Zn(L,K);return K.slice(0,z)}var fr=ke?new Uint16Array(32768):ft(32768),pn=ke?new Uint16Array(32768):ft(32768),Ht=ke?new Uint16Array(128):ft(128),hr=1,Gn=1;function wr(L,K){var z=Ye(L,K)+257;K+=5;var G=Ye(L,K)+1;K+=5;var X=Je(L,K)+4;K+=4;for(var Z=0,de=ke?new Uint8Array(19):ft(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,ye=ke?new Uint8Array(8):ft(8),ve=ke?new Uint8Array(8):ft(8),ze=de.length,He=0;He<X;++He)de[te[He]]=Z=Ae(L,K),me<Z&&(me=Z),ye[Z]++,K+=3;var Ke=0;for(ye[0]=0,He=1;He<=me;++He)ve[He]=Ke=Ke+ye[He-1]<<1;for(He=0;He<ze;++He)(Ke=de[He])!=0&&(Ne[He]=ve[Ke]++);var je=0;for(He=0;He<ze;++He)if(je=de[He],je!=0){Ke=se[Ne[He]]>>8-je;for(var $e=(1<<7-je)-1;$e>=0;--$e)Ht[Ke|$e<<je]=je&7|He<<3}var tt=[];for(me=1;tt.length<z+G;)switch(Ke=Ht[ge(L,K)],K+=Ke&7,Ke>>>=3){case 16:for(Z=3+we(L,K),K+=2,Ke=tt[tt.length-1];Z-- >0;)tt.push(Ke);break;case 17:for(Z=3+Ae(L,K),K+=3;Z-- >0;)tt.push(0);break;case 18:for(Z=11+ge(L,K),K+=7;Z-- >0;)tt.push(0);break;default:tt.push(Ke),me<Ke&&(me=Ke);break}var $t=tt.slice(0,z),Kt=tt.slice(z);for(He=z;He<286;++He)$t[He]=0;for(He=G;He<30;++He)Kt[He]=0;return hr=lr($t,fr,286),Gn=lr(Kt,pn,30),K}function hc(L,K){if(L[0]==3&&!(L[1]&3))return[Uo(K),2];for(var z=0,G=0,X=hA(K||1<<18),Z=0,de=X.length>>>0,Ne=0,me=0;(G&1)==0;){if(G=Ae(L,z),z+=3,G>>>1)G>>1==1?(Ne=9,me=5):(z=wr(L,z),Ne=hr,me=Gn);else{z&7&&(z+=8-(z&7));var ye=L[z>>>3]|L[(z>>>3)+1]<<8;if(z+=32,ye>0)for(!K&&de<Z+ye&&(X=rr(X,Z+ye),de=X.length);ye-- >0;)X[Z++]=L[z>>>3],z+=8;continue}for(;;){!K&&de<Z+32767&&(X=rr(X,Z+32767),de=X.length);var ve=qe(L,z,Ne),ze=G>>>1==1?en[ve]:fr[ve];if(z+=ze&15,ze>>>=4,(ze>>>8&255)===0)X[Z++]=ze;else{if(ze==256)break;ze-=257;var He=ze<8?0:ze-4>>2;He>5&&(He=0);var Ke=Z+ce[ze];He>0&&(Ke+=qe(L,z,He),z+=He),ve=qe(L,z,me),ze=G>>>1==1?ha[ve]:pn[ve],z+=ze&15,ze>>>=4;var je=ze<4?0:ze-2>>1,$e=Se[ze];for(je>0&&($e+=qe(L,z,je),z+=je),!K&&de<Ke&&(X=rr(X,Ke+100),de=X.length);Z<Ke;)X[Z]=X[Z-$e],++Z}}}return K?[X,z+7>>>3]:[X.slice(0,Z),z+7>>>3]}function ti(L,K){var z=L.slice(L.l||0),G=hc(z,K);return L.l+=G[1],G[0]}function rl(L,K){if(L)typeof console<"u"&&console.error(K);else throw new Error(K)}function da(L,K){var z=L;Sn(z,0);var G=[],X=[],Z={FileIndex:G,FullPaths:X};N(Z,{root:K.root});for(var de=z.length-4;(z[de]!=80||z[de+1]!=75||z[de+2]!=5||z[de+3]!=6)&&de>=0;)--de;z.l=de+4,z.l+=4;var Ne=z.read_shift(2);z.l+=6;var me=z.read_shift(4);for(z.l=me,de=0;de<Ne;++de){z.l+=20;var ye=z.read_shift(4),ve=z.read_shift(4),ze=z.read_shift(2),He=z.read_shift(2),Ke=z.read_shift(2);z.l+=8;var je=z.read_shift(4),$e=u(z.slice(z.l+ze,z.l+ze+He));z.l+=ze+He+Ke;var tt=z.l;z.l=je+4,ri(z,ye,ve,Z,$e),z.l=tt}return Z}function ri(L,K,z,G,X){L.l+=2;var Z=L.read_shift(2),de=L.read_shift(2),Ne=l(L);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var me=L.read_shift(4),ye=L.read_shift(4),ve=L.read_shift(4),ze=L.read_shift(2),He=L.read_shift(2),Ke="",je=0;je<ze;++je)Ke+=String.fromCharCode(L[L.l++]);if(He){var $e=u(L.slice(L.l,L.l+He));($e[21589]||{}).mt&&(Ne=$e[21589].mt),((X||{})[21589]||{}).mt&&(Ne=X[21589].mt)}L.l+=He;var tt=L.slice(L.l,L.l+ye);switch(de){case 8:tt=Q(L,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var $t=!1;Z&8&&(me=L.read_shift(4),me==134695760&&(me=L.read_shift(4),$t=!0),ye=L.read_shift(4),ve=L.read_shift(4)),ye!=K&&rl($t,"Bad compressed size: "+K+" != "+ye),ve!=z&&rl($t,"Bad uncompressed size: "+z+" != "+ve),si(G,Ke,tt,{unsafe:!0,mt:Ne})}function kr(L,K){var z=K||{},G=[],X=[],Z=be(1),de=z.compression?8:0,Ne=0,me=0,ye=0,ve=0,ze=0,He=L.FullPaths[0],Ke=He,je=L.FileIndex[0],$e=[],tt=0;for(me=1;me<L.FullPaths.length;++me)if(Ke=L.FullPaths[me].slice(He.length),je=L.FileIndex[me],!(!je.size||!je.content||Ke=="Sh33tJ5")){var $t=ve,Kt=be(Ke.length);for(ye=0;ye<Ke.length;++ye)Kt.write_shift(1,Ke.charCodeAt(ye)&127);Kt=Kt.slice(0,Kt.l),$e[ze]=xL.buf(je.content,0);var cr=je.content;de==8&&(cr=J(cr)),Z=be(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,Ne),Z.write_shift(2,de),je.mt?i(Z,je.mt):Z.write_shift(4,0),Z.write_shift(-4,$e[ze]),Z.write_shift(4,cr.length),Z.write_shift(4,je.content.length),Z.write_shift(2,Kt.length),Z.write_shift(2,0),ve+=Z.length,G.push(Z),ve+=Kt.length,G.push(Kt),ve+=cr.length,G.push(cr),Z=be(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,Ne),Z.write_shift(2,de),Z.write_shift(4,0),Z.write_shift(-4,$e[ze]),Z.write_shift(4,cr.length),Z.write_shift(4,je.content.length),Z.write_shift(2,Kt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,$t),tt+=Z.l,X.push(Z),tt+=Kt.length,X.push(Kt),++ze}return Z=be(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,ze),Z.write_shift(2,ze),Z.write_shift(4,tt),Z.write_shift(4,ve),Z.write_shift(2,0),hn([hn(G),hn(X),Z])}var qn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ra(L,K){if(L.ctype)return L.ctype;var z=L.name||"",G=z.match(/\.([^\.]+)$/);return G&&qn[G[1]]||K&&(G=(z=K).match(/[\.\\]([^\.\\])+$/),G&&qn[G[1]])?qn[G[1]]:"application/octet-stream"}function ma(L){for(var K=Fh(L),z=[],G=0;G<K.length;G+=76)z.push(K.slice(G,G+76));return z.join(`\r
`)+`\r
`}function Yu(L){var K=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var ve=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],G=K.split(`\r
`),X=0;X<G.length;++X){var Z=G[X];if(Z.length==0){z.push("");continue}for(var de=0;de<Z.length;){var Ne=76,me=Z.slice(de,de+Ne);me.charAt(Ne-1)=="="?Ne--:me.charAt(Ne-2)=="="?Ne-=2:me.charAt(Ne-3)=="="&&(Ne-=3),me=Z.slice(de,de+Ne),de+=Ne,de<Z.length&&(me+="="),z.push(me)}}return z.join(`\r
`)}function dc(L){for(var K=[],z=0;z<L.length;++z){for(var G=L[z];z<=L.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+L[++z];K.push(G)}for(var X=0;X<K.length;++X)K[X]=K[X].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return Na(K.join(`\r
`))}function Da(L,K,z){for(var G="",X="",Z="",de,Ne=0;Ne<10;++Ne){var me=K[Ne];if(!me||me.match(/^\s*$/))break;var ye=me.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":G=ye[2].trim();break;case"content-type":Z=ye[2].trim();break;case"content-transfer-encoding":X=ye[2].trim();break}}switch(++Ne,X.toLowerCase()){case"base64":de=Na(ka(K.slice(Ne).join("")));break;case"quoted-printable":de=dc(K.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var ve=si(L,G.slice(z.length),de,{unsafe:!0});Z&&(ve.ctype=Z)}function ni(L,K){if(ie(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=K&&K.root||"",G=(St&&Buffer.isBuffer(L)?L.toString("binary"):ie(L)).split(`\r
`),X=0,Z="";for(X=0;X<G.length;++X)if(Z=G[X],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),z||(z=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),Z.slice(0,z.length)!=z););var de=(G[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Ne="--"+(de[1]||""),me=[],ye=[],ve={FileIndex:me,FullPaths:ye};N(ve);var ze,He=0;for(X=0;X<G.length;++X){var Ke=G[X];Ke!==Ne&&Ke!==Ne+"--"||(He++&&Da(ve,G.slice(ze,X),z),ze=X)}return ve}function Qu(L,K){var z=K||{},G=z.boundary||"SheetJS";G="------="+G;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],Z=L.FullPaths[0],de=Z,Ne=L.FileIndex[0],me=1;me<L.FullPaths.length;++me)if(de=L.FullPaths[me].slice(Z.length),Ne=L.FileIndex[me],!(!Ne.size||!Ne.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(tt){return"_x"+tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(tt){return"_u"+tt.charCodeAt(0).toString(16)+"_"});for(var ye=Ne.content,ve=St&&Buffer.isBuffer(ye)?ye.toString("binary"):ie(ye),ze=0,He=Math.min(1024,ve.length),Ke=0,je=0;je<=He;++je)(Ke=ve.charCodeAt(je))>=32&&Ke<128&&++ze;var $e=ze>=He*4/5;X.push(G),X.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+de),X.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),X.push("Content-Type: "+Ra(Ne,de)),X.push(""),X.push($e?Yu(ve):ma(ve))}return X.push(G+`--\r
`),X.join(`\r
`)}function ai(L){var K={};return N(K,L),K}function si(L,K,z,G){var X=G&&G.unsafe;X||N(L);var Z=!X&&st.find(L,K);if(!Z){var de=L.FullPaths[0];K.slice(0,de.length)==de?de=K:(de.slice(-1)!="/"&&(de+="/"),de=(de+K).replace("//","/")),Z={name:a(K),type:2},L.FileIndex.push(Z),L.FullPaths.push(de),X||st.utils.cfb_gc(L)}return Z.content=z,Z.size=z?z.length:0,G&&(G.CLSID&&(Z.clsid=G.CLSID),G.mt&&(Z.mt=G.mt),G.ct&&(Z.ct=G.ct)),Z}function nl(L,K){N(L);var z=st.find(L,K);if(z){for(var G=0;G<L.FileIndex.length;++G)if(L.FileIndex[G]==z)return L.FileIndex.splice(G,1),L.FullPaths.splice(G,1),!0}return!1}function ii(L,K,z){N(L);var G=st.find(L,K);if(G){for(var X=0;X<L.FileIndex.length;++X)if(L.FileIndex[X]==G)return L.FileIndex[X].name=a(z),L.FullPaths[X]=z,!0}return!1}function as(L){k(L,!0)}return e.find=P,e.read=W,e.parse=m,e.write=Fe,e.writeFile=fe,e.utils={cfb_new:ai,cfb_add:si,cfb_del:nl,cfb_mov:ii,cfb_gc:as,ReadShift:lh,CheckField:uk,prep_blob:Sn,bconcat:hn,use_zlib:B,_deflateRaw:vt,_inflateRaw:ti,consts:ae},e})();function vL(t){return typeof t=="string"?Cp(t):Array.isArray(t)?GP(t):t}function o0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Cp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?zs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([vL(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=Jo(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function yL(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Mr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function _A(t,e){for(var r=[],n=Mr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Rp(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Dp(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function _L(t){for(var e=[],r=Mr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var qm=new Date(1899,11,30,0,0,0);function on(t,e){var r=t.getTime(),n=qm.getTime()+(t.getTimezoneOffset()-qm.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var HC=new Date,EL=qm.getTime()+(HC.getTimezoneOffset()-qm.getTimezoneOffset())*6e4,EA=HC.getTimezoneOffset();function Ip(t){var e=new Date;return e.setTime(t*24*60*60*1e3+EL),e.getTimezoneOffset()!==EA&&e.setTime(e.getTime()+(e.getTimezoneOffset()-EA)*6e4),e}function TL(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[i],10)}return e}var TA=new Date("2017-02-19T19:06:09.000Z"),GC=isNaN(TA.getFullYear())?new Date("2/19/17"):TA,wL=GC.getFullYear()==2017;function xr(t,e){var r=new Date(t);if(wL)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(GC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Wl(t,e){if(St&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return zs(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return zs(DC(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return zs(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return zs(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function vr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=vr(t[r]));return e}function Fr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ss(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var SL=["january","february","march","april","may","june","july","august","september","october","november","december"];function Tu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&SL.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var AL=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),l=[i[0]],u=1;u<i.length;++u)l.push(a),l.push(i[u]);return l}})();function qC(t){return t?t.content&&t.type?Wl(t.content,!0):t.data?Yf(t.data):t.asNodeBuffer&&St?Yf(t.asNodeBuffer().toString("binary")):t.asBinary?Yf(t.asBinary()):t._data&&t._data.getContent?Yf(Wl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function WC(t){if(!t)return null;if(t.data)return uA(t.data);if(t.asNodeBuffer&&St)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?uA(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function bL(t){return t&&t.name.slice(-4)===".bin"?WC(t):qC(t)}function $a(t,e){for(var r=t.FullPaths||Mr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function jy(t,e){var r=$a(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Yr(t,e,r){if(!r)return bL(jy(t,e));if(!e)return null;try{return Yr(t,e)}catch{return null}}function Ca(t,e,r){if(!r)return qC(jy(t,e));if(!e)return null;try{return Ca(t,e)}catch{return null}}function NL(t,e,r){return WC(jy(t,e))}function wA(t){for(var e=t.FullPaths||Mr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function wt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return St?n=zi(r):n=qP(r),st.utils.cfb_add(t,e,n)}st.utils.cfb_add(t,e,r)}else t.file(e,r)}function Uy(){return st.utils.cfb_new()}function XC(t,e){switch(e.type){case"base64":return st.read(t,{type:"base64"});case"binary":return st.read(t,{type:"binary"});case"buffer":case"array":return st.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Jf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var zr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,CL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,SA=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,kL=/<[^>]*>/g,Hn=zr.match(SA)?SA:kL,RL=/<\w*:/,DL=/<(\/?)\w+:/;function dt(t,e,r){for(var n={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(CL),u=0,f="",h=0,m="",x="",v=1;if(l)for(h=0;h!=l.length;++h){for(x=l[h],i=0;i!=x.length&&x.charCodeAt(i)!==61;++i);for(m=x.slice(0,i).trim();x.charCodeAt(i+1)==32;)++i;for(v=(a=x.charCodeAt(i+1))==34||a==39?1:0,f=x.slice(i+1+v,x.length-v),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var E=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[E]&&m.slice(u-3,u)=="ext")continue;n[E]=f,n[E.toLowerCase()]=f}}return n}function Zs(t){return t.replace(DL,"<$1")}var $C={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zy=Rp($C),Lt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(u,f){return $C[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,l)+r(a.slice(l+3))}})(),Hy=/[&<>'"]/g,IL=/[\u0000-\u0008\u000b-\u001f]/g;function tr(t){var e=t+"";return e.replace(Hy,function(r){return zy[r]}).replace(IL,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function AA(t){return tr(t).replace(/ /g,"_x0020_")}var KC=/[\u0000-\u001f]/g;function Gy(t){var e=t+"";return e.replace(Hy,function(r){return zy[r]}).replace(/\n/g,"<br/>").replace(KC,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function FL(t){var e=t+"";return e.replace(Hy,function(r){return zy[r]}).replace(KC,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var bA=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function OL(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function pr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mx(t){for(var e="",r=0,n=0,a=0,i=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function NA(t){var e=Uo(2*t.length),r,n,a=1,i=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[i++]=l&255,e[i++]=l>>>8,l=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function CA(t){return zi(t,"binary").toString("utf8")}var Yd="foo bar baz",or=St&&(CA(Yd)==mx(Yd)&&CA||NA(Yd)==mx(Yd)&&NA)||mx,zs=St?function(t){return zi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Mh=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),YC=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),ML=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),PL=/<\/?(?:vt:)?variant>/g,LL=/<(?:vt:)([^>]*)>([\s\S]*)</;function kA(t,e){var r=dt(t),n=t.match(ML(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var l=i.replace(PL,"").match(LL);l&&a.push({v:or(l[2]),t:l[1]})}),a}var QC=/(^\s|\s$|\n)/;function An(t,e){return"<"+t+(e.match(QC)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Ph(t){return Mr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ge(t,e,r){return"<"+t+(r!=null?Ph(r):"")+(e!=null?(e.match(QC)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function fv(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function VL(t,e){switch(typeof t){case"string":var r=Ge("vt:lpwstr",tr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ge((t|0)==t?"vt:i4":"vt:r8",tr(String(t)));case"boolean":return Ge("vt:bool",t?"true":"false")}if(t instanceof Date)return Ge("vt:filetime",fv(t));throw new Error("Unable to serialize "+t)}function qy(t){if(St&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return or(Jo(Ly(t)));throw new Error("Bad input format: expected Buffer or string")}var Lh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,nn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},rc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Sa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function BL(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function jL(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,l=n?-e:e;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var u=0;u<=5;++u,i/=256)t[r+u]=i&255;t[r+6]=(a&15)<<4|i&15,t[r+7]=a>>4|n}var RA=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,i=t[0][n].length;a<i;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},DA=St?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:zi(e)})):RA(t)}:RA,IA=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(bi(t,a)));return n.join("").replace(Qn,"")},Wy=St?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Qn,""):IA(t,e,r)}:IA,FA=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},JC=St?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):FA(t,e,r)}:FA,OA=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(eu(t,a)));return n.join("")},l0=St?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):OA(e,r,n)}:OA,ZC=function(t,e){var r=Aa(t,e);return r>0?l0(t,e+4,e+4+r-1):""},ek=ZC,tk=function(t,e){var r=Aa(t,e);return r>0?l0(t,e+4,e+4+r-1):""},rk=tk,nk=function(t,e){var r=2*Aa(t,e);return r>0?l0(t,e+4,e+4+r-1):""},ak=nk,sk=function(e,r){var n=Aa(e,r);return n>0?Wy(e,r+4,r+4+n):""},ik=sk,ok=function(t,e){var r=Aa(t,e);return r>0?l0(t,e+4,e+4+r):""},lk=ok,ck=function(t,e){return BL(t,e)},Wm=ck,Xy=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};St&&(ek=function(e,r){if(!Buffer.isBuffer(e))return ZC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},rk=function(e,r){if(!Buffer.isBuffer(e))return tk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},ak=function(e,r){if(!Buffer.isBuffer(e))return nk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},ik=function(e,r){if(!Buffer.isBuffer(e))return sk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},lk=function(e,r){if(!Buffer.isBuffer(e))return ok(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Wm=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):ck(e,r)},Xy=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var eu=function(t,e){return t[e]},bi=function(t,e){return t[e+1]*256+t[e]},UL=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Aa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Dl=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},zL=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function lh(t,e){var r="",n,a,i=[],l,u,f,h;switch(e){case"dbcs":if(h=this.l,St&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(bi(this,h)),h+=2;t*=2;break;case"utf8":r=l0(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Wy(this,this.l,this.l+t);break;case"wstr":return lh.call(this,t,"dbcs");case"lpstr-ansi":r=ek(this,this.l),t=4+Aa(this,this.l);break;case"lpstr-cp":r=rk(this,this.l),t=4+Aa(this,this.l);break;case"lpwstr":r=ak(this,this.l),t=4+2*Aa(this,this.l);break;case"lpp4":t=4+Aa(this,this.l),r=ik(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Aa(this,this.l),r=lk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=eu(this,this.l+t++))!==0;)i.push(Kd(l));r=i.join("");break;case"_wstr":for(t=0,r="";(l=bi(this,this.l+t))!==0;)i.push(Kd(l)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=eu(this,h),this.l=h+1,u=lh.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Kd(bi(this,h))),h+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return l=eu(this,h),this.l=h+1,u=lh.call(this,t-f,l?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Kd(eu(this,h))),h+=1}r=i.join("");break;default:switch(t){case 1:return n=eu(this,this.l),this.l++,n;case 2:return n=(e==="i"?UL:bi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Dl:zL)(this,this.l),this.l+=4,n):(a=Aa(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Wm(this,this.l):a=Wm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=JC(this,this.l,t);break}}return this.l+=t,r}var HL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},GL=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},qL=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function WL(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)qL(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,HL(this,e,this.l);break;case 8:if(n=8,r==="f"){jL(this,e,this.l);break}case 16:break;case-4:n=4,GL(this,e,this.l);break}return this.l+=n,this}function uk(t,e){var r=JC(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sn(t,e){t.l=e,t.read_shift=lh,t.chk=uk,t.write_shift=WL}function Un(t,e){t.l+=e}function be(t){var e=Uo(t);return Sn(e,0),e}function Hi(t,e,r){if(t){var n,a,i;Sn(t,t.l||0);for(var l=t.length,u=0,f=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var h=Hh[u]||Hh[65535];for(n=t.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=t.read_shift(1))&127)<<7*a;f=t.l+i;var m=h.f&&h.f(t,i,r);if(t.l=f,e(m,h,u))return}}}function ua(){var t=[],e=St?256:2048,r=function(h){var m=be(h);return Sn(m,0),m},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(h){return n&&h<n.length-n.l?n:(a(),n=r(Math.max(h+1,e)))},l=function(){return a(),hn(t)},u=function(h){a(),n=h,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:u,end:l,_bufs:t}}function Ve(t,e,r,n){var a=+e,i;if(!isNaN(a)){n||(n=Hh[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var l=t.next(i);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Xy(r)&&t.push(r)}}function ch(t,e,r){var n=vr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function MA(t,e,r){var n=vr(t);return n.s=ch(n.s,e.s,r),n.e=ch(n.e,e.s,r),n}function uh(t,e){if(t.cRel&&t.c<0)for(t=vr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=vr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ct(t);return!t.cRel&&t.cRel!=null&&(r=KL(r)),!t.rRel&&t.rRel!=null&&(r=XL(r)),r}function px(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+br(t.s.c)+":"+(t.e.cRel?"":"$")+br(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ur(t.s.r)+":"+(t.e.rRel?"":"$")+Ur(t.e.r):uh(t.s,e.biff)+":"+uh(t.e,e.biff)}function $y(t){return parseInt($L(t),10)-1}function Ur(t){return""+(t+1)}function XL(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $L(t){return t.replace(/\$(\d+)$/,"$1")}function Ky(t){for(var e=YL(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function br(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function KL(t){return t.replace(/^([A-Z])/,"$$$1")}function YL(t){return t.replace(/^\$([A-Z])/,"$1")}function QL(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ct(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function fa(t){var e=t.indexOf(":");return e==-1?{s:Nr(t),e:Nr(t)}:{s:Nr(t.slice(0,e)),e:Nr(t.slice(e+1))}}function Et(t,e){return typeof e>"u"||typeof e=="number"?Et(t.s,t.e):(typeof t!="string"&&(t=ct(t)),typeof e!="string"&&(e=ct(e)),t==e?t:t+":"+e)}function Vt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=t.length;for(r=0;n<i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function PA(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ts(t.z,r?on(e):e)}catch{}try{return t.w=ts((t.XF||{}).numFmtId||(r?14:0),r?on(e):e)}catch{return""+e}}function Pi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Gi[t.v]||t.v:e==null?PA(t,t.v):PA(t,e))}function Zo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function fk(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,i=t||(a?[]:{}),l=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Nr(n.origin):n.origin;l=f.r,u=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=Vt(i["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),l==-1&&(h.e.r=l=m.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[x].length;++v)if(!(typeof e[x][v]>"u")){var E={v:e[x][v]},w=l+x,T=u+v;if(h.s.r>w&&(h.s.r=w),h.s.c>T&&(h.s.c=T),h.e.r<w&&(h.e.r=w),h.e.c<T&&(h.e.c=T),e[x][v]&&typeof e[x][v]=="object"&&!Array.isArray(e[x][v])&&!(e[x][v]instanceof Date))E=e[x][v];else if(Array.isArray(E.v)&&(E.f=e[x][v][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||lt[14],n.cellDates?(E.t="d",E.w=ts(E.z,on(E.v))):(E.t="n",E.v=on(E.v),E.w=ts(E.z,E.v))):E.t="s";if(a)i[w]||(i[w]=[]),i[w][T]&&i[w][T].z&&(E.z=i[w][T].z),i[w][T]=E;else{var A=ct({c:T,r:w});i[A]&&i[A].z&&(E.z=i[A].z),i[A]=E}}}return h.s.c<1e7&&(i["!ref"]=Et(h)),i}function Vu(t,e){return fk(null,t,e)}function JL(t){return t.read_shift(4,"i")}function As(t,e){return e||(e=be(4)),e.write_shift(4,t),e}function jn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function dn(t,e){var r=!1;return e==null&&(r=!0,e=be(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function ZL(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function e9(t,e){return e||(e=be(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Yy(t,e){var r=t.l,n=t.read_shift(1),a=jn(t),i=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)i.push(ZL(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function t9(t,e){var r=!1;return e==null&&(r=!0,e=be(15+4*t.t.length)),e.write_shift(1,0),dn(t.t,e),r?e.slice(0,e.l):e}var r9=Yy;function n9(t,e){var r=!1;return e==null&&(r=!0,e=be(23+4*t.t.length)),e.write_shift(1,1),dn(t.t,e),e.write_shift(4,1),e9({},e),r?e.slice(0,e.l):e}function ns(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function nc(t,e){return e==null&&(e=be(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ac(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function sc(t,e){return e==null&&(e=be(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var a9=jn,hk=dn;function Qy(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Xm(t,e){var r=!1;return e==null&&(r=!0,e=be(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var s9=jn,hv=Qy,Jy=Xm;function Zy(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Wm([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Dl(e,0)>>2;return r?a/100:a}function dk(t,e){e==null&&(e=be(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function mk(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function i9(t,e){return e||(e=be(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ic=mk,Bu=i9;function Vn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Xl(t,e){return(e||be(8)).write_shift(8,t,"f")}function o9(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var h=Bl[a];h&&(e.rgb=Bh(h));break;case 2:e.rgb=Bh([l,u,f]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function $m(t,e){if(e||(e=be(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function l9(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function c9(t,e){e||(e=be(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function pk(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function u9(t){return pk(t,1)}function f9(t){return pk(t,2)}var e_=2,oa=3,Qd=11,LA=12,Km=19,Jd=64,h9=65,d9=71,m9=4108,p9=4126,un=80,gk=81,g9=[un,gk],dv={1:{n:"CodePage",t:e_},2:{n:"Category",t:un},3:{n:"PresentationFormat",t:un},4:{n:"ByteCount",t:oa},5:{n:"LineCount",t:oa},6:{n:"ParagraphCount",t:oa},7:{n:"SlideCount",t:oa},8:{n:"NoteCount",t:oa},9:{n:"HiddenCount",t:oa},10:{n:"MultimediaClipCount",t:oa},11:{n:"ScaleCrop",t:Qd},12:{n:"HeadingPairs",t:m9},13:{n:"TitlesOfParts",t:p9},14:{n:"Manager",t:un},15:{n:"Company",t:un},16:{n:"LinksUpToDate",t:Qd},17:{n:"CharacterCount",t:oa},19:{n:"SharedDoc",t:Qd},22:{n:"HyperlinksChanged",t:Qd},23:{n:"AppVersion",t:oa,p:"version"},24:{n:"DigSig",t:h9},26:{n:"ContentType",t:un},27:{n:"ContentStatus",t:un},28:{n:"Language",t:un},29:{n:"Version",t:un},255:{},2147483648:{n:"Locale",t:Km},2147483651:{n:"Behavior",t:Km},1919054434:{}},mv={1:{n:"CodePage",t:e_},2:{n:"Title",t:un},3:{n:"Subject",t:un},4:{n:"Author",t:un},5:{n:"Keywords",t:un},6:{n:"Comments",t:un},7:{n:"Template",t:un},8:{n:"LastAuthor",t:un},9:{n:"RevNumber",t:un},10:{n:"EditTime",t:Jd},11:{n:"LastPrinted",t:Jd},12:{n:"CreatedDate",t:Jd},13:{n:"ModifiedDate",t:Jd},14:{n:"PageCount",t:oa},15:{n:"WordCount",t:oa},16:{n:"CharCount",t:oa},17:{n:"Thumbnail",t:d9},18:{n:"Application",t:un},19:{n:"DocSecurity",t:oa},255:{},2147483648:{n:"Locale",t:Km},2147483651:{n:"Behavior",t:Km},1919054434:{}},VA={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},x9=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function v9(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var y9=v9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Bl=vr(y9),Gi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},xk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function t_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _9(t){var e=t_();if(!t||!t.match)return e;var r={};if((t.match(Hn)||[]).forEach(function(n){var a=dt(n);switch(a[0].replace(RL,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[pv[a.ContentType]]!==void 0&&e[pv[a.ContentType]].push(a.PartName);break}}),e.xmlns!==nn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function vk(t,e){var r=_L(pv),n=[],a;n[n.length]=zr,n[n.length]=Ge("Types",null,{xmlns:nn.CT,"xmlns:xsd":nn.xsd,"xmlns:xsi":nn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ge("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=Ge("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Zd[f][e.bookType]||Zd[f].xlsx}))},l=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Ge("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Zd[f][e.bookType]||Zd[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Ge("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[f][0]})})};return i("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var At={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vh(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function fh(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Hn)||[]).forEach(function(a){var i=dt(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:Jf(i.Target,e);r[u]=l,n[i.Id]=l}}),r["!id"]=n,r}function du(t){var e=[zr,Ge("Relationships",null,{xmlns:nn.RELS})];return Mr(t["!id"]).forEach(function(r){e[e.length]=Ge("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function er(t,e,r,n,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[At.HLINK,At.XPATH,At.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var E9="application/vnd.oasis.opendocument.spreadsheet";function T9(t,e){for(var r=qy(t),n,a;n=Lh.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=dt(n[0],!1),a.path=="/"&&a.type!==E9)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function w9(t){var e=[zr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function BA(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function S9(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function A9(t){var e=[zr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(BA(t[r][0],t[r][1])),e.push(S9("",t[r][0]));return e.push(BA("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function yk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Um.version+"</meta:generator></office:meta></office:document-meta>"}var es=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],b9=(function(){for(var t=new Array(es.length),e=0;e<es.length;++e){var r=es[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function _k(t){var e={};t=or(t);for(var r=0;r<es.length;++r){var n=es[r],a=t.match(b9[r]);a!=null&&a.length>0&&(e[n[1]]=Lt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=xr(e[n[1]]))}return e}function gx(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=tr(e),n[n.length]=r?Ge(t,e,r):An(t,e))}function Ek(t,e){var r=e||{},n=[zr,Ge("cp:coreProperties",null,{"xmlns:cp":nn.CORE_PROPS,"xmlns:dc":nn.dc,"xmlns:dcterms":nn.dcterms,"xmlns:dcmitype":nn.dcmitype,"xmlns:xsi":nn.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&gx("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:fv(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&gx("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:fv(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=es.length;++i){var l=es[i],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&gx(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var jl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Tk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wk(t,e,r,n){var a=[];if(typeof t=="string")a=kA(t,n);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(m){return{v:m}}));var l=typeof e=="string"?kA(e,n).map(function(m){return m.v}):e,u=0,f=0;if(l.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=l.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=l.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=l.slice(u,u+f);break}u+=f}}function N9(t,e,r){var n={};return e||(e={}),t=or(t),jl.forEach(function(a){var i=(t.match(Mh(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=Lt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wk(n.HeadingPairs,n.TitlesOfParts,e,r),e}function Sk(t){var e=[],r=Ge;return t||(t={}),t.Application="SheetJS",e[e.length]=zr,e[e.length]=Ge("Properties",null,{xmlns:nn.EXT_PROPS,"xmlns:vt":nn.vt}),jl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=tr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+tr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var C9=/<[^>]+>[^<]*/g;function k9(t,e){var r={},n="",a=t.match(C9);if(a)for(var i=0;i!=a.length;++i){var l=a[i],u=dt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Lt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),h=f[0].slice(4),m=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=Lt(m);break;case"bool":r[n]=pr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=xr(m);break;case"cy":case"error":r[n]=Lt(m);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,h,f)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function Ak(t){var e=[zr,Ge("Properties",null,{xmlns:nn.CUST_PROPS,"xmlns:vt":nn.vt})];if(!t)return e.join("");var r=1;return Mr(t).forEach(function(a){++r,e[e.length]=Ge("property",VL(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:tr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var gv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},xx;function R9(t,e,r){xx||(xx=Rp(gv)),e=xx[e]||e,t[e]=r}function D9(t,e){var r=[];return Mr(gv).map(function(n){for(var a=0;a<es.length;++a)if(es[a][1]==n)return es[a];for(a=0;a<jl.length;++a)if(jl[a][1]==n)return jl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(An(gv[n[1]]||n[1],a))}}),Ge("DocumentProperties",r.join(""),{xmlns:Sa.o})}function I9(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Mr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var l=0;l<es.length;++l)if(i==es[l][1])return;for(l=0;l<jl.length;++l)if(i==jl[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var u=t[i],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(Ge(AA(i),u,{"dt:dt":f}))}}),e&&Mr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var l=e[i],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Ge(AA(i),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Sa.o+'">'+a.join("")+"</"+n+">"}function r_(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function F9(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var l=be(8);return l.write_shift(4,n),l.write_shift(4,a),l}function bk(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function Nk(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function Ck(t,e,r){return e===31?Nk(t):bk(t,e,r)}function xv(t,e,r){return Ck(t,e,r===!1?0:4)}function O9(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return Ck(t,e,0)}function M9(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Qn,""),t.l-a&2&&(t.l+=2)}return r}function P9(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Qn,"");return r}function L9(t){var e=t.l,r=Ym(t,gk);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Ym(t,oa);return[r,n]}function V9(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(L9(t));return r}function jA(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var i=t.read_shift(4),l=t.read_shift(4);n[i]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Qn,"").replace(Qf,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function kk(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function B9(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Ym(t,e,r){var n=t.read_shift(2),a,i=r||{};if(t.l+=2,e!==LA&&n!==e&&g9.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===LA?n:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return bk(t,n,4).replace(Qn,"");case 31:return Nk(t);case 64:return r_(t);case 65:return kk(t);case 71:return B9(t);case 80:return xv(t,n,!i.raw).replace(Qn,"");case 81:return O9(t,n).replace(Qn,"");case 4108:return V9(t);case 4126:case 4127:return n==4127?M9(t):P9(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function UA(t,e){var r=be(4),n=be(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=be(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=F9(e);break;case 31:case 80:for(n=be(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return hn([r,n])}function zA(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),i=[],l=0,u=0,f=-1,h={};for(l=0;l!=a;++l){var m=t.read_shift(4),x=t.read_shift(4);i[l]=[m,x+r]}i.sort(function(O,D){return O[1]-D[1]});var v={};for(l=0;l!=a;++l){if(t.l!==i[l][1]){var E=!0;if(l>0&&e)switch(e[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,E=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],E=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],E=!1);break}if((!e||l==0)&&t.l<=i[l][1]&&(E=!1,t.l=i[l][1]),E)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(e){var w=e[i[l][0]];if(v[w.n]=Ym(t,w.t,{raw:!0}),w.p==="version"&&(v[w.n]=String(v[w.n]>>16)+"."+("0000"+String(v[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(v[w.n]){case 0:v[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ys(u=v[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[w.n])}}else if(i[l][0]===1){if(u=v.CodePage=Ym(t,e_),ys(u),f!==-1){var T=t.l;t.l=i[f][1],h=jA(t,u),t.l=T}}else if(i[l][0]===0){if(u===0){f=l,t.l=i[l+1][1];continue}h=jA(t,u)}else{var A=h[i[l][0]],I;switch(t[t.l]){case 65:t.l+=4,I=kk(t);break;case 30:t.l+=4,I=xv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,I=xv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,I=t.read_shift(4,"i");break;case 19:t.l+=4,I=t.read_shift(4);break;case 5:t.l+=4,I=t.read_shift(8,"f");break;case 11:t.l+=4,I=Br(t,4);break;case 64:t.l+=4,I=xr(r_(t));break;default:throw new Error("unparsed value: "+t[t.l])}v[A]=I}}return t.l=r+n,v}var Rk=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function j9(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function HA(t,e,r){var n=be(8),a=[],i=[],l=8,u=0,f=be(8),h=be(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),i.push(f),a.push(h),l+=8+f.length,!e){h=be(8),h.write_shift(4,0),a.unshift(h);var m=[be(4)];for(m[0].write_shift(4,t.length),u=0;u<t.length;++u){var x=t[u][0];for(f=be(8+2*(x.length+1)+(x.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,x.length+1),f.write_shift(0,x,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=hn(m),i.unshift(f),l+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(Rk.indexOf(t[u][0])>-1||Tk.indexOf(t[u][0])>-1)&&t[u][1]!=null){var v=t[u][1],E=0;if(e){E=+e[t[u][0]];var w=r[E];if(w.p=="version"&&typeof v=="string"){var T=v.split(".");v=(+T[0]<<16)+(+T[1]||0)}f=UA(w.t,v)}else{var A=j9(v);A==-1&&(A=31,v=String(v)),f=UA(A,v)}i.push(f),h=be(8),h.write_shift(4,e?E:2+u),a.push(h),l+=8+f.length}var I=8*(i.length+1);for(u=0;u<i.length;++u)a[u].write_shift(4,I),I+=i[u].length;return n.write_shift(4,l),n.write_shift(4,i.length),hn([n].concat(a).concat(i))}function GA(t,e,r){var n=t.content;if(!n)return{};Sn(n,0);var a,i,l,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),m=n.read_shift(16);if(m!==st.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),f=n.read_shift(4));var x=zA(n,e),v={SystemIdentifier:h};for(var E in x)v[E]=x[E];if(v.FMTID=i,a===1)return v;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var w;try{w=zA(n,null)}catch{}for(E in w)v[E]=w[E];return v.FMTID=[i,l],v}function qA(t,e,r,n,a,i){var l=be(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,st.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var f=HA(t,r,n);if(u.push(f),a){var h=HA(a,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+f.length),u.push(h)}return hn(u)}function Ao(t,e){return t.read_shift(e),null}function U9(t,e){e||(e=be(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function z9(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Br(t,e){return t.read_shift(e)===1}function Kn(t,e){return e||(e=be(2)),e.write_shift(2,+!!t),e}function Qr(t){return t.read_shift(2,"u")}function Ka(t,e){return e||(e=be(2)),e.write_shift(2,t),e}function Dk(t,e){return z9(t,e,Qr)}function H9(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Ik(t,e,r){return r||(r=be(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function c0(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function G9(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,i=1+(r&1),l=0,u,f={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var h=i==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,h);return a&&(t.l+=4*l),n&&(t.l+=u),f.t=m,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function q9(t){var e=t.t||"",r=be(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=be(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return hn(a)}function $l(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function u0(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):$l(t,n,r)}function oc(t,e,r){if(r.biff>5)return u0(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Fk(t,e,r){return r||(r=be(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function W9(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function X9(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Qn,"");return n&&(t.l+=24),a}function $9(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(Qn,"");return r+l}function K9(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return X9(t);case"0303000000000000c000000000000046":return $9(t);default:throw new Error("Unsupported Moniker "+r)}}function em(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Qn,""):"";return r}function WA(t,e){e||(e=be(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Y9(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var i,l,u,f,h="",m,x;a&16&&(i=em(t,r-t.l)),a&128&&(l=em(t,r-t.l)),(a&257)===257&&(u=em(t,r-t.l)),(a&257)===1&&(f=K9(t,r-t.l)),a&8&&(h=em(t,r-t.l)),a&32&&(m=t.read_shift(16)),a&64&&(x=r_(t)),t.l=r;var v=l||u||f||"";v&&h&&(v+="#"+h),v||(v="#"+h),a&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var E={Target:v};return m&&(E.guid=m),x&&(E.time=x),i&&(E.Tooltip=i),E}function Q9(t){var e=be(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(i==28)n=n.slice(1),WA(n,e);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),i&8&&WA(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Ok(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function Mk(t,e){var r=Ok(t);return r[3]=0,r}function ei(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Kl(t,e,r,n){return n||(n=be(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function J9(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Z9(t,e,r){return e===0?"":oc(t,e,r)}function eV(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),i=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,i,l]}function Pk(t){var e=t.read_shift(2),r=Zy(t);return[e,r]}function tV(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=c0(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,a}function Fp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function Lk(t,e){return e||(e=be(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Vk(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var rV=Vk;function Bk(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function nV(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function aV(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Dn(t){t.l+=2,t.l+=t.read_shift(2)}var sV={0:Dn,4:Dn,5:Dn,6:Dn,7:aV,8:Dn,9:Dn,10:Dn,11:Dn,12:Dn,13:nV,14:Dn,15:Dn,16:Dn,17:Dn,18:Dn,19:Dn,20:Dn,21:Bk};function iV(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(sV[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function tm(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function n_(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=be(a);return i.write_shift(2,n),i.write_shift(2,e),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function oV(t,e){return e===0||t.read_shift(2),1200}function lV(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=oc(t,0,r);return t.read_shift(e+n-t.l),a}function cV(t,e){var r=!e||e.biff==8,n=be(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function uV(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function fV(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=c0(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:i,name:l}}function hV(t,e){var r=!e||e.biff>=8?2:1,n=be(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function dV(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),i=[],l=0;l!=a&&t.l<r;++l)i.push(G9(t));return i.Count=n,i.Unique=a,i}function mV(t,e){var r=be(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=q9(t[a]);var i=hn([r].concat(n));return i.parts=[r.length].concat(n.map(function(l){return l.length})),i}function pV(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function gV(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function xV(t){var e=J9(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function vV(t){return t.read_shift(2),t.read_shift(4)}function XA(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function yV(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:i,CurTab:l,FirstTab:u,Selected:f,TabRatio:h}}function _V(){var t=be(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function EV(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function TV(t){var e=be(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function wV(){}function SV(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=c0(t,0,r),n}function AV(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,i=be(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function bV(t){var e=ei(t);return e.isst=t.read_shift(4),e}function NV(t,e,r,n){var a=be(10);return Kl(t,e,n,a),a.write_shift(4,r),a}function CV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=ei(t);r.biff==2&&t.l++;var i=u0(t,n-t.l,r);return a.val=i,a}function kV(t,e,r,n,a){var i=!a||a.biff==8,l=be(8+ +i+(1+i)*r.length);return Kl(t,e,n,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function RV(t,e,r){var n=t.read_shift(2),a=oc(t,0,r);return[n,a]}function DV(t,e,r,n){var a=r&&r.biff==5;n||(n=be(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var IV=oc;function $A(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,i=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:i,c:u},e:{r:l,c:f}}}function FV(t,e){var r=e.biff==8||!e.biff?4:2,n=be(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function OV(t){var e=t.read_shift(2),r=t.read_shift(2),n=Pk(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function MV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(Pk(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:i}}function PV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:i}}function LV(t,e,r,n){var a={},i=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return a.patternType=x9[u>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function VV(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=LV(t,e,n.fStyle,r),n}function KA(t,e,r,n){var a=r&&r.biff==5;n||(n=be(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function BV(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function jV(t){var e=be(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function YA(t,e,r){var n=ei(t);(r.biff==2||e==9)&&++t.l;var a=H9(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function UV(t,e,r,n,a,i){var l=be(8);return Kl(t,e,n,l),Ik(r,i,l),l}function zV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ei(t),a=Vn(t);return n.val=a,n}function HV(t,e,r,n){var a=be(14);return Kl(t,e,n,a),Xl(r,a),a}var QA=Z9;function GV(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=$l(t,i),u=[];n>t.l;)u.push(u0(t));return[i,a,l,u]}function JA(t,e,r){var n=t.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=tV(t,e-2,r)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var qV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ZA(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=$l(t,l,r);a&32&&(h=qV[h.charCodeAt(0)]);var m=n-t.l;r&&r.biff==2&&--m;var x=n==t.l||u===0||!(m>0)?[]:iz(t,m,r,u);return{chKey:i,Name:h,itab:f,rgce:x}}function jk(t,e,r){if(r.biff<8)return WV(t,e,r);for(var n=[],a=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(eV(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function WV(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=c0(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function XV(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),i=$l(t,n,r),l=$l(t,a,r);return[i,l]}function $V(t,e,r){var n=Vk(t);t.l++;var a=t.read_shift(1);return e-=8,[oz(t,e,r),a,n]}function eb(t,e,r){var n=rV(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,az(t,e,r)]}function KV(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function YV(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),u=oc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,i]}}function QV(t,e,r){return YV(t,e,r)}function JV(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Fp(t));return r}function ZV(t){var e=be(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Lk(t[r],e);return e}function e7(t,e,r){if(r&&r.biff<8)return r7(t,e,r);var n=Bk(t),a=iV(t,e-22,n[1]);return{cmo:n,ft:a}}var t7={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function r7(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((t7[n]||Un)(t,e,r)),{cmo:[a,n,i],ft:l}}function n7(t,e,r){var n=t.l,a="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=W9(t,6,r);var u=t.read_shift(2);t.read_shift(2),Qr(t,2);var f=t.read_shift(2);t.l+=f;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var m=t[t.l],x=$l(t,t.lens[h+1]-t.lens[h]-1);if(a+=x,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function a7(t,e){var r=Fp(t);t.l+=16;var n=Y9(t,e-24);return[r,n]}function s7(t){var e=be(24),r=Nr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return hn([e,Q9(t[1])])}function i7(t,e){t.read_shift(2);var r=Fp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Qn,""),[r,n]}function o7(t){var e=t[1].Tooltip,r=be(10+2*(e.length+1));r.write_shift(2,2048);var n=Nr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function l7(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=VA[r]||r,r=t.read_shift(2),e[1]=VA[r]||r,e}function c7(t){return t||(t=be(4)),t.write_shift(2,1),t.write_shift(2,1),t}function u7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Mk(t));return r}function f7(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Mk(t));return r}function h7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Uk(t,e,r){if(!r.cellStyles)return Un(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),i=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var h={s:a,e:i,w:l,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function d7(t,e){var r=be(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function m7(t,e){var r={};return e<32||(t.l+=16,r.header=Vn(t),r.footer=Vn(t),t.l+=2),r}function p7(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function g7(t){for(var e=be(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var x7=ei,v7=Dk,y7=u0;function _7(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function E7(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ei(t);++t.l;var a=oc(t,e-7,r);return n.t="str",n.val=a,n}function T7(t){var e=ei(t);++t.l;var r=Vn(t);return e.t="n",e.val=r,e}function w7(t,e,r){var n=be(15);return m0(n,t,e),n.write_shift(8,r,"f"),n}function S7(t){var e=ei(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function A7(t,e,r){var n=be(9);return m0(n,t,e),n.write_shift(2,r),n}function b7(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function N7(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function C7(t,e,r){var n=t.l+e,a=ei(t),i=t.read_shift(2),l=$l(t,i,r);return t.l=n,a.t="str",a.val=l,a}var k7=[2,3,48,49,131,139,140,245],vv=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Rp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var h=[],m=Uo(1);switch(f.type){case"base64":m=Na(ka(u));break;case"binary":m=Na(u);break;case"buffer":case"array":m=u;break}Sn(m,0);var x=m.read_shift(1),v=!!(x&136),E=!1,w=!1;switch(x){case 2:break;case 3:break;case 48:E=!0,v=!0;break;case 49:E=!0,v=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var T=0,A=521;x==2&&(T=m.read_shift(2)),m.l+=3,x!=2&&(T=m.read_shift(4)),T>1048576&&(T=1e6),x!=2&&(A=m.read_shift(2));var I=m.read_shift(2),O=f.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(O=t[m[m.l]]),m.l+=1,m.l+=2),w&&(m.l+=36);for(var D=[],q={},Y=Math.min(m.length,x==2?521:A-10-(E?264:0)),W=w?32:11;m.l<Y&&m[m.l]!=13;)switch(q={},q.name=Ih.utils.decode(O,m.slice(m.l,m.l+W)).replace(/[\u0000\r\n].*$/g,""),m.l+=W,q.type=String.fromCharCode(m.read_shift(1)),x!=2&&!w&&(q.offset=m.read_shift(4)),q.len=m.read_shift(1),x==2&&(q.offset=m.read_shift(2)),q.dec=m.read_shift(1),q.name.length&&D.push(q),x!=2&&(m.l+=w?13:14),q.type){case"B":(!E||q.len!=8)&&f.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(m[m.l]!==13&&(m.l=A-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=A;var N=0,b=0;for(h[0]=[],b=0;b!=D.length;++b)h[0][b]=D[b].name;for(;T-- >0;){if(m[m.l]===42){m.l+=I;continue}for(++m.l,h[++N]=[],b=0,b=0;b!=D.length;++b){var k=m.slice(m.l,m.l+D[b].len);m.l+=D[b].len,Sn(k,0);var F=Ih.utils.decode(O,k);switch(D[b].type){case"C":F.trim().length&&(h[N][b]=F.replace(/\s+$/,""));break;case"D":F.length===8?h[N][b]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):h[N][b]=F;break;case"F":h[N][b]=parseFloat(F.trim());break;case"+":case"I":h[N][b]=w?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":h[N][b]=!0;break;case"N":case"F":h[N][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[N][b]="##MEMO##"+(w?parseInt(F.trim(),10):k.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(h[N][b]=+F||0);break;case"@":h[N][b]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":h[N][b]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":h[N][b]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[N][b]=-k.read_shift(-8,"f");break;case"B":if(E&&D[b].len==8){h[N][b]=k.read_shift(8,"f");break}case"G":case"P":k.l+=D[b].len;break;case"0":if(D[b].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+D[b].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=D,h}function n(u,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var m=Vu(r(u,h),h);return m["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,m}function a(u,f){try{return Zo(n(u,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,f){var h=f||{};if(+h.codepage>=0&&ys(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=ua(),x=ep(u,{header:1,raw:!0,cellDates:!0}),v=x[0],E=x.slice(1),w=u["!cols"]||[],T=0,A=0,I=0,O=1;for(T=0;T<v.length;++T){if(((w[T]||{}).DBF||{}).name){v[T]=w[T].DBF.name,++I;continue}if(v[T]!=null){if(++I,typeof v[T]=="number"&&(v[T]=v[T].toString(10)),typeof v[T]!="string")throw new Error("DBF Invalid column name "+v[T]+" |"+typeof v[T]+"|");if(v.indexOf(v[T])!==T){for(A=0;A<1024;++A)if(v.indexOf(v[T]+"_"+A)==-1){v[T]+="_"+A;break}}}}var D=Vt(u["!ref"]),q=[],Y=[],W=[];for(T=0;T<=D.e.c-D.s.c;++T){var N="",b="",k=0,F=[];for(A=0;A<E.length;++A)E[A][T]!=null&&F.push(E[A][T]);if(F.length==0||v[T]==null){q[T]="?";continue}for(A=0;A<F.length;++A){switch(typeof F[A]){case"number":b="B";break;case"string":b="C";break;case"boolean":b="L";break;case"object":b=F[A]instanceof Date?"D":"C";break;default:b="C"}k=Math.max(k,String(F[A]).length),N=N&&N!=b?"C":b}k>250&&(k=250),b=((w[T]||{}).DBF||{}).type,b=="C"&&w[T].DBF.len>k&&(k=w[T].DBF.len),N=="B"&&b=="N"&&(N="N",W[T]=w[T].DBF.dec,k=w[T].DBF.len),Y[T]=N=="C"||b=="N"?k:i[N]||0,O+=Y[T],q[T]=N}var P=m.next(32);for(P.write_shift(4,318902576),P.write_shift(4,E.length),P.write_shift(2,296+32*I),P.write_shift(2,O),T=0;T<4;++T)P.write_shift(4,0);for(P.write_shift(4,0|(+e[RC]||3)<<8),T=0,A=0;T<v.length;++T)if(v[T]!=null){var M=m.next(32),j=(v[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,j,"sbcs"),M.write_shift(1,q[T]=="?"?"C":q[T],"sbcs"),M.write_shift(4,A),M.write_shift(1,Y[T]||i[q[T]]||0),M.write_shift(1,W[T]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),A+=Y[T]||i[q[T]]||0}var Le=m.next(264);for(Le.write_shift(4,13),T=0;T<65;++T)Le.write_shift(4,0);for(T=0;T<E.length;++T){var De=m.next(O);for(De.write_shift(1,0),A=0;A<v.length;++A)if(v[A]!=null)switch(q[A]){case"L":De.write_shift(1,E[T][A]==null?63:E[T][A]?84:70);break;case"B":De.write_shift(8,E[T][A]||0,"f");break;case"N":var ne="0";for(typeof E[T][A]=="number"&&(ne=E[T][A].toFixed(W[A]||0)),I=0;I<Y[A]-ne.length;++I)De.write_shift(1,32);De.write_shift(1,ne,"sbcs");break;case"D":E[T][A]?(De.write_shift(4,("0000"+E[T][A].getFullYear()).slice(-4),"sbcs"),De.write_shift(2,("00"+(E[T][A].getMonth()+1)).slice(-2),"sbcs"),De.write_shift(2,("00"+E[T][A].getDate()).slice(-2),"sbcs")):De.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(E[T][A]!=null?E[T][A]:"").slice(0,Y[A]);for(De.write_shift(1,ae,"sbcs"),I=0;I<Y[A]-ae.length;++I)De.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),zk=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Mr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,E){var w=t[E];return typeof w=="number"?fA(w):w},n=function(v,E,w){var T=E.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return T==59?v:fA(T)};t["|"]=254;function a(v,E){switch(E.type){case"base64":return i(ka(v),E);case"binary":return i(v,E);case"buffer":return i(St&&Buffer.isBuffer(v)?v.toString("binary"):Jo(v),E);case"array":return i(Wl(v),E)}throw new Error("Unrecognized type "+E.type)}function i(v,E){var w=v.split(/[\n\r]+/),T=-1,A=-1,I=0,O=0,D=[],q=[],Y=null,W={},N=[],b=[],k=[],F=0,P;for(+E.codepage>=0&&ys(+E.codepage);I!==w.length;++I){F=0;var M=w[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),j=M.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),Le=j[0],De;if(M.length>0)switch(Le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":j[1].charAt(0)=="P"&&q.push(M.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,ae=!1,fe=!1,ie=!1,Fe=-1,ee=-1;for(O=1;O<j.length;++O)switch(j[O].charAt(0)){case"A":break;case"X":A=parseInt(j[O].slice(1))-1,ae=!0;break;case"Y":for(T=parseInt(j[O].slice(1))-1,ae||(A=0),P=D.length;P<=T;++P)D[P]=[];break;case"K":De=j[O].slice(1),De.charAt(0)==='"'?De=De.slice(1,De.length-1):De==="TRUE"?De=!0:De==="FALSE"?De=!1:isNaN(Ss(De))?isNaN(Tu(De).getDate())||(De=xr(De)):(De=Ss(De),Y!==null&&Pu(Y)&&(De=Ip(De))),ne=!0;break;case"E":ie=!0;var B=mu(j[O].slice(1),{r:T,c:A});D[T][A]=[D[T][A],B];break;case"S":fe=!0,D[T][A]=[D[T][A],"S5S"];break;case"G":break;case"R":Fe=parseInt(j[O].slice(1))-1;break;case"C":ee=parseInt(j[O].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+M)}if(ne&&(D[T][A]&&D[T][A].length==2?D[T][A][0]=De:D[T][A]=De,Y=null),fe){if(ie)throw new Error("SYLK shared formula cannot have own formula");var Q=Fe>-1&&D[Fe][ee];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");D[T][A][1]=i3(Q[1],{r:T-Fe,c:A-ee})}break;case"F":var J=0;for(O=1;O<j.length;++O)switch(j[O].charAt(0)){case"X":A=parseInt(j[O].slice(1))-1,++J;break;case"Y":for(T=parseInt(j[O].slice(1))-1,P=D.length;P<=T;++P)D[P]=[];break;case"M":F=parseInt(j[O].slice(1))/20;break;case"F":break;case"G":break;case"P":Y=q[parseInt(j[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=j[O].slice(1).split(" "),P=parseInt(k[0],10);P<=parseInt(k[1],10);++P)F=parseInt(k[2],10),b[P-1]=F===0?{hidden:!0}:{wch:F},zo(b[P-1]);break;case"C":A=parseInt(j[O].slice(1))-1,b[A]||(b[A]={});break;case"R":T=parseInt(j[O].slice(1))-1,N[T]||(N[T]={}),F>0?(N[T].hpt=F,N[T].hpx=Su(F)):F===0&&(N[T].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+M)}J<1&&(Y=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+M)}}return N.length>0&&(W["!rows"]=N),b.length>0&&(W["!cols"]=b),E&&E.sheetRows&&(D=D.slice(0,E.sheetRows)),[D,W]}function l(v,E){var w=a(v,E),T=w[0],A=w[1],I=Vu(T,E);return Mr(A).forEach(function(O){I[O]=A[O]}),I}function u(v,E){return Zo(l(v,E),E)}function f(v,E,w,T){var A="C;Y"+(w+1)+";X"+(T+1)+";K";switch(v.t){case"n":A+=v.v||0,v.f&&!v.F&&(A+=";E"+c_(v.f,{r:w,c:T}));break;case"b":A+=v.v?"TRUE":"FALSE";break;case"e":A+=v.w||v.v;break;case"d":A+='"'+(v.w||v.v)+'"';break;case"s":A+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function h(v,E){E.forEach(function(w,T){var A="F;W"+(T+1)+" "+(T+1)+" ";w.hidden?A+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=jh(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Uh(w.wpx)),typeof w.wch=="number"&&(A+=Math.round(w.wch))),A.charAt(A.length-1)!=" "&&v.push(A)})}function m(v,E){E.forEach(function(w,T){var A="F;";w.hidden?A+="M0;":w.hpt?A+="M"+20*w.hpt+";":w.hpx&&(A+="M"+20*zh(w.hpx)+";"),A.length>2&&v.push(A+"R"+(T+1))})}function x(v,E){var w=["ID;PWXL;N;E"],T=[],A=Vt(v["!ref"]),I,O=Array.isArray(v),D=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),v["!cols"]&&h(w,v["!cols"]),v["!rows"]&&m(w,v["!rows"]),w.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var q=A.s.r;q<=A.e.r;++q)for(var Y=A.s.c;Y<=A.e.c;++Y){var W=ct({r:q,c:Y});I=O?(v[q]||[])[Y]:v[W],!(!I||I.v==null&&(!I.f||I.F))&&T.push(f(I,v,q,Y))}return w.join(D)+D+T.join(D)+D+"E"+D}return{to_workbook:u,to_sheet:l,from_sheet:x}})(),Hk=(function(){function t(i,l){switch(l.type){case"base64":return e(ka(i),l);case"binary":return e(i,l);case"buffer":return e(St&&Buffer.isBuffer(i)?i.toString("binary"):Jo(i),l);case"array":return e(Wl(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){for(var u=i.split(`
`),f=-1,h=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++f]=[],h=0;continue}if(!(f<0)){var v=u[m].trim().split(","),E=v[0],w=v[1];++m;for(var T=u[m]||"";(T.match(/["]/g)||[]).length&1&&m<u.length-1;)T+=`
`+u[++m];switch(T=T.trim(),+E){case-1:if(T==="BOT"){x[++f]=[],h=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?x[f][h]=!0:T==="FALSE"?x[f][h]=!1:isNaN(Ss(w))?isNaN(Tu(w).getDate())?x[f][h]=w:x[f][h]=xr(w):x[f][h]=Ss(w),++h;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),x[f][h++]=T!==""?T:null;break}if(T==="EOD")break}}return l&&l.sheetRows&&(x=x.slice(0,l.sheetRows)),x}function r(i,l){return Vu(t(i,l),l)}function n(i,l){return Zo(r(i,l),l)}var a=(function(){var i=function(f,h,m,x,v){f.push(h),f.push(m+","+x),f.push('"'+v.replace(/"/g,'""')+'"')},l=function(f,h,m,x){f.push(h+","+m),f.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var h=[],m=Vt(f["!ref"]),x,v=Array.isArray(f);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,m.e.r-m.s.r+1,""),i(h,"TUPLES",0,m.e.c-m.s.c+1,""),i(h,"DATA",0,0,"");for(var E=m.s.r;E<=m.e.r;++E){l(h,-1,0,"BOT");for(var w=m.s.c;w<=m.e.c;++w){var T=ct({r:E,c:w});if(x=v?(f[E]||[])[w]:f[T],!x){l(h,1,0,"");continue}switch(x.t){case"n":var A=x.w;!A&&x.v!=null&&(A=x.v),A==null?x.f&&!x.F?l(h,1,0,"="+x.f):l(h,1,0,""):l(h,0,A,"V");break;case"b":l(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":l(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=ts(x.z||lt[14],on(xr(x.v)))),l(h,0,x.w,"V");break;default:l(h,1,0,"")}}}l(h,-1,0,"EOD");var I=`\r
`,O=h.join(I);return O}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),Gk=(function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var E=x.split(`
`),w=-1,T=-1,A=0,I=[];A!==E.length;++A){var O=E[A].trim().split(":");if(O[0]==="cell"){var D=Nr(O[1]);if(I.length<=D.r)for(w=I.length;w<=D.r;++w)I[w]||(I[w]=[]);switch(w=D.r,T=D.c,O[2]){case"t":I[w][T]=t(O[3]);break;case"v":I[w][T]=+O[3];break;case"vtf":var q=O[O.length-1];case"vtc":switch(O[3]){case"nl":I[w][T]=!!+O[4];break;default:I[w][T]=+O[4];break}O[2]=="vtf"&&(I[w][T]=[I[w][T],q])}}}return v&&v.sheetRows&&(I=I.slice(0,v.sheetRows)),I}function n(x,v){return Vu(r(x,v),v)}function a(x,v){return Zo(n(x,v),v)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var v=[],E=[],w,T="",A=fa(x["!ref"]),I=Array.isArray(x),O=A.s.r;O<=A.e.r;++O)for(var D=A.s.c;D<=A.e.c;++D)if(T=ct({r:O,c:D}),w=I?(x[O]||[])[D]:x[T],!(!w||w.v==null||w.t==="z")){switch(E=["cell",T,"t"],w.t){case"s":case"str":E.push(e(w.v));break;case"n":w.f?(E[2]="vtf",E[3]="n",E[4]=w.v,E[5]=e(w.f)):(E[2]="v",E[3]=w.v);break;case"b":E[2]="vt"+(w.f?"f":"c"),E[3]="nl",E[4]=w.v?"1":"0",E[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var q=on(xr(w.v));E[2]="vtc",E[3]="nd",E[4]=""+q,E[5]=w.w||ts(w.z||lt[14],q);break;case"e":continue}v.push(E.join(":"))}return v.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(x){return[i,l,u,l,h(x),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}})(),wu=(function(){function t(m,x,v,E,w){w.raw?x[v][E]=m:m===""||(m==="TRUE"?x[v][E]=!0:m==="FALSE"?x[v][E]=!1:isNaN(Ss(m))?isNaN(Tu(m).getDate())?x[v][E]=m:x[v][E]=xr(m):x[v][E]=Ss(m))}function e(m,x){var v=x||{},E=[];if(!m||m.length===0)return E;for(var w=m.split(/[\r\n]/),T=w.length-1;T>=0&&w[T].length===0;)--T;for(var A=10,I=0,O=0;O<=T;++O)I=w[O].indexOf(" "),I==-1?I=w[O].length:I++,A=Math.max(A,I);for(O=0;O<=T;++O){E[O]=[];var D=0;for(t(w[O].slice(0,A).trim(),E,O,D,v),D=1;D<=(w[O].length-A)/10+1;++D)t(w[O].slice(A+(D-1)*10,A+D*10).trim(),E,O,D,v)}return v.sheetRows&&(E=E.slice(0,v.sheetRows)),E}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var x={},v=!1,E=0,w=0;E<m.length;++E)(w=m.charCodeAt(E))==34?v=!v:!v&&w in r&&(x[w]=(x[w]||0)+1);w=[];for(E in x)Object.prototype.hasOwnProperty.call(x,E)&&w.push([x[E],E]);if(!w.length){x=n;for(E in x)Object.prototype.hasOwnProperty.call(x,E)&&w.push([x[E],E])}return w.sort(function(T,A){return T[0]-A[0]||n[T[1]]-n[A[1]]}),r[w.pop()[1]]||44}function i(m,x){var v=x||{},E="",w=v.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(E=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(E=m.charAt(4),m=m.slice(6)):E=a(m.slice(0,1024)):v&&v.FS?E=v.FS:E=a(m.slice(0,1024));var A=0,I=0,O=0,D=0,q=0,Y=E.charCodeAt(0),W=!1,N=0,b=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var k=v.dateNF!=null?pL(v.dateNF):null;function F(){var P=m.slice(D,q),M={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)M.t="z";else if(v.raw)M.t="s",M.v=P;else if(P.trim().length===0)M.t="s",M.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(M.t="s",M.v=P.slice(2,-1).replace(/""/g,'"')):Gj(P)?(M.t="n",M.f=P.slice(1)):(M.t="s",M.v=P);else if(P=="TRUE")M.t="b",M.v=!0;else if(P=="FALSE")M.t="b",M.v=!1;else if(!isNaN(O=Ss(P)))M.t="n",v.cellText!==!1&&(M.w=P),M.v=O;else if(!isNaN(Tu(P).getDate())||k&&P.match(k)){M.z=v.dateNF||lt[14];var j=0;k&&P.match(k)&&(P=gL(P,v.dateNF,P.match(k)||[]),j=1),v.cellDates?(M.t="d",M.v=xr(P,j)):(M.t="n",M.v=on(xr(P,j))),v.cellText!==!1&&(M.w=ts(M.z,M.v instanceof Date?on(M.v):M.v)),v.cellNF||delete M.z}else M.t="s",M.v=P;if(M.t=="z"||(v.dense?(w[A]||(w[A]=[]),w[A][I]=M):w[ct({c:I,r:A})]=M),D=q+1,b=m.charCodeAt(D),T.e.c<I&&(T.e.c=I),T.e.r<A&&(T.e.r=A),N==Y)++I;else if(I=0,++A,v.sheetRows&&v.sheetRows<=A)return!0}e:for(;q<m.length;++q)switch(N=m.charCodeAt(q)){case 34:b===34&&(W=!W);break;case Y:case 10:case 13:if(!W&&F())break e;break}return q-D>0&&F(),w["!ref"]=Et(T),w}function l(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?i(m,x):Vu(e(m,x),x)}function u(m,x){var v="",E=x.type=="string"?[0,0,0,0]:x_(m,x);switch(x.type){case"base64":v=ka(m);break;case"binary":v=m;break;case"buffer":x.codepage==65001?v=m.toString("utf8"):x.codepage&&typeof Ih<"u"||(v=St&&Buffer.isBuffer(m)?m.toString("binary"):Jo(m));break;case"array":v=Wl(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+x.type)}return E[0]==239&&E[1]==187&&E[2]==191?v=or(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=or(v):x.type=="binary"&&typeof Ih<"u",v.slice(0,19)=="socialcalc:version:"?Gk.to_sheet(x.type=="string"?v:or(v),x):l(v,x)}function f(m,x){return Zo(u(m,x),x)}function h(m){for(var x=[],v=Vt(m["!ref"]),E,w=Array.isArray(m),T=v.s.r;T<=v.e.r;++T){for(var A=[],I=v.s.c;I<=v.e.c;++I){var O=ct({r:T,c:I});if(E=w?(m[T]||[])[I]:m[O],!E||E.v==null){A.push("          ");continue}for(var D=(E.w||(Pi(E),E.w)||"").slice(0,10);D.length<10;)D+=" ";A.push(D+(I===0?" ":""))}x.push(A.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:h}})();function R7(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=zk.to_workbook(t,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return wu.to_workbook(t,e)}}var Ul=(function(){function t(B,Q,J){if(B){Sn(B,B.l||0);for(var te=J.Enum||Fe;B.l<B.length;){var ce=B.read_shift(2),Se=te[ce]||te[65535],Oe=B.read_shift(2),ke=B.l+Oe,se=Se.f&&Se.f(B,Oe,J);if(B.l=ke,Q(se,Se,ce))return}}}function e(B,Q){switch(Q.type){case"base64":return r(Na(ka(B)),Q);case"binary":return r(Na(B),Q);case"buffer":case"array":return r(B,Q)}throw"Unsupported type "+Q.type}function r(B,Q){if(!B)return B;var J=Q||{},te=J.dense?[]:{},ce="Sheet1",Se="",Oe=0,ke={},se=[],Me=[],V={s:{r:0,c:0},e:{r:0,c:0}},we=J.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)J.Enum=Fe,t(B,function(ge,qe,Be){switch(Be){case 0:J.vers=ge,ge>=4096&&(J.qpro=!0);break;case 6:V=ge;break;case 204:ge&&(Se=ge);break;case 222:Se=ge;break;case 15:case 51:J.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:Be==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=J.dateNF||lt[14],J.cellDates&&(ge[1].t="d",ge[1].v=Ip(ge[1].v))),J.qpro&&ge[3]>Oe&&(te["!ref"]=Et(V),ke[ce]=te,se.push(ce),te=J.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Oe=ge[3],ce=Se||"Sheet"+(Oe+1),Se="");var Qe=J.dense?(te[ge[0].r]||[])[ge[0].c]:te[ct(ge[0])];if(Qe){Qe.t=ge[1].t,Qe.v=ge[1].v,ge[1].z!=null&&(Qe.z=ge[1].z),ge[1].f!=null&&(Qe.f=ge[1].f);break}J.dense?(te[ge[0].r]||(te[ge[0].r]=[]),te[ge[0].r][ge[0].c]=ge[1]):te[ct(ge[0])]=ge[1];break}},J);else if(B[2]==26||B[2]==14)J.Enum=ee,B[2]==14&&(J.qpro=!0,B.l=0),t(B,function(ge,qe,Be){switch(Be){case 204:ce=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>Oe&&(te["!ref"]=Et(V),ke[ce]=te,se.push(ce),te=J.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Oe=ge[3],ce="Sheet"+(Oe+1)),we>0&&ge[0].r>=we)break;J.dense?(te[ge[0].r]||(te[ge[0].r]=[]),te[ge[0].r][ge[0].c]=ge[1]):te[ct(ge[0])]=ge[1],V.e.c<ge[0].c&&(V.e.c=ge[0].c),V.e.r<ge[0].r&&(V.e.r=ge[0].r);break;case 27:ge[14e3]&&(Me[ge[14e3][0]]=ge[14e3][1]);break;case 1537:Me[ge[0]]=ge[1],ge[0]==Oe&&(ce=ge[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(te["!ref"]=Et(V),ke[Se||ce]=te,se.push(Se||ce),!Me.length)return{SheetNames:se,Sheets:ke};for(var Ae={},Je=[],Ye=0;Ye<Me.length;++Ye)ke[se[Ye]]?(Je.push(Me[Ye]||se[Ye]),Ae[Me[Ye]]=ke[Me[Ye]]||ke[se[Ye]]):(Je.push(Me[Ye]),Ae[Me[Ye]]={"!ref":"A1"});return{SheetNames:Je,Sheets:Ae}}function n(B,Q){var J=Q||{};if(+J.codepage>=0&&ys(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var te=ua(),ce=Vt(B["!ref"]),Se=Array.isArray(B),Oe=[];We(te,0,i(1030)),We(te,6,f(ce));for(var ke=Math.min(ce.e.r,8191),se=ce.s.r;se<=ke;++se)for(var Me=Ur(se),V=ce.s.c;V<=ce.e.c;++V){se===ce.s.r&&(Oe[V]=br(V));var we=Oe[V]+Me,Ae=Se?(B[se]||[])[V]:B[we];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?We(te,13,E(se,V,Ae.v)):We(te,14,T(se,V,Ae.v));else{var Je=Pi(Ae);We(te,15,x(se,V,Je.slice(0,239)))}}return We(te,1),te.end()}function a(B,Q){var J=Q||{};if(+J.codepage>=0&&ys(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var te=ua();We(te,0,l(B));for(var ce=0,Se=0;ce<B.SheetNames.length;++ce)(B.Sheets[B.SheetNames[ce]]||{})["!ref"]&&We(te,27,ie(B.SheetNames[ce],Se++));var Oe=0;for(ce=0;ce<B.SheetNames.length;++ce){var ke=B.Sheets[B.SheetNames[ce]];if(!(!ke||!ke["!ref"])){for(var se=Vt(ke["!ref"]),Me=Array.isArray(ke),V=[],we=Math.min(se.e.r,8191),Ae=se.s.r;Ae<=we;++Ae)for(var Je=Ur(Ae),Ye=se.s.c;Ye<=se.e.c;++Ye){Ae===se.s.r&&(V[Ye]=br(Ye));var ge=V[Ye]+Je,qe=Me?(ke[Ae]||[])[Ye]:ke[ge];if(!(!qe||qe.t=="z"))if(qe.t=="n")We(te,23,F(Ae,Ye,Oe,qe.v));else{var Be=Pi(qe);We(te,22,N(Ae,Ye,Oe,Be.slice(0,239)))}}++Oe}}return We(te,1),te.end()}function i(B){var Q=be(2);return Q.write_shift(2,B),Q}function l(B){var Q=be(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var J=0,te=0,ce=0,Se=0;Se<B.SheetNames.length;++Se){var Oe=B.SheetNames[Se],ke=B.Sheets[Oe];if(!(!ke||!ke["!ref"])){++ce;var se=fa(ke["!ref"]);J<se.e.r&&(J=se.e.r),te<se.e.c&&(te=se.e.c)}}return J>8191&&(J=8191),Q.write_shift(2,J),Q.write_shift(1,ce),Q.write_shift(1,te),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function u(B,Q,J){var te={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&J.qpro?(te.s.c=B.read_shift(1),B.l++,te.s.r=B.read_shift(2),te.e.c=B.read_shift(1),B.l++,te.e.r=B.read_shift(2),te):(te.s.c=B.read_shift(2),te.s.r=B.read_shift(2),Q==12&&J.qpro&&(B.l+=2),te.e.c=B.read_shift(2),te.e.r=B.read_shift(2),Q==12&&J.qpro&&(B.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function f(B){var Q=be(8);return Q.write_shift(2,B.s.c),Q.write_shift(2,B.s.r),Q.write_shift(2,B.e.c),Q.write_shift(2,B.e.r),Q}function h(B,Q,J){var te=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(te[0].c=B.read_shift(1),te[3]=B.read_shift(1),te[0].r=B.read_shift(2),B.l+=2):(te[2]=B.read_shift(1),te[0].c=B.read_shift(2),te[0].r=B.read_shift(2)),te}function m(B,Q,J){var te=B.l+Q,ce=h(B,Q,J);if(ce[1].t="s",J.vers==20768){B.l++;var Se=B.read_shift(1);return ce[1].v=B.read_shift(Se,"utf8"),ce}return J.qpro&&B.l++,ce[1].v=B.read_shift(te-B.l,"cstr"),ce}function x(B,Q,J){var te=be(7+J.length);te.write_shift(1,255),te.write_shift(2,Q),te.write_shift(2,B),te.write_shift(1,39);for(var ce=0;ce<te.length;++ce){var Se=J.charCodeAt(ce);te.write_shift(1,Se>=128?95:Se)}return te.write_shift(1,0),te}function v(B,Q,J){var te=h(B,Q,J);return te[1].v=B.read_shift(2,"i"),te}function E(B,Q,J){var te=be(7);return te.write_shift(1,255),te.write_shift(2,Q),te.write_shift(2,B),te.write_shift(2,J,"i"),te}function w(B,Q,J){var te=h(B,Q,J);return te[1].v=B.read_shift(8,"f"),te}function T(B,Q,J){var te=be(13);return te.write_shift(1,255),te.write_shift(2,Q),te.write_shift(2,B),te.write_shift(8,J,"f"),te}function A(B,Q,J){var te=B.l+Q,ce=h(B,Q,J);if(ce[1].v=B.read_shift(8,"f"),J.qpro)B.l=te;else{var Se=B.read_shift(2);q(B.slice(B.l,B.l+Se),ce),B.l+=Se}return ce}function I(B,Q,J){var te=Q&32768;return Q&=-32769,Q=(te?B:0)+(Q>=8192?Q-16384:Q),(te?"":"$")+(J?br(Q):Ur(Q))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},D=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function q(B,Q){Sn(B,0);for(var J=[],te=0,ce="",Se="",Oe="",ke="";B.l<B.length;){var se=B[B.l++];switch(se){case 0:J.push(B.read_shift(8,"f"));break;case 1:Se=I(Q[0].c,B.read_shift(2),!0),ce=I(Q[0].r,B.read_shift(2),!1),J.push(Se+ce);break;case 2:{var Me=I(Q[0].c,B.read_shift(2),!0),V=I(Q[0].r,B.read_shift(2),!1);Se=I(Q[0].c,B.read_shift(2),!0),ce=I(Q[0].r,B.read_shift(2),!1),J.push(Me+V+":"+Se+ce)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(B.read_shift(2));break;case 6:{for(var we="";se=B[B.l++];)we+=String.fromCharCode(se);J.push('"'+we.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:ke=J.pop(),Oe=J.pop(),J.push(["AND","OR"][se-20]+"("+Oe+","+ke+")");break;default:if(se<32&&D[se])ke=J.pop(),Oe=J.pop(),J.push(Oe+D[se]+ke);else if(O[se]){if(te=O[se][1],te==69&&(te=B[B.l++]),te>J.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+J.join("|")+"|");return}var Ae=J.slice(-te);J.length-=te,J.push(O[se][0]+"("+Ae.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}J.length==1?Q[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function Y(B){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=B.read_shift(2),Q[3]=B[B.l++],Q[0].c=B[B.l++],Q}function W(B,Q){var J=Y(B);return J[1].t="s",J[1].v=B.read_shift(Q-4,"cstr"),J}function N(B,Q,J,te){var ce=be(6+te.length);ce.write_shift(2,B),ce.write_shift(1,J),ce.write_shift(1,Q),ce.write_shift(1,39);for(var Se=0;Se<te.length;++Se){var Oe=te.charCodeAt(Se);ce.write_shift(1,Oe>=128?95:Oe)}return ce.write_shift(1,0),ce}function b(B,Q){var J=Y(B);J[1].v=B.read_shift(2);var te=J[1].v>>1;if(J[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return J[1].v=te,J}function k(B,Q){var J=Y(B),te=B.read_shift(4),ce=B.read_shift(4),Se=B.read_shift(2);if(Se==65535)return te===0&&ce===3221225472?(J[1].t="e",J[1].v=15):te===0&&ce===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Oe=Se&32768;return Se=(Se&32767)-16446,J[1].v=(1-Oe*2)*(ce*Math.pow(2,Se+32)+te*Math.pow(2,Se)),J}function F(B,Q,J,te){var ce=be(14);if(ce.write_shift(2,B),ce.write_shift(1,J),ce.write_shift(1,Q),te==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Se=0,Oe=0,ke=0,se=0;return te<0&&(Se=1,te=-te),Oe=Math.log2(te)|0,te/=Math.pow(2,Oe-31),se=te>>>0,(se&2147483648)==0&&(te/=2,++Oe,se=te>>>0),te-=se,se|=2147483648,se>>>=0,te*=Math.pow(2,32),ke=te>>>0,ce.write_shift(4,ke),ce.write_shift(4,se),Oe+=16383+(Se?32768:0),ce.write_shift(2,Oe),ce}function P(B,Q){var J=k(B);return B.l+=Q-14,J}function M(B,Q){var J=Y(B),te=B.read_shift(4);return J[1].v=te>>6,J}function j(B,Q){var J=Y(B),te=B.read_shift(8,"f");return J[1].v=te,J}function Le(B,Q){var J=j(B);return B.l+=Q-10,J}function De(B,Q){return B[B.l+Q-1]==0?B.read_shift(Q,"cstr"):""}function ne(B,Q){var J=B[B.l++];J>Q-1&&(J=Q-1);for(var te="";te.length<J;)te+=String.fromCharCode(B[B.l++]);return te}function ae(B,Q,J){if(!(!J.qpro||Q<21)){var te=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var ce=B.read_shift(Q-21,"cstr");return[te,ce]}}function fe(B,Q){for(var J={},te=B.l+Q;B.l<te;){var ce=B.read_shift(2);if(ce==14e3){for(J[ce]=[0,""],J[ce][0]=B.read_shift(2);B[B.l];)J[ce][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return J}function ie(B,Q){var J=be(5+B.length);J.write_shift(2,14e3),J.write_shift(2,Q);for(var te=0;te<B.length;++te){var ce=B.charCodeAt(te);J[J.l++]=ce>127?95:ce}return J[J.l++]=0,J}var Fe={0:{n:"BOF",f:Qr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:De},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:b},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:j},40:{n:"FORMULA28",f:Le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:De},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function D7(t){var e={},r=t.match(Hn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=dt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Oy[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var I7=(function(){var t=Mh("t"),e=Mh("rPr");function r(i){var l=i.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Lt(l[1])},f=i.match(e);return f&&(u.s=D7(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),F7=(function(){var e=/(\r\n|\n)/g;function r(a,i,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),O7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,M7=/<(?:\w+:)?r>/,P7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function a_(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Lt(or(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=or(t),r&&(n.h=Gy(n.t))):t.match(M7)&&(n.r=or(t),n.t=Lt(or((t.replace(P7,"").match(O7)||[]).join("").replace(Hn,""))),r&&(n.h=F7(I7(n.r)))),n):{t:""}}var L7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,V7=/<(?:\w+:)?(?:si|sstItem)>/g,B7=/<\/(?:\w+:)?(?:si|sstItem)>/;function j7(t,e){var r=[],n="";if(!t)return r;var a=t.match(L7);if(a){n=a[2].replace(V7,"").split(B7);for(var i=0;i!=n.length;++i){var l=a_(n[i].trim(),e);l!=null&&(r[r.length]=l)}a=dt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var U7=/^\s|\s$|[\t\n\r]/;function qk(t,e){if(!e.bookSST)return"";var r=[zr];r[r.length]=Ge("sst",null,{xmlns:rc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(U7)&&(i+=' xml:space="preserve"'),i+=">"+tr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function z7(t){return[t.read_shift(4),t.read_shift(4)]}function H7(t,e){var r=[],n=!1;return Hi(t,function(i,l,u){switch(u){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function G7(t,e){return e||(e=be(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var q7=t9;function W7(t){var e=ua();Ve(e,159,G7(t));for(var r=0;r<t.length;++r)Ve(e,19,q7(t[r]));return Ve(e,160),e.end()}function Wk(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Di(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function X7(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Di(t,4),e.U=Di(t,4),e.W=Di(t,4),e}function $7(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function K7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push($7(t));return e}function Y7(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Q7(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Di(t,4),e.U=Di(t,4),e.W=Di(t,4),e}function J7(t){var e=Q7(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Xk(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function $k(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Z7(t){var e=Di(t);switch(e.Minor){case 2:return[e.Minor,eB(t)];case 3:return[e.Minor,tB()];case 4:return[e.Minor,rB(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function eB(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Xk(t,r),a=$k(t,t.length-t.l);return{t:"Std",h:n,v:a}}function tB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function rB(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Hn,function(i){var l=dt(i);switch(Zs(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function nB(t,e){var r={},n=r.EncryptionVersionInfo=Di(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=Xk(t,a),e-=a,r.EncryptionVerifier=$k(t,e),r}function aB(t){var e={},r=e.EncryptionVersionInfo=Di(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function s_(t){var e=0,r,n=Wk(t),a=n.length+1,i,l,u,f,h;for(r=Uo(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)l=r[i],u=(e&16384)===0?0:1,f=e<<1&32767,h=u|f,e=h^l;return e^52811}var Kk=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},i=function(l){for(var u=e[l.length-1],f=104,h=l.length-1;h>=0;--h)for(var m=l[h],x=0;x!=7;++x)m&64&&(u^=r[f]),m*=2,--f;return u};return function(l){for(var u=Wk(l),f=i(u),h=u.length,m=Uo(16),x=0;x!=16;++x)m[x]=0;var v,E,w;for((h&1)===1&&(v=f>>8,m[h]=a(t[0],v),--h,v=f&255,E=u[u.length-1],m[h]=a(E,v));h>0;)--h,v=f>>8,m[h]=a(u[h],v),--h,v=f&255,m[h]=a(u[h],v);for(h=15,w=15-u.length;w>0;)v=f>>8,m[h]=a(t[w],v),--h,--w,v=f&255,m[h]=a(u[h],v),--h,--w;return m}})(),sB=function(t,e,r,n,a){a||(a=e),n||(n=Kk(t));var i,l;for(i=0;i!=e.length;++i)l=e[i],l^=n[r],l=(l>>5|l<<3)&255,a[i]=l,++r;return[a,r,n]},iB=function(t){var e=0,r=Kk(t);return function(n){var a=sB("",n,e,r);return e=a[1],a[0]}};function oB(t,e,r,n){var a={key:Qr(t),verificationBytes:Qr(t)};return r.password&&(a.verifier=s_(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=iB(r.password)),a}function lB(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=aB(t):n.Data=nB(t,e),n}function cB(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?lB(t,e-2,n):oB(t,r.biff>=8?e:e-2,r,n),n}var Yk=(function(){function t(a,i){switch(i.type){case"base64":return e(ka(a),i);case"binary":return e(a,i);case"buffer":return e(St&&Buffer.isBuffer(a)?a.toString("binary"):Jo(a),i);case"array":return e(Wl(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var l=i||{},u=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,E=0,w,T=-1;w=v.exec(m);){switch(w[0]){case"\\cell":var A=m.slice(E,v.lastIndex-w[0].length);if(A[0]==" "&&(A=A.slice(1)),++T,A.length){var I={v:A,t:"s"};Array.isArray(u)?u[x][T]=I:u[ct({r:x,c:T})]=I}break}E=v.lastIndex}T>h.e.c&&(h.e.c=T)}),u["!ref"]=Et(h),u}function r(a,i){return Zo(t(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],l=Vt(a["!ref"]),u,f=Array.isArray(a),h=l.s.r;h<=l.e.r;++h){i.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)i.push("\\cellx"+(m+1));for(i.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var x=ct({r:h,c:m});u=f?(a[h]||[])[m]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(Pi(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function uB(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Bh(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function fB(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),i=Math.min(e,r,n),l=a-i;if(l===0)return[0,0,e];var u=0,f=0,h=a+i;switch(f=l/(h>1?2-h:h),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,f,h/2]}function hB(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),i=n-a/2,l=[i,i,i],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=a*u,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-u),l[0]+=f,l[1]+=a;break;case 2:f=a*(u-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-u),l[1]+=f,l[2]+=a;break;case 4:f=a*(u-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-u),l[2]+=f,l[0]+=a;break}for(var h=0;h!=3;++h)l[h]=Math.round(l[h]*255);return l}function Qm(t,e){if(e===0)return t;var r=fB(uB(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Bh(hB(r))}var Qk=6,dB=15,mB=1,Pn=Qk;function jh(t){return Math.floor((t+Math.round(128/Pn)/256)*Pn)}function Uh(t){return Math.floor((t-5)/Pn*100+.5)/100}function Jm(t){return Math.round((t*Pn+5)/Pn*256)/256}function vx(t){return Jm(Uh(jh(t)))}function i_(t){var e=Math.abs(t-vx(t)),r=Pn;if(e>.005)for(Pn=mB;Pn<dB;++Pn)Math.abs(t-vx(t))<=e&&(e=Math.abs(t-vx(t)),r=Pn);Pn=r}function zo(t){t.width?(t.wpx=jh(t.width),t.wch=Uh(t.wpx),t.MDW=Pn):t.wpx?(t.wch=Uh(t.wpx),t.width=Jm(t.wch),t.MDW=Pn):typeof t.wch=="number"&&(t.width=Jm(t.wch),t.wpx=jh(t.width),t.MDW=Pn),t.customWidth&&delete t.customWidth}var pB=96,Jk=pB;function zh(t){return t*96/Jk}function Su(t){return t*Jk/96}var gB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xB(t,e,r,n){e.Borders=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(l){var u=dt(l);switch(Zs(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=pr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=pr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function vB(t,e,r,n){e.Fills=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(l){var u=dt(l);switch(Zs(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function yB(t,e,r,n){e.Fonts=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(l){var u=dt(l);switch(Zs(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=or(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?pr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?pr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?pr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?pr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?pr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?pr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?pr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Oy[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=pr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=Bl[a.color.index];a.color.index==81&&(f=Bl[1]),f||(f=Bl[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Qm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function _B(t,e,r){e.NumberFmt=[];for(var n=Mr(lt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=lt[n[a]];var i=t[0].match(Hn);if(i)for(a=0;a<i.length;++a){var l=dt(i[a]);switch(Zs(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Lt(or(l.formatCode)),f=parseInt(l.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Ri(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function EB(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ge("numFmt",null,{numFmtId:n,formatCode:tr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ge("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var rm=["numFmtId","fillId","fontId","borderId","xfId"],nm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function TB(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Hn)||[]).forEach(function(i){var l=dt(i),u=0;switch(Zs(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<rm.length;++u)n[rm[u]]&&(n[rm[u]]=parseInt(n[rm[u]],10));for(u=0;u<nm.length;++u)n[nm[u]]&&(n[nm[u]]=pr(n[nm[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=pr(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function wB(t){var e=[];return e[e.length]=Ge("cellXfs",null),t.forEach(function(r){e[e.length]=Ge("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ge("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var SB=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&_B(x,m,h),(x=u.match(a))&&yB(x,m,f,h),(x=u.match(n))&&vB(x,m,f,h),(x=u.match(i))&&xB(x,m,f,h),(x=u.match(r))&&TB(x,m,h),m}})();function Zk(t,e){var r=[zr,Ge("styleSheet",null,{xmlns:rc[0],"xmlns:vt":nn.vt})],n;return t.SSF&&(n=EB(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=wB(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function AB(t,e){var r=t.read_shift(2),n=jn(t);return[r,n]}function bB(t,e,r){r||(r=be(6+4*e.length)),r.write_shift(2,t),dn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function NB(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=l9(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=o9(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=jn(t),n}function CB(t,e){e||(e=be(153)),e.write_shift(2,t.sz*20),c9(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),$m(t.color,e);var n=0;return n=2,e.write_shift(1,n),dn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var kB=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],yx,RB=Un;function tb(t,e){e||(e=be(84)),yx||(yx=Rp(kB));var r=yx[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for($m({auto:1},e),$m({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function DB(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function e3(t,e,r){r||(r=be(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function $f(t,e){return e||(e=be(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var IB=Un;function FB(t,e){return e||(e=be(51)),e.write_shift(1,0),$f(null,e),$f(null,e),$f(null,e),$f(null,e),$f(null,e),e.length>e.l?e.slice(0,e.l):e}function OB(t,e){return e||(e=be(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Xm(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function MB(t,e,r){var n=be(2052);return n.write_shift(4,t),Xm(e,n),Xm(r,n),n.length>n.l?n.slice(0,n.l):n}function PB(t,e,r){var n={};n.NumberFmt=[];for(var a in lt)n.NumberFmt[a]=lt[a];n.CellXf=[],n.Fonts=[];var i=[],l=!1;return Hi(t,function(f,h,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],Ri(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=Qm(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(m),l=!0;break;case 38:i.pop(),l=!1;break;default:if(h.T>0)i.push(m);else if(h.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function LB(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Ve(t,615,As(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Ve(t,44,bB(a,e[a]))}),Ve(t,616))}}function VB(t){var e=1;Ve(t,611,As(e)),Ve(t,43,CB({sz:12,color:{theme:1},name:"Calibri",family:2})),Ve(t,612)}function BB(t){var e=2;Ve(t,603,As(e)),Ve(t,45,tb({patternType:"none"})),Ve(t,45,tb({patternType:"gray125"})),Ve(t,604)}function jB(t){var e=1;Ve(t,613,As(e)),Ve(t,46,FB()),Ve(t,614)}function UB(t){var e=1;Ve(t,626,As(e)),Ve(t,47,e3({numFmtId:0},65535)),Ve(t,627)}function zB(t,e){Ve(t,617,As(e.length)),e.forEach(function(r){Ve(t,47,e3(r,0))}),Ve(t,618)}function HB(t){var e=1;Ve(t,619,As(e)),Ve(t,48,OB({xfId:0,name:"Normal"})),Ve(t,620)}function GB(t){var e=0;Ve(t,505,As(e)),Ve(t,506)}function qB(t){var e=0;Ve(t,508,MB(e,"TableStyleMedium9","PivotStyleMedium4")),Ve(t,509)}function WB(t,e){var r=ua();return Ve(r,278),LB(r,t.SSF),VB(r),BB(r),jB(r),UB(r),zB(r,e.cellXfs),HB(r),GB(r),qB(r),Ve(r,279),r.end()}var XB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $B(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Hn)||[]).forEach(function(a){var i=dt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[XB.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function KB(){}function YB(){}var QB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,JB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ZB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ej(t,e,r){e.themeElements={};var n;[["clrScheme",QB,$B],["fontScheme",JB,KB],["fmtScheme",ZB,YB]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var tj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function t3(t,e){(!t||t.length===0)&&(t=o_());var r,n={};if(!(r=t.match(tj)))throw new Error("themeElements not found in theme");return ej(r[0],n,e),n.raw=t,n}function o_(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[zr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rj(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var l;try{l=XC(i,{type:"array"})}catch{return}var u=Ca(l,"theme/theme/theme1.xml",!0);if(u)return t3(u,r)}}function nj(t){return t.read_shift(4)}function aj(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=sj(t,4);break;case 2:e.xclrValue=Ok(t);break;case 3:e.xclrValue=nj(t);break;case 4:t.l+=4;break}return t.l+=8,e}function sj(t,e){return Un(t,e)}function ij(t,e){return Un(t,e)}function oj(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=aj(t);break;case 6:n[1]=ij(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function lj(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(oj(t,r-t.l));return{ixfe:n,ext:i}}function cj(t,e){e.forEach(function(r){r[0]})}function uj(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:jn(t)}}function fj(t){var e=be(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),dn(t.name,e),e.slice(0,e.l)}function hj(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function dj(t){var e=be(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function mj(t,e){var r=be(8+2*e.length);return r.write_shift(4,t),dn(e,r),r.slice(0,r.l)}function pj(t){return t.l+=4,t.read_shift(4)!=0}function gj(t,e){var r=be(8);return r.write_shift(4,t),r.write_shift(4,1),r}function xj(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],l=!1,u=2;return Hi(t,function(f,h,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:i.push(m),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!h.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function vj(){var t=ua();return Ve(t,332),Ve(t,334,As(1)),Ve(t,335,fj({name:"XLDAPR",version:12e4,flags:3496657072})),Ve(t,336),Ve(t,339,mj(1,"XLDAPR")),Ve(t,52),Ve(t,35,As(514)),Ve(t,4096,As(0)),Ve(t,4097,Ka(1)),Ve(t,36),Ve(t,53),Ve(t,340),Ve(t,337,gj(1)),Ve(t,51,dj([[1,0]])),Ve(t,338),Ve(t,333),t.end()}function yj(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,i=2,l;return t.replace(Hn,function(u){var f=dt(u);switch(Zs(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==f.name&&(l=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function r3(){var t=[zr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function _j(t){var e=[];if(!t)return e;var r=1;return(t.match(Hn)||[]).forEach(function(n){var a=dt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function Ej(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ct(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Tj(t,e,r){var n=[];return Hi(t,function(i,l,u){switch(u){case 63:n.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function wj(t,e,r,n){if(!t)return t;var a=n||{},i=!1;Hi(t,function(u,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function Sj(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var uu=1024;function n3(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ge("xml",null,{"xmlns:v":Sa.v,"xmlns:o":Sa.o,"xmlns:x":Sa.x,"xmlns:mv":Sa.mv}).replace(/\/>/,">"),Ge("o:shapelayout",Ge("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ge("v:shapetype",[Ge("v:stroke",null,{joinstyle:"miter"}),Ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];uu<t*1e3;)uu+=1e3;return e.forEach(function(i){var l=Nr(i[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ge("v:fill",f,u),m={on:"t",obscured:"t"};++uu,a=a.concat(["<v:shape"+Ph({id:"_x0000_s"+uu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ge("v:shadow",null,m),Ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",An("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),An("x:AutoFill","False"),An("x:Row",String(l.r)),An("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function rb(t,e,r,n){var a=Array.isArray(t),i;e.forEach(function(l){var u=Nr(l.ref);if(a?(t[u.r]||(t[u.r]=[]),i=t[u.r][u.c]):i=t[l.ref],!i){i={t:"z"},a?t[u.r][u.c]=i:t[l.ref]=i;var f=Vt(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var h=Et(f);h!==t["!ref"]&&(t["!ref"]=h)}i.c||(i.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var x=i.c.length-1;x>=0;--x){if(!r&&i.c[x].T)return;r&&!i.c[x].T&&i.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(m.a==n[x].id){m.a=n[x].name||m.a;break}}i.c.push(m)})}function Aj(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=dt(u[0]),h={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=Nr(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var x=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&a_(x[1])||{r:"",t:"",h:""};h.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),h.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=v.h),n.push(h)}}}}),n}function a3(t){var e=[zr,Ge("comments",null,{xmlns:rc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var i=tr(a.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(tr(f.a))),i.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)e.push(An("t",tr(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,u=1;u<i.length;++u)l+=`Reply:
    `+i[u]+`
`;e.push(An("t",tr(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function bj(t,e){var r=[],n=!1,a={},i=0;return t.replace(Hn,function(u,f){var h=dt(u);switch(Zs(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+u.length;break;case"</text>":a.t=t.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),r}function Nj(t,e,r){var n=[zr,Ge("ThreadedComments",null,{xmlns:nn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?i=f.id:f.parentId=i,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(Ge("threadedComment",An("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function Cj(t,e){var r=[],n=!1;return t.replace(Hn,function(i){var l=dt(i);switch(Zs(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function kj(t){var e=[zr,Ge("personList",null,{xmlns:nn.TCMNT,"xmlns:x":rc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function Rj(t){var e={};e.iauthor=t.read_shift(4);var r=ic(t);return e.rfx=r.s,e.ref=ct(r.s),t.l+=16,e}function Dj(t,e){return e==null&&(e=be(36)),e.write_shift(4,t[1].iauthor),Bu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var Ij=jn;function Fj(t){return dn(t.slice(0,54))}function Oj(t,e){var r=[],n=[],a={},i=!1;return Hi(t,function(u,f,h){switch(h){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function Mj(t){var e=ua(),r=[];return Ve(e,628),Ve(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ve(e,632,Fj(a.a)))})}),Ve(e,631),Ve(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Nr(n[0]),e:Nr(n[0])};Ve(e,635,Dj([i,a])),a.t&&a.t.length>0&&Ve(e,637,n9(a)),Ve(e,636),delete a.iauthor})}),Ve(e,634),Ve(e,629),e.end()}var Pj="application/vnd.ms-office.vbaProject";function Lj(t){var e=st.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(e,a,t.FileIndex[n].content)}}),st.write(e)}function Vj(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&st.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var s3=["xlsb","xlsm","xlam","biff8","xla"];function Bj(){return{"!type":"dialog"}}function jj(){return{"!type":"dialog"}}function Uj(){return{"!type":"macro"}}function zj(){return{"!type":"macro"}}var mu=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,i,l){var u=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return u?m+=e.c:--m,f?h+=e.r:--h,a+(u?"":"$")+br(m)+(f?"":"$")+Ur(h)}return function(a,i){return e=i,a.replace(t,r)}})(),l_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,c_=(function(){return function(e,r){return e.replace(l_,function(n,a,i,l,u,f){var h=Ky(l)-(i?0:r.c),m=$y(f)-(u?0:r.r),x=m==0?"":u?m+1:"["+m+"]",v=h==0?"":i?h+1:"["+h+"]";return a+"R"+x+"C"+v})}})();function i3(t,e){return t.replace(l_,function(r,n,a,i,l,u){return n+(a=="$"?a+i:br(Ky(i)+e.c))+(l=="$"?l+u:Ur($y(u)+e.r))})}function Hj(t,e,r){var n=fa(e),a=n.s,i=Nr(r),l={r:i.r-a.r,c:i.c-a.c};return i3(t,l)}function Gj(t){return t.length!=1}function nb(t){return t.replace(/_xlfn\./g,"")}function $r(t){t.l+=1}function Ho(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function o3(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return l3(t);r.biff==12&&(n=4)}var a=t.read_shift(n),i=t.read_shift(n),l=Ho(t),u=Ho(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function l3(t){var e=Ho(t),r=Ho(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function qj(t,e,r){if(r.biff<8)return l3(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),i=Ho(t),l=Ho(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function c3(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Wj(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Ho(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Wj(t){var e=Ho(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Xj(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $j(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Kj(t);var a=t.read_shift(n>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:u}}function Kj(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function Yj(t,e,r){var n=(t[t.l++]&96)>>5,a=o3(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Qj(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=o3(t,i,r);return[n,a,l]}function Jj(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Zj(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,a]}function eU(t,e,r){var n=(t[t.l++]&96)>>5,a=qj(t,e-1,r);return[n,a]}function tU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ab(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function rU(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function nU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function aU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function sU(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function iU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function u3(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function oU(t){return t.read_shift(2),u3(t)}function lU(t){return t.read_shift(2),u3(t)}function cU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=c3(t,0,r);return[n,a]}function uU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=$j(t,0,r);return[n,a]}function fU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=c3(t,0,r);return[n,a,i]}function hU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[pz[a],d3[a],n]}function dU(t,e,r){var n=t[t.l++],a=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:mU(t);return[a,(i[0]===0?d3:mz)[i[1]]]}function mU(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function pU(t,e,r){t.l+=r&&r.biff==2?3:4}function gU(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function xU(t){return t.l++,Gi[t.read_shift(1)]}function vU(t){return t.l++,t.read_shift(2)}function yU(t){return t.l++,t.read_shift(1)!==0}function _U(t){return t.l++,Vn(t)}function EU(t,e,r){return t.l++,c0(t,e-1,r)}function TU(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Br(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Gi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Vn(t);break;case 2:r[1]=oc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function wU(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?ic:Fp)(t));return a}function SU(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,l=[];i!=n&&(l[i]=[]);++i)for(var u=0;u!=a;++u)l[i][u]=TU(t,r.biff);return l}function AU(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function bU(t,e,r){if(r.biff==5)return NU(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[n,a,i]}function NU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function CU(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function kU(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function RU(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function DU(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,a]}var IU=Un,FU=Un,OU=Un;function f0(t,e,r){return t.l+=2,[Xj(t)]}function u_(t){return t.l+=6,[]}var MU=f0,PU=u_,LU=u_,VU=f0;function f3(t){return t.l+=2,[Qr(t),t.read_shift(2)&1]}var BU=f0,jU=f3,UU=u_,zU=f0,HU=f0,GU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qU(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),l=GU[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:i}}function WU(t){return t.l+=2,[t.read_shift(4)]}function XU(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function $U(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function KU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function YU(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function QU(t){return t.l+=4,[0,0]}var sb={1:{n:"PtgExp",f:gU},2:{n:"PtgTbl",f:OU},3:{n:"PtgAdd",f:$r},4:{n:"PtgSub",f:$r},5:{n:"PtgMul",f:$r},6:{n:"PtgDiv",f:$r},7:{n:"PtgPower",f:$r},8:{n:"PtgConcat",f:$r},9:{n:"PtgLt",f:$r},10:{n:"PtgLe",f:$r},11:{n:"PtgEq",f:$r},12:{n:"PtgGe",f:$r},13:{n:"PtgGt",f:$r},14:{n:"PtgNe",f:$r},15:{n:"PtgIsect",f:$r},16:{n:"PtgUnion",f:$r},17:{n:"PtgRange",f:$r},18:{n:"PtgUplus",f:$r},19:{n:"PtgUminus",f:$r},20:{n:"PtgPercent",f:$r},21:{n:"PtgParen",f:$r},22:{n:"PtgMissArg",f:$r},23:{n:"PtgStr",f:EU},26:{n:"PtgSheet",f:XU},27:{n:"PtgEndSheet",f:$U},28:{n:"PtgErr",f:xU},29:{n:"PtgBool",f:yU},30:{n:"PtgInt",f:vU},31:{n:"PtgNum",f:_U},32:{n:"PtgArray",f:tU},33:{n:"PtgFunc",f:hU},34:{n:"PtgFuncVar",f:dU},35:{n:"PtgName",f:AU},36:{n:"PtgRef",f:cU},37:{n:"PtgArea",f:Yj},38:{n:"PtgMemArea",f:CU},39:{n:"PtgMemErr",f:IU},40:{n:"PtgMemNoMem",f:FU},41:{n:"PtgMemFunc",f:kU},42:{n:"PtgRefErr",f:RU},43:{n:"PtgAreaErr",f:Jj},44:{n:"PtgRefN",f:uU},45:{n:"PtgAreaN",f:eU},46:{n:"PtgMemAreaN",f:KU},47:{n:"PtgMemNoMemN",f:YU},57:{n:"PtgNameX",f:bU},58:{n:"PtgRef3d",f:fU},59:{n:"PtgArea3d",f:Qj},60:{n:"PtgRefErr3d",f:DU},61:{n:"PtgAreaErr3d",f:Zj},255:{}},JU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ZU={1:{n:"PtgElfLel",f:f3},2:{n:"PtgElfRw",f:zU},3:{n:"PtgElfCol",f:MU},6:{n:"PtgElfRwV",f:HU},7:{n:"PtgElfColV",f:VU},10:{n:"PtgElfRadical",f:BU},11:{n:"PtgElfRadicalS",f:UU},13:{n:"PtgElfColS",f:PU},15:{n:"PtgElfColSV",f:LU},16:{n:"PtgElfRadicalLel",f:jU},25:{n:"PtgList",f:qU},29:{n:"PtgSxName",f:WU},255:{}},ez={0:{n:"PtgAttrNoop",f:QU},1:{n:"PtgAttrSemi",f:iU},2:{n:"PtgAttrIf",f:aU},4:{n:"PtgAttrChoose",f:rU},8:{n:"PtgAttrGoto",f:nU},16:{n:"PtgAttrSum",f:pU},32:{n:"PtgAttrBaxcel",f:ab},33:{n:"PtgAttrBaxcel",f:ab},64:{n:"PtgAttrSpace",f:oU},65:{n:"PtgAttrSpaceSemi",f:lU},128:{n:"PtgAttrIfError",f:sU},255:{}};function h0(t,e,r,n){if(n.biff<8)return Un(t,e);for(var a=t.l+e,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=SU(t,0,n),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=wU(t,r[l][1],n),i.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&i.push(Un(t,e)),i}function d0(t,e,r){for(var n=t.l+e,a,i,l=[];n!=t.l;)e=n-t.l,i=t[t.l],a=sb[i]||sb[JU[i]],(i===24||i===25)&&(a=(i===24?ZU:ez)[t[t.l+1]]),!a||!a.f?Un(t,e):l.push([a.n,a.f(t,e,r)]);return l}function tz(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],i=0;i<n.length;++i){var l=n[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var rz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nz(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function h3(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ib(t,e,r){var n=h3(t,e,r);return n=="#REF"?n:nz(n,r)}function Mn(t,e,r,n,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},u=[],f,h,m,x=0,v=0,E,w="";if(!t[0]||!t[0][0])return"";for(var T=-1,A="",I=0,O=t[0].length;I<O;++I){var D=t[0][I];switch(D[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),h=u.pop(),T>=0){switch(t[0][T][1][0]){case 0:A=Fr(" ",t[0][T][1][1]);break;case 1:A=Fr("\r",t[0][T][1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}h=h+A,T=-1}u.push(h+rz[D[0]]+f);break;case"PtgIsect":f=u.pop(),h=u.pop(),u.push(h+" "+f);break;case"PtgUnion":f=u.pop(),h=u.pop(),u.push(h+","+f);break;case"PtgRange":f=u.pop(),h=u.pop(),u.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=ch(D[1][1],l,a),u.push(uh(m,i));break;case"PtgRefN":m=r?ch(D[1][1],r,a):D[1][1],u.push(uh(m,i));break;case"PtgRef3d":x=D[1][1],m=ch(D[1][2],l,a),w=ib(n,x,a),u.push(w+"!"+uh(m,i));break;case"PtgFunc":case"PtgFuncVar":var q=D[1][0],Y=D[1][1];q||(q=0),q&=127;var W=q==0?[]:u.slice(-q);u.length-=q,Y==="User"&&(Y=W.shift()),u.push(Y+"("+W.join(",")+")");break;case"PtgBool":u.push(D[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(D[1]);break;case"PtgNum":u.push(String(D[1]));break;case"PtgStr":u.push('"'+D[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(D[1]);break;case"PtgAreaN":E=MA(D[1][1],r?{s:r}:l,a),u.push(px(E,a));break;case"PtgArea":E=MA(D[1][1],l,a),u.push(px(E,a));break;case"PtgArea3d":x=D[1][1],E=D[1][2],w=ib(n,x,a),u.push(w+"!"+px(E,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=D[1][2];var N=(n.names||[])[v-1]||(n[0]||[])[v],b=N?N.Name:"SH33TJSNAME"+String(v);b&&b.slice(0,6)=="_xlfn."&&!a.xlfn&&(b=b.slice(6)),u.push(b);break;case"PtgNameX":var k=D[1][1];v=D[1][2];var F;if(a.biff<=5)k<0&&(k=-k),n[k]&&(F=n[k][v]);else{var P="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][v]&&n[k][v].itab>0&&(P=n.SheetNames[n[k][v].itab-1]+"!"):P=n.SheetNames[v-1]+"!"),n[k]&&n[k][v])P+=n[k][v].Name;else if(n[0]&&n[0][v])P+=n[0][v].Name;else{var M=(h3(n,k,a)||"").split(";;");M[v-1]?P=M[v-1]:P+="SH33TJSERRX"}u.push(P);break}F||(F={Name:"SH33TJSERRY"}),u.push(F.Name);break;case"PtgParen":var j="(",Le=")";if(T>=0){switch(A="",t[0][T][1][0]){case 2:j=Fr(" ",t[0][T][1][1])+j;break;case 3:j=Fr("\r",t[0][T][1][1])+j;break;case 4:Le=Fr(" ",t[0][T][1][1])+Le;break;case 5:Le=Fr("\r",t[0][T][1][1])+Le;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}T=-1}u.push(j+u.pop()+Le);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:D[1][1],r:D[1][0]};var De={c:r.c,r:r.r};if(n.sharedf[ct(m)]){var ne=n.sharedf[ct(m)];u.push(Mn(ne,l,De,n,a))}else{var ae=!1;for(f=0;f!=n.arrayf.length;++f)if(h=n.arrayf[f],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(Mn(h[1],l,De,n,a)),ae=!0;break}ae||u.push(D[1])}break;case"PtgArray":u.push("{"+tz(D[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+D[1].idx+"[#"+D[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(D));default:throw new Error("Unrecognized Formula Token: "+String(D))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&T>=0&&fe.indexOf(t[0][I][0])==-1){D=t[0][T];var ie=!0;switch(D[1][0]){case 4:ie=!1;case 0:A=Fr(" ",D[1][1]);break;case 5:ie=!1;case 1:A=Fr("\r",D[1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+D[1][0])}u.push((ie?A:"")+u.pop()+(ie?"":A)),T=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function az(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],Un(t,e-2)];var u=d0(t,l,r);return e!==l+a&&(i=h0(t,e-l-a,u,r)),t.l=n,[u,i]}function sz(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],Un(t,e-2)];var u=d0(t,l,r);return e!==l+a&&(i=h0(t,e-l-a,u,r)),t.l=n,[u,i]}function iz(t,e,r,n){var a=t.l+e,i=d0(t,n,r),l;return a!==t.l&&(l=h0(t,a-t.l,i,r)),[i,l]}function oz(t,e,r){var n=t.l+e,a,i=t.read_shift(2),l=d0(t,i,r);return i==65535?[[],Un(t,e-2)]:(e!==i+2&&(a=h0(t,n-i-2,l,r)),[l,a])}function lz(t){var e;if(bi(t,t.l+6)!==65535)return[Vn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function cz(t){if(t==null){var e=be(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Xl(t);return Xl(0)}function _x(t,e,r){var n=t.l+e,a=ei(t);r.biff==2&&++t.l;var i=lz(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=sz(t,n-t.l,r);return{cell:a,val:i[0],formula:u,shared:l>>3&1,tt:i[1]}}function uz(t,e,r,n,a){var i=Kl(e,r,a),l=cz(t.v),u=be(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var h=be(t.bf.length),m=0;m<t.bf.length;++m)h[m]=t.bf[m];var x=hn([i,l,u,h]);return x}function Op(t,e,r){var n=t.read_shift(4),a=d0(t,n,r),i=t.read_shift(4),l=i>0?h0(t,i,a,r):null;return[a,l]}var fz=Op,Mp=Op,hz=Op,dz=Op,mz={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},d3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},pz={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ob(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function gz(t){var e="of:="+t.replace(l_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Ex(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function xz(t){return t.replace(/\./,"!")}var hh={},pu={},dh=typeof Map<"u";function f_(t,e,r){var n=0,a=t.length;if(r){if(dh?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=dh?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(dh?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Pp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Pn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Uh(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Jm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function zl(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function el(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,i=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ri(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===n)return a;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function m3(t,e,r,n,a,i){try{n.cellNF&&(t.z=lt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=xr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(lt[e]==null&&Ri(mL[e]||"General",e),t.t==="e")t.w=t.w||Gi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Oh(t.v);else if(t.t==="d"){var l=on(t.v);(l|0)===l?t.w=l.toString(10):t.w=Oh(l)}else{if(t.v===void 0)return"";t.w=ql(t.v,pu)}else t.t==="d"?t.w=ts(e,on(t.v),pu):t.w=ts(e,t.v,pu)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Qm(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Qm(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&i.Fills)throw u}}}function vz(t,e,r){if(t&&t["!ref"]){var n=Vt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function yz(t,e){var r=Vt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Et(r))}var _z=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Ez=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Tz=/<(?:\w:)?hyperlink [^>]*>/mg,wz=/"(\w*:\w*)"/,Sz=/<(?:\w:)?col\b[^>]*[\/]?>/g,Az=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,bz=/<(?:\w:)?pageMargins[^>]*\/>/g,p3=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Nz=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Cz=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kz(t,e,r,n,a,i,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",x=t.match(Ez);x?(h=t.slice(0,x.index),m=t.slice(x.index+x[0].length)):h=m=t;var v=h.match(p3);v?h_(v[0],u,a,r):(v=h.match(Nz))&&Dz(v[0],v[1]||"",u,a,r);var E=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var w=h.slice(E,E+50).match(wz);w&&yz(u,w[1])}var T=h.match(Cz);T&&T[1]&&Gz(T[1],a);var A=[];if(e.cellStyles){var I=h.match(Sz);I&&Bz(A,I)}x&&Xz(x[1],u,e,f,i,l);var O=m.match(Az);O&&(u["!autofilter"]=Uz(O[0]));var D=[],q=m.match(_z);if(q)for(E=0;E!=q.length;++E)D[E]=Vt(q[E].slice(q[E].indexOf('"')+1));var Y=m.match(Tz);Y&&Pz(u,Y,n);var W=m.match(bz);if(W&&(u["!margins"]=Lz(dt(W[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=Et(f)),e.sheetRows>0&&u["!ref"]){var N=Vt(u["!ref"]);e.sheetRows<=+N.e.r&&(N.e.r=e.sheetRows-1,N.e.r>f.e.r&&(N.e.r=f.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>f.e.c&&(N.e.c=f.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Et(N))}return A.length>0&&(u["!cols"]=A),D.length>0&&(u["!merges"]=D),u}function Rz(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Et(t[r])+'"/>';return e+"</mergeCells>"}function h_(t,e,r,n){var a=dt(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Lt(or(a.codeName)))}function Dz(t,e,r,n,a){h_(t.slice(0,t.indexOf(">")),r,n,a)}function Iz(t,e,r,n,a){var i=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,l.codeName=zs(tr(f))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),u=(u||"")+Ge("outlinePr",null,h)}!i&&!u||(a[a.length]=Ge("sheetPr",u,l))}var Fz=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Oz=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Mz(t){var e={sheet:1};return Fz.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Oz.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=s_(t.password).toString(16).toUpperCase()),Ge("sheetProtection",null,e)}function Pz(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var i=dt(or(e[a]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Lt(i.location))):(i.Target="#"+Lt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=Vt(i.ref),f=u.s.r;f<=u.e.r;++f)for(var h=u.s.c;h<=u.e.c;++h){var m=ct({c:h,r:f});n?(t[f]||(t[f]=[]),t[f][h]||(t[f][h]={t:"z",v:void 0}),t[f][h].l=i):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=i)}}}function Lz(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Vz(t){return zl(t),Ge("pageMargins",null,t)}function Bz(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=dt(e[n],!0);a.hidden&&(a.hidden=pr(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,i_(a.width)),zo(a);i<=l;)t[i++]=vr(a)}}function jz(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Ge("col",null,Pp(a,n)));return r[r.length]="</cols>",r.join("")}function Uz(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function zz(t,e,r,n){var a=typeof t.ref=="string"?t.ref:Et(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=fa(a);l.s.r==l.e.r&&(l.e.r=fa(e["!ref"]).e.r,a=Et(l));for(var u=0;u<i.length;++u){var f=i[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ge("autoFilter",null,{ref:a})}var Hz=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Gz(t,e){e.Views||(e.Views=[{}]),(t.match(Hz)||[]).forEach(function(r,n){var a=dt(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),pr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function qz(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ge("sheetViews",Ge("sheetView",null,a),{})}function Wz(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Gi[t.v];break;case"d":n&&n.cellDates?a=xr(t.v,-1).toISOString():(t=vr(t),t.t="n",a=""+(t.v=on(xr(t.v)))),typeof t.z>"u"&&(t.z=lt[14]);break;default:a=t.v;break}var u=An("v",tr(a)),f={r:e},h=el(n.cellXfs,t,n);switch(h!==0&&(f.s=h),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=An("v",""+f_(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=i&&(t.t=i,t.v=l),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Ge("f",tr(t.f),m)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Ge("c",u,f)}var Xz=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Mh("v"),l=Mh("f");return function(f,h,m,x,v,E){for(var w=0,T="",A=[],I=[],O=0,D=0,q=0,Y="",W,N,b=0,k=0,F,P,M=0,j=0,Le=Array.isArray(E.CellXf),De,ne=[],ae=[],fe=Array.isArray(h),ie=[],Fe={},ee=!1,B=!!m.sheetStubs,Q=f.split(e),J=0,te=Q.length;J!=te;++J){T=Q[J].trim();var ce=T.length;if(ce!==0){var Se=0;e:for(w=0;w<ce;++w)switch(T[w]){case">":if(T[w-1]!="/"){++w;break e}if(m&&m.cellStyles){if(N=dt(T.slice(Se,w),!0),b=N.r!=null?parseInt(N.r,10):b+1,k=-1,m.sheetRows&&m.sheetRows<b)continue;Fe={},ee=!1,N.ht&&(ee=!0,Fe.hpt=parseFloat(N.ht),Fe.hpx=Su(Fe.hpt)),N.hidden=="1"&&(ee=!0,Fe.hidden=!0),N.outlineLevel!=null&&(ee=!0,Fe.level=+N.outlineLevel),ee&&(ie[b-1]=Fe)}break;case"<":Se=w;break}if(Se>=w)break;if(N=dt(T.slice(Se,w),!0),b=N.r!=null?parseInt(N.r,10):b+1,k=-1,!(m.sheetRows&&m.sheetRows<b)){x.s.r>b-1&&(x.s.r=b-1),x.e.r<b-1&&(x.e.r=b-1),m&&m.cellStyles&&(Fe={},ee=!1,N.ht&&(ee=!0,Fe.hpt=parseFloat(N.ht),Fe.hpx=Su(Fe.hpt)),N.hidden=="1"&&(ee=!0,Fe.hidden=!0),N.outlineLevel!=null&&(ee=!0,Fe.level=+N.outlineLevel),ee&&(ie[b-1]=Fe)),A=T.slice(w).split(t);for(var Oe=0;Oe!=A.length&&A[Oe].trim().charAt(0)=="<";++Oe);for(A=A.slice(Oe),w=0;w!=A.length;++w)if(T=A[w].trim(),T.length!==0){if(I=T.match(r),O=w,D=0,q=0,T="<c "+(T.slice(0,1)=="<"?">":"")+T,I!=null&&I.length===2){for(O=0,Y=I[1],D=0;D!=Y.length&&!((q=Y.charCodeAt(D)-64)<1||q>26);++D)O=26*O+q;--O,k=O}else++k;for(D=0;D!=T.length&&T.charCodeAt(D)!==62;++D);if(++D,N=dt(T.slice(0,D),!0),N.r||(N.r=ct({r:b-1,c:k})),Y=T.slice(D),W={t:""},(I=Y.match(i))!=null&&I[1]!==""&&(W.v=Lt(I[1])),m.cellFormula){if((I=Y.match(l))!=null&&I[1]!==""){if(W.f=Lt(or(I[1])).replace(/\r\n/g,`
`),m.xlfn||(W.f=nb(W.f)),I[0].indexOf('t="array"')>-1)W.F=(Y.match(a)||[])[1],W.F.indexOf(":")>-1&&ne.push([Vt(W.F),W.F]);else if(I[0].indexOf('t="shared"')>-1){P=dt(I[0]);var ke=Lt(or(I[1]));m.xlfn||(ke=nb(ke)),ae[parseInt(P.si,10)]=[P,ke,N.r]}}else(I=Y.match(/<f[^>]*\/>/))&&(P=dt(I[0]),ae[P.si]&&(W.f=Hj(ae[P.si][1],ae[P.si][2],N.r)));var se=Nr(N.r);for(D=0;D<ne.length;++D)se.r>=ne[D][0].s.r&&se.r<=ne[D][0].e.r&&se.c>=ne[D][0].s.c&&se.c<=ne[D][0].e.c&&(W.F=ne[D][1])}if(N.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(B)W.t="z";else continue;else W.t=N.t||"n";switch(x.s.c>k&&(x.s.c=k),x.e.c<k&&(x.e.c=k),W.t){case"n":if(W.v==""||W.v==null){if(!B)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!B)continue;W.t="z"}else F=hh[parseInt(W.v,10)],W.v=F.t,W.r=F.r,m.cellHTML&&(W.h=F.h);break;case"str":W.t="s",W.v=W.v!=null?or(W.v):"",m.cellHTML&&(W.h=Gy(W.v));break;case"inlineStr":I=Y.match(n),W.t="s",I!=null&&(F=a_(I[1]))?(W.v=F.t,m.cellHTML&&(W.h=F.h)):W.v="";break;case"b":W.v=pr(W.v);break;case"d":m.cellDates?W.v=xr(W.v,1):(W.v=on(xr(W.v,1)),W.t="n");break;case"e":(!m||m.cellText!==!1)&&(W.w=W.v),W.v=xk[W.v];break}if(M=j=0,De=null,Le&&N.s!==void 0&&(De=E.CellXf[N.s],De!=null&&(De.numFmtId!=null&&(M=De.numFmtId),m.cellStyles&&De.fillId!=null&&(j=De.fillId))),m3(W,M,j,m,v,E),m.cellDates&&Le&&W.t=="n"&&Pu(lt[M])&&(W.t="d",W.v=Ip(W.v)),N.cm&&m.xlmeta){var Me=(m.xlmeta.Cell||[])[+N.cm-1];Me&&Me.type=="XLDAPR"&&(W.D=!0)}if(fe){var V=Nr(N.r);h[V.r]||(h[V.r]=[]),h[V.r][V.c]=W}else h[N.r]=W}}}}ie.length>0&&(h["!rows"]=ie)}})();function $z(t,e,r,n){var a=[],i=[],l=Vt(t["!ref"]),u="",f,h="",m=[],x=0,v=0,E=t["!rows"],w=Array.isArray(t),T={r:h},A,I=-1;for(v=l.s.c;v<=l.e.c;++v)m[v]=br(v);for(x=l.s.r;x<=l.e.r;++x){for(i=[],h=Ur(x),v=l.s.c;v<=l.e.c;++v){f=m[v]+h;var O=w?(t[x]||[])[v]:t[f];O!==void 0&&(u=Wz(O,f,t,e))!=null&&i.push(u)}(i.length>0||E&&E[x])&&(T={r:h},E&&E[x]&&(A=E[x],A.hidden&&(T.hidden=1),I=-1,A.hpx?I=zh(A.hpx):A.hpt&&(I=A.hpt),I>-1&&(T.ht=I,T.customHeight=1),A.level&&(T.outlineLevel=A.level)),a[a.length]=Ge("row",i.join(""),T))}if(E)for(;x<E.length;++x)E&&E[x]&&(T={r:x+1},A=E[x],A.hidden&&(T.hidden=1),I=-1,A.hpx?I=zh(A.hpx):A.hpt&&(I=A.hpt),I>-1&&(T.ht=I,T.customHeight=1),A.level&&(T.outlineLevel=A.level),a[a.length]=Ge("row","",T));return a.join("")}function g3(t,e,r,n){var a=[zr,Ge("worksheet",null,{xmlns:rc[0],"xmlns:r":nn.r})],i=r.SheetNames[t],l=0,u="",f=r.Sheets[i];f==null&&(f={});var h=f["!ref"]||"A1",m=Vt(h);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=Et(m)}n||(n={}),f["!comments"]=[];var x=[];Iz(f,r,t,e,a),a[a.length]=Ge("dimension",null,{ref:h}),a[a.length]=qz(f,e,t,r),e.sheetFormat&&(a[a.length]=Ge("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=jz(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=$z(f,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=Mz(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=zz(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Rz(f["!merges"]));var v=-1,E,w=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(T){T[1].Target&&(E={ref:T[0]},T[1].Target.charAt(0)!="#"&&(w=er(n,-1,tr(T[1].Target).replace(/#.*$/,""),At.HLINK),E["r:id"]="rId"+w),(v=T[1].Target.indexOf("#"))>-1&&(E.location=tr(T[1].Target.slice(v+1))),T[1].Tooltip&&(E.tooltip=tr(T[1].Tooltip)),a[a.length]=Ge("hyperlink",null,E))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=Vz(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=An("ignoredErrors",Ge("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(w=er(n,-1,"../drawings/drawing"+(t+1)+".xml",At.DRAW),a[a.length]=Ge("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=x),f["!comments"].length>0&&(w=er(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",At.VML),a[a.length]=Ge("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Kz(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Yz(t,e,r){var n=be(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;a.hpx?i=zh(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var h={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var x=-1,v=-1,E=m<<10;E<m+1<<10;++E){h.c=E;var w=Array.isArray(r)?(r[h.r]||[])[h.c]:r[ct(h)];w&&(x<0&&(x=E),v=E)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,v))}var T=n.l;return n.l=f,n.write_shift(4,u),n.l=T,n.length>n.l?n.slice(0,n.l):n}function Qz(t,e,r,n){var a=Yz(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Ve(t,0,a)}var Jz=ic,Zz=Bu;function eH(){}function tH(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=a9(t),r}function rH(t,e,r){r==null&&(r=be(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return $m({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),hk(t,r),r.slice(0,r.l)}function nH(t){var e=ns(t);return[e]}function aH(t,e,r){return r==null&&(r=be(8)),nc(e,r)}function sH(t){var e=ac(t);return[e]}function iH(t,e,r){return r==null&&(r=be(4)),sc(e,r)}function oH(t){var e=ns(t),r=t.read_shift(1);return[e,r,"b"]}function lH(t,e,r){return r==null&&(r=be(9)),nc(e,r),r.write_shift(1,t.v?1:0),r}function cH(t){var e=ac(t),r=t.read_shift(1);return[e,r,"b"]}function uH(t,e,r){return r==null&&(r=be(5)),sc(e,r),r.write_shift(1,t.v?1:0),r}function fH(t){var e=ns(t),r=t.read_shift(1);return[e,r,"e"]}function hH(t,e,r){return r==null&&(r=be(9)),nc(e,r),r.write_shift(1,t.v),r}function dH(t){var e=ac(t),r=t.read_shift(1);return[e,r,"e"]}function mH(t,e,r){return r==null&&(r=be(8)),sc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function pH(t){var e=ns(t),r=t.read_shift(4);return[e,r,"s"]}function gH(t,e,r){return r==null&&(r=be(12)),nc(e,r),r.write_shift(4,e.v),r}function xH(t){var e=ac(t),r=t.read_shift(4);return[e,r,"s"]}function vH(t,e,r){return r==null&&(r=be(8)),sc(e,r),r.write_shift(4,e.v),r}function yH(t){var e=ns(t),r=Vn(t);return[e,r,"n"]}function _H(t,e,r){return r==null&&(r=be(16)),nc(e,r),Xl(t.v,r),r}function x3(t){var e=ac(t),r=Vn(t);return[e,r,"n"]}function EH(t,e,r){return r==null&&(r=be(12)),sc(e,r),Xl(t.v,r),r}function TH(t){var e=ns(t),r=Zy(t);return[e,r,"n"]}function wH(t,e,r){return r==null&&(r=be(12)),nc(e,r),dk(t.v,r),r}function SH(t){var e=ac(t),r=Zy(t);return[e,r,"n"]}function AH(t,e,r){return r==null&&(r=be(8)),sc(e,r),dk(t.v,r),r}function bH(t){var e=ns(t),r=Yy(t);return[e,r,"is"]}function NH(t){var e=ns(t),r=jn(t);return[e,r,"str"]}function CH(t,e,r){return r==null&&(r=be(12+4*t.v.length)),nc(e,r),dn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function kH(t){var e=ac(t),r=jn(t);return[e,r,"str"]}function RH(t,e,r){return r==null&&(r=be(8+4*t.v.length)),sc(e,r),dn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function DH(t,e,r){var n=t.l+e,a=ns(t);a.r=r["!row"];var i=t.read_shift(1),l=[a,i,"b"];if(r.cellFormula){t.l+=2;var u=Mp(t,n-t.l,r);l[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return l}function IH(t,e,r){var n=t.l+e,a=ns(t);a.r=r["!row"];var i=t.read_shift(1),l=[a,i,"e"];if(r.cellFormula){t.l+=2;var u=Mp(t,n-t.l,r);l[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return l}function FH(t,e,r){var n=t.l+e,a=ns(t);a.r=r["!row"];var i=Vn(t),l=[a,i,"n"];if(r.cellFormula){t.l+=2;var u=Mp(t,n-t.l,r);l[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return l}function OH(t,e,r){var n=t.l+e,a=ns(t);a.r=r["!row"];var i=jn(t),l=[a,i,"str"];if(r.cellFormula){t.l+=2;var u=Mp(t,n-t.l,r);l[3]=Mn(u,null,a,r.supbooks,r)}else t.l=n;return l}var MH=ic,PH=Bu;function LH(t,e){return e==null&&(e=be(4)),e.write_shift(4,t),e}function VH(t,e){var r=t.l+e,n=ic(t),a=Qy(t),i=jn(t),l=jn(t),u=jn(t);t.l=r;var f={rfx:n,relId:a,loc:i,display:u};return l&&(f.Tooltip=l),f}function BH(t,e){var r=be(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Bu({s:Nr(t[0]),e:Nr(t[0])},r),Jy("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return dn(a||"",r),dn(t[1].Tooltip||"",r),dn("",r),r.slice(0,r.l)}function jH(){}function UH(t,e,r){var n=t.l+e,a=mk(t),i=t.read_shift(1),l=[a];if(l[2]=i,r.cellFormula){var u=fz(t,n-t.l,r);l[1]=u}else t.l=n;return l}function zH(t,e,r){var n=t.l+e,a=ic(t),i=[a];if(r.cellFormula){var l=dz(t,n-t.l,r);i[1]=l,t.l=n}else t.l=n;return i}function HH(t,e,r){r==null&&(r=be(18));var n=Pp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var v3=["left","right","top","bottom","header","footer"];function GH(t){var e={};return v3.forEach(function(r){e[r]=Vn(t)}),e}function qH(t,e){return e==null&&(e=be(48)),zl(t),v3.forEach(function(r){Xl(t[r],e)}),e}function WH(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function XH(t,e,r){r==null&&(r=be(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $H(t){var e=be(24);return e.write_shift(4,4),e.write_shift(4,1),Bu(t,e),e}function KH(t,e){return e==null&&(e=be(66)),e.write_shift(2,t.password?s_(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function YH(){}function QH(){}function JH(t,e,r,n,a,i,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,E,w,T,A,I,O,D,q,Y,W=[];u.biff=12,u["!row"]=0;var N=0,b=!1,k=[],F={},P=u.supbooks||a.supbooks||[[]];if(P.sharedf=F,P.arrayf=k,P.SheetNames=a.SheetNames||a.Sheets.map(function(fe){return fe.name}),!u.supbooks&&(u.supbooks=P,a.Names))for(var M=0;M<a.Names.length;++M)P[0][M+1]=a.Names[M];var j=[],Le=[],De=!1;Hh[16]={n:"BrtShortReal",f:x3};var ne;if(Hi(t,function(ie,Fe,ee){if(!v)switch(ee){case 148:h=ie;break;case 0:E=ie,u.sheetRows&&u.sheetRows<=E.r&&(v=!0),q=Ur(A=E.r),u["!row"]=E.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=Su(ie.hpt)),Le[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ie[2]},ie[2]){case"n":w.v=ie[1];break;case"s":D=hh[ie[1]],w.v=D.t,w.r=D.r;break;case"b":w.v=!!ie[1];break;case"e":w.v=ie[1],u.cellText!==!1&&(w.w=Gi[w.v]);break;case"str":w.t="s",w.v=ie[1];break;case"is":w.t="s",w.v=ie[1].t;break}if((T=l.CellXf[ie[0].iStyleRef])&&m3(w,T.numFmtId,null,u,i,l),I=ie[0].c==-1?I+1:ie[0].c,u.dense?(f[A]||(f[A]=[]),f[A][I]=w):f[br(I)+q]=w,u.cellFormula){for(b=!1,N=0;N<k.length;++N){var B=k[N];E.r>=B[0].s.r&&E.r<=B[0].e.r&&I>=B[0].s.c&&I<=B[0].e.c&&(w.F=Et(B[0]),b=!0)}!b&&ie.length>3&&(w.f=ie[3])}if(m.s.r>E.r&&(m.s.r=E.r),m.s.c>I&&(m.s.c=I),m.e.r<E.r&&(m.e.r=E.r),m.e.c<I&&(m.e.c=I),u.cellDates&&T&&w.t=="n"&&Pu(lt[T.numFmtId])){var Q=Ol(w.v);Q&&(w.t="d",w.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;w={t:"z",v:void 0},I=ie[0].c==-1?I+1:ie[0].c,u.dense?(f[A]||(f[A]=[]),f[A][I]=w):f[br(I)+q]=w,m.s.r>E.r&&(m.s.r=E.r),m.s.c>I&&(m.s.c=I),m.e.r<E.r&&(m.e.r=E.r),m.e.c<I&&(m.e.c=I),ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 176:W.push(ie);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var J=n["!id"][ie.relId];for(J?(ie.Target=J.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=J):ie.relId==""&&(ie.Target="#"+ie.loc),A=ie.rfx.s.r;A<=ie.rfx.e.r;++A)for(I=ie.rfx.s.c;I<=ie.rfx.e.c;++I)u.dense?(f[A]||(f[A]=[]),f[A][I]||(f[A][I]={t:"z",v:void 0}),f[A][I].l=ie):(O=ct({c:I,r:A}),f[O]||(f[O]={t:"z",v:void 0}),f[O].l=ie);break;case 426:if(!u.cellFormula)break;k.push(ie),Y=u.dense?f[A][I]:f[br(I)+q],Y.f=Mn(ie[1],m,{r:E.r,c:I},P,u),Y.F=Et(ie[0]);break;case 427:if(!u.cellFormula)break;F[ct(ie[0].s)]=ie[1],Y=u.dense?f[A][I]:f[br(I)+q],Y.f=Mn(ie[1],m,{r:E.r,c:I},P,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)j[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},De||(De=!0,i_(ie.w/256)),zo(j[ie.e+1]);break;case 161:f["!autofilter"]={ref:Et(ie)};break;case 476:f["!margins"]=ie;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ie.name&&(a.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(f["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Fe.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=Et(h||m)),u.sheetRows&&f["!ref"]){var ae=Vt(f["!ref"]);u.sheetRows<=+ae.e.r&&(ae.e.r=u.sheetRows-1,ae.e.r>m.e.r&&(ae.e.r=m.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>m.e.c&&(ae.e.c=m.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Et(ae))}return W.length>0&&(f["!merges"]=W),j.length>0&&(f["!cols"]=j),Le.length>0&&(f["!rows"]=Le),f}function ZH(t,e,r,n,a,i,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=vr(e),e.z=e.z||lt[14],e.v=on(xr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:n};switch(f.s=el(a.cellXfs,e,a),e.l&&i["!links"].push([ct(f),e.l]),e.c&&i["!comments"].push([ct(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=f_(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,l?Ve(t,18,vH(e,f)):Ve(t,7,gH(e,f))):(f.t="str",l?Ve(t,17,RH(e,f)):Ve(t,6,CH(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Ve(t,13,AH(e,f)):Ve(t,2,wH(e,f)):l?Ve(t,16,EH(e,f)):Ve(t,5,_H(e,f)),!0;case"b":return f.t="b",l?Ve(t,15,uH(e,f)):Ve(t,4,lH(e,f)),!0;case"e":return f.t="e",l?Ve(t,14,mH(e,f)):Ve(t,3,hH(e,f)),!0}return l?Ve(t,12,iH(e,f)):Ve(t,1,aH(e,f)),!0}function eG(t,e,r,n){var a=Vt(e["!ref"]||"A1"),i,l="",u=[];Ve(t,145);var f=Array.isArray(e),h=a.e.r;e["!rows"]&&(h=Math.max(a.e.r,e["!rows"].length-1));for(var m=a.s.r;m<=h;++m){l=Ur(m),Qz(t,e,a,m);var x=!1;if(m<=a.e.r)for(var v=a.s.c;v<=a.e.c;++v){m===a.s.r&&(u[v]=br(v)),i=u[v]+l;var E=f?(e[m]||[])[v]:e[i];if(!E){x=!1;continue}x=ZH(t,E,m,v,n,e,x)}}Ve(t,146)}function tG(t,e){!e||!e["!merges"]||(Ve(t,177,LH(e["!merges"].length)),e["!merges"].forEach(function(r){Ve(t,176,PH(r))}),Ve(t,178))}function rG(t,e){!e||!e["!cols"]||(Ve(t,390),e["!cols"].forEach(function(r,n){r&&Ve(t,60,HH(n,r))}),Ve(t,391))}function nG(t,e){!e||!e["!ref"]||(Ve(t,648),Ve(t,649,$H(Vt(e["!ref"]))),Ve(t,650))}function aG(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=er(r,-1,n[1].Target.replace(/#.*$/,""),At.HLINK);Ve(t,494,BH(n,a))}}),delete e["!links"]}function sG(t,e,r,n){if(e["!comments"].length>0){var a=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",At.VML);Ve(t,551,Jy("rId"+a)),e["!legacy"]=a}}function iG(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],i=typeof a.ref=="string"?a.ref:Et(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=fa(i);u.s.r==u.e.r&&(u.e.r=fa(e["!ref"]).e.r,i=Et(u));for(var f=0;f<l.length;++f){var h=l[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ve(t,161,Bu(Vt(i))),Ve(t,162)}}function oG(t,e,r){Ve(t,133),Ve(t,137,XH(e,r)),Ve(t,138),Ve(t,134)}function lG(t,e){e["!protect"]&&Ve(t,535,KH(e["!protect"]))}function cG(t,e,r,n){var a=ua(),i=r.SheetNames[t],l=r.Sheets[i]||{},u=i;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=Vt(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ve(a,129),(r.vbaraw||l["!outline"])&&Ve(a,147,rH(u,l["!outline"])),Ve(a,148,Zz(f)),oG(a,l,r.Workbook),rG(a,l),eG(a,l,t,e),lG(a,l),iG(a,l,r,t),tG(a,l),aG(a,l,n),l["!margins"]&&Ve(a,476,qH(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&nG(a,l),sG(a,l,t,n),Ve(a,130),a.end()}function uG(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=Lt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,a,n]}function fG(t,e,r,n,a,i){var l=i||{"!type":"chart"};if(!t)return i;var u=0,f=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=uG(x);m.s.r=m.s.c=0,m.e.c=u,h=br(u),v[0].forEach(function(E,w){l[h+Ur(w)]={t:"n",v:E,z:v[1]},f=w}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(l["!ref"]=Et(m)),l}function hG(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(p3);return u&&h_(u[0],i,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function dG(t,e){t.l+=10;var r=jn(t);return{name:r}}function mG(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Hi(t,function(f,h,m){switch(m){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var d_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],pG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gG=[],xG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function lb(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var i=e[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=pr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function cb(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=pr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function y3(t){cb(t.WBProps,d_),cb(t.CalcPr,xG),lb(t.WBView,pG),lb(t.Sheets,gG),pu.date1904=pr(t.WBProps.date1904)}function vG(t){return!t.Workbook||!t.Workbook.WBProps?"false":pr(t.Workbook.WBProps.date1904)?"true":"false"}var yG="][*?/\\".split("");function _3(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yG.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function _G(t,e,r){t.forEach(function(n,a){_3(n);for(var i=0;i<a;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function EG(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];_G(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)vz(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var TG=/<\w+:workbook/;function wG(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},l=0;if(t.replace(Hn,function(f,h){var m=dt(f);switch(Zs(m[0])){case"<?xml":break;case"<workbook":f.match(TG)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":d_.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=pr(m[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:r.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(r.WBProps.CodeName=or(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Lt(or(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=or(m.name),m.comment&&(i.Comment=m.comment),m.localSheetId&&(i.Sheet=+m.localSheetId),pr(m.hidden||"0")&&(i.Hidden=!0),l=h+f.length;break;case"</definedName>":i.Ref=Lt(or(t.slice(l,h))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),rc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return y3(r),r}function E3(t){var e=[zr];e[e.length]=Ge("workbook",null,{xmlns:rc[0],"xmlns:r":nn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(d_.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ge("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var l={name:tr(t.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Ge("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Ge("definedName",tr(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function SG(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=hv(t),r.name=jn(t),r}function AG(t,e){return e||(e=be(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Jy(t.strRelID,e),dn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function bG(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?jn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function NG(t,e){e||(e=be(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),hk(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function CG(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function kG(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=s9(t),l=hz(t,0,r),u=Qy(t);t.l=n;var f={Name:i,Ptg:l};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function RG(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Hh[16]={n:"BrtFRTArchID$",f:CG},Hi(t,function(f,h,m){switch(m){case 156:l.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Mn(f.Ptg,null,null,l,e),delete e.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),y3(r),r.Names=i,r.supbooks=l,r}function DG(t,e){Ve(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ve(t,156,AG(a))}Ve(t,144)}function IG(t,e){e||(e=be(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return dn("SheetJS",e),dn(Um.version,e),dn(Um.version,e),dn("7262",e),e.length>e.l?e.slice(0,e.l):e}function FG(t,e){e||(e=be(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function OG(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Ve(t,135),Ve(t,158,FG(a)),Ve(t,136))}}function MG(t,e){var r=ua();return Ve(r,131),Ve(r,128,IG()),Ve(r,153,NG(t.Workbook&&t.Workbook.WBProps||null)),OG(r,t),DG(r,t),Ve(r,132),r.end()}function PG(t,e,r){return e.slice(-4)===".bin"?RG(t,r):wG(t,r)}function LG(t,e,r,n,a,i,l,u){return e.slice(-4)===".bin"?JH(t,n,r,a,i,l,u):kz(t,n,r,a,i,l,u)}function VG(t,e,r,n,a,i,l,u){return e.slice(-4)===".bin"?mG(t,n,r,a,i):hG(t,n,r,a,i)}function BG(t,e,r,n,a,i,l,u){return e.slice(-4)===".bin"?Uj():zj()}function jG(t,e,r,n,a,i,l,u){return e.slice(-4)===".bin"?Bj():jj()}function UG(t,e,r,n){return e.slice(-4)===".bin"?PB(t,r,n):SB(t,r,n)}function zG(t,e,r){return t3(t,r)}function HG(t,e,r){return e.slice(-4)===".bin"?H7(t,r):j7(t,r)}function GG(t,e,r){return e.slice(-4)===".bin"?Oj(t,r):Aj(t,r)}function qG(t,e,r){return e.slice(-4)===".bin"?Tj(t):_j(t)}function WG(t,e,r,n){return r.slice(-4)===".bin"?wj(t,e,r,n):void 0}function XG(t,e,r){return e.slice(-4)===".bin"?xj(t,e,r):yj(t,e,r)}function $G(t,e,r){return(e.slice(-4)===".bin"?MG:E3)(t)}function KG(t,e,r,n,a){return(e.slice(-4)===".bin"?cG:g3)(t,r,n,a)}function YG(t,e,r){return(e.slice(-4)===".bin"?WB:Zk)(t,r)}function QG(t,e,r){return(e.slice(-4)===".bin"?W7:qk)(t,r)}function JG(t,e,r){return(e.slice(-4)===".bin"?Mj:a3)(t)}function ZG(t){return(t.slice(-4)===".bin"?vj:r3)()}var T3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,w3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(T3),i,l,u,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(w3),(l=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(l+1),n[u]=i[2].slice(1,i[2].length-1));return n}function eq(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(T3),a,i,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(w3),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),r[l]=a[2].slice(1,a[2].length-1));return r}var mh;function tq(t,e){var r=mh[t]||Lt(t);return r==="General"?ql(e):ts(r,e)}function rq(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=pr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=xr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Lt(e)]=a}function nq(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Gi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Oh(t.v):t.w=ql(t.v):t.w=tq(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=mh[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Pu(n)){var a=Ol(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function aq(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=gB[n.Pattern]||n.Pattern)}t[e.ID]=e}function sq(t,e,r,n,a,i,l,u,f,h){var m="General",x=n.StyleID,v={};h=h||{};var E=[],w=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&l&&(x=l.StyleID);i[x]!==void 0&&(i[x].nf&&(m=i[x].nf),i[x].Interior&&E.push(i[x].Interior),!!i[x].Parent);)x=i[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=pr(t);break;case"String":n.t="s",n.r=bA(Lt(t)),n.v=t.indexOf("<")>-1?Lt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(xr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Lt(t):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=xk[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=bA(e||t));break}if(nq(n,m,h),h.cellFormula!==!1)if(n.Formula){var T=Lt(n.Formula);T.charCodeAt(0)==61&&(T=T.slice(1)),n.f=mu(T,a),delete n.Formula,n.ArrayRange=="RC"?n.F=mu("RC:RC",a):n.ArrayRange&&(n.F=mu(n.ArrayRange,a),f.push([Vt(n.F),n.F]))}else for(w=0;w<f.length;++w)a.r>=f[w][0].s.r&&a.r<=f[w][0].e.r&&a.c>=f[w][0].s.c&&a.c<=f[w][0].e.c&&(n.F=f[w][1]);h.cellStyles&&(E.forEach(function(A){!v.patternType&&A.patternType&&(v.patternType=A.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function iq(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Tx(t,e){var r=e||{};Lu();var n=Yf(qy(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=or(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=vr(r);return l.type="string",wu.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(qe){a.indexOf("<"+qe)>=0&&(i=!0)}),i)return qq(n,r);mh={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],h,m={},x=[],v=r.dense?[]:{},E="",w={},T={},A=gs('<Data ss:Type="String">'),I=0,O=0,D=0,q={s:{r:2e6,c:2e6},e:{r:0,c:0}},Y={},W={},N="",b=0,k=[],F={},P={},M=0,j=[],Le=[],De={},ne=[],ae,fe=!1,ie=[],Fe=[],ee={},B=0,Q=0,J={Sheets:[],WBProps:{date1904:!1}},te={};Lh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";u=Lh.exec(n);)switch(u[3]=(ce=u[3]).toLowerCase()){case"data":if(ce=="data"){if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?sq(n.slice(I,u.index),N,A,f[f.length-1][0]=="comment"?De:w,{c:O,r:D},Y,ne[O],T,ie,r):(N="",A=gs(u[0]),I=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Le.length>0&&(w.c=Le),(!r.sheetRows||r.sheetRows>D)&&w.v!==void 0&&(r.dense?(v[D]||(v[D]=[]),v[D][O]=w):v[br(O)+Ur(D)]=w),w.HRef&&(w.l={Target:Lt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(B=O+(parseInt(w.MergeAcross,10)|0),Q=D+(parseInt(w.MergeDown,10)|0),k.push({s:{c:O,r:D},e:{c:B,r:Q}})),!r.sheetStubs)w.MergeAcross?O=B+1:++O;else if(w.MergeAcross||w.MergeDown){for(var Se=O;Se<=B;++Se)for(var Oe=D;Oe<=Q;++Oe)(Se>O||Oe>D)&&(r.dense?(v[Oe]||(v[Oe]=[]),v[Oe][Se]={t:"z"}):v[br(Se)+Ur(Oe)]={t:"z"});O=B+1}else++O;else w=eq(u[0]),w.Index&&(O=+w.Index-1),O<q.s.c&&(q.s.c=O),O>q.e.c&&(q.e.c=O),u[0].slice(-2)==="/>"&&++O,Le=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(D<q.s.r&&(q.s.r=D),D>q.e.r&&(q.e.r=D),u[0].slice(-2)==="/>"&&(T=gs(u[0]),T.Index&&(D=+T.Index-1)),O=0,++D):(T=gs(u[0]),T.Index&&(D=+T.Index-1),ee={},(T.AutoFitHeight=="0"||T.Height)&&(ee.hpx=parseInt(T.Height,10),ee.hpt=zh(ee.hpx),Fe[D]=ee),T.Hidden=="1"&&(ee.hidden=!0,Fe[D]=ee));break;case"worksheet":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));x.push(E),q.s.r<=q.e.r&&q.s.c<=q.e.c&&(v["!ref"]=Et(q),r.sheetRows&&r.sheetRows<=q.e.r&&(v["!fullref"]=v["!ref"],q.e.r=r.sheetRows-1,v["!ref"]=Et(q))),k.length&&(v["!merges"]=k),ne.length>0&&(v["!cols"]=ne),Fe.length>0&&(v["!rows"]=Fe),m[E]=v}else q={s:{r:2e6,c:2e6},e:{r:0,c:0}},D=O=0,f.push([u[3],!1]),h=gs(u[0]),E=Lt(h.Name),v=r.dense?[]:{},k=[],ie=[],Fe=[],te={name:E,Hidden:0},J.Sheets.push(te);break;case"table":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),ne=[],fe=!1}break;case"style":u[1]==="/"?aq(Y,W,r):W=gs(u[0]);break;case"numberformat":W.nf=Lt(gs(u[0]).Format||"General"),mh[W.nf]&&(W.nf=mh[W.nf]);for(var ke=0;ke!=392&&lt[ke]!=W.nf;++ke);if(ke==392){for(ke=57;ke!=392;++ke)if(lt[ke]==null){Ri(W.nf,ke);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ae=gs(u[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!fe&&ae.wpx>10){fe=!0,Pn=Qk;for(var se=0;se<ne.length;++se)ne[se]&&zo(ne[se])}fe&&zo(ae),ne[ae.Index-1||ne.length]=ae;for(var Me=0;Me<+ae.Span;++Me)ne[ne.length]=vr(ae);break;case"namedrange":if(u[1]==="/")break;J.Names||(J.Names=[]);var V=dt(u[0]),we={Name:V.Name,Ref:mu(V.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(we.Sheet=J.Sheets.length-1),J.Names.push(we);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?N+=n.slice(b,u.index):b=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=gs(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?R9(F,ce,n.slice(M,u.index)):M=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));iq(De),Le.push(De)}else f.push([u[3],!1]),h=gs(u[0]),De={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ae=gs(u[0]);v["!autofilter"]={ref:mu(Ae.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return mb(n,r);var Je=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(u[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(M,u.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else M=u.index+u[0].length;break;case"header":v["!margins"]||zl(v["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(v["!margins"].header=+dt(u[0]).Margin);break;case"footer":v["!margins"]||zl(v["!margins"]={},"xlml"),isNaN(+dt(u[0]).Margin)||(v["!margins"].footer=+dt(u[0]).Margin);break;case"pagemargins":var Ye=dt(u[0]);v["!margins"]||zl(v["!margins"]={},"xlml"),isNaN(+Ye.Top)||(v["!margins"].top=+Ye.Top),isNaN(+Ye.Left)||(v["!margins"].left=+Ye.Left),isNaN(+Ye.Right)||(v["!margins"].right=+Ye.Right),isNaN(+Ye.Bottom)||(v["!margins"].bottom=+Ye.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?rq(P,ce,j,n.slice(M,u.index)):(j=u,M=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var ge={};return!r.bookSheets&&!r.bookProps&&(ge.Sheets=m),ge.SheetNames=x,ge.Workbook=J,ge.SSF=vr(lt),ge.Props=F,ge.Custprops=P,ge}function yv(t,e){switch(p_(e=e||{}),e.type||"base64"){case"base64":return Tx(ka(t),e);case"binary":case"buffer":case"file":return Tx(t,e);case"array":return Tx(Jo(t),e)}}function oq(t,e){var r=[];return t.Props&&r.push(D9(t.Props,e)),t.Custprops&&r.push(I9(t.Props,t.Custprops)),r.join("")}function lq(){return""}function cq(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var i=[];i.push(Ge("NumberFormat",null,{"ss:Format":tr(lt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Ge("Style",i.join(""),l))}),Ge("Styles",r.join(""))}function S3(t){return Ge("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+c_(t.Ref,{r:0,c:0})})}function uq(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(S3(a)))}return Ge("Names",r.join(""))}function fq(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||i.push(S3(u)))}return i.join("")}function hq(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ge("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ge("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ge("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(An("ProtectContents","True")),t["!protect"].objects&&a.push(An("ProtectObjects","True")),t["!protect"].scenarios&&a.push(An("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(An("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(An("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Ge("WorksheetOptions",a.join(""),{xmlns:Sa.x})}function dq(t){return t.map(function(e){var r=OL(e.t||""),n=Ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ge("Comment",n,{"ss:Author":e.a})}).join("")}function mq(t,e,r,n,a,i,l){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+tr(c_(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var f=Nr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=tr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=tr(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],m=0;m!=h.length;++m)h[m].s.c!=l.c||h[m].s.r!=l.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var x="",v="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",v=String(t.v);break;case"b":x="Boolean",v=t.v?"1":"0";break;case"e":x="Error",v=Gi[t.v];break;case"d":x="DateTime",v=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||lt[14]);break;case"s":x="String",v=FL(t.v||"");break}var E=el(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+E),u["ss:Index"]=l.c+1;var w=t.v!=null?v:"",T=t.t=="z"?"":'<Data ss:Type="'+x+'">'+w+"</Data>";return(t.c||[]).length>0&&(T+=dq(t.c)),Ge("Cell",T,u)}function pq(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Su(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gq(t,e,r,n){if(!t["!ref"])return"";var a=Vt(t["!ref"]),i=t["!merges"]||[],l=0,u=[];t["!cols"]&&t["!cols"].forEach(function(A,I){zo(A);var O=!!A.width,D=Pp(I,A),q={"ss:Index":I+1};O&&(q["ss:Width"]=jh(D.width)),A.hidden&&(q["ss:Hidden"]="1"),u.push(Ge("Column",null,q))});for(var f=Array.isArray(t),h=a.s.r;h<=a.e.r;++h){for(var m=[pq(h,(t["!rows"]||[])[h])],x=a.s.c;x<=a.e.c;++x){var v=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>x)&&!(i[l].s.r>h)&&!(i[l].e.c<x)&&!(i[l].e.r<h)){(i[l].s.c!=x||i[l].s.r!=h)&&(v=!0);break}if(!v){var E={r:h,c:x},w=ct(E),T=f?(t[h]||[])[x]:t[w];m.push(mq(T,w,t,e,r,n,E))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function xq(t,e,r){var n=[],a=r.SheetNames[t],i=r.Sheets[a],l=i?fq(i,e,t,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=i?gq(i,e,t,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(hq(i,e,t,r)),n.join("")}function vq(t,e){e||(e={}),t.SSF||(t.SSF=vr(lt)),t.SSF&&(Lu(),kp(t.SSF),e.revssf=Dp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],el(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(oq(t,e)),r.push(lq()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ge("Worksheet",xq(n,e,t),{"ss:Name":tr(t.SheetNames[n])}));return r[2]=cq(t,e),r[3]=uq(t),zr+Ge("Workbook",r.join(""),{xmlns:Sa.ss,"xmlns:o":Sa.o,"xmlns:x":Sa.x,"xmlns:ss":Sa.ss,"xmlns:dt":Sa.dt,"xmlns:html":Sa.html})}function yq(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=u9(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=f9(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var _q=[60,1084,2066,2165,2175];function Eq(t,e,r,n,a){var i=n,l=[],u=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=i;for(var f=bi(r,r.l),h=_v[f],m=0;h!=null&&_q.indexOf(f)>-1;)i=bi(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=r.slice(m,r.l+4+i),l.push(u),r.l+=4+i,h=_v[f=bi(r,r.l)];var x=hn(l);Sn(x,0);var v=0;x.lens=[];for(var E=0;E<l.length;++E)x.lens.push(v),v+=l[E].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,a)}function Vs(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=lt[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Gi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Oh(t.v):t.w=ql(t.v):t.w=ts(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Pu(lt[n]||String(n))){var a=Ol(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function am(t,e,r){return{v:t,ixfe:e,t:r}}function Tq(t,e){var r={opts:{}},n={},a=e.dense?[]:{},i={},l={},u=null,f=[],h="",m={},x,v="",E,w,T,A,I={},O=[],D,q,Y=[],W=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},b={},k=function(vt){return vt<8?Bl[vt]:vt<64&&W[vt-8]||Bl[vt]},F=function(vt,fr,pn){var Ht=fr.XF.data;if(!(!Ht||!Ht.patternType||!pn||!pn.cellStyles)){fr.s={},fr.s.patternType=Ht.patternType;var hr;(hr=Bh(k(Ht.icvFore)))&&(fr.s.fgColor={rgb:hr}),(hr=Bh(k(Ht.icvBack)))&&(fr.s.bgColor={rgb:hr})}},P=function(vt,fr,pn){if(!(ee>1)&&!(pn.sheetRows&&vt.r>=pn.sheetRows)){if(pn.cellStyles&&fr.XF&&fr.XF.data&&F(vt,fr,pn),delete fr.ixfe,delete fr.XF,x=vt,v=ct(vt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),vt.r<l.s.r&&(l.s.r=vt.r),vt.c<l.s.c&&(l.s.c=vt.c),vt.r+1>l.e.r&&(l.e.r=vt.r+1),vt.c+1>l.e.c&&(l.e.c=vt.c+1),pn.cellFormula&&fr.f){for(var Ht=0;Ht<O.length;++Ht)if(!(O[Ht][0].s.c>vt.c||O[Ht][0].s.r>vt.r)&&!(O[Ht][0].e.c<vt.c||O[Ht][0].e.r<vt.r)){fr.F=Et(O[Ht][0]),(O[Ht][0].s.c!=vt.c||O[Ht][0].s.r!=vt.r)&&delete fr.f,fr.f&&(fr.f=""+Mn(O[Ht][1],l,vt,ie,M));break}}pn.dense?(a[vt.r]||(a[vt.r]=[]),a[vt.r][vt.c]=fr):a[v]=fr}},M={enc:!1,sbcch:0,snames:[],sharedf:I,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(M.password=e.password);var j,Le=[],De=[],ne=[],ae=[],fe=!1,ie=[];ie.SheetNames=M.snames,ie.sharedf=M.sharedf,ie.arrayf=M.arrayf,ie.names=[],ie.XTI=[];var Fe=0,ee=0,B=0,Q=[],J=[],te;M.codepage=1200,ys(1200);for(var ce=!1;t.l<t.length-1;){var Se=t.l,Oe=t.read_shift(2);if(Oe===0&&Fe===10)break;var ke=t.l===t.length?0:t.read_shift(2),se=_v[Oe];if(se&&se.f){if(e.bookSheets&&Fe===133&&Oe!==133)break;if(Fe=Oe,se.r===2||se.r==12){var Me=t.read_shift(2);if(ke-=2,!M.enc&&Me!==Oe&&((Me&255)<<8|Me>>8)!==Oe)throw new Error("rt mismatch: "+Me+"!="+Oe);se.r==12&&(t.l+=10,ke-=10)}var V={};if(Oe===10?V=se.f(t,ke,M):V=Eq(Oe,se,t,ke,M),ee==0&&[9,521,1033,2057].indexOf(Fe)===-1)continue;switch(Oe){case 34:r.opts.Date1904=N.WBProps.date1904=V;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(t.l=0),M.enc=V,!e.password)throw new Error("File is password-protected");if(V.valid==null)throw new Error("Encryption scheme unsupported");if(!V.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=V;break;case 66:var we=Number(V);switch(we){case 21010:we=1200;break;case 32768:we=1e4;break;case 32769:we=1252;break}ys(M.codepage=we),ce=!0;break;case 317:M.rrtabid=V;break;case 25:M.winlocked=V;break;case 439:r.opts.RefreshAll=V;break;case 12:r.opts.CalcCount=V;break;case 16:r.opts.CalcDelta=V;break;case 17:r.opts.CalcIter=V;break;case 13:r.opts.CalcMode=V;break;case 14:r.opts.CalcPrecision=V;break;case 95:r.opts.CalcSaveRecalc=V;break;case 15:M.CalcRefMode=V;break;case 2211:r.opts.FullCalc=V;break;case 129:V.fDialog&&(a["!type"]="dialog"),V.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),V.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:Y.push(V);break;case 430:ie.push([V]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(V);break;case 24:case 536:te={Name:V.Name,Ref:Mn(V.rgce,l,null,ie,M)},V.itab>0&&(te.Sheet=V.itab-1),ie.names.push(te),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(V),V.Name=="_xlnm._FilterDatabase"&&V.itab>0&&V.rgce&&V.rgce[0]&&V.rgce[0][0]&&V.rgce[0][0][0]=="PtgArea3d"&&(J[V.itab-1]={ref:Et(V.rgce[0][0][1][2])});break;case 22:M.ExternCount=V;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(V),ie.XTI=ie.XTI.concat(V);break;case 2196:if(M.biff<8)break;te!=null&&(te.Comment=V[1]);break;case 18:a["!protect"]=V;break;case 19:V!==0&&M.WTF&&console.error("Password verifier: "+V);break;case 133:i[V.pos]=V,M.snames.push(V.name);break;case 10:{if(--ee)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Et(l),e.sheetRows&&e.sheetRows<=l.e.r){var Ae=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Et(l),l.e.r=Ae}l.e.r++,l.e.c++}Le.length>0&&(a["!merges"]=Le),De.length>0&&(a["!objects"]=De),ne.length>0&&(a["!cols"]=ne),ae.length>0&&(a["!rows"]=ae),N.Sheets.push(b)}h===""?m=a:n[h]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[Oe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[V.BIFFVer]||8),M.biffguess=V.BIFFVer==0,V.BIFFVer==0&&V.dt==4096&&(M.biff=5,ce=!0,ys(M.codepage=28591)),M.biff==8&&V.BIFFVer==0&&V.dt==16&&(M.biff=2),ee++)break;if(a=e.dense?[]:{},M.biff<8&&!ce&&(ce=!0,ys(M.codepage=e.codepage||1252)),M.biff<5||V.BIFFVer==0&&V.dt==4096){h===""&&(h="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:t.l-ke,name:h};i[Je.pos]=Je,M.snames.push(h)}else h=(i[Se]||{name:""}).name;V.dt==32&&(a["!type"]="chart"),V.dt==64&&(a["!type"]="macro"),Le=[],De=[],M.arrayf=O=[],ne=[],ae=[],fe=!1,b={Hidden:(i[Se]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[V.r]||[])[V.c]:a[ct({c:V.c,r:V.r})])&&++V.c,D={ixfe:V.ixfe,XF:Y[V.ixfe]||{},v:V.val,t:"n"},B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:V.c,r:V.r},D,e);break;case 5:case 517:D={ixfe:V.ixfe,XF:Y[V.ixfe],v:V.val,t:V.t},B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:V.c,r:V.r},D,e);break;case 638:D={ixfe:V.ixfe,XF:Y[V.ixfe],v:V.rknum,t:"n"},B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:V.c,r:V.r},D,e);break;case 189:for(var Ye=V.c;Ye<=V.C;++Ye){var ge=V.rkrec[Ye-V.c][0];D={ixfe:ge,XF:Y[ge],v:V.rkrec[Ye-V.c][1],t:"n"},B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:Ye,r:V.r},D,e)}break;case 6:case 518:case 1030:{if(V.val=="String"){u=V;break}if(D=am(V.val,V.cell.ixfe,V.tt),D.XF=Y[D.ixfe],e.cellFormula){var qe=V.formula;if(qe&&qe[0]&&qe[0][0]&&qe[0][0][0]=="PtgExp"){var Be=qe[0][0][1][0],Qe=qe[0][0][1][1],zt=ct({r:Be,c:Qe});I[zt]?D.f=""+Mn(V.formula,l,V.cell,ie,M):D.F=((e.dense?(a[Be]||[])[Qe]:a[zt])||{}).F}else D.f=""+Mn(V.formula,l,V.cell,ie,M)}B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P(V.cell,D,e),u=V}break;case 7:case 519:if(u)u.val=V,D=am(V,u.cell.ixfe,"s"),D.XF=Y[D.ixfe],e.cellFormula&&(D.f=""+Mn(u.formula,l,u.cell,ie,M)),B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P(u.cell,D,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(V);var Wt=ct(V[0].s);if(E=e.dense?(a[V[0].s.r]||[])[V[0].s.c]:a[Wt],e.cellFormula&&E){if(!u||!Wt||!E)break;E.f=""+Mn(V[1],l,V[0],ie,M),E.F=Et(V[0])}}break;case 1212:{if(!e.cellFormula)break;if(v){if(!u)break;I[ct(u.cell)]=V[0],E=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ct(u.cell)],(E||{}).f=""+Mn(V[0],l,x,ie,M)}}break;case 253:D=am(f[V.isst].t,V.ixfe,"s"),f[V.isst].h&&(D.h=f[V.isst].h),D.XF=Y[D.ixfe],B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:V.c,r:V.r},D,e);break;case 513:e.sheetStubs&&(D={ixfe:V.ixfe,XF:Y[V.ixfe],t:"z"},B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:V.c,r:V.r},D,e));break;case 190:if(e.sheetStubs)for(var rr=V.c;rr<=V.C;++rr){var ft=V.ixfe[rr-V.c];D={ixfe:ft,XF:Y[ft],t:"z"},B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:rr,r:V.r},D,e)}break;case 214:case 516:case 4:D=am(V.val,V.ixfe,"s"),D.XF=Y[D.ixfe],B>0&&(D.z=Q[D.ixfe>>8&63]),Vs(D,e,r.opts.Date1904),P({c:V.c,r:V.r},D,e);break;case 0:case 512:ee===1&&(l=V);break;case 252:f=V;break;case 1054:if(M.biff==4){Q[B++]=V[1];for(var lr=0;lr<B+163&&lt[lr]!=V[1];++lr);lr>=163&&Ri(V[1],B+163)}else Ri(V[1],V[0]);break;case 30:{Q[B++]=V;for(var en=0;en<B+163&&lt[en]!=V;++en);en>=163&&Ri(V,B+163)}break;case 229:Le=Le.concat(V);break;case 93:De[V.cmo[0]]=M.lastobj=V;break;case 438:M.lastobj.TxO=V;break;case 127:M.lastobj.ImData=V;break;case 440:for(A=V[0].s.r;A<=V[0].e.r;++A)for(T=V[0].s.c;T<=V[0].e.c;++T)E=e.dense?(a[A]||[])[T]:a[ct({c:T,r:A})],E&&(E.l=V[1]);break;case 2048:for(A=V[0].s.r;A<=V[0].e.r;++A)for(T=V[0].s.c;T<=V[0].e.c;++T)E=e.dense?(a[A]||[])[T]:a[ct({c:T,r:A})],E&&E.l&&(E.l.Tooltip=V[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;E=e.dense?(a[V[0].r]||[])[V[0].c]:a[ct(V[0])];var ha=De[V[2]];E||(e.dense?(a[V[0].r]||(a[V[0].r]=[]),E=a[V[0].r][V[0].c]={t:"z"}):E=a[ct(V[0])]={t:"z"},l.e.r=Math.max(l.e.r,V[0].r),l.s.r=Math.min(l.s.r,V[0].r),l.e.c=Math.max(l.e.c,V[0].c),l.s.c=Math.min(l.s.c,V[0].c)),E.c||(E.c=[]),w={a:V[1],t:ha.TxO.t},E.c.push(w)}break;case 2173:cj(Y[V.ixfe],V.ext);break;case 125:{if(!M.cellStyles)break;for(;V.e>=V.s;)ne[V.e--]={width:V.w/256,level:V.level||0,hidden:!!(V.flags&1)},fe||(fe=!0,i_(V.w/256)),zo(ne[V.e+1])}break;case 520:{var yr={};V.level!=null&&(ae[V.r]=yr,yr.level=V.level),V.hidden&&(ae[V.r]=yr,yr.hidden=!0),V.hpt&&(ae[V.r]=yr,yr.hpt=V.hpt,yr.hpx=Su(V.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zl(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Oe]]=V;break;case 161:a["!margins"]||zl(a["!margins"]={}),a["!margins"].header=V.header,a["!margins"].footer=V.footer;break;case 574:V.RTL&&(N.Views[0].RTL=!0);break;case 146:W=V;break;case 2198:j=V;break;case 140:q=V;break;case 442:h?b.CodeName=V||b.name:N.WBProps.CodeName=V||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+Oe.toString(16)),t.l+=ke}return r.SheetNames=Mr(i).sort(function(Zn,vt){return Number(Zn)-Number(vt)}).map(function(Zn){return i[Zn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&J.forEach(function(Zn,vt){r.Sheets[r.SheetNames[vt]]["!autofilter"]=Zn}),r.Strings=f,r.SSF=vr(lt),M.enc&&(r.Encryption=M.enc),j&&(r.Themes=j),r.Metadata={},q!==void 0&&(r.Metadata.Country=q),ie.names.length>0&&(N.Names=ie.names),r.Workbook=N,r}var ph={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function wq(t,e,r){var n=st.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=GA(n,dv,ph.DSI);for(var i in a)e[i]=a[i]}catch(h){if(r.WTF)throw h}var l=st.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=GA(l,mv,ph.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(wk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Sq(t,e){var r=[],n=[],a=[],i=0,l,u=_A(dv,"n"),f=_A(mv,"n");if(t.Props)for(l=Mr(t.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(u,l[i])?r:Object.prototype.hasOwnProperty.call(f,l[i])?n:a).push([l[i],t.Props[l[i]]]);if(t.Custprops)for(l=Mr(t.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(u,l[i])?r:Object.prototype.hasOwnProperty.call(f,l[i])?n:a).push([l[i],t.Custprops[l[i]]]);var h=[];for(i=0;i<a.length;++i)Rk.indexOf(a[i][0])>-1||Tk.indexOf(a[i][0])>-1||a[i][1]!=null&&h.push(a[i]);n.length&&st.utils.cfb_add(e,"/SummaryInformation",qA(n,ph.SI,f,mv)),(r.length||h.length)&&st.utils.cfb_add(e,"/DocumentSummaryInformation",qA(r,ph.DSI,u,dv,h.length?h:null,ph.UDI))}function A3(t,e){e||(e={}),p_(e),Py(),e.codepage&&My(e.codepage);var r,n;if(t.FullPaths){if(st.find(t,"/encryption"))throw new Error("File is password-protected");r=st.find(t,"!CompObj"),n=st.find(t,"/Workbook")||st.find(t,"/Book")}else{switch(e.type){case"base64":t=Na(ka(t));break;case"binary":t=Na(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sn(t,0),n={content:t}}var a,i;if(r&&yq(r),e.bookProps&&!e.bookSheets)a={};else{var l=St?"buffer":"array";if(n&&n.content)a=Tq(n.content,e);else if((i=st.find(t,"PerfectOffice_MAIN"))&&i.content)a=Ul.to_workbook(i.content,(e.type=l,e));else if((i=st.find(t,"NativeContent_MAIN"))&&i.content)a=Ul.to_workbook(i.content,(e.type=l,e));else throw(i=st.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&st.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Lj(t))}var u={};return t.FullPaths&&wq(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function Aq(t,e){var r=e||{},n=st.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return st.utils.cfb_add(n,a,b3(t,r)),r.biff==8&&(t.Props||t.Custprops)&&Sq(t,n),r.biff==8&&t.vbaraw&&Vj(n,st.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Hh={0:{f:Kz},1:{f:nH},2:{f:TH},3:{f:fH},4:{f:oH},5:{f:yH},6:{f:NH},7:{f:pH},8:{f:OH},9:{f:FH},10:{f:DH},11:{f:IH},12:{f:sH},13:{f:SH},14:{f:dH},15:{f:cH},16:{f:x3},17:{f:kH},18:{f:xH},19:{f:Yy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:kG},40:{},42:{},43:{f:NB},44:{f:AB},45:{f:RB},46:{f:IB},47:{f:DB},48:{},49:{f:JL},50:{},51:{f:hj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Uk},62:{f:bH},63:{f:Ej},64:{f:YH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Un,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:WH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tH},148:{f:Jz,p:16},151:{f:jH},152:{},153:{f:bG},154:{},155:{},156:{f:SG},157:{},158:{},159:{T:1,f:z7},160:{T:-1},161:{T:1,f:ic},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:MH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:uj},336:{T:-1},337:{f:pj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:UH},427:{f:zH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:GH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eH},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:VH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Ij},633:{T:1},634:{T:-1},635:{T:1,f:Rj},636:{T:-1},637:{f:r9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:dG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:QH},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_v={6:{f:_x},10:{f:Ao},12:{f:Qr},13:{f:Qr},14:{f:Br},15:{f:Br},16:{f:Vn},17:{f:Br},18:{f:Br},19:{f:Qr},20:{f:QA},21:{f:QA},23:{f:jk},24:{f:ZA},25:{f:Br},26:{},27:{},28:{f:QV},29:{},34:{f:Br},35:{f:JA},38:{f:Vn},39:{f:Vn},40:{f:Vn},41:{f:Vn},42:{f:Br},43:{f:Br},47:{f:cB},49:{f:SV},51:{f:Qr},60:{},61:{f:yV},64:{f:Br},65:{f:wV},66:{f:Qr},77:{},80:{},81:{},82:{},85:{f:Qr},89:{},90:{},91:{},92:{f:lV},93:{f:e7},94:{},95:{f:Br},96:{},97:{},99:{f:Br},125:{f:Uk},128:{f:BV},129:{f:uV},130:{f:Qr},131:{f:Br},132:{f:Br},133:{f:fV},134:{},140:{f:l7},141:{f:Qr},144:{},146:{f:f7},151:{},152:{},153:{},154:{},155:{},156:{f:Qr},157:{},158:{},160:{f:v7},161:{f:m7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:MV},190:{f:PV},193:{f:Ao},197:{},198:{},199:{},200:{},201:{},202:{f:Br},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Qr},220:{},221:{f:Br},222:{},224:{f:VV},225:{f:oV},226:{f:Ao},227:{},229:{f:JV},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:dV},253:{f:bV},255:{f:pV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Dk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Br},353:{f:Ao},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:GV},431:{f:Br},432:{},433:{},434:{},437:{},438:{f:n7},439:{f:Br},440:{f:a7},441:{},442:{f:u0},443:{},444:{f:Qr},445:{},446:{},448:{f:Ao},449:{f:vV,r:2},450:{f:Ao},512:{f:$A},513:{f:x7},515:{f:zV},516:{f:CV},517:{f:YA},519:{f:y7},520:{f:gV},523:{},545:{f:eb},549:{f:XA},566:{},574:{f:EV},638:{f:OV},659:{},1048:{},1054:{f:RV},1084:{},1212:{f:$V},2048:{f:i7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ao},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:h7,r:12},2173:{f:lj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Br,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:XV,r:12},2197:{},2198:{f:rj,r:12},2199:{},2200:{},2201:{},2202:{f:KV,r:12},2203:{f:Ao},2204:{},2205:{},2206:{},2207:{},2211:{f:xV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Qr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:p7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:u7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$A},1:{},2:{f:S7},3:{f:T7},4:{f:E7},5:{f:YA},7:{f:b7},8:{},9:{f:tm},11:{},22:{f:Qr},30:{f:IV},31:{},32:{},33:{f:eb},36:{},37:{f:XA},50:{f:N7},62:{},52:{},67:{},68:{f:Qr},69:{},86:{},126:{},127:{f:_7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:C7},223:{},234:{},354:{},421:{},518:{f:_x},521:{f:tm},536:{f:ZA},547:{f:JA},561:{},579:{},1030:{f:_x},1033:{f:tm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function We(t,e,r,n){var a=e;if(!isNaN(a)){var i=n||(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&Xy(r)&&t.push(r)}}function bq(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return We(t,e,r,a);var i=e;if(!isNaN(i)){for(var l=r.parts||[],u=0,f=0,h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;var m=t.next(4);for(m.write_shift(2,i),m.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h;f<a;){for(m=t.next(4),m.write_shift(2,60),h=0;h+(l[u]||8224)<=8224;)h+=l[u]||8224,u++;m.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h}}}function m0(t,e,r){return t||(t=be(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Nq(t,e,r,n){var a=be(9);return m0(a,t,e),Ik(r,n||"b",a),a}function Cq(t,e,r){var n=be(8+2*r.length);return m0(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function kq(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?on(xr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?We(t,2,A7(r,n,a)):We(t,3,w7(r,n,a));return;case"b":case"e":We(t,5,Nq(r,n,e.v,e.t));return;case"s":case"str":We(t,4,Cq(r,n,(e.v||"").slice(0,255)));return}We(t,1,m0(null,r,n))}function Rq(t,e,r,n){var a=Array.isArray(e),i=Vt(e["!ref"]||"A1"),l,u="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=Et(i)}for(var h=i.s.r;h<=i.e.r;++h){u=Ur(h);for(var m=i.s.c;m<=i.e.c;++m){h===i.s.r&&(f[m]=br(m)),l=f[m]+u;var x=a?(e[h]||[])[m]:e[l];x&&kq(t,x,h,m)}}}function Dq(t,e){for(var r=e||{},n=ua(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return We(n,r.biff==4?1033:r.biff==3?521:9,n_(t,16,r)),Rq(n,t.Sheets[t.SheetNames[a]],a,r),We(n,10),n.end()}function Iq(t,e,r){We(t,49,AV({sz:12,name:"Arial"},r))}function Fq(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&We(t,1054,DV(a,e[a],r))})}function Oq(t,e){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),We(t,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Lk(Vt(e["!ref"]||"A1"),r),r.write_shift(4,4),We(t,2152,r)}function Mq(t,e){for(var r=0;r<16;++r)We(t,224,KA({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){We(t,224,KA(n,0,e))})}function Pq(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];We(t,440,s7(n)),n[1].Tooltip&&We(t,2048,o7(n))}delete e["!links"]}function Lq(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&We(t,125,d7(Pp(a,n),a))})}}function Vq(t,e,r,n,a){var i=16+el(a.cellXfs,e,a);if(e.v==null&&!e.bf){We(t,513,Kl(r,n,i));return}if(e.bf)We(t,6,uz(e,r,n,a,i));else switch(e.t){case"d":case"n":var l=e.t=="d"?on(xr(e.v)):e.v;We(t,515,HV(r,n,l,i));break;case"b":case"e":We(t,517,UV(r,n,e.v,i,a,e.t));break;case"s":case"str":if(a.bookSST){var u=f_(a.Strings,e.v,a.revStrings);We(t,253,NV(r,n,u,i))}else We(t,516,kV(r,n,(e.v||"").slice(0,255),i,a));break;default:We(t,513,Kl(r,n,i))}}function Bq(t,e,r){var n=ua(),a=r.SheetNames[t],i=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[t]||{},f=Array.isArray(i),h=e.biff==8,m,x="",v=[],E=Vt(i["!ref"]||"A1"),w=h?65536:16384;if(E.e.c>255||E.e.r>=w){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,w-1)}We(n,2057,n_(r,16,e)),We(n,13,Ka(1)),We(n,12,Ka(100)),We(n,15,Kn(!0)),We(n,17,Kn(!1)),We(n,16,Xl(.001)),We(n,95,Kn(!0)),We(n,42,Kn(!1)),We(n,43,Kn(!1)),We(n,130,Ka(1)),We(n,128,jV()),We(n,131,Kn(!1)),We(n,132,Kn(!1)),h&&Lq(n,i["!cols"]),We(n,512,FV(E,e)),h&&(i["!links"]=[]);for(var T=E.s.r;T<=E.e.r;++T){x=Ur(T);for(var A=E.s.c;A<=E.e.c;++A){T===E.s.r&&(v[A]=br(A)),m=v[A]+x;var I=f?(i[T]||[])[A]:i[m];I&&(Vq(n,I,T,A,e),h&&I.l&&i["!links"].push([m,I.l]))}}var O=u.CodeName||u.name||a;return h&&We(n,574,TV((l.Views||[])[0])),h&&(i["!merges"]||[]).length&&We(n,229,ZV(i["!merges"])),h&&Pq(n,i),We(n,442,Fk(O)),h&&Oq(n,i),We(n,10),n.end()}function jq(t,e,r){var n=ua(),a=(t||{}).Workbook||{},i=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(We(n,2057,n_(t,5,r)),r.bookType=="xla"&&We(n,135),We(n,225,u?Ka(1200):null),We(n,193,U9(2)),f&&We(n,191),f&&We(n,192),We(n,226),We(n,92,cV("SheetJS",r)),We(n,66,Ka(u?1200:1252)),u&&We(n,353,Ka(0)),u&&We(n,448),We(n,317,g7(t.SheetNames.length)),u&&t.vbaraw&&We(n,211),u&&t.vbaraw){var h=l.CodeName||"ThisWorkbook";We(n,442,Fk(h))}We(n,156,Ka(17)),We(n,25,Kn(!1)),We(n,18,Kn(!1)),We(n,19,Ka(0)),u&&We(n,431,Kn(!1)),u&&We(n,444,Ka(0)),We(n,61,_V()),We(n,64,Kn(!1)),We(n,141,Ka(0)),We(n,34,Kn(vG(t)=="true")),We(n,14,Kn(!0)),u&&We(n,439,Kn(!1)),We(n,218,Ka(0)),Iq(n,t,r),Fq(n,t.SSF,r),Mq(n,r),u&&We(n,352,Kn(!1));var m=n.end(),x=ua();u&&We(x,140,c7()),u&&r.Strings&&bq(x,252,mV(r.Strings)),We(x,10);var v=x.end(),E=ua(),w=0,T=0;for(T=0;T<t.SheetNames.length;++T)w+=(u?12:11)+(u?2:1)*t.SheetNames[T].length;var A=m.length+w+v.length;for(T=0;T<t.SheetNames.length;++T){var I=i[T]||{};We(E,133,hV({pos:A,hs:I.Hidden||0,dt:0,name:t.SheetNames[T]},r)),A+=e[T].length}var O=E.end();if(w!=O.length)throw new Error("BS8 "+w+" != "+O.length);var D=[];return m.length&&D.push(m),O.length&&D.push(O),v.length&&D.push(v),hn(D)}function Uq(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=vr(lt)),t&&t.SSF&&(Lu(),kp(t.SSF),r.revssf=Dp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,g_(r),r.cellXfs=[],el(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=Bq(a,r,t);return n.unshift(jq(t,n,r)),hn(n)}function b3(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=fa(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return Uq(t,e);case 4:case 3:case 2:return Dq(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function ub(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=a.index,u=i&&i.index||t.length,f=AL(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,x=0,v=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<f.length;++l){var T=f[l].trim(),A=T.slice(0,3).toLowerCase();if(A=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}m=0;continue}if(!(A!="<td"&&A!="<th")){var I=T.split(/<\/t[dh]>/i);for(u=0;u<I.length;++u){var O=I[u].trim();if(O.match(/<t[dh]/i)){for(var D=O,q=0;D.charAt(0)=="<"&&(q=D.indexOf(">"))>-1;)D=D.slice(q+1);for(var Y=0;Y<w.length;++Y){var W=w[Y];W.s.c==m&&W.s.r<h&&h<=W.e.r&&(m=W.e.c+1,Y=-1)}var N=dt(O.slice(0,O.indexOf(">")));v=N.colspan?+N.colspan:1,((x=+N.rowspan)>1||v>1)&&w.push({s:{r:h,c:m},e:{r:h+(x||1)-1,c:m+v-1}});var b=N.t||N["data-t"]||"";if(!D.length){m+=v;continue}if(D=YC(D),E.s.r>h&&(E.s.r=h),E.e.r<h&&(E.e.r=h),E.s.c>m&&(E.s.c=m),E.e.c<m&&(E.e.c=m),!D.length){m+=v;continue}var k={t:"s",v:D};r.raw||!D.trim().length||b=="s"||(D==="TRUE"?k={t:"b",v:!0}:D==="FALSE"?k={t:"b",v:!1}:isNaN(Ss(D))?isNaN(Tu(D).getDate())||(k={t:"d",v:xr(D)},r.cellDates||(k={t:"n",v:on(k.v)}),k.z=r.dateNF||lt[14]):k={t:"n",v:Ss(D)}),r.dense?(n[h]||(n[h]=[]),n[h][m]=k):n[ct({r:h,c:m})]=k,m+=v}}}}return n["!ref"]=Et(E),w.length&&(n["!merges"]=w),n}function zq(t,e,r,n){for(var a=t["!merges"]||[],i=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>l)&&!(a[h].e.r<r||a[h].e.c<l)){if(a[h].s.r<r||a[h].s.c<l){u=-1;break}u=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var m=ct({r,c:l}),x=n.dense?(t[r]||[])[l]:t[m],v=x&&x.v!=null&&(x.h||Gy(x.w||(Pi(x),x.w)||""))||"",E={};u>1&&(E.rowspan=u),f>1&&(E.colspan=f),n.editable?v='<span contenteditable="true">'+v+"</span>":x&&(E["data-t"]=x&&x.t||"z",x.v!=null&&(E["data-v"]=x.v),x.z!=null&&(E["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),E.id=(n.id||"sjs")+"-"+m,i.push(Ge("td",v,E))}}var w="<tr>";return w+i.join("")+"</tr>"}var Hq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Gq="</body></html>";function qq(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Zo(ub(r[0],e),e);var n=y_();return r.forEach(function(a,i){__(n,ub(a,e),"Sheet"+(i+1))}),n}function Wq(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function N3(t,e){var r=e||{},n=r.header!=null?r.header:Hq,a=r.footer!=null?r.footer:Gq,i=[n],l=fa(t["!ref"]);r.dense=Array.isArray(t),i.push(Wq(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)i.push(zq(t,l,u,r));return i.push("</table>"+a),i.join("")}function C3(t,e,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Nr(n.origin):n.origin;a=l.r,i=l.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var m=fa(t["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),a==-1&&(h.e.r=a=m.e.r+1)}var x=[],v=0,E=t["!rows"]||(t["!rows"]=[]),w=0,T=0,A=0,I=0,O=0,D=0;for(t["!cols"]||(t["!cols"]=[]);w<u.length&&T<f;++w){var q=u[w];if(fb(q)){if(n.display)continue;E[T]={hidden:!0}}var Y=q.children;for(A=I=0;A<Y.length;++A){var W=Y[A];if(!(n.display&&fb(W))){var N=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):YC(W.innerHTML),b=W.getAttribute("data-z")||W.getAttribute("z");for(v=0;v<x.length;++v){var k=x[v];k.s.c==I+i&&k.s.r<T+a&&T+a<=k.e.r&&(I=k.e.c+1-i,v=-1)}D=+W.getAttribute("colspan")||1,((O=+W.getAttribute("rowspan")||1)>1||D>1)&&x.push({s:{r:T+a,c:I+i},e:{r:T+a+(O||1)-1,c:I+i+(D||1)-1}});var F={t:"s",v:N},P=W.getAttribute("data-t")||W.getAttribute("t")||"";N!=null&&(N.length==0?F.t=P||"z":n.raw||N.trim().length==0||P=="s"||(N==="TRUE"?F={t:"b",v:!0}:N==="FALSE"?F={t:"b",v:!1}:isNaN(Ss(N))?isNaN(Tu(N).getDate())||(F={t:"d",v:xr(N)},n.cellDates||(F={t:"n",v:on(F.v)}),F.z=n.dateNF||lt[14]):F={t:"n",v:Ss(N)})),F.z===void 0&&b!=null&&(F.z=b);var M="",j=W.getElementsByTagName("A");if(j&&j.length)for(var Le=0;Le<j.length&&!(j[Le].hasAttribute("href")&&(M=j[Le].getAttribute("href"),M.charAt(0)!="#"));++Le);M&&M.charAt(0)!="#"&&(F.l={Target:M}),n.dense?(t[T+a]||(t[T+a]=[]),t[T+a][I+i]=F):t[ct({c:I+i,r:T+a})]=F,h.e.c<I+i&&(h.e.c=I+i),I+=D}}++T}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,T-1+a),t["!ref"]=Et(h),T>=f&&(t["!fullref"]=Et((h.e.r=u.length-w+T-1+a,h))),t}function k3(t,e){var r=e||{},n=r.dense?[]:{};return C3(n,t,e)}function Xq(t,e){return Zo(k3(t,e),e)}function fb(t){var e="",r=$q(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function $q(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Kq(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Lt(e.replace(/<[^>]*>/g,""));return[r]}var hb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function R3(t,e){var r=e||{},n=qy(t),a=[],i,l,u={name:""},f="",h=0,m,x,v={},E=[],w=r.dense?[]:{},T,A,I={value:""},O="",D=0,q=[],Y=-1,W=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},b=0,k={},F=[],P={},M=0,j=0,Le=[],De=1,ne=1,ae=[],fe={Names:[]},ie={},Fe=["",""],ee=[],B={},Q="",J=0,te=!1,ce=!1,Se=0;for(Lh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=Lh.exec(n);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"":T[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?w["!ref"]=Et(N):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(w["!fullref"]=w["!ref"],N.e.r=r.sheetRows-1,w["!ref"]=Et(N)),F.length&&(w["!merges"]=F),Le.length&&(w["!rows"]=Le),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),E.push(m.name),v[m.name]=w,ce=!1):T[0].charAt(T[0].length-2)!=="/"&&(m=dt(T[0],!1),Y=W=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,w=r.dense?[]:{},F=[],Le=[],ce=!0);break;case"table-row-group":T[1]==="/"?--b:++b;break;case"table-row":case"":if(T[1]==="/"){Y+=De,De=1;break}if(x=dt(T[0],!1),x.?Y=x.-1:Y==-1&&(Y=0),De=+x["number-rows-repeated"]||1,De<10)for(Se=0;Se<De;++Se)b>0&&(Le[Y+Se]={level:b});W=-1;break;case"covered-table-cell":T[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(w[Y]||(w[Y]=[]),w[Y][W]={t:"z"}):w[ct({r:Y,c:W})]={t:"z"}),O="",q=[];break;case"table-cell":case"":if(T[0].charAt(T[0].length-2)==="/")++W,I=dt(T[0],!1),ne=parseInt(I["number-columns-repeated"]||"1",10),A={t:"z",v:null},I.formula&&r.cellFormula!=!1&&(A.f=ob(Lt(I.formula))),(I.||I["value-type"])=="string"&&(A.t="s",A.v=Lt(I["string-value"]||""),r.dense?(w[Y]||(w[Y]=[]),w[Y][W]=A):w[ct({r:Y,c:W})]=A),W+=ne-1;else if(T[1]!=="/"){++W,O="",D=0,q=[],ne=1;var Oe=De?Y+De-1:Y;if(W>N.e.c&&(N.e.c=W),W<N.s.c&&(N.s.c=W),Y<N.s.r&&(N.s.r=Y),Oe>N.e.r&&(N.e.r=Oe),I=dt(T[0],!1),ee=[],B={},A={t:I.||I["value-type"],v:null},r.cellFormula)if(I.formula&&(I.formula=Lt(I.formula)),I["number-matrix-columns-spanned"]&&I["number-matrix-rows-spanned"]&&(M=parseInt(I["number-matrix-rows-spanned"],10)||0,j=parseInt(I["number-matrix-columns-spanned"],10)||0,P={s:{r:Y,c:W},e:{r:Y+M-1,c:W+j-1}},A.F=Et(P),ae.push([P,A.F])),I.formula)A.f=ob(I.formula);else for(Se=0;Se<ae.length;++Se)Y>=ae[Se][0].s.r&&Y<=ae[Se][0].e.r&&W>=ae[Se][0].s.c&&W<=ae[Se][0].e.c&&(A.F=ae[Se][1]);switch((I["number-columns-spanned"]||I["number-rows-spanned"])&&(M=parseInt(I["number-rows-spanned"],10)||0,j=parseInt(I["number-columns-spanned"],10)||0,P={s:{r:Y,c:W},e:{r:Y+M-1,c:W+j-1}},F.push(P)),I["number-columns-repeated"]&&(ne=parseInt(I["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=pr(I["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(I.value);break;case"percentage":A.t="n",A.v=parseFloat(I.value);break;case"currency":A.t="n",A.v=parseFloat(I.value);break;case"date":A.t="d",A.v=xr(I["date-value"]),r.cellDates||(A.t="n",A.v=on(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=TL(I["time-value"])/86400,r.cellDates&&(A.t="d",A.v=Ip(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(I.);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",I["string-value"]!=null&&(O=Lt(I["string-value"]),q=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(te=!1,A.t==="s"&&(A.v=O||"",q.length&&(A.R=q),te=D==0),ie.Target&&(A.l=ie),ee.length>0&&(A.c=ee,ee=[]),O&&r.cellText!==!1&&(A.w=O),te&&(A.t="z",delete A.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Y))for(var ke=0;ke<De;++ke){if(ne=parseInt(I["number-columns-repeated"]||"1",10),r.dense)for(w[Y+ke]||(w[Y+ke]=[]),w[Y+ke][W]=ke==0?A:vr(A);--ne>0;)w[Y+ke][W+ne]=vr(A);else for(w[ct({r:Y+ke,c:W})]=A;--ne>0;)w[ct({r:Y+ke,c:W+ne})]=vr(A);N.e.c<=W&&(N.e.c=W)}ne=parseInt(I["number-columns-repeated"]||"1",10),W+=ne-1,ne=0,A={},O="",q=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(T[1]==="/"){if((i=a.pop())[0]!==T[3])throw"Bad state: "+i}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!0]);break;case"annotation":if(T[1]==="/"){if((i=a.pop())[0]!==T[3])throw"Bad state: "+i;B.t=O,q.length&&(B.R=q),B.a=Q,ee.push(B)}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);Q="",J=0,O="",D=0,q=[];break;case"creator":T[1]==="/"?Q=n.slice(J,T.index):J=T.index+T[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(T[1]==="/"){if((i=a.pop())[0]!==T[3])throw"Bad state: "+i}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);O="",D=0,q=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(T[1]==="/"){if(k[u.name]=f,(i=a.pop())[0]!==T[3])throw"Bad state: "+i}else T[0].charAt(T[0].length-2)!=="/"&&(f="",u=dt(T[0],!1),a.push([T[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=dt(T[0],!1),f+=hb[T[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=dt(T[0],!1),f+=hb[T[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(T[0].slice(-2)==="/>")break;if(T[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(h,T.index);break}else h=T.index+T[0].length;break;case"named-range":l=dt(T[0],!1),Fe=Ex(l["cell-range-address"]);var se={Name:l.name,Ref:Fe[0]+"!"+Fe[1]};ce&&(se.Sheet=E.length),fe.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(T[1]==="/"&&(!I||!I["string-value"])){var Me=Kq(n.slice(D,T.index));O=(O.length>0?O+`
`:"")+Me[0]}else dt(T[0],!1),D=T.index+T[0].length;break;case"s":break;case"database-range":if(T[1]==="/")break;try{Fe=Ex(dt(T[0])["target-range-address"]),v[Fe[0]]["!autofilter"]={ref:Fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(T[1]!=="/"){if(ie=dt(T[0],!1),!ie.href)break;ie.Target=Lt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Fe=Ex(ie.Target.slice(1)),ie.Target="#"+Fe[0]+"!"+Fe[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(T)}}var V={Sheets:v,SheetNames:E,Workbook:fe};return r.bookSheets&&delete V.Sheets,V}function db(t,e){e=e||{},$a(t,"META-INF/manifest.xml")&&T9(Yr(t,"META-INF/manifest.xml"),e);var r=Ca(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=R3(or(r),e);return $a(t,"meta.xml")&&(n.Props=_k(Yr(t,"meta.xml"))),n}function mb(t,e){return R3(t,e)}var Yq=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Ph({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return zr+e}})(),pb=(function(){var t=function(i){return tr(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,l,u){var f=[];f.push('      <table:table table:name="'+tr(l.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,x=fa(i["!ref"]||"A1"),v=i["!merges"]||[],E=0,w=Array.isArray(i);if(i["!cols"])for(m=0;m<=x.e.c;++m)f.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var T="",A=i["!rows"]||[];for(h=0;h<x.s.r;++h)T=A[h]?' table:style-name="ro'+A[h].ods+'"':"",f.push("        <table:table-row"+T+`></table:table-row>
`);for(;h<=x.e.r;++h){for(T=A[h]?' table:style-name="ro'+A[h].ods+'"':"",f.push("        <table:table-row"+T+`>
`),m=0;m<x.s.c;++m)f.push(e);for(;m<=x.e.c;++m){var I=!1,O={},D="";for(E=0;E!=v.length;++E)if(!(v[E].s.c>m)&&!(v[E].s.r>h)&&!(v[E].e.c<m)&&!(v[E].e.r<h)){(v[E].s.c!=m||v[E].s.r!=h)&&(I=!0),O["table:number-columns-spanned"]=v[E].e.c-v[E].s.c+1,O["table:number-rows-spanned"]=v[E].e.r-v[E].s.r+1;break}if(I){f.push(r);continue}var q=ct({r:h,c:m}),Y=w?(i[h]||[])[m]:i[q];if(Y&&Y.f&&(O["table:formula"]=tr(gz(Y.f)),Y.F&&Y.F.slice(0,q.length)==q)){var W=fa(Y.F);O["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,O["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!Y){f.push(e);continue}switch(Y.t){case"b":D=Y.v?"TRUE":"FALSE",O["office:value-type"]="boolean",O["office:boolean-value"]=Y.v?"true":"false";break;case"n":D=Y.w||String(Y.v||0),O["office:value-type"]="float",O["office:value"]=Y.v||0;break;case"s":case"str":D=Y.v==null?"":Y.v,O["office:value-type"]="string";break;case"d":D=Y.w||xr(Y.v).toISOString(),O["office:value-type"]="date",O["office:date-value"]=xr(Y.v).toISOString(),O["table:style-name"]="ce1";break;default:f.push(e);continue}var N=t(D);if(Y.l&&Y.l.Target){var b=Y.l.Target;b=b.charAt(0)=="#"?"#"+xz(b.slice(1)):b,b.charAt(0)!="#"&&!b.match(/^\w+:/)&&(b="../"+b),N=Ge("text:a",N,{"xlink:href":b.replace(/&/g,"&amp;")})}f.push("          "+Ge("table:table-cell",Ge("text:p",N,{}),O)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var x=h["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;zo(x),x.ods=u;var v=h["!cols"][m].wpx+"px";i.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),i.push(`  </style:style>
`),++u}}});var f=0;l.SheetNames.map(function(h){return l.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=f;var x=h["!rows"][m].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,u){var f=[zr],h=Ph({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Ph({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+h+m+`>
`),f.push(yk().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+h+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var x=0;x!=l.SheetNames.length;++x)f.push(n(l.Sheets[l.SheetNames[x]],l,x));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function D3(t,e){if(e.bookType=="fods")return pb(t,e);var r=Uy(),n="",a=[],i=[];return n="mimetype",wt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",wt(r,n,pb(t,e)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",wt(r,n,Yq(t,e)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",wt(r,n,zr+yk()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",wt(r,n,A9(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",wt(r,n,w9(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Yl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ev(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):or(Jo(t))}function Qq(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Na(zs(t))}function Jq(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Go(t){var e=t.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function gb(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Zq(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function eW(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)t[e+i]=a&255;t[e+15]|=r>=0?0:128}function Gh(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Zt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Or(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ut(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=Gh(t,r),i=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(i){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Gh(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var h={data:u,type:i};e[a]==null?e[a]=[h]:e[a].push(h)}return e}function En(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Zt(n*8+a.type)),a.type==2&&e.push(Zt(a.data.length)),e.push(a.data))})}),Go(e)}function m_(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function qa(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=Gh(t,n),i=Ut(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:Or(i[1][0].data),messages:[]};i[2].forEach(function(u){var f=Ut(u.data),h=Or(f[3][0].data);l.messages.push({meta:f,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=i[3])!=null&&e[0]&&(l.merge=Or(i[3][0].data)>>>0>0),r.push(l)}return r}function Jc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Zt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Zt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Zt(l.data.length)}],n[2].push({data:En(l.meta),type:2})});var i=En(n);e.push(Zt(i.length)),e.push(i),a.forEach(function(l){return e.push(l)})}),Go(e)}function tW(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Gh(e,r),a=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var f=0,h=0;if(i==1?(h=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,i==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Go(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var m=Go(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function Wa(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(tW(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Go(e)}function Zc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var i=Zt(n),l=i.length;e.push(i),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return Go(e)}function rW(t,e,r,n){var a=Yl(t),i=a.getUint32(4,!0),l=(n>1?12:8)+gb(i&(n>1?3470:398))*4,u=-1,f=-1,h=NaN,m=new Date(2001,0,1);i&512&&(u=a.getUint32(l,!0),l+=4),l+=gb(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(l,!0),l+=4),i&32&&(h=a.getFloat64(l,!0),l+=8),i&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:e[f]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(f>-1)x={t:"s",v:e[f]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function nW(t,e,r){var n=Yl(t),a=n.getUint32(8,!0),i=12,l=-1,u=-1,f=NaN,h=NaN,m=new Date(2001,0,1);a&1&&(f=Zq(t,i),i+=16),a&2&&(h=n.getFloat64(i,!0),i+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(u=n.getUint32(i,!0),i+=4),a&16&&(l=n.getUint32(i,!0),i+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(l>-1)x={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return x}function wx(t,e){var r=new Uint8Array(32),n=Yl(r),a=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,eW(r,a,t.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Sx(t,e){var r=new Uint8Array(32),n=Yl(r),a=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,a)}function aW(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return rW(t,e,r,t[0]);case 5:return nW(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Fn(t){var e=Ut(t);return Gh(e[1][0].data)}function xb(t,e){var r=Ut(e.data),n=Or(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(l){var u=Ut(l.data),f=Or(u[1][0].data)>>>0;switch(n){case 1:i[f]=Ev(u[3][0].data);break;case 8:{var h=t[Fn(u[9][0].data)][0],m=Ut(h.data),x=t[Fn(m[1][0].data)][0],v=Or(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var E=Ut(x.data);i[f]=E[3].map(function(w){return Ev(w.data)}).join("")}break}}),i}function sW(t,e){var r,n,a,i,l,u,f,h,m,x,v,E,w,T,A=Ut(t),I=Or(A[1][0].data)>>>0,O=Or(A[2][0].data)>>>0,D=((n=(r=A[8])==null?void 0:r[0])==null?void 0:n.data)&&Or(A[8][0].data)>0||!1,q,Y;if((i=(a=A[7])==null?void 0:a[0])!=null&&i.data&&e!=0)q=(u=(l=A[7])==null?void 0:l[0])==null?void 0:u.data,Y=(h=(f=A[6])==null?void 0:f[0])==null?void 0:h.data;else if((x=(m=A[4])==null?void 0:m[0])!=null&&x.data&&e!=1)q=(E=(v=A[4])==null?void 0:v[0])==null?void 0:E.data,Y=(T=(w=A[3])==null?void 0:w[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var W=D?4:1,N=Yl(q),b=[],k=0;k<q.length/2;++k){var F=N.getUint16(k*2,!0);F<65535&&b.push([k,F])}if(b.length!=O)throw"Expected ".concat(O," cells, found ").concat(b.length);var P=[];for(k=0;k<b.length-1;++k)P[b[k][0]]=Y.subarray(b[k][1]*W,b[k+1][1]*W);return b.length>=1&&(P[b[b.length-1][0]]=Y.subarray(b[b.length-1][1]*W)),{R:I,cells:P}}function iW(t,e){var r,n=Ut(e.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Or(n[7][0].data)>>>0>0?1:0:-1,i=m_(n[5],function(l){return sW(l,a)});return{nrows:Or(n[4][0].data)>>>0,data:i.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(f,h){if(l[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));l[u.R][h]=f}),l},[])}}function oW(t,e,r){var n,a=Ut(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Or(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Or(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Et(i);var l=Ut(a[4][0].data),u=xb(t,t[Fn(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?xb(t,t[Fn(l[17][0].data)][0]):[],h=Ut(l[3][0].data),m=0;h[1].forEach(function(x){var v=Ut(x.data),E=t[Fn(v[2][0].data)][0],w=Or(E.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var T=iW(t,E);T.data.forEach(function(A,I){A.forEach(function(O,D){var q=ct({r:m+I,c:D}),Y=aW(O,u,f);Y&&(r[q]=Y)})}),m+=T.nrows})}function lW(t,e){var r=Ut(e.data),n={"!ref":"A1"},a=t[Fn(r[2][0].data)],i=Or(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return oW(t,a[0],n),n}function cW(t,e){var r,n=Ut(e.data),a={name:(r=n[1])!=null&&r[0]?Ev(n[1][0].data):"",sheets:[]},i=m_(n[2],Fn);return i.forEach(function(l){t[l].forEach(function(u){var f=Or(u.meta[1][0].data);f==6e3&&a.sheets.push(lW(t,u))})}),a}function uW(t,e){var r=y_(),n=Ut(e.data),a=m_(n[1],Fn);if(a.forEach(function(i){t[i].forEach(function(l){var u=Or(l.meta[1][0].data);if(u==2){var f=cW(t,l);f.sheets.forEach(function(h,m){__(r,h,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Ax(t){var e,r,n,a,i={},l=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=Wa(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var m;try{m=qa(h)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){i[x.id]=x.messages,l.push(x.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Or(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||l.forEach(function(f){i[f].forEach(function(h){var m=Or(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return uW(i,u)}function fW(t,e,r){var n,a,i,l;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(i=t[8])==null?void 0:i[0])==null?void 0:l.data)&&Or(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,h=Yl(t[7][0].data),m=0,x=[],v=Yl(t[4][0].data),E=0,w=[],T=0;T<e.length;++T){if(e[T]==null){h.setUint16(T*2,65535,!0),v.setUint16(T*2,65535);continue}h.setUint16(T*2,m,!0),v.setUint16(T*2,E,!0);var A,I;switch(typeof e[T]){case"string":A=wx({t:"s",v:e[T]},r),I=Sx({t:"s",v:e[T]},r);break;case"number":A=wx({t:"n",v:e[T]},r),I=Sx({t:"n",v:e[T]},r);break;case"boolean":A=wx({t:"b",v:e[T]},r),I=Sx({t:"b",v:e[T]},r);break;default:throw new Error("Unsupported value "+e[T])}x.push(A),m+=A.length,w.push(I),E+=I.length,++f}for(t[2][0].data=Zt(f);T<t[7][0].data.length/2;++T)h.setUint16(T*2,65535,!0),v.setUint16(T*2,65535,!0);return t[6][0].data=Go(x),t[3][0].data=Go(w),f}function hW(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=fa(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Et(n)));var i=ep(r,{range:n,header:1}),l=["~Sh33tJ5~"];i.forEach(function(Q){return Q.forEach(function(J){typeof J=="string"&&l.push(J)})});var u={},f=[],h=st.read(e.numbers,{type:"base64"});h.FileIndex.map(function(Q,J){return[Q,h.FullPaths[J]]}).forEach(function(Q){var J=Q[0],te=Q[1];if(J.type==2&&J.name.match(/\.iwa/)){var ce=J.content,Se=Wa(ce),Oe=qa(Se);Oe.forEach(function(ke){f.push(ke.id),u[ke.id]={deps:[],location:te,type:Or(ke.messages[0].meta[1][0].data)}})}}),f.sort(function(Q,J){return Q-J});var m=f.filter(function(Q){return Q>1}).map(function(Q){return[Q,Zt(Q)]});h.FileIndex.map(function(Q,J){return[Q,h.FullPaths[J]]}).forEach(function(Q){var J=Q[0];if(Q[1],!!J.name.match(/\.iwa/)){var te=qa(Wa(J.content));te.forEach(function(ce){ce.messages.forEach(function(Se){m.forEach(function(Oe){ce.messages.some(function(ke){return Or(ke.meta[1][0].data)!=11006&&Jq(ke.data,Oe[1])})&&u[Oe[0]].deps.push(ce.id)})})})}});for(var x=st.find(h,u[1].location),v=qa(Wa(x.content)),E,w=0;w<v.length;++w){var T=v[w];T.id==1&&(E=T)}var A=Fn(Ut(E.messages[0].data)[1][0].data);for(x=st.find(h,u[A].location),v=qa(Wa(x.content)),w=0;w<v.length;++w)T=v[w],T.id==A&&(E=T);for(A=Fn(Ut(E.messages[0].data)[2][0].data),x=st.find(h,u[A].location),v=qa(Wa(x.content)),w=0;w<v.length;++w)T=v[w],T.id==A&&(E=T);for(A=Fn(Ut(E.messages[0].data)[2][0].data),x=st.find(h,u[A].location),v=qa(Wa(x.content)),w=0;w<v.length;++w)T=v[w],T.id==A&&(E=T);var I=Ut(E.messages[0].data);{I[6][0].data=Zt(n.e.r+1),I[7][0].data=Zt(n.e.c+1);var O=Fn(I[46][0].data),D=st.find(h,u[O].location),q=qa(Wa(D.content));{for(var Y=0;Y<q.length&&q[Y].id!=O;++Y);if(q[Y].id!=O)throw"Bad ColumnRowUIDMapArchive";var W=Ut(q[Y].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var N=0;N<=n.e.c;++N){var b=[];b[1]=b[2]=[{type:0,data:Zt(N+420690)}],W[1].push({type:2,data:En(b)}),W[2].push({type:0,data:Zt(N)}),W[3].push({type:0,data:Zt(N)})}W[4]=[],W[5]=[],W[6]=[];for(var k=0;k<=n.e.r;++k)b=[],b[1]=b[2]=[{type:0,data:Zt(k+726270)}],W[4].push({type:2,data:En(b)}),W[5].push({type:0,data:Zt(k)}),W[6].push({type:0,data:Zt(k)});q[Y].messages[0].data=En(W)}D.content=Zc(Jc(q)),D.size=D.content.length,delete I[46];var F=Ut(I[4][0].data);{F[7][0].data=Zt(n.e.r+1);var P=Ut(F[1][0].data),M=Fn(P[2][0].data);D=st.find(h,u[M].location),q=qa(Wa(D.content));{if(q[0].id!=M)throw"Bad HeaderStorageBucket";var j=Ut(q[0].messages[0].data);for(k=0;k<i.length;++k){var Le=Ut(j[2][0].data);Le[1][0].data=Zt(k),Le[4][0].data=Zt(i[k].length),j[2][k]={type:j[2][0].type,data:En(Le)}}q[0].messages[0].data=En(j)}D.content=Zc(Jc(q)),D.size=D.content.length;var De=Fn(F[2][0].data);D=st.find(h,u[De].location),q=qa(Wa(D.content));{if(q[0].id!=De)throw"Bad HeaderStorageBucket";for(j=Ut(q[0].messages[0].data),N=0;N<=n.e.c;++N)Le=Ut(j[2][0].data),Le[1][0].data=Zt(N),Le[4][0].data=Zt(n.e.r+1),j[2][N]={type:j[2][0].type,data:En(Le)};q[0].messages[0].data=En(j)}D.content=Zc(Jc(q)),D.size=D.content.length;var ne=Fn(F[4][0].data);(function(){for(var Q=st.find(h,u[ne].location),J=qa(Wa(Q.content)),te,ce=0;ce<J.length;++ce){var Se=J[ce];Se.id==ne&&(te=Se)}var Oe=Ut(te.messages[0].data);{Oe[3]=[];var ke=[];l.forEach(function(V,we){ke[1]=[{type:0,data:Zt(we)}],ke[2]=[{type:0,data:Zt(1)}],ke[3]=[{type:2,data:Qq(V)}],Oe[3].push({type:2,data:En(ke)})})}te.messages[0].data=En(Oe);var se=Jc(J),Me=Zc(se);Q.content=Me,Q.size=Q.content.length})();var ae=Ut(F[3][0].data);{var fe=ae[1][0];delete ae[2];var ie=Ut(fe.data);{var Fe=Fn(ie[2][0].data);(function(){for(var Q=st.find(h,u[Fe].location),J=qa(Wa(Q.content)),te,ce=0;ce<J.length;++ce){var Se=J[ce];Se.id==Fe&&(te=Se)}var Oe=Ut(te.messages[0].data);{delete Oe[6],delete ae[7];var ke=new Uint8Array(Oe[5][0].data);Oe[5]=[];for(var se=0,Me=0;Me<=n.e.r;++Me){var V=Ut(ke);se+=fW(V,i[Me],l),V[1][0].data=Zt(Me),Oe[5].push({data:En(V),type:2})}Oe[1]=[{type:0,data:Zt(n.e.c+1)}],Oe[2]=[{type:0,data:Zt(n.e.r+1)}],Oe[3]=[{type:0,data:Zt(se)}],Oe[4]=[{type:0,data:Zt(n.e.r+1)}]}te.messages[0].data=En(Oe);var we=Jc(J),Ae=Zc(we);Q.content=Ae,Q.size=Q.content.length})()}fe.data=En(ie)}F[3][0].data=En(ae)}I[4][0].data=En(F)}E.messages[0].data=En(I);var ee=Jc(v),B=Zc(ee);return x.content=B,x.size=x.content.length,h}function I3(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function p_(t){I3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function g_(t){I3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function dW(t){return At.WS.indexOf(t)>-1?"sheet":t==At.CS?"chart":t==At.DS?"dialog":t==At.MS?"macro":t&&t.length?t:"sheet"}function mW(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,dW(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function pW(t,e,r,n,a,i,l,u,f,h,m,x){try{i[n]=fh(Ca(t,r,!0),e);var v=Yr(t,e),E;switch(u){case"sheet":E=LG(v,e,a,f,i[n],h,m,x);break;case"chart":if(E=VG(v,e,a,f,i[n],h,m,x),!E||!E["!drawel"])break;var w=Jf(E["!drawel"].Target,e),T=Vh(w),A=Sj(Ca(t,w,!0),fh(Ca(t,T,!0),w)),I=Jf(A,w),O=Vh(I);E=fG(Ca(t,I,!0),I,f,fh(Ca(t,O,!0),I),h,E);break;case"macro":E=BG(v,e,a,f,i[n],h,m,x);break;case"dialog":E=jG(v,e,a,f,i[n],h,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=E;var D=[];i&&i[n]&&Mr(i[n]).forEach(function(q){var Y="";if(i[n][q].Type==At.CMNT){Y=Jf(i[n][q].Target,e);var W=GG(Yr(t,Y,!0),Y,f);if(!W||!W.length)return;rb(E,W,!1)}i[n][q].Type==At.TCMNT&&(Y=Jf(i[n][q].Target,e),D=D.concat(bj(Yr(t,Y,!0),f)))}),D&&D.length&&rb(E,D,!0,f.people||[])}catch(q){if(f.WTF)throw q}}function Ha(t){return t.charAt(0)=="/"?t.slice(1):t}function gW(t,e){if(Lu(),e=e||{},p_(e),$a(t,"META-INF/manifest.xml")||$a(t,"objectdata.xml"))return db(t,e);if($a(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Ax<"u"){if(t.FileIndex)return Ax(t);var r=st.utils.cfb_new();return wA(t).forEach(function(Le){wt(r,Le,NL(t,Le))}),Ax(r)}throw new Error("Unsupported NUMBERS file")}if(!$a(t,"[Content_Types].xml"))throw $a(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):$a(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=wA(t),a=_9(Ca(t,"[Content_Types].xml")),i=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Yr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Yr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},h={};if(!e.bookSheets&&!e.bookProps){if(hh=[],a.sst)try{hh=HG(Yr(t,Ha(a.sst)),a.sst,e)}catch(Le){if(e.WTF)throw Le}e.cellStyles&&a.themes.length&&(f=zG(Ca(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(h=UG(Yr(t,Ha(a.style)),a.style,f,e))}a.links.map(function(Le){try{var De=fh(Ca(t,Vh(Ha(Le))),Le);return WG(Yr(t,Ha(Le)),De,Le,e)}catch{}});var m=PG(Yr(t,Ha(a.workbooks[0])),a.workbooks[0],e),x={},v="";a.coreprops.length&&(v=Yr(t,Ha(a.coreprops[0]),!0),v&&(x=_k(v)),a.extprops.length!==0&&(v=Yr(t,Ha(a.extprops[0]),!0),v&&N9(v,x,e)));var E={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(v=Ca(t,Ha(a.custprops[0]),!0),v&&(E=k9(v,e)));var w={};if((e.bookSheets||e.bookProps)&&(m.Sheets?l=m.Sheets.map(function(De){return De.name}):x.Worksheets&&x.SheetNames.length>0&&(l=x.SheetNames),e.bookProps&&(w.Props=x,w.Custprops=E),e.bookSheets&&typeof l<"u"&&(w.SheetNames=l),e.bookSheets?w.SheetNames:e.bookProps))return w;l={};var T={};e.bookDeps&&a.calcchain&&(T=qG(Yr(t,Ha(a.calcchain)),a.calcchain));var A=0,I={},O,D;{var q=m.Sheets;x.Worksheets=q.length,x.SheetNames=[];for(var Y=0;Y!=q.length;++Y)x.SheetNames[Y]=q[Y].name}var W=i?"bin":"xml",N=a.workbooks[0].lastIndexOf("/"),b=(a.workbooks[0].slice(0,N+1)+"_rels/"+a.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");$a(t,b)||(b="xl/_rels/workbook."+W+".rels");var k=fh(Ca(t,b,!0),b.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=XG(Yr(t,Ha(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=Cj(Yr(t,Ha(a.people[0])),e)),k&&(k=mW(k,m.Sheets));var F=Yr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=x.Worksheets;++A){var P="sheet";if(k&&k[A]?(O="xl/"+k[A][1].replace(/[\/]?xl\//,""),$a(t,O)||(O=k[A][1]),$a(t,O)||(O=b.replace(/_rels\/.*$/,"")+k[A][1]),P=k[A][2]):(O="xl/worksheets/sheet"+(A+1-F)+"."+W,O=O.replace(/sheet0\./,"sheet.")),D=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(A!=e.sheets)continue e;break;case"string":if(x.SheetNames[A].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var M=!1,j=0;j!=e.sheets.length;++j)typeof e.sheets[j]=="number"&&e.sheets[j]==A&&(M=1),typeof e.sheets[j]=="string"&&e.sheets[j].toLowerCase()==x.SheetNames[A].toLowerCase()&&(M=1);if(!M)continue e}}pW(t,O,D,x.SheetNames[A],A,I,l,P,e,m,f,h)}return w={Directory:a,Workbook:m,Props:x,Custprops:E,Deps:T,Sheets:l,SheetNames:x.SheetNames,Strings:hh,Styles:h,Themes:f,SSF:vr(lt)},e&&e.bookFiles&&(t.files?(w.keys=n,w.files=t.files):(w.keys=[],w.files={},t.FullPaths.forEach(function(Le,De){Le=Le.replace(/^Root Entry[\/]/,""),w.keys.push(Le),w.files[Le]=t.FileIndex[De]}))),e&&e.bookVBA&&(a.vba.length>0?w.vbaraw=Yr(t,Ha(a.vba[0]),!0):a.defaults&&a.defaults.bin===Pj&&(w.vbaraw=Yr(t,"xl/vbaProject.bin",!0))),w}function xW(t,e){var r=e||{},n="Workbook",a=st.find(t,n);try{if(n="/!DataSpaces/Version",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(X7(a.content),n="/!DataSpaces/DataSpaceMap",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=K7(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=Y7(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);J7(a.content)}catch{}if(n="/EncryptionInfo",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=Z7(a.content);if(n="/EncryptedPackage",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function vW(t,e){return e.bookType=="ods"?D3(t,e):e.bookType=="numbers"?hW(t,e):e.bookType=="xlsb"?yW(t,e):_W(t,e)}function yW(t,e){uu=1024,t&&!t.SSF&&(t.SSF=vr(lt)),t&&t.SSF&&(Lu(),kp(t.SSF),e.revssf=Dp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,dh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=s3.indexOf(e.bookType)>-1,a=t_();g_(e=e||{});var i=Uy(),l="",u=0;if(e.cellXfs=[],el(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",wt(i,l,Ek(t.Props,e)),a.coreprops.push(l),er(e.rels,2,l,At.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,wt(i,l,Sk(t.Props)),a.extprops.push(l),er(e.rels,3,l,At.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",wt(i,l,Ak(t.Custprops)),a.custprops.push(l),er(e.rels,4,l,At.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var m={"!id":{}},x=t.Sheets[t.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,wt(i,l,KG(u-1,l,e,t,m)),a.sheets.push(l),er(e.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0])}if(x){var E=x["!comments"],w=!1,T="";E&&E.length>0&&(T="xl/comments"+u+"."+r,wt(i,T,JG(E,T)),a.comments.push(T),er(m,-1,"../comments"+u+"."+r,At.CMNT),w=!0),x["!legacy"]&&w&&wt(i,"xl/drawings/vmlDrawing"+u+".vml",n3(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&wt(i,Vh(l),du(m))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,wt(i,l,QG(e.Strings,l,e)),a.strs.push(l),er(e.wbrels,-1,"sharedStrings."+r,At.SST)),l="xl/workbook."+r,wt(i,l,$G(t,l)),a.workbooks.push(l),er(e.rels,1,l,At.WB),l="xl/theme/theme1.xml",wt(i,l,o_(t.Themes,e)),a.themes.push(l),er(e.wbrels,-1,"theme/theme1.xml",At.THEME),l="xl/styles."+r,wt(i,l,YG(t,l,e)),a.styles.push(l),er(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",wt(i,l,t.vbaraw),a.vba.push(l),er(e.wbrels,-1,"vbaProject.bin",At.VBA)),l="xl/metadata."+r,wt(i,l,ZG(l)),a.metadata.push(l),er(e.wbrels,-1,"metadata."+r,At.XLMETA),wt(i,"[Content_Types].xml",vk(a,e)),wt(i,"_rels/.rels",du(e.rels)),wt(i,"xl/_rels/workbook."+r+".rels",du(e.wbrels)),delete e.revssf,delete e.ssf,i}function _W(t,e){uu=1024,t&&!t.SSF&&(t.SSF=vr(lt)),t&&t.SSF&&(Lu(),kp(t.SSF),e.revssf=Dp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,dh?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=s3.indexOf(e.bookType)>-1,a=t_();g_(e=e||{});var i=Uy(),l="",u=0;if(e.cellXfs=[],el(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",wt(i,l,Ek(t.Props,e)),a.coreprops.push(l),er(e.rels,2,l,At.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,wt(i,l,Sk(t.Props)),a.extprops.push(l),er(e.rels,3,l,At.EXT_PROPS),t.Custprops!==t.Props&&Mr(t.Custprops||{}).length>0&&(l="docProps/custom.xml",wt(i,l,Ak(t.Custprops)),a.custprops.push(l),er(e.rels,4,l,At.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var x={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],E=(v||{})["!type"]||"sheet";switch(E){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,wt(i,l,g3(u-1,e,t,x)),a.sheets.push(l),er(e.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0])}if(v){var w=v["!comments"],T=!1,A="";if(w&&w.length>0){var I=!1;w.forEach(function(O){O[1].forEach(function(D){D.T==!0&&(I=!0)})}),I&&(A="xl/threadedComments/threadedComment"+u+"."+r,wt(i,A,Nj(w,m,e)),a.threadedcomments.push(A),er(x,-1,"../threadedComments/threadedComment"+u+"."+r,At.TCMNT)),A="xl/comments"+u+"."+r,wt(i,A,a3(w)),a.comments.push(A),er(x,-1,"../comments"+u+"."+r,At.CMNT),T=!0}v["!legacy"]&&T&&wt(i,"xl/drawings/vmlDrawing"+u+".vml",n3(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&wt(i,Vh(l),du(x))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,wt(i,l,qk(e.Strings,e)),a.strs.push(l),er(e.wbrels,-1,"sharedStrings."+r,At.SST)),l="xl/workbook."+r,wt(i,l,E3(t)),a.workbooks.push(l),er(e.rels,1,l,At.WB),l="xl/theme/theme1.xml",wt(i,l,o_(t.Themes,e)),a.themes.push(l),er(e.wbrels,-1,"theme/theme1.xml",At.THEME),l="xl/styles."+r,wt(i,l,Zk(t,e)),a.styles.push(l),er(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",wt(i,l,t.vbaraw),a.vba.push(l),er(e.wbrels,-1,"vbaProject.bin",At.VBA)),l="xl/metadata."+r,wt(i,l,r3()),a.metadata.push(l),er(e.wbrels,-1,"metadata."+r,At.XLMETA),m.length>1&&(l="xl/persons/person.xml",wt(i,l,kj(m)),a.people.push(l),er(e.wbrels,-1,"persons/person.xml",At.PEOPLE)),wt(i,"[Content_Types].xml",vk(a,e)),wt(i,"_rels/.rels",du(e.rels)),wt(i,"xl/_rels/workbook."+r+".rels",du(e.wbrels)),delete e.revssf,delete e.ssf,i}function x_(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ka(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function EW(t,e){return st.find(t,"EncryptedPackage")?xW(t,e):A3(t,e)}function TW(t,e){var r,n=t,a=e||{};return a.type||(a.type=St&&Buffer.isBuffer(t)?"buffer":"base64"),r=XC(n,a),gW(r,a)}function F3(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return yv(t.slice(r),e);default:break e}return wu.to_workbook(t,e)}function wW(t,e){var r="",n=x_(t,e);switch(e.type){case"base64":r=ka(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Wl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=or(r)),e.type="binary",F3(r,e)}function SW(t,e){var r=t;return e.type=="base64"&&(r=ka(r)),r=Ih.utils.decode(1200,r.slice(2),"str"),e.type="binary",F3(r,e)}function AW(t){return t.match(/[^\x00-\x7F]/)?zs(t):t}function bx(t,e,r,n){return n?(r.type="string",wu.to_workbook(t,r)):wu.to_workbook(e,r)}function Tv(t,e){Py();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Tv(new Uint8Array(t),(r=vr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),pu={},r.dateNF&&(pu.dateNF=r.dateNF),r.type||(r.type=St&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=St?"buffer":"binary",n=yL(t),typeof Uint8Array<"u"&&!St&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=AW(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=vr(r),r.type="array",Tv(Ly(n),r)}switch((a=x_(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return EW(st.read(n,r),r);break;case 9:if(a[1]<=8)return A3(n,r);break;case 60:return yv(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return R7(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Hk.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?TW(n,r):bx(t,n,r,i);case 239:return a[3]===60?yv(n,r):bx(t,n,r,i);case 255:if(a[1]===254)return SW(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Ul.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Ul.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return vv.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Yk.to_workbook(n,r);break;case 10:case 13:case 32:return wW(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return k7.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?vv.to_workbook(n,r):bx(t,n,r,i)}function O3(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return o0(e.file,st.write(t,{type:St?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return st.write(t,e)}function bW(t,e){var r=vr(e||{}),n=vW(t,r);return NW(n,r)}function NW(t,e){var r={},n=St?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?st.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Cp(a))}return e.password&&typeof encrypt_agile<"u"?O3(encrypt_agile(a,e.password),e):e.type==="file"?o0(e.file,a):e.type=="string"?or(a):a}function CW(t,e){var r=e||{},n=Aq(t,r);return O3(n,r)}function js(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Fh(zs(n));case"binary":return zs(n);case"string":return t;case"file":return o0(e.file,n,"utf8");case"buffer":return St?zi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):js(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function kW(t,e){switch(e.type){case"base64":return Fh(t);case"binary":return t;case"string":return t;case"file":return o0(e.file,t,"binary");case"buffer":return St?zi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function sm(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Fh(r):e.type=="string"?or(r):r;case"file":return o0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function M3(t,e){Py(),EG(t);var r=vr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=M3(t,r);return r.type="array",Cp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return js(vq(t,r),r);case"slk":case"sylk":return js(zk.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return js(N3(t.Sheets[t.SheetNames[a]],r),r);case"txt":return kW(P3(t.Sheets[t.SheetNames[a]],r),r);case"csv":return js(v_(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return js(Hk.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return sm(vv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return js(wu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return js(Yk.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return js(Gk.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return js(D3(t,r),r);case"wk1":return sm(Ul.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return sm(Ul.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),sm(b3(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),CW(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return bW(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function RW(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Zm(t,e,r){var n={};return n.type="file",n.file=e,RW(n),M3(t,n)}function DW(t,e,r,n,a,i,l,u){var f=Ur(r),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!l||t[r])for(var E=e.s.c;E<=e.e.c;++E){var w=l?t[r][E]:t[n[E]+f];if(w===void 0||w.t===void 0){if(h===void 0)continue;i[E]!=null&&(v[i[E]]=h);continue}var T=w.v;switch(w.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(i[E]!=null){if(T==null)if(w.t=="e"&&T===null)v[i[E]]=null;else if(h!==void 0)v[i[E]]=h;else if(m&&T===null)v[i[E]]=null;else continue;else v[i[E]]=m&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?T:Pi(w,T,u);T!=null&&(x=!1)}}return{row:v,isempty:x}}function ep(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],l=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},m=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof m){case"string":f=Vt(m);break;case"number":f=Vt(t["!ref"]),f.s.r=m;break;default:f=m}n>0&&(a=0);var x=Ur(f.s.r),v=[],E=[],w=0,T=0,A=Array.isArray(t),I=f.s.r,O=0,D={};A&&!t[I]&&(t[I]=[]);var q=h.skipHidden&&t["!cols"]||[],Y=h.skipHidden&&t["!rows"]||[];for(O=f.s.c;O<=f.e.c;++O)if(!(q[O]||{}).hidden)switch(v[O]=br(O),r=A?t[I][O]:t[v[O]+x],n){case 1:i[O]=O-f.s.c;break;case 2:i[O]=v[O];break;case 3:i[O]=h.header[O-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Pi(r,null,h),T=D[l]||0,!T)D[l]=1;else{do u=l+"_"+T++;while(D[u]);D[l]=T,D[u]=1}i[O]=u}for(I=f.s.r+a;I<=f.e.r;++I)if(!(Y[I]||{}).hidden){var W=DW(t,f,I,v,n,i,A,h);(W.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(E[w++]=W.row)}return E.length=w,E}var vb=/"/g;function IW(t,e,r,n,a,i,l,u){for(var f=!0,h=[],m="",x=Ur(r),v=e.s.c;v<=e.e.c;++v)if(n[v]){var E=u.dense?(t[r]||[])[v]:t[n[v]+x];if(E==null)m="";else if(E.v!=null){f=!1,m=""+(u.rawNumbers&&E.t=="n"?E.v:Pi(E,null,u));for(var w=0,T=0;w!==m.length;++w)if((T=m.charCodeAt(w))===a||T===i||T===34||u.forceQuotes){m='"'+m.replace(vb,'""')+'"';break}m=="ID"&&(m='"ID"')}else E.f!=null&&!E.F?(f=!1,m="="+E.f,m.indexOf(",")>=0&&(m='"'+m.replace(vb,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&f?null:h.join(l)}function v_(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Vt(t["!ref"]),i=n.FS!==void 0?n.FS:",",l=i.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),m="",x=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],E=n.skipHidden&&t["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(v[w]||{}).hidden||(x[w]=br(w));for(var T=0,A=a.s.r;A<=a.e.r;++A)(E[A]||{}).hidden||(m=IW(t,a,A,x,l,f,i,n),m!=null&&(n.strip&&(m=m.replace(h,"")),(m||n.blankrows!==!1)&&r.push((T++?u:"")+m)));return delete n.dense,r.join("")}function P3(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=v_(t,e);return r}function FW(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Vt(t["!ref"]),i="",l=[],u,f=[],h=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=br(u);for(var m=a.s.r;m<=a.e.r;++m)for(i=Ur(m),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+i,r=h?(t[m]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function L3(t,e,r){var n=r||{},a=+!n.skipHeader,i=t||{},l=0,u=0;if(i&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Nr(n.origin):n.origin;l=f.r,u=f.c}var h,m={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(i["!ref"]){var x=Vt(i["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),l==-1&&(l=x.e.r+1,m.e.r=l+e.length-1+a)}else l==-1&&(l=0,m.e.r=e.length-1+a);var v=n.header||[],E=0;e.forEach(function(T,A){Mr(T).forEach(function(I){(E=v.indexOf(I))==-1&&(v[E=v.length]=I);var O=T[I],D="z",q="",Y=ct({c:u+E,r:l+A+a});h=qh(i,Y),O&&typeof O=="object"&&!(O instanceof Date)?i[Y]=O:(typeof O=="number"?D="n":typeof O=="boolean"?D="b":typeof O=="string"?D="s":O instanceof Date?(D="d",n.cellDates||(D="n",O=on(O)),q=n.dateNF||lt[14]):O===null&&n.nullError&&(D="e",O=0),h?(h.t=D,h.v=O,delete h.w,delete h.R,q&&(h.z=q)):i[Y]=h={t:D,v:O},q&&(h.z=q))})}),m.e.c=Math.max(m.e.c,u+v.length-1);var w=Ur(l);if(a)for(E=0;E<v.length;++E)i[br(E+u)+w]={t:"s",v:v[E]};return i["!ref"]=Et(m),i}function OW(t,e){return L3(null,t,e)}function qh(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Nr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?qh(t,ct(e)):qh(t,ct({r:e,c:r||0}))}function MW(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function y_(){return{SheetNames:[],Sheets:{}}}function __(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(_3(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function PW(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=MW(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function LW(t,e){return t.z=e,t}function V3(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function VW(t,e,r){return V3(t,"#"+e,r)}function BW(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function jW(t,e,r,n){for(var a=typeof e!="string"?e:Vt(e),i=typeof e=="string"?e:Et(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var f=qh(t,l,u);f.t="n",f.F=i,delete f.v,l==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var ba={encode_col:br,encode_row:Ur,encode_cell:ct,encode_range:Et,decode_col:Ky,decode_row:$y,split_cell:QL,decode_cell:Nr,decode_range:fa,format_cell:Pi,sheet_add_aoa:fk,sheet_add_json:L3,sheet_add_dom:C3,aoa_to_sheet:Vu,json_to_sheet:OW,table_to_sheet:k3,table_to_book:Xq,sheet_to_csv:v_,sheet_to_txt:P3,sheet_to_json:ep,sheet_to_html:N3,sheet_to_formulae:FW,sheet_to_row_object_array:ep,sheet_get_cell:qh,book_new:y_,book_append_sheet:__,book_set_sheet_visibility:PW,cell_set_number_format:LW,cell_set_hyperlink:V3,cell_set_internal_link:VW,cell_add_comment:BW,sheet_set_array_formula:jW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const UW=[{employeeNumber:"346",fullName:"PAMELA L PEREZ MENDEZ"},{employeeNumber:"442",fullName:"JOEL F MADERA"},{employeeNumber:"1421",fullName:"JOEL SANCHEZ"},{employeeNumber:"1865",fullName:"JUAN M MELENDEZ"},{employeeNumber:"2073",fullName:"LUIS JAVIER FIGUEROA"},{employeeNumber:"2410",fullName:"ISMAEL BENITEZ"},{employeeNumber:"2594",fullName:"CARMELO DE LA ROSA"},{employeeNumber:"2788",fullName:"WILLREY CARMONA SANTIAGO"},{employeeNumber:"2906",fullName:"TURIANO MALDONADO"},{employeeNumber:"2953",fullName:"JOSE R RIVERA BENITEZ"},{employeeNumber:"3610",fullName:"GABRIEL R RODRIGUEZ"},{employeeNumber:"3804",fullName:"HECTOR M LANDRAU"},{employeeNumber:"4169",fullName:"LUIS A MELENDEZ"},{employeeNumber:"5192",fullName:"RAFAEL QUIONES"},{employeeNumber:"5234",fullName:"HECTOR R LOPEZ"},{employeeNumber:"5379",fullName:"LUIS JOEL CURBELO MELENDEZ"},{employeeNumber:"5486",fullName:"ANDRES ORTIZ"},{employeeNumber:"6222",fullName:"HUGO MANUEL TEJEDA-DE LA ROSA"},{employeeNumber:"6476",fullName:"VILMARIE MORALES"},{employeeNumber:"6833",fullName:"RAMON E FALU"},{employeeNumber:"9230",fullName:"SAMUEL NIEVES"},{employeeNumber:"9475",fullName:"AXEL COLL"},{employeeNumber:"9791",fullName:"JONATHAN A HERNANDEZ"},{employeeNumber:"O602",fullName:"CESAR O. QUIOENES"},{employeeNumber:"5025",fullName:"EDWIN X MILLET"},{employeeNumber:"4073",fullName:"GLORYVEE PEREZ"},{employeeNumber:"4697",fullName:"LUIS GOMEZ"},{employeeNumber:"3008",fullName:"JOSE QUIONES"},{employeeNumber:"2325",fullName:"CARLOS A. CARRERO"},{employeeNumber:"2455",fullName:"JOHNNY BATISTA"},{employeeNumber:"8347",fullName:"EDWIN PIZARRO"},{employeeNumber:"4006",fullName:"WILLIAM FIGUEROA"},{employeeNumber:"3474",fullName:"JOEL A. CRUZ"},{employeeNumber:"3792",fullName:"ANGEL M. RIVERA"},{employeeNumber:"O629",fullName:"AMANDA PEREZ"},{employeeNumber:"2845",fullName:"ALEXIS MERCADO"},{employeeNumber:"7669",fullName:"CARMEN SANTIAGO"},{employeeNumber:"9800",fullName:"ZERIMAR MERCADO"},{employeeNumber:"9801",fullName:"PEPE MILAN"},{employeeNumber:"9802",fullName:"ROBERTO RAMIREZ"}],B3="referee_database_v1",Ii=()=>{try{const t=localStorage.getItem(B3);if(t){const e=JSON.parse(t);if(Array.isArray(e)&&e.length>0)return e;console.warn("Referee database was empty or invalid, using defaults")}}catch(t){console.error("Failed to load referee database",t)}return UW},E_=t=>{localStorage.setItem(B3,JSON.stringify(t)),window.dispatchEvent(new Event("referee-db-updated"))},zW=t=>{const e=Ii();if(e.some(n=>n.employeeNumber===t.employeeNumber))throw new Error(`Referee with ID ${t.employeeNumber} already exists.`);const r=[...e,t].sort((n,a)=>n.fullName.localeCompare(a.fullName));E_(r)},HW=(t,e)=>{const r=Ii(),n=r.findIndex(i=>i.employeeNumber===t);if(n===-1)throw new Error(`Referee with ID ${t} not found.`);if(t!==e.employeeNumber&&r.some(i=>i.employeeNumber===e.employeeNumber))throw new Error(`Referee with ID ${e.employeeNumber} already exists.`);const a=[...r];a[n]=e,a.sort((i,l)=>i.fullName.localeCompare(l.fullName)),E_(a)},GW=t=>{const r=Ii().filter(n=>n.employeeNumber!==t);E_(r)},qW=Ii(),j3="referee_match_mappings",U3=()=>{try{const t=localStorage.getItem(j3);return t?JSON.parse(t):[]}catch{return[]}},WW=t=>{localStorage.setItem(j3,JSON.stringify(t))},z3=t=>{const r=U3().filter(n=>Li(n.scheduleName)!==Li(t.scheduleName));r.push(t),WW(r)},Li=t=>t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s]/g," ").replace(/\s+/g," ").trim(),yb=t=>Li(t).split(" ").filter(e=>e.length>0),XW=(t,e)=>{const r=Li(t),n=Li(e);if(r===n)return 100;if(r.includes(n)||n.includes(r))return 90;const a=yb(t),i=yb(e);let l=0,u=0;for(const x of a)for(const v of i)if(x===v){l++;break}else if(x.includes(v)||v.includes(x)){u++;break}else if(x.length>2&&v.length>2&&$W(x,v)>.8){u++;break}const f=Math.max(a.length,i.length);if(f===0)return 0;const h=l/f*80,m=u/f*50;if(a.length>0&&i.length>0){const x=a[0],v=i[0];if(x===v)return Math.min(100,h+m+20);for(const E of i)if(E===x&&E.length>3)return Math.min(100,h+m+15)}return Math.min(100,h+m)},$W=(t,e)=>{const r=[];for(let i=0;i<=e.length;i++)r[i]=[i];for(let i=0;i<=t.length;i++)r[0][i]=i;for(let i=1;i<=e.length;i++)for(let l=1;l<=t.length;l++)e.charAt(i-1)===t.charAt(l-1)?r[i][l]=r[i-1][l-1]:r[i][l]=Math.min(r[i-1][l-1]+1,r[i][l-1]+1,r[i-1][l]+1);const n=r[e.length][t.length],a=Math.max(t.length,e.length);return a===0?1:1-n/a},KW=(t,e)=>{const r=U3(),n=Ii();if(n.length===0)return{scheduleName:t,matchedReferee:null,confidence:0,isFromStorage:!1,suggestions:[]};const a=r.find(h=>Li(h.scheduleName)===Li(t));if(a){const h=n.find(m=>m.employeeNumber===a.employeeNumber);if(h)return{scheduleName:t,matchedReferee:h,confidence:100,isFromStorage:!0,suggestions:[]}}const i=n.map(h=>({referee:h,confidence:XW(t,h.fullName)})).sort((h,m)=>m.confidence-h.confidence),l=i[0],f=l&&l.confidence>=60;return{scheduleName:t,matchedReferee:(l==null?void 0:l.referee)||null,confidence:(l==null?void 0:l.confidence)||0,isFromStorage:!1,suggestions:f?i.slice(0,5).filter(h=>h.confidence>=30):i.slice(0,8)}},YW=(t,e)=>{const r=t.map(n=>KW(n));return{matched:r.filter(n=>n.matchedReferee!==null),unmatched:r.filter(n=>n.matchedReferee===null)}},QW=(t,e,r)=>{z3({scheduleName:t,employeeNumber:e.employeeNumber,matchedAt:Date.now(),dateProcessed:r,isManual:!0})},JW=(t,e,r)=>{z3({scheduleName:t,employeeNumber:e.employeeNumber,matchedAt:Date.now(),dateProcessed:r,isManual:!1})},H3=t=>`${t.fullName} (${t.employeeNumber})`,T_=t=>{const e=t.trim(),r=e.match(/^(\d+)\s*(u|uf)?$/i);if(r){const[,n,a]=r;if(!a)return`${n}u`;if(a.toLowerCase()==="u")return`${n}u`;if(a.toLowerCase()==="uf")return`${n}uF`}return e},_b=t=>Object.entries(t).reduce((e,[r,n])=>{const a=T_(r);return e[a]=(e[a]||0)+n,e},{}),ZW=async t=>{const e=await t.arrayBuffer(),r=Tv(e),n=r.SheetNames[0],a=r.Sheets[n],i=ba.sheet_to_json(a,{header:1}),l={},u=new Set;i.forEach(v=>{if(v.length>=5&&v[0]!=="TORNEO"&&v[1]&&v[2]&&v[4]){const E=T_(String(v[4]));u.add(E);const w=T=>{if(!T)return;String(T).split("/").forEach(I=>{const O=I.trim();O&&(l[O]||(l[O]={}),l[O][E]||(l[O][E]=0),l[O][E]++)})};w(v[1]),w(v[2])}});const f=(v,E)=>{const w=T=>T.endsWith("u")?parseInt(T.slice(0,-1)):T.endsWith("uF")?parseInt(T.slice(0,-2))+.5:0;return w(v)-w(E)},h=Array.from(u).sort(f),m=Object.keys(l).sort();return{arbitrators:m.map(v=>{let E=0;return h.forEach(w=>{E+=l[v][w]||0}),{name:v,categories:l[v],total:E,displayName:v}}),allCategories:h,scheduleNames:m}},G3="referee_payroll_settings",p0="payroll_history",q3="referee_app_state",w_=2,S_=new Set(["346","1421","1865","2594","5192","5379","6222","9475","4073","2455","4006"]),eX=t=>S_.has(t),gh={Senior:40,Junior:30,Juvenil:28,Mini:25,Infantil:20,Femenino:28,"U6-U8":25,"U9-U11":27,"U12-U14":29,"U15-U16":30,"U17-U18":35},W3={haciendaTaxRate:.1,depositFee:1,adminFeeAmount:w_,categoryRates:gh},tl=()=>{try{const t=localStorage.getItem(G3);if(t)return JSON.parse(t)}catch(t){console.error("Error loading settings:",t)}return{global:W3,referees:{}}},g0=t=>{localStorage.setItem(G3,JSON.stringify(t))},tp=()=>tl().global,tX=t=>{const e=tl();g0({...e,global:{...t,adminFeeAmount:w_}})},X3=()=>{const t=tp();return{...gh,...t.categoryRates}},Eb=t=>{const e=tl(),r={...e.global,categoryRates:t};g0({...e,global:r}),window.dispatchEvent(new Event("settings-updated"))},rX=t=>{const e=X3();if(t in e)return e[t];const r=t.match(/(\d+)/);if(r){const a=parseInt(r[1]);if(a>=6&&a<=8)return e["U6-U8"];if(a>=9&&a<=11)return e["U9-U11"];if(a>=12&&a<=14)return e["U12-U14"];if(a>=15&&a<=16)return e["U15-U16"];if(a>=17&&a<=19)return e["U17-U18"]}const n=t.toLowerCase();return n.includes("senior")?e.Senior:n.includes("junior")?e.Junior:n.includes("juvenil")?e.Juvenil:n.includes("mini")?e.Mini:n.includes("infantil")?e.Infantil:n.includes("femenino")||n.includes("fem")?e.Femenino:0},nX=t=>{const r=tl().referees[t];return r||{employeeNumber:t,hasFixedRate:!1,fixedRate:0,hasAdminFee:!S_.has(t)}},aX=t=>{const e=tl();let r=!1;t.forEach(n=>{e.referees[n.employeeNumber]||(e.referees[n.employeeNumber]={employeeNumber:n.employeeNumber,hasFixedRate:!1,fixedRate:0,hasAdminFee:!S_.has(n.employeeNumber)},r=!0)}),r&&g0(e)},sX=t=>{const e=tl();e.referees[t.employeeNumber]=t,g0(e),window.dispatchEvent(new Event("settings-updated"))},iX=()=>tl().referees,Jn=()=>{try{const t=localStorage.getItem(p0);return t?JSON.parse(t):[]}catch{return[]}},oX=t=>{const e=Jn(),r=e.findIndex(n=>n.id===t.id);r>=0?e[r]=t:e.unshift(t),localStorage.setItem(p0,JSON.stringify(e)),window.dispatchEvent(new Event("payroll-updated"))},lX=t=>{const e=Jn().filter(r=>r.id!==t);localStorage.setItem(p0,JSON.stringify(e)),window.dispatchEvent(new Event("payroll-updated"))},cX=(t,e)=>{const n=Jn().map(a=>a.id===t?{...a,name:e}:a);localStorage.setItem(p0,JSON.stringify(n)),window.dispatchEvent(new Event("payroll-updated"))},uX=t=>{const e=Jn().filter(r=>{const n=new Date(r.dateRange.start);return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`!==t});localStorage.setItem(p0,JSON.stringify(e)),window.dispatchEvent(new Event("payroll-updated"))},fX=()=>{try{const t=localStorage.getItem(q3);return t?JSON.parse(t):null}catch{return null}},hX=t=>{localStorage.setItem(q3,JSON.stringify(t))},dX=t=>{const{categories:e,rates:r,extraPay:n,fines:a=0,globalSettings:i,refereeSettings:l,lifetimeEarningsBefore:u=0}=t;let f=0;Object.values(e).forEach(O=>{f+=O});let h=0;l.hasFixedRate&&l.fixedRate>0?h=f*l.fixedRate:Object.entries(e).forEach(([O,D])=>{const q=r[O]||0;h+=D*q});const m=h+n,x=l.hasAdminFee?f*w_:0,v=m,E=Math.max(0,500-u),w=Math.max(0,v-E),T=w>0?w*i.haciendaTaxRate:0,A=i.depositFee,I=m-x-T-A-a;return{games:f,grossPay:h,extraPay:n,fines:a,totalEarnings:m,adminFee:x,taxableIncome:w,haciendaTax:T,depositFee:A,netPay:I,usedFixedRate:l.hasFixedRate,fixedRate:l.hasFixedRate?l.fixedRate:void 0}},$3=t=>{const e=new Date(t);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`},Wh=t=>{const[e,r]=t.split("-");return new Date(parseInt(e),parseInt(r)-1,1).toLocaleDateString("en-US",{month:"long",year:"numeric"})},ym=()=>{const t=Jn(),e={};return t.forEach(r=>{const n=$3(r.dateRange.start);e[n]||(e[n]={month:n,monthLabel:Wh(n),totalGross:0,totalExtra:0,totalAdminFees:0,totalTax:0,totalDeposits:0,totalNet:0,totalGames:0,refereeCount:0,batches:[]}),e[n].totalGross+=r.totals.grossPay,e[n].totalExtra+=r.totals.totalExtraPay,e[n].totalAdminFees+=r.totals.totalAdminFees,e[n].totalTax+=r.totals.totalTax,e[n].totalDeposits+=r.totals.totalDeposit,e[n].totalNet+=r.totals.netPay,e[n].totalGames+=r.totals.totalGames,e[n].refereeCount=new Set([...e[n].batches.flatMap(a=>a.referees.map(i=>i.employeeNumber)),...r.referees.map(a=>a.employeeNumber)]).size,e[n].batches.push(r)}),Object.values(e).sort((r,n)=>n.month.localeCompare(r.month))},wv=()=>{const t=Jn(),e={};return t.forEach(r=>{const n=$3(r.dateRange.start);r.referees.forEach(a=>{e[a.employeeNumber]||(e[a.employeeNumber]={employeeNumber:a.employeeNumber,refereeName:a.refereeName,months:{},totals:{grossPay:0,extraPay:0,adminFee:0,tax:0,deposit:0,netPay:0,games:0}}),e[a.employeeNumber].months[n]||(e[a.employeeNumber].months[n]={grossPay:0,extraPay:0,adminFee:0,tax:0,deposit:0,netPay:0,games:0});const i=e[a.employeeNumber],l=i.months[n];l.grossPay+=a.grossPay,l.extraPay+=a.extraPay,l.adminFee+=a.adminFee,l.tax+=a.haciendaTax,l.deposit+=a.depositFee,l.netPay+=a.netPay,l.games+=a.games,i.totals.grossPay+=a.grossPay,i.totals.extraPay+=a.extraPay,i.totals.adminFee+=a.adminFee,i.totals.tax+=a.haciendaTax,i.totals.deposit+=a.depositFee,i.totals.netPay+=a.netPay,i.totals.games+=a.games})}),Object.values(e).sort((r,n)=>r.refereeName.localeCompare(n.refereeName))},K3=({isOpen:t,onClose:e,onSettingsChange:r})=>{const[n,a]=xe.useState("global"),[i,l]=xe.useState(W3),[u,f]=xe.useState(gh),[h,m]=xe.useState({}),[x,v]=xe.useState([]),[E,w]=xe.useState(""),[T,A]=xe.useState(null),[I,O]=xe.useState(!1),[D,q]=xe.useState(null),[Y,W]=xe.useState({employeeNumber:"",fullName:""}),[N,b]=xe.useState(null);xe.useEffect(()=>{t&&(l(tp()),f(X3()),m(iX()),v(Ii()))},[t]);const k=(fe,ie)=>{const Fe={...i,[fe]:ie};l(Fe),tX(Fe),r==null||r()},F=(fe,ie)=>{const Fe={...u,[fe]:ie};f(Fe),Eb(Fe),r==null||r()},P=(fe,ie,Fe)=>{const B={...h[fe]||{employeeNumber:fe,hasFixedRate:!1,fixedRate:0,hasAdminFee:!1},[ie]:Fe};m(Q=>({...Q,[fe]:B})),sX(B),r==null||r()},M=x.filter(fe=>fe.fullName.toLowerCase().includes(E.toLowerCase())||fe.employeeNumber.toLowerCase().includes(E.toLowerCase())),j=()=>{O(!0),q(null),W({employeeNumber:"",fullName:""}),b(null)},Le=fe=>{q(fe.employeeNumber),O(!1),W({...fe}),b(null)},De=()=>{O(!1),q(null),W({employeeNumber:"",fullName:""}),b(null)},ne=()=>{if(!Y.fullName.trim()||!Y.employeeNumber.trim()){b("Name and Employee Number are required");return}try{I?zW(Y):D&&HW(D,Y),v(Ii()),De()}catch(fe){b(fe.message||"Failed to save referee")}},ae=fe=>{confirm("Are you sure you want to delete this referee? This cannot be undone.")&&(GW(fe),v(Ii()),D===fe&&De())};return t?_.jsx(ws,{children:_.jsx(Pt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:_.jsxs(Pt.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[85vh] flex flex-col overflow-hidden",children:[_.jsxs("div",{className:"p-6 border-b border-slate-200 flex justify-between items-center bg-gradient-to-r from-slate-50 to-white",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"p-2 bg-primary-100 rounded-xl",children:_.jsx(Iy,{className:"w-5 h-5 text-primary-600"})}),_.jsxs("div",{children:[_.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Payroll Settings"}),_.jsx("p",{className:"text-sm text-slate-500",children:"Configure rates, fees, and database"})]})]}),_.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:_.jsx(Dh,{className:"w-5 h-5 text-slate-500"})})]}),_.jsxs("div",{className:"flex border-b border-slate-200",children:[_.jsx("button",{onClick:()=>a("global"),className:`flex-1 py-3 px-4 text-sm font-medium transition-colors ${n==="global"?"text-primary-600 border-b-2 border-primary-600 bg-primary-50/50":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:_.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_.jsx(bC,{className:"w-4 h-4"}),"Global"]})}),_.jsx("button",{onClick:()=>a("rates"),className:`flex-1 py-3 px-4 text-sm font-medium transition-colors ${n==="rates"?"text-primary-600 border-b-2 border-primary-600 bg-primary-50/50":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:_.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_.jsx(kP,{className:"w-4 h-4"}),"Category Rates"]})}),_.jsx("button",{onClick:()=>a("referees"),className:`flex-1 py-3 px-4 text-sm font-medium transition-colors ${n==="referees"?"text-primary-600 border-b-2 border-primary-600 bg-primary-50/50":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:_.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_.jsx(Fy,{className:"w-4 h-4"}),"Referee Rates"]})}),_.jsx("button",{onClick:()=>a("database"),className:`flex-1 py-3 px-4 text-sm font-medium transition-colors ${n==="database"?"text-primary-600 border-b-2 border-primary-600 bg-primary-50/50":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:_.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_.jsx(tP,{className:"w-4 h-4"}),"Database"]})})]}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[n==="global"&&_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4",children:[_.jsx("h3",{className:"font-semibold text-amber-800 mb-1",children:"Puerto Rico Hacienda Tax"}),_.jsx("p",{className:"text-sm text-amber-600 mb-3",children:"This is the mandatory tax deduction from all referee earnings."}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsxs("div",{className:"relative flex-1 max-w-[150px]",children:[_.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:i.haciendaTaxRate*100,onChange:fe=>k("haciendaTaxRate",parseFloat(fe.target.value)/100||0),className:"w-full px-4 py-2 pr-8 border border-amber-300 rounded-lg focus:ring-2 focus:ring-amber-500/20 focus:border-amber-500 outline-none"}),_.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-amber-600",children:"%"})]}),_.jsx("span",{className:"text-sm text-amber-700",children:"of taxable income"})]})]}),_.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:[_.jsx("h3",{className:"font-semibold text-blue-800 mb-1",children:"Deposit Fee"}),_.jsx("p",{className:"text-sm text-blue-600 mb-3",children:"Fixed fee deducted from each referee's pay."}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsxs("div",{className:"relative flex-1 max-w-[150px]",children:[_.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-blue-600",children:"$"}),_.jsx("input",{type:"number",min:"0",step:"0.01",value:i.depositFee,onChange:fe=>k("depositFee",parseFloat(fe.target.value)||0),className:"w-full px-4 py-2 pl-8 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none"})]}),_.jsx("span",{className:"text-sm text-blue-700",children:"per referee"})]})]}),_.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[_.jsx("h3",{className:"font-semibold text-purple-800 mb-1",children:"Administration Fee"}),_.jsx("p",{className:"text-sm text-purple-600 mb-3",children:"Fixed at $2 per game for non-exempt referees. Exemptions are set per referee below."}),_.jsxs("div",{className:"flex items-center gap-3 text-purple-700",children:[_.jsxs("div",{className:"flex items-center gap-2 bg-white border border-purple-200 rounded-lg px-3 py-2",children:[_.jsx(bp,{className:"w-4 h-4"}),_.jsx("span",{className:"font-semibold",children:"2.00"}),_.jsx("span",{className:"text-sm text-purple-500",children:"per game"})]}),_.jsx("span",{className:"text-sm",children:"Non-editable (policy)"})]})]})]}),n==="rates"&&_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-4",children:[_.jsx("h3",{className:"font-semibold text-green-800 mb-1",children:"Category Rates Configuration"}),_.jsx("p",{className:"text-sm text-green-600",children:"Set the default payment rate for each game category. These rates are used when calculating referee pay."})]}),_.jsxs("div",{children:[_.jsxs("h4",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[_.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Named Categories"]}),_.jsx("div",{className:"grid grid-cols-2 gap-4",children:["Senior","Junior","Juvenil","Mini","Infantil","Femenino"].map(fe=>_.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4",children:[_.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:fe}),_.jsxs("div",{className:"relative",children:[_.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:"$"}),_.jsx("input",{type:"number",min:"0",step:"1",value:u[fe],onChange:ie=>F(fe,parseFloat(ie.target.value)||0),className:"w-full px-4 py-2 pl-8 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none"})]})]},fe))})]}),_.jsxs("div",{children:[_.jsxs("h4",{className:"text-sm font-semibold text-slate-700 mb-3 flex items-center gap-2",children:[_.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"Age-Based Categories (U-Series)"]}),_.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:["U6-U8","U9-U11","U12-U14","U15-U16","U17-U18"].map(fe=>_.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4",children:[_.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:fe}),_.jsxs("div",{className:"relative",children:[_.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:"$"}),_.jsx("input",{type:"number",min:"0",step:"1",value:u[fe],onChange:ie=>F(fe,parseFloat(ie.target.value)||0),className:"w-full px-4 py-2 pl-8 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none"})]})]},fe))})]}),_.jsx("div",{className:"pt-4 border-t border-slate-200",children:_.jsx("button",{onClick:()=>{f(gh),Eb(gh),r==null||r()},className:"text-sm text-slate-500 hover:text-primary-600 transition-colors",children:"Reset to default rates"})})]}),n==="referees"&&_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"relative",children:[_.jsx(cv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),_.jsx("input",{type:"text",placeholder:"Search referees...",value:E,onChange:fe=>w(fe.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none"})]}),_.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-3 text-sm",children:[_.jsxs("p",{className:"text-slate-600 mb-2",children:[_.jsx("strong",{children:"Admin Fee:"})," $2/game is charged to all referees ",_.jsx("strong",{children:"except"})," those marked as exempt."]}),_.jsx("p",{className:"text-slate-500",children:"Configure individual referee settings for fixed rates and admin fee exemptions below."})]}),_.jsx("div",{className:"space-y-2",children:M.map(fe=>{const ie=eX(fe.employeeNumber),Fe=h[fe.employeeNumber]||{employeeNumber:fe.employeeNumber,hasFixedRate:!1,fixedRate:0,hasAdminFee:!ie},ee=T===fe.employeeNumber;return _.jsxs("div",{className:"border border-slate-200 rounded-xl overflow-hidden",children:[_.jsxs("div",{onClick:()=>A(ee?null:fe.employeeNumber),className:"p-4 flex items-center justify-between cursor-pointer hover:bg-slate-50 transition-colors",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-600 font-medium",children:fe.fullName.charAt(0)}),_.jsxs("div",{children:[_.jsx("p",{className:"font-medium text-slate-800",children:fe.fullName}),_.jsxs("p",{className:"text-xs text-slate-400",children:["#",fe.employeeNumber]})]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[Fe.hasFixedRate&&_.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full",children:["Fixed $",Fe.fixedRate]}),Fe.hasAdminFee?_.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full",children:"Admin Fee $2/game"}):_.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded-full",children:"Exempt"})]})]}),_.jsx(ws,{children:ee&&_.jsx(Pt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-200 bg-slate-50",children:_.jsxs("div",{className:"p-4 space-y-4",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("p",{className:"font-medium text-slate-700",children:"Fixed Rate"}),_.jsx("p",{className:"text-xs text-slate-500",children:"Same pay per game, ignores category rates"})]}),_.jsx("button",{onClick:()=>P(fe.employeeNumber,"hasFixedRate",!Fe.hasFixedRate),className:`w-12 h-6 rounded-full transition-colors ${Fe.hasFixedRate?"bg-green-500":"bg-slate-300"}`,children:_.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-sm transform transition-transform ${Fe.hasFixedRate?"translate-x-6":"translate-x-0.5"}`})})]}),Fe.hasFixedRate&&_.jsxs("div",{className:"pl-4 border-l-2 border-green-300",children:[_.jsx("label",{className:"block text-sm text-slate-600 mb-1",children:"Rate per game"}),_.jsxs("div",{className:"relative w-32",children:[_.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:"$"}),_.jsx("input",{type:"number",min:"0",step:"0.01",value:Fe.fixedRate,onChange:B=>P(fe.employeeNumber,"fixedRate",parseFloat(B.target.value)||0),className:"w-full pl-8 pr-3 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-green-500/20 focus:border-green-500 outline-none"})]})]}),_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("p",{className:"font-medium text-slate-700",children:Fe.hasAdminFee?"Pays Admin Fee":"Exempt from Admin Fee"}),_.jsxs("p",{className:"text-xs text-slate-500",children:[Fe.hasAdminFee?"$2/game deducted from earnings":"No admin fee deduction",ie&&!Fe.hasAdminFee&&_.jsx("span",{className:"ml-1 text-emerald-600",children:"(default exempt)"})]})]}),_.jsx("button",{onClick:()=>P(fe.employeeNumber,"hasAdminFee",!Fe.hasAdminFee),className:`w-12 h-6 rounded-full transition-colors ${Fe.hasAdminFee?"bg-purple-500":"bg-emerald-500"}`,children:_.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-sm transform transition-transform ${Fe.hasAdminFee?"translate-x-6":"translate-x-0.5"}`})})]})]})})})]},fe.employeeNumber)})})]}),n==="database"&&_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsxs("div",{className:"relative flex-1 mr-4",children:[_.jsx(cv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),_.jsx("input",{type:"text",placeholder:"Search database...",value:E,onChange:fe=>w(fe.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none"})]}),_.jsxs("button",{onClick:j,disabled:I,className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[_.jsx(Ry,{className:"w-4 h-4"}),"Add Referee"]})]}),_.jsx(ws,{children:(I||D)&&_.jsxs(Pt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-slate-50 border border-slate-200 rounded-xl p-4 mb-4",children:[_.jsxs("div",{className:"flex justify-between items-start mb-4",children:[_.jsx("h3",{className:"font-semibold text-slate-800",children:I?"Add New Referee":"Edit Referee"}),_.jsx("button",{onClick:De,className:"text-slate-400 hover:text-slate-600",children:_.jsx(Dh,{className:"w-4 h-4"})})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Full Name"}),_.jsx("input",{type:"text",value:Y.fullName,onChange:fe=>W(ie=>({...ie,fullName:fe.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none",placeholder:"e.g., JOHN DOE"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Employee Number"}),_.jsx("input",{type:"text",value:Y.employeeNumber,onChange:fe=>W(ie=>({...ie,employeeNumber:fe.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none",placeholder:"e.g., 1234",disabled:!!D}),D&&_.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Employee ID cannot be changed once created."})]}),N&&_.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm bg-red-50 p-2 rounded-lg",children:[_.jsx(SC,{className:"w-4 h-4"}),N]}),_.jsxs("div",{className:"flex justify-end gap-3",children:[_.jsx("button",{onClick:De,className:"px-4 py-2 text-slate-600 hover:text-slate-800 font-medium",children:"Cancel"}),_.jsxs("button",{onClick:ne,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 font-medium flex items-center gap-2",children:[_.jsx(wP,{className:"w-4 h-4"}),"Save"]})]})]})]})}),_.jsxs("div",{className:"space-y-2",children:[M.map(fe=>_.jsxs("div",{className:`border rounded-xl p-4 flex justify-between items-center bg-white hover:border-primary-200 transition-colors ${D===fe.employeeNumber?"border-primary-500 ring-1 ring-primary-500":"border-slate-200"}`,children:[_.jsxs("div",{children:[_.jsx("p",{className:"font-medium text-slate-800",children:fe.fullName}),_.jsxs("p",{className:"text-xs text-slate-400",children:["#",fe.employeeNumber]})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("button",{onClick:()=>Le(fe),className:"p-2 text-slate-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors",title:"Edit",children:_.jsx(mP,{className:"w-4 h-4"})}),_.jsx("button",{onClick:()=>ae(fe.employeeNumber),className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:_.jsx(Np,{className:"w-4 h-4"})})]})]},fe.employeeNumber)),M.length===0&&_.jsxs("div",{className:"text-center py-8 text-slate-400",children:['No referees found matching "',E,'"']})]})]})]}),_.jsx("div",{className:"p-4 border-t border-slate-200 bg-slate-50 flex justify-end",children:_.jsxs("button",{onClick:e,className:"px-6 py-2.5 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-semibold shadow-lg shadow-primary-600/20 transition-all flex items-center gap-2",children:[_.jsx(lv,{className:"w-4 h-4"}),"Done"]})})]})})}):null},mX=({arbitrators:t=[],rates:e={},categories:r=[],dateRange:n,batchId:a="",onRateChange:i=()=>{},onReset:l,initialMonth:u=""})=>{var ce,Se,Oe,ke;const[f,h]=xe.useState("payroll"),[m,x]=xe.useState(tp()),[v,E]=xe.useState({}),[w,T]=xe.useState({}),[A,I]=xe.useState(new Set),[O,D]=xe.useState(!1),[q,Y]=xe.useState(!1),[W,N]=xe.useState(0),[b,k]=xe.useState(u),[F,P]=xe.useState(a),M=xe.useRef(null);xe.useEffect(()=>{u&&k(u)},[u]),xe.useEffect(()=>{a&&P(a)},[a]),xe.useEffect(()=>{var se;q&&((se=M.current)==null||se.scrollIntoView({behavior:"smooth",block:"start"}))},[q]);const j=xe.useMemo(()=>{if(!b)return{arbitrators:t,rates:e};const Me=Jn().filter(we=>{const Ae=new Date(we.dateRange.start);return`${Ae.getFullYear()}-${String(Ae.getMonth()+1).padStart(2,"0")}`===b}),V={};return Me.forEach(we=>{we.referees.forEach(Ae=>{const Je=Ae.employeeNumber;V[Je]||(V[Je]={name:Ae.scheduleName,displayName:Ae.refereeName,employeeNumber:Ae.employeeNumber,categories:{},total:0,matchedReferee:{employeeNumber:Ae.employeeNumber,fullName:Ae.refereeName}});const Ye=V[Je];Ye.total+=Ae.games})}),{arbitrators:Object.values(V),rates:{},isHistoryView:!0,monthBatches:Me}},[b,t,e]),Le=xe.useMemo(()=>{const se=Jn(),Me=new Set;return se.forEach(V=>{const we=new Date(V.dateRange.start),Ae=`${we.getFullYear()}-${String(we.getMonth()+1).padStart(2,"0")}`;Me.add(Ae)}),Array.from(Me).sort().reverse()},[]);xe.useEffect(()=>{const se=t.find(Me=>Me.employeeNumber==="594"||Me.employeeNumber==="2594");if(se){const Me=se.employeeNumber||se.name;E(V=>V[Me]===void 0?{...V,[Me]:175}:V)}},[t]);const De=xe.useMemo(()=>{const se=Jn(),Me={};return se.forEach(V=>{F&&V.id===F||V.referees.forEach(we=>{const Ae=we.grossPay+we.extraPay;Me[we.employeeNumber]=(Me[we.employeeNumber]||0)+Ae})}),Me},[W,F]);xe.useEffect(()=>{x(tp())},[W]);const ne=xe.useMemo(()=>{if(j.isHistoryView&&j.monthBatches){const se={};return j.monthBatches.forEach(Me=>{Me.referees.forEach(V=>{const we=V.employeeNumber;se[we]||(se[we]={name:V.scheduleName,displayName:V.refereeName,employeeNumber:V.employeeNumber,categories:{},total:0,extraPay:0,calculation:{games:0,grossPay:0,extraPay:0,fines:0,totalEarnings:0,adminFee:0,taxableIncome:0,haciendaTax:0,depositFee:0,netPay:0,usedFixedRate:!1}});const Ae=se[we];Ae.total+=V.games,Ae.extraPay+=V.extraPay,Ae.calculation.games+=V.games,Ae.calculation.grossPay+=V.grossPay,Ae.calculation.extraPay+=V.extraPay,Ae.calculation.fines+=V.fines||0,Ae.calculation.totalEarnings+=V.grossPay+V.extraPay,Ae.calculation.adminFee+=V.adminFee,Ae.calculation.taxableIncome+=V.taxableIncome,Ae.calculation.haciendaTax+=V.haciendaTax,Ae.calculation.depositFee+=V.depositFee,Ae.calculation.netPay+=V.netPay,Ae.calculation.usedFixedRate=V.usedFixedRate,Ae.calculation.fixedRate=V.fixedRate})}),Object.values(se).sort((Me,V)=>(Me.displayName||Me.name).localeCompare(V.displayName||V.name))}return t.map(se=>{const Me=se.employeeNumber||se.name,V=nX(Me),we=v[Me]||0,Ae=w[Me]||0,Je=De[Me]||0,Ye=dX({refereeName:se.displayName||se.name,scheduleName:se.name,categories:se.categories,rates:e,extraPay:we,fines:Ae,globalSettings:m,refereeSettings:V,lifetimeEarningsBefore:Je});return{...se,calculation:Ye,extraPay:we,fines:Ae}}).sort((se,Me)=>(se.displayName||se.name).localeCompare(Me.displayName||Me.name))},[t,e,m,v,w,W,j,De]),ae=xe.useMemo(()=>{const se=ne.reduce((Be,Qe)=>Be+Qe.calculation.grossPay,0),Me=ne.reduce((Be,Qe)=>Be+Qe.calculation.extraPay,0),V=ne.reduce((Be,Qe)=>Be+Qe.calculation.fines,0),we=ne.reduce((Be,Qe)=>Be+Qe.calculation.adminFee,0),Ae=ne.reduce((Be,Qe)=>Be+Qe.calculation.haciendaTax,0),Je=ne.reduce((Be,Qe)=>Be+Qe.calculation.depositFee,0),Ye=ne.reduce((Be,Qe)=>Be+Qe.calculation.netPay,0),ge=ne.reduce((Be,Qe)=>Be+Qe.calculation.games,0),qe=[...ne].sort((Be,Qe)=>Qe.calculation.netPay-Be.calculation.netPay)[0];return{totalGross:se,totalExtra:Me,totalFines:V,totalAdminFees:we,totalTax:Ae,totalDeposit:Je,totalNet:Ye,totalGames:ge,topEarner:qe}},[ne]),fe=(se,Me)=>{E(V=>({...V,[se]:Math.max(0,Me)}))},ie=(se,Me)=>{T(V=>({...V,[se]:Math.max(0,Me)}))},Fe=se=>{I(Me=>{const V=new Set(Me);return V.has(se)?V.delete(se):V.add(se),V})},ee=()=>{const se=F||`batch_${Date.now()}`;F||P(se);const Me=ne.map(we=>({employeeNumber:we.employeeNumber||we.name,refereeName:we.displayName||we.name,scheduleName:we.name,games:we.calculation.games,grossPay:we.calculation.grossPay,extraPay:we.calculation.extraPay,adminFee:we.calculation.adminFee,fines:we.calculation.fines,taxableIncome:we.calculation.taxableIncome,haciendaTax:we.calculation.haciendaTax,depositFee:we.calculation.depositFee,netPay:we.calculation.netPay,usedFixedRate:we.calculation.usedFixedRate,fixedRate:we.calculation.fixedRate,categories:we.categories,categoryRates:e})),V={id:se,timestamp:Date.now(),dateRange:n||{start:"",end:""},files:[],referees:Me,totals:{grossPay:ae.totalGross,totalExtraPay:ae.totalExtra,totalAdminFees:ae.totalAdminFees,totalFines:ae.totalFines,totalTax:ae.totalTax,totalDeposit:ae.totalDeposit,netPay:ae.totalNet,totalGames:ae.totalGames}};oX(V),alert("Payroll batch saved successfully!")},B=()=>{const se=new Set;ne.forEach(ge=>{Object.keys(ge.categories||{}).forEach(qe=>se.add(qe))});const Me=Array.from(se).sort(),V=ne.map(ge=>{const qe={"Employee #":ge.employeeNumber||"N/A","Referee Name":ge.displayName||ge.name,Games:ge.calculation.games,"Rate Type":ge.calculation.usedFixedRate?`Fixed $${ge.calculation.fixedRate}`:"Category"};return Me.forEach(Be=>{var Wt;const Qe=((Wt=ge.categories)==null?void 0:Wt[Be])||0,zt=e[Be]||0;qe[`${Be} (Games)`]=Qe,qe[`${Be} (Rate)`]=Qe>0?`$${zt}`:"-",qe[`${Be} (Value)`]=Qe>0?Qe*zt:0}),qe["Gross Pay"]=ge.calculation.grossPay,qe["Extra Pay"]=ge.calculation.extraPay,qe["Total Earnings"]=ge.calculation.totalEarnings,qe["Admin Fee"]=ge.calculation.adminFee,qe.Fines=ge.calculation.fines,qe["Taxable Income"]=ge.calculation.taxableIncome,qe["Hacienda Tax (10%)"]=ge.calculation.haciendaTax,qe["Deposit Fee"]=ge.calculation.depositFee,qe["Net Pay"]=ge.calculation.netPay,qe}),we={"Employee #":"","Referee Name":"TOTALS",Games:ae.totalGames,"Rate Type":""};Me.forEach(ge=>{const qe=ne.reduce((Qe,zt)=>{var Wt;return Qe+(((Wt=zt.categories)==null?void 0:Wt[ge])||0)},0),Be=e[ge]||0;we[`${ge} (Games)`]=qe,we[`${ge} (Rate)`]=`$${Be}`,we[`${ge} (Value)`]=qe*Be}),we["Gross Pay"]=ae.totalGross,we["Extra Pay"]=ae.totalExtra,we["Total Earnings"]=ae.totalGross+ae.totalExtra,we["Admin Fee"]=ae.totalAdminFees,we.Fines=ae.totalFines,we["Taxable Income"]="N/A",we["Hacienda Tax (10%)"]=ae.totalTax,we["Deposit Fee"]=ae.totalDeposit,we["Net Pay"]=ae.totalNet,V.push(we);const Ae=ba.json_to_sheet(V),Je=ba.book_new();ba.book_append_sheet(Je,Ae,"Payroll Report");let Ye="Referee_Payroll_Report.xlsx";n!=null&&n.start&&(n!=null&&n.end)&&(Ye=`Payroll_${n.start}_to_${n.end}.xlsx`),Zm(Je,Ye)},Q=xe.useMemo(()=>{const se=(ge,qe)=>{const Be=ge.match(/(\d+)/),Qe=qe.match(/(\d+)/),zt=Be?parseInt(Be[1],10):Number.NaN,Wt=Qe?parseInt(Qe[1],10):Number.NaN,rr=Number.isFinite(zt),ft=Number.isFinite(Wt);return rr&&ft?zt!==Wt?zt-Wt:ge.localeCompare(qe,void 0,{numeric:!0,sensitivity:"base"}):rr?-1:ft?1:ge.localeCompare(qe,void 0,{numeric:!0,sensitivity:"base"})},Me=new Set,V={},we=[];let Ae=0;const Je=(ge,qe)=>{if(Number.isNaN(qe))return;const Be=T_(ge);V[Be]===void 0&&(V[Be]=qe),Me.add(Be)};if(j.isHistoryView&&j.monthBatches){const ge={};j.monthBatches.forEach(qe=>{qe.referees.forEach(Be=>{const Qe=Be.employeeNumber;ge[Qe]||(ge[Qe]={employeeNumber:Be.employeeNumber,refereeName:Be.refereeName||Be.scheduleName,totalGames:0,categories:{}}),ge[Qe].totalGames+=Be.games;const zt=_b(Be.categories||{});Object.entries(zt).forEach(([rr,ft])=>{ge[Qe].categories[rr]=(ge[Qe].categories[rr]||0)+ft,Me.add(rr)});const Wt=Be.categoryRates||{};Object.entries(Wt).forEach(([rr,ft])=>{Je(rr,ft)})})}),Object.values(ge).sort((qe,Be)=>qe.refereeName.localeCompare(Be.refereeName)).forEach(qe=>{Ae+=qe.totalGames,we.push(qe)})}else ne.forEach(ge=>{const qe=_b(ge.categories||{});Object.keys(qe).forEach(Be=>Me.add(Be)),Ae+=ge.calculation.games,we.push({employeeNumber:ge.employeeNumber||"N/A",refereeName:ge.displayName||ge.name,totalGames:ge.calculation.games,categories:qe})}),Object.entries(e).forEach(([ge,qe])=>{Je(ge,qe)});return{categories:Array.from(Me).sort(se),rows:we,totalGames:Ae,categoryRates:V}},[j,ne,e]),J=se=>{const Me=Q.categoryRates[se];return Me===void 0?"Rate n/a":`$${Me.toFixed(2)}/game`},te=()=>{if(Q.rows.length===0||Q.categories.length===0){alert("No category data available for this report.");return}const se=Q.rows.map(ge=>{const qe={"Employee #":ge.employeeNumber||"N/A","Referee Name":ge.refereeName,"Total Games":ge.totalGames};return Q.categories.forEach(Be=>{qe[Be]=ge.categories[Be]||0}),qe}),Me={"Employee #":"","Referee Name":"Rate ($/game)","Total Games":""};Q.categories.forEach(ge=>{const qe=Q.categoryRates[ge];Me[ge]=qe!==void 0?qe:""});const V={"Employee #":"","Referee Name":"TOTALS","Total Games":Q.totalGames};Q.categories.forEach(ge=>{V[ge]=se.reduce((qe,Be)=>qe+Number(Be[ge]||0),0)});const we=[Me,...se,V],Ae=ba.json_to_sheet(we),Je=ba.book_new();ba.book_append_sheet(Je,Ae,"Category Report");let Ye="Category_Report.xlsx";b?Ye=`Category_Report_${b}.xlsx`:n!=null&&n.start&&(n!=null&&n.end)&&(Ye=`Category_Report_${n.start}_to_${n.end}.xlsx`),Zm(Je,Ye)};return _.jsxs(Pt.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full space-y-6",children:[_.jsx(K3,{isOpen:O,onClose:()=>D(!1),onSettingsChange:()=>N(se=>se+1)}),_.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-4",children:[_.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Payroll Dashboard"}),b?_.jsxs("p",{className:"text-sm text-slate-500 flex items-center gap-2 mt-1",children:[_.jsx(Rh,{className:"w-4 h-4"}),"Viewing History: ",Wh(b)]}):(n==null?void 0:n.start)&&(n==null?void 0:n.end)&&_.jsxs("p",{className:"text-sm text-slate-500 flex items-center gap-2 mt-1",children:[_.jsx(Rh,{className:"w-4 h-4"}),"Period: ",n.start," to ",n.end]})]}),_.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[_.jsxs("div",{className:"relative",children:[_.jsxs("select",{value:b,onChange:se=>k(se.target.value),className:"appearance-none pl-3 pr-8 py-2 bg-slate-50 border border-slate-200 text-slate-700 rounded-lg text-sm font-medium focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none cursor-pointer hover:bg-slate-100 transition-colors",children:[_.jsx("option",{value:"",children:t.length>0?"Current Batch":"Select Month..."}),Le.map(se=>_.jsx("option",{value:se,children:Wh(se)},se))]}),_.jsx(Lm,{className:"w-4 h-4 text-slate-400 absolute right-2.5 top-1/2 -translate-y-1/2 pointer-events-none"})]}),!b&&t.length>0&&_.jsxs(_.Fragment,{children:[_.jsxs("button",{onClick:()=>D(!0),className:"flex items-center gap-2 px-4 py-2 text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg font-medium transition-colors",children:[_.jsx(Iy,{className:"w-4 h-4"}),"Settings"]}),_.jsx("button",{onClick:l,className:"px-4 py-2 text-slate-600 hover:text-slate-800 font-medium transition-colors",children:"Start Over"}),_.jsxs("button",{onClick:ee,className:"flex items-center gap-2 bg-white text-slate-600 hover:text-slate-800 hover:bg-slate-50 border border-slate-200 px-4 py-2 rounded-lg font-medium transition-all",children:[_.jsx(oh,{className:"w-4 h-4"}),"Save Batch"]})]}),_.jsxs("button",{onClick:B,className:"flex items-center gap-2 bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg font-medium shadow-lg shadow-primary-600/20 transition-all",children:[_.jsx(Vm,{className:"w-4 h-4"}),"Export ",b?"Month":"Batch"]}),_.jsxs("button",{onClick:()=>Y(se=>!se),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all border ${q?"bg-primary-50 text-primary-700 border-primary-200":"bg-white text-slate-600 hover:text-slate-800 hover:bg-slate-50 border-slate-200"}`,children:[_.jsx(oh,{className:"w-4 h-4"}),q?"Hide Category Report":"Category Report"]})]})]}),_.jsx("div",{className:"flex gap-1 mt-4 border-t border-slate-100 pt-4",children:[{id:"payroll",label:"Current Payroll",icon:_P},{id:"employees",label:"Employee View",icon:jm},{id:"monthly",label:"Monthly Summary",icon:NC},{id:"history",label:"History",icon:oh}].map(se=>_.jsxs("button",{onClick:()=>h(se.id),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-sm transition-all ${f===se.id?"bg-primary-100 text-primary-700":"text-slate-500 hover:text-slate-700 hover:bg-slate-50"}`,children:[_.jsx(se.icon,{className:"w-4 h-4"}),se.label]},se.id))})]}),f==="payroll"&&_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[_.jsx(im,{icon:bp,iconBg:"bg-green-100",iconColor:"text-green-600",label:"Net Payout",value:`$${ae.totalNet.toLocaleString("en-US",{minimumFractionDigits:2})}`,sublabel:`Gross: $${ae.totalGross.toFixed(2)}`}),_.jsx(im,{icon:bC,iconBg:"bg-amber-100",iconColor:"text-amber-600",label:"Hacienda Tax",value:`$${ae.totalTax.toLocaleString("en-US",{minimumFractionDigits:2})}`,sublabel:"10% of taxable income"}),_.jsx(im,{icon:jm,iconBg:"bg-blue-100",iconColor:"text-blue-600",label:"Total Games",value:ae.totalGames.toString(),sublabel:`${ne.length} referees`}),_.jsx(im,{icon:OP,iconBg:"bg-purple-100",iconColor:"text-purple-600",label:"Top Earner",value:((Se=(ce=ae.topEarner)==null?void 0:ce.displayName)==null?void 0:Se.split(" ")[0])||((Oe=ae.topEarner)==null?void 0:Oe.name)||"-",sublabel:`$${((ke=ae.topEarner)==null?void 0:ke.calculation.netPay.toFixed(2))||0}`})]}),_.jsxs("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 rounded-2xl p-6 text-white",children:[_.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[_.jsx(q8,{className:"w-5 h-5"}),"Deductions Summary"]}),_.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 text-center",children:[_.jsxs("div",{children:[_.jsx("p",{className:"text-slate-400 text-xs uppercase",children:"Gross Total"}),_.jsxs("p",{className:"text-xl font-bold",children:["$",(ae.totalGross+ae.totalExtra).toFixed(2)]})]}),_.jsxs("div",{children:[_.jsx("p",{className:"text-slate-400 text-xs uppercase",children:"Admin Fees"}),_.jsxs("p",{className:"text-xl font-bold text-red-400",children:["-$",ae.totalAdminFees.toFixed(2)]})]}),_.jsxs("div",{children:[_.jsx("p",{className:"text-slate-400 text-xs uppercase",children:"Fines"}),_.jsxs("p",{className:"text-xl font-bold text-red-400",children:["-$",ae.totalFines.toFixed(2)]})]}),_.jsxs("div",{children:[_.jsx("p",{className:"text-slate-400 text-xs uppercase",children:"Hacienda Tax"}),_.jsxs("p",{className:"text-xl font-bold text-amber-400",children:["-$",ae.totalTax.toFixed(2)]})]}),_.jsxs("div",{children:[_.jsx("p",{className:"text-slate-400 text-xs uppercase",children:"Deposit Fees"}),_.jsxs("p",{className:"text-xl font-bold text-blue-400",children:["-$",ae.totalDeposit.toFixed(2)]})]}),_.jsxs("div",{className:"bg-white/10 rounded-xl p-2",children:[_.jsx("p",{className:"text-green-300 text-xs uppercase",children:"Net Payout"}),_.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",ae.totalNet.toFixed(2)]})]})]})]}),_.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm",children:[_.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-4 py-3 text-left font-semibold text-slate-600",children:"Referee"}),_.jsx("th",{className:"px-4 py-3 text-center font-semibold text-slate-600",children:"Games"}),_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-600",children:"Gross"}),_.jsx("th",{className:"px-4 py-3 text-center font-semibold text-slate-600",children:"Extra Pay"}),_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-600",children:"Admin Fee"}),_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-600",children:"Fines"}),_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-600",children:"Tax (10%)"}),_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-600",children:"Deposit"}),_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-600",children:"Net Pay"}),_.jsx("th",{className:"px-4 py-3 w-10"})]})}),_.jsx("tbody",{className:"divide-y divide-slate-100",children:ne.map((se,Me)=>{const V=A.has(se.name),we=se.employeeNumber||se.name;return _.jsxs(Y6.Fragment,{children:[_.jsxs(Pt.tr,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:Me*.02},className:"hover:bg-slate-50/50 transition-colors",children:[_.jsx("td",{className:"px-4 py-3",children:_.jsxs("div",{className:"flex flex-col",children:[_.jsx("span",{className:"font-medium text-slate-900",children:se.displayName||se.name}),_.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[se.employeeNumber&&_.jsxs("span",{className:"text-xs text-slate-400",children:["#",se.employeeNumber]}),se.calculation.usedFixedRate&&_.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-green-100 text-green-700 rounded",children:["Fixed $",se.calculation.fixedRate]})]})]})}),_.jsx("td",{className:"px-4 py-3 text-center",children:_.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-primary-50 text-primary-600 font-medium",children:se.calculation.games})}),_.jsxs("td",{className:"px-4 py-3 text-right font-medium",children:["$",se.calculation.grossPay.toFixed(2)]}),_.jsx("td",{className:"px-4 py-3",children:_.jsx("div",{className:"flex items-center justify-center gap-1",children:_.jsx("input",{type:"number",min:"0",value:v[we]||0,onChange:Ae=>fe(we,parseFloat(Ae.target.value)||0),className:"w-20 text-center px-2 py-1 border border-slate-200 rounded text-sm bg-slate-50 focus:bg-white focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all outline-none"})})}),_.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:se.calculation.adminFee>0?`-$${se.calculation.adminFee.toFixed(2)}`:"-"}),_.jsx("td",{className:"px-4 py-3",children:_.jsx("div",{className:"flex items-center justify-end gap-1",children:_.jsx("input",{type:"number",min:"0",value:w[we]||0,onChange:Ae=>ie(we,parseFloat(Ae.target.value)||0),className:`w-16 text-center px-2 py-1 border rounded text-sm ${(w[we]||0)>0?"border-red-300 bg-red-50 text-red-700":"border-slate-200"}`,placeholder:"0"})})}),_.jsxs("td",{className:"px-4 py-3 text-right text-amber-600",children:["-$",se.calculation.haciendaTax.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-right text-blue-600",children:["-$",se.calculation.depositFee.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-right font-bold text-green-600",children:["$",se.calculation.netPay.toFixed(2)]}),_.jsx("td",{className:"px-2 py-3",children:_.jsx("button",{onClick:()=>Fe(se.name),className:"p-1 hover:bg-slate-100 rounded",children:V?_.jsx(ky,{className:"w-4 h-4"}):_.jsx(Lm,{className:"w-4 h-4"})})})]}),_.jsx(ws,{children:V&&_.jsx(Pt.tr,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:_.jsx("td",{colSpan:10,className:"bg-slate-50 px-6 py-4",children:_.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.map(Ae=>{const Je=se.categories[Ae]||0;return Je===0?null:_.jsxs("div",{className:"bg-white rounded-lg p-3 border border-slate-200",children:[_.jsx("p",{className:"text-xs text-slate-500 uppercase",children:Ae}),_.jsxs("p",{className:"text-lg font-bold text-slate-800",children:[Je," games"]}),!se.calculation.usedFixedRate&&_.jsxs("p",{className:"text-xs text-slate-400",children:["@ $",e[Ae],"/game"]})]},Ae)})})})})})]},se.name)})}),_.jsx("tfoot",{className:"bg-slate-100 font-semibold",children:_.jsxs("tr",{children:[_.jsxs("td",{className:"px-4 py-3",children:["Totals (",ne.length," referees)"]}),_.jsx("td",{className:"px-4 py-3 text-center",children:ae.totalGames}),_.jsxs("td",{className:"px-4 py-3 text-right",children:["$",ae.totalGross.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-center",children:["$",ae.totalExtra.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-right text-red-600",children:["-$",ae.totalAdminFees.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-right text-red-600",children:["-$",ae.totalFines.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-right text-amber-600",children:["-$",ae.totalTax.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-right text-blue-600",children:["-$",ae.totalDeposit.toFixed(2)]}),_.jsxs("td",{className:"px-4 py-3 text-right text-green-600",children:["$",ae.totalNet.toFixed(2)]}),_.jsx("td",{})]})})]})})}),q&&_.jsxs("div",{ref:M,className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[_.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 p-4 border-b border-slate-100",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-semibold text-slate-800",children:"Category Report"}),_.jsx("p",{className:"text-sm text-slate-500",children:"All categories in this batch and the categories each referee worked."})]}),_.jsxs("button",{onClick:te,className:"flex items-center gap-2 px-3 py-2 text-sm text-white bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors shadow-sm",children:[_.jsx(Vm,{className:"w-4 h-4"}),"Download Report"]})]}),Q.categories.length===0?_.jsx("div",{className:"p-6 text-center text-slate-500",children:"No category data available for this report."}):_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm",children:[_.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-4 py-3 text-left font-semibold text-slate-600",children:"Referee"}),_.jsx("th",{className:"px-4 py-3 text-center font-semibold text-slate-600",children:"Total Games"}),Q.categories.map(se=>_.jsx("th",{className:"px-4 py-3 text-center font-semibold text-slate-600",children:_.jsxs("div",{className:"flex flex-col items-center gap-1",children:[_.jsx("span",{children:se}),_.jsx("span",{className:"text-xs font-normal text-slate-400",children:J(se)})]})},se))]})}),_.jsx("tbody",{className:"divide-y divide-slate-100",children:Q.rows.map(se=>_.jsxs("tr",{className:"hover:bg-slate-50/50",children:[_.jsx("td",{className:"px-4 py-3",children:_.jsxs("div",{className:"flex flex-col",children:[_.jsx("span",{className:"font-medium text-slate-900",children:se.refereeName}),se.employeeNumber&&_.jsxs("span",{className:"text-xs text-slate-400",children:["#",se.employeeNumber]})]})}),_.jsx("td",{className:"px-4 py-3 text-center font-medium text-slate-700",children:se.totalGames}),Q.categories.map(Me=>_.jsx("td",{className:"px-4 py-3 text-center text-slate-700",children:se.categories[Me]||0},Me))]},`${se.employeeNumber}-${se.refereeName}`))}),_.jsx("tfoot",{className:"bg-slate-100 font-semibold",children:_.jsxs("tr",{children:[_.jsx("td",{className:"px-4 py-3",children:"Totals"}),_.jsx("td",{className:"px-4 py-3 text-center",children:Q.totalGames}),Q.categories.map(se=>_.jsx("td",{className:"px-4 py-3 text-center",children:Q.rows.reduce((Me,V)=>Me+(V.categories[se]||0),0)},se))]})})]})})]}),!b&&_.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6",children:[_.jsx("h3",{className:"font-semibold text-slate-800 mb-4",children:"Category Rates"}),_.jsx("div",{className:"flex flex-wrap gap-3",children:r.map(se=>_.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 rounded-lg p-2",children:[_.jsx("span",{className:"text-sm font-medium text-slate-700",children:se}),_.jsxs("div",{className:"relative",children:[_.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"$"}),_.jsx("input",{type:"number",min:"0",step:"0.01",value:e[se],onChange:Me=>i(se,parseFloat(Me.target.value)||0),className:"w-20 pl-6 pr-2 py-1 text-sm border border-slate-200 rounded focus:border-primary-500 outline-none"})]})]},se))})]})]}),f==="employees"&&_.jsx(pX,{}),f==="monthly"&&_.jsx(gX,{}),f==="history"&&_.jsx(xX,{})]})},im=({icon:t,iconBg:e,iconColor:r,label:n,value:a,sublabel:i})=>_.jsx(Pt.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},className:"bg-white p-4 rounded-xl shadow-sm border border-slate-100",children:_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:`p-2.5 ${e} ${r} rounded-lg`,children:_.jsx(t,{className:"w-5 h-5"})}),_.jsxs("div",{children:[_.jsx("p",{className:"text-xs text-slate-500 font-medium",children:n}),_.jsx("p",{className:"text-xl font-bold text-slate-800",children:a}),i&&_.jsx("p",{className:"text-xs text-slate-400",children:i})]})]})}),pX=()=>{const[t,e]=xe.useState(()=>wv()),r=xe.useMemo(()=>{const a=new Set;return t.forEach(i=>{Object.keys(i.months).forEach(l=>a.add(l))}),Array.from(a).sort().reverse()},[t]),n=()=>{e(wv())};return t.length===0?_.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-slate-100",children:[_.jsx(jm,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),_.jsx("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"No Employee Data Yet"}),_.jsx("p",{className:"text-slate-400",children:"Process and save some payroll batches to see employee summaries."})]}):_.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[_.jsxs("div",{className:"p-4 border-b border-slate-100 flex justify-between items-center",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-semibold text-slate-800",children:"Employee Monthly Income"}),_.jsx("p",{className:"text-sm text-slate-500",children:"View each referee's earnings by month"})]}),_.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:[_.jsx(Dy,{className:"w-4 h-4"}),"Refresh"]}),_.jsxs("button",{onClick:()=>{const a=t.map(u=>{const f={"Employee Name":u.refereeName,"Employee #":u.employeeNumber};return r.forEach(h=>{f[Wh(h)]=u.months[h]?u.months[h].netPay:0}),f.Total=u.totals.netPay,f}),i=ba.json_to_sheet(a),l=ba.book_new();ba.book_append_sheet(l,i,"Employee Summaries"),Zm(l,"Employee_Yearly_Summary.xlsx")},className:"flex items-center gap-2 px-3 py-1.5 text-sm text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors shadow-sm ml-2",children:[_.jsx(Vm,{className:"w-4 h-4"}),"Export"]})]}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm",children:[_.jsx("thead",{className:"bg-slate-50",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-4 py-3 text-left font-semibold text-slate-600",children:"Employee"}),r.map(a=>_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-600",children:Wh(a)},a)),_.jsx("th",{className:"px-4 py-3 text-right font-semibold text-slate-800 bg-slate-100",children:"Total"})]})}),_.jsx("tbody",{className:"divide-y divide-slate-100",children:t.map(a=>_.jsxs("tr",{className:"hover:bg-slate-50",children:[_.jsx("td",{className:"px-4 py-3",children:_.jsxs("div",{children:[_.jsx("p",{className:"font-medium text-slate-800",children:a.refereeName}),_.jsxs("p",{className:"text-xs text-slate-400",children:["#",a.employeeNumber]})]})}),r.map(i=>_.jsx("td",{className:"px-4 py-3 text-right",children:a.months[i]?_.jsxs("span",{className:"font-medium text-slate-700",children:["$",a.months[i].netPay.toFixed(2)]}):_.jsx("span",{className:"text-slate-300",children:"-"})},i)),_.jsxs("td",{className:"px-4 py-3 text-right font-bold text-green-600 bg-slate-50",children:["$",a.totals.netPay.toFixed(2)]})]},a.employeeNumber))})]})})]})},gX=()=>{const[t,e]=xe.useState(()=>ym()),[r,n]=xe.useState(null),a=l=>{uX(l),e(ym()),n(null)},i=()=>{e(ym())};return t.length===0?_.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-slate-100",children:[_.jsx(Rh,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),_.jsx("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"No Monthly Data Yet"}),_.jsx("p",{className:"text-slate-400",children:"Process and save some payroll batches to see monthly summaries."})]}):_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex justify-end",children:[_.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:[_.jsx(Dy,{className:"w-4 h-4"}),"Refresh"]}),_.jsxs("button",{onClick:()=>{const l=t.map(h=>({Month:h.monthLabel,Batches:h.batches.length,Referees:h.refereeCount,Games:h.totalGames,"Gross Pay":h.totalGross,"Extra Pay":h.totalExtra,"Admin Fees":h.totalAdminFees,"Hacienda Tax":h.totalTax,"Net Payout":h.totalNet})),u=ba.json_to_sheet(l),f=ba.book_new();ba.book_append_sheet(f,u,"Monthly Summaries"),Zm(f,"Monthly_Performance_Summary.xlsx")},className:"flex items-center gap-2 px-3 py-1.5 text-sm text-white bg-green-600 hover:bg-green-700 rounded-lg transition-colors shadow-sm ml-2",children:[_.jsx(Vm,{className:"w-4 h-4"}),"Export"]})]}),t.map(l=>_.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6",children:[_.jsxs("div",{className:"flex justify-between items-start mb-4",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"text-xl font-bold text-slate-800",children:l.monthLabel}),_.jsxs("p",{className:"text-sm text-slate-500",children:[l.batches.length," batch(es)  ",l.refereeCount," referees"]})]}),_.jsxs("div",{className:"flex items-start gap-4",children:[_.jsxs("div",{className:"text-right",children:[_.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["$",l.totalNet.toFixed(2)]}),_.jsx("p",{className:"text-xs text-slate-400",children:"Net Payout"})]}),r===l.month?_.jsxs("div",{className:"flex items-center gap-2 bg-red-50 border border-red-200 rounded-lg p-2",children:[_.jsx(uv,{className:"w-4 h-4 text-red-500"}),_.jsx("span",{className:"text-sm text-red-700",children:"Clear all?"}),_.jsx("button",{onClick:()=>a(l.month),className:"px-2 py-1 bg-red-600 text-white text-xs font-medium rounded hover:bg-red-700",children:"Yes"}),_.jsx("button",{onClick:()=>n(null),className:"px-2 py-1 bg-slate-200 text-slate-700 text-xs font-medium rounded hover:bg-slate-300",children:"No"})]}):_.jsx("button",{onClick:()=>n(l.month),className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Clear this month and start over",children:_.jsx(Np,{className:"w-5 h-5"})})]})]}),_.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[_.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[_.jsx("p",{className:"text-xs text-slate-500",children:"Gross"}),_.jsxs("p",{className:"text-lg font-bold text-slate-800",children:["$",l.totalGross.toFixed(2)]})]}),_.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[_.jsx("p",{className:"text-xs text-slate-500",children:"Extra Pay"}),_.jsxs("p",{className:"text-lg font-bold text-slate-800",children:["$",l.totalExtra.toFixed(2)]})]}),_.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[_.jsx("p",{className:"text-xs text-slate-500",children:"Admin Fees"}),_.jsxs("p",{className:"text-lg font-bold text-red-600",children:["-$",l.totalAdminFees.toFixed(2)]})]}),_.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[_.jsx("p",{className:"text-xs text-slate-500",children:"Hacienda Tax"}),_.jsxs("p",{className:"text-lg font-bold text-amber-600",children:["-$",l.totalTax.toFixed(2)]})]}),_.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[_.jsx("p",{className:"text-xs text-slate-500",children:"Total Games"}),_.jsx("p",{className:"text-lg font-bold text-slate-800",children:l.totalGames})]})]})]},l.month))]})},xX=()=>{const[t,e]=xe.useState(()=>Jn()),[r,n]=xe.useState(null),[a,i]=xe.useState(null),l=f=>{lX(f),e(Jn()),i(null),r===f&&n(null)},u=()=>{e(Jn())};return t.length===0?_.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-slate-100",children:[_.jsx(oh,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),_.jsx("h3",{className:"text-lg font-semibold text-slate-600 mb-2",children:"No History Yet"}),_.jsx("p",{className:"text-slate-400",children:"Saved payroll batches will appear here."})]}):_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsxs("p",{className:"text-sm text-slate-500",children:[t.length," saved batch(es)"]}),_.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-3 py-1.5 text-sm text-slate-600 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-colors",children:[_.jsx(Dy,{className:"w-4 h-4"}),"Refresh"]})]}),t.map(f=>_.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[_.jsxs("div",{className:"p-4 flex justify-between items-center",children:[_.jsxs("div",{onClick:()=>n(r===f.id?null:f.id),className:"flex-1 cursor-pointer",children:[_.jsxs("p",{className:"font-semibold text-slate-800",children:[f.dateRange.start," to ",f.dateRange.end]}),_.jsxs("p",{className:"text-sm text-slate-500",children:[new Date(f.timestamp).toLocaleDateString(),"  ",f.referees.length," referees  ",f.totals.totalGames," games"]})]}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsxs("div",{className:"text-right",children:[_.jsxs("p",{className:"font-bold text-green-600",children:["$",f.totals.netPay.toFixed(2)]}),_.jsx("p",{className:"text-xs text-slate-400",children:"Net Payout"})]}),a===f.id?_.jsxs("div",{className:"flex items-center gap-1",children:[_.jsx("button",{onClick:()=>l(f.id),className:"p-1.5 bg-red-600 text-white text-xs font-medium rounded hover:bg-red-700",children:"Delete"}),_.jsx("button",{onClick:()=>i(null),className:"p-1.5 bg-slate-200 text-slate-700 text-xs font-medium rounded hover:bg-slate-300",children:"Cancel"})]}):_.jsx("button",{onClick:h=>{h.stopPropagation(),i(f.id)},className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Delete this batch",children:_.jsx(Np,{className:"w-4 h-4"})}),_.jsx("button",{onClick:()=>n(r===f.id?null:f.id),className:"p-1 hover:bg-slate-100 rounded",children:r===f.id?_.jsx(ky,{className:"w-5 h-5"}):_.jsx(Lm,{className:"w-5 h-5"})})]})]}),_.jsx(ws,{children:r===f.id&&_.jsx(Pt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100",children:_.jsx("div",{className:"p-4 bg-slate-50",children:_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm",children:[_.jsx("thead",{children:_.jsxs("tr",{className:"text-slate-500",children:[_.jsx("th",{className:"text-left py-2",children:"Referee"}),_.jsx("th",{className:"text-center py-2",children:"Games"}),_.jsx("th",{className:"text-right py-2",children:"Gross"}),_.jsx("th",{className:"text-right py-2",children:"Extra"}),_.jsx("th",{className:"text-right py-2",children:"Admin Fee"}),_.jsx("th",{className:"text-right py-2",children:"Tax"}),_.jsx("th",{className:"text-right py-2",children:"Net"})]})}),_.jsx("tbody",{className:"divide-y divide-slate-200",children:f.referees.map(h=>_.jsxs("tr",{children:[_.jsx("td",{className:"py-2 font-medium",children:h.refereeName}),_.jsx("td",{className:"py-2 text-center",children:h.games}),_.jsxs("td",{className:"py-2 text-right",children:["$",h.grossPay.toFixed(2)]}),_.jsxs("td",{className:"py-2 text-right",children:["$",h.extraPay.toFixed(2)]}),_.jsxs("td",{className:"py-2 text-right text-purple-600",children:["-$",h.adminFee.toFixed(2)]}),_.jsxs("td",{className:"py-2 text-right text-amber-600",children:["-$",h.haciendaTax.toFixed(2)]}),_.jsxs("td",{className:"py-2 text-right font-bold text-green-600",children:["$",h.netPay.toFixed(2)]})]},h.employeeNumber))})]})})})})})]},f.id))]})},vX=({isOpen:t,onClose:e,history:r,selectedId:n,onSelect:a,onDelete:i})=>_.jsx(ws,{children:t&&_.jsxs(_.Fragment,{children:[_.jsx(Pt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e,className:"fixed inset-0 z-40 bg-black/20 backdrop-blur-sm"}),_.jsx(Pt.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-y-0 right-0 z-50 w-full max-w-md bg-white shadow-2xl border-l border-slate-100",children:_.jsxs("div",{className:"flex flex-col h-full",children:[_.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[_.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[_.jsx(Bm,{className:"w-5 h-5 text-primary-500"}),"History"]}),_.jsx("button",{onClick:e,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-full transition-colors",children:_.jsx(Dh,{className:"w-5 h-5"})})]}),_.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.length===0?_.jsxs("div",{className:"text-center py-12",children:[_.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-400",children:_.jsx(Bm,{className:"w-8 h-8"})}),_.jsx("p",{className:"text-slate-500 font-medium",children:"No history yet"}),_.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Processed batches will appear here."})]}):_.jsx("div",{className:"space-y-3",children:r.map(l=>_.jsxs("div",{onClick:()=>{a(l),e()},className:vm("p-4 rounded-2xl cursor-pointer transition-all border relative group",n===l.id?"bg-primary-50 border-primary-200 shadow-sm":"bg-white border-slate-200 hover:border-primary-200 hover:shadow-md"),children:[_.jsxs("div",{className:"flex justify-between items-start mb-2",children:[_.jsxs("span",{className:"text-xs font-medium text-slate-400 flex items-center gap-1",children:[_.jsx(AC,{className:"w-3 h-3"}),new Date(l.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),_.jsx("button",{onClick:u=>i(l.id,u),className:"text-slate-300 hover:text-red-500 transition-colors p-1 opacity-0 group-hover:opacity-100",children:_.jsx(Np,{className:"w-4 h-4"})})]}),_.jsxs("p",{className:"font-semibold text-slate-800 text-sm mb-1",children:[l.dateRange.start," - ",l.dateRange.end]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-slate-100 text-slate-800",children:[l.files.length," file",l.files.length!==1?"s":""]}),_.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:["$",Object.values(l.data.arbitrators).reduce((u,f)=>u+Object.entries(f.categories).reduce((h,[m,x])=>h+x*(l.rates[m]||0),0),0).toLocaleString()]})]})]},l.id))})})]})})]})}),yX=({isOpen:t,matchResults:e,dateProcessed:r,onConfirm:n,onCancel:a})=>{const l=b=>{var k;return b.matchedReferee||((k=b.suggestions[0])==null?void 0:k.referee)||null},[u,f]=xe.useState(new Map);xe.useEffect(()=>{if(e.length>0){const b=new Map;e.forEach(k=>{b.set(k.scheduleName,l(k))}),f(b)}},[e]);const[h,m]=xe.useState(""),[x,v]=xe.useState(null),E=xe.useMemo(()=>Ii(),[t]),w=xe.useMemo(()=>{if(!h.trim())return E;const b=Li(h);return E.filter(k=>Li(k.fullName).includes(b)||k.employeeNumber.toLowerCase().includes(b))},[h,E]),T=e.filter(b=>!b.matchedReferee),A=e.filter(b=>b.matchedReferee&&!b.isFromStorage&&b.confidence<60),I=e.filter(b=>b.matchedReferee&&!b.isFromStorage&&b.confidence>=60),O=e.filter(b=>b.matchedReferee&&b.isFromStorage),D=(b,k)=>{f(F=>new Map(F).set(b,k)),v(null),m("")},q=()=>{const b=new Map;u.forEach((k,F)=>{var j;const P=e.find(Le=>Le.scheduleName===F),M=k||(P?l(P):null);M&&(b.set(F,M),P&&(((j=P.matchedReferee)==null?void 0:j.employeeNumber)===M.employeeNumber?P.isFromStorage||JW(F,M,r):QW(F,M,r)))}),n(b)},Y=A.length,W=e.filter(b=>!u.get(b.scheduleName)).length,N=e.length>0&&u.size===e.length&&Array.from(u.values()).every(b=>b!==null);return t?_.jsx(ws,{children:_.jsx(Pt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:_.jsxs(Pt.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[_.jsxs("div",{className:"p-6 border-b border-slate-200 flex justify-between items-center bg-gradient-to-r from-primary-50 to-white",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Match Referees"}),_.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Confirm or manually select referee matches from the database"})]}),_.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors",children:_.jsx(Dh,{className:"w-5 h-5 text-slate-500"})})]}),_.jsxs("div",{className:"px-6 py-3 bg-slate-50 border-b border-slate-200 flex flex-wrap gap-4 text-sm",children:[_.jsxs("span",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),_.jsxs("span",{className:"text-slate-600",children:["Confident Matches: ",I.length+O.length]})]}),Y>0&&_.jsxs("span",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-500"}),_.jsxs("span",{className:"text-slate-600",children:["Low Confidence: ",Y]})]}),T.length>0&&_.jsxs("span",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500"}),_.jsxs("span",{className:"text-slate-600",children:["Needs Manual Selection: ",T.length]})]})]}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[T.length>0&&_.jsxs("div",{className:"space-y-3",children:[_.jsxs("h3",{className:"text-sm font-semibold text-red-600 flex items-center gap-2",children:[_.jsx(uv,{className:"w-4 h-4"}),"Requires Manual Selection (",T.length,")"]}),_.jsx("p",{className:"text-xs text-red-500 -mt-2",children:"These referees could not be matched. Please select from the database."}),T.map(b=>_.jsx(om,{result:b,selected:u.get(b.scheduleName)||null,isExpanded:x===b.scheduleName,onExpand:()=>v(x===b.scheduleName?null:b.scheduleName),onSelect:k=>D(b.scheduleName,k),searchQuery:h,onSearchChange:m,filteredReferees:w,isLowConfidence:!0},b.scheduleName))]}),A.length>0&&_.jsxs("div",{className:"space-y-3",children:[_.jsxs("h3",{className:"text-sm font-semibold text-amber-600 flex items-center gap-2",children:[_.jsx(uv,{className:"w-4 h-4"}),"Low Confidence - Please Review (",A.length,")"]}),_.jsx("p",{className:"text-xs text-amber-500 -mt-2",children:"These have been auto-matched to the best guess. Click to change if incorrect."}),A.map(b=>_.jsx(om,{result:b,selected:u.get(b.scheduleName)||null,isExpanded:x===b.scheduleName,onExpand:()=>v(x===b.scheduleName?null:b.scheduleName),onSelect:k=>D(b.scheduleName,k),searchQuery:h,onSearchChange:m,filteredReferees:w,isLowConfidence:!0},b.scheduleName))]}),I.length>0&&_.jsxs("div",{className:"space-y-3",children:[_.jsxs("h3",{className:"text-sm font-semibold text-green-600 flex items-center gap-2",children:[_.jsx(lv,{className:"w-4 h-4"}),"Auto-Matched (",I.length,")"]}),I.map(b=>_.jsx(om,{result:b,selected:u.get(b.scheduleName)||null,isExpanded:x===b.scheduleName,onExpand:()=>v(x===b.scheduleName?null:b.scheduleName),onSelect:k=>D(b.scheduleName,k),searchQuery:h,onSearchChange:m,filteredReferees:w,isLowConfidence:!1},b.scheduleName))]}),O.length>0&&_.jsxs("div",{className:"space-y-3",children:[_.jsxs("h3",{className:"text-sm font-semibold text-blue-600 flex items-center gap-2",children:[_.jsx(Fy,{className:"w-4 h-4"}),"Previously Matched (",O.length,")"]}),O.map(b=>_.jsx(om,{result:b,selected:u.get(b.scheduleName)||null,isExpanded:x===b.scheduleName,onExpand:()=>v(x===b.scheduleName?null:b.scheduleName),onSelect:k=>D(b.scheduleName,k),searchQuery:h,onSearchChange:m,filteredReferees:w,isLowConfidence:!1},b.scheduleName))]})]}),_.jsxs("div",{className:"p-6 border-t border-slate-200 bg-slate-50 flex justify-between items-center",children:[_.jsx("div",{className:"text-sm text-slate-500",children:W>0?_.jsxs("span",{className:"text-red-600 font-medium",children:[W," referee",W>1?"s":""," could not be matched - expand to select manually"]}):Y>0?_.jsxs("span",{className:"text-amber-600 font-medium",children:[Y," low-confidence match",Y>1?"es":""," - please review before confirming"]}):_.jsx("span",{className:"text-green-600 font-medium",children:"All referees matched with high confidence "})}),_.jsxs("div",{className:"flex gap-3",children:[_.jsx("button",{onClick:a,className:"px-5 py-2.5 text-slate-600 hover:text-slate-800 font-medium transition-colors",children:"Cancel"}),_.jsxs("button",{onClick:q,disabled:!N,className:`px-6 py-2.5 rounded-xl font-semibold shadow-lg transition-all flex items-center gap-2 ${N?"bg-primary-600 hover:bg-primary-700 text-white shadow-primary-600/20":"bg-slate-200 text-slate-400 cursor-not-allowed shadow-none"}`,children:[_.jsx(lv,{className:"w-4 h-4"}),"Confirm Matches"]})]})]})]})})}):null},om=({result:t,selected:e,isExpanded:r,onExpand:n,onSelect:a,searchQuery:i,onSearchChange:l,filteredReferees:u,isLowConfidence:f})=>_.jsxs("div",{className:`border rounded-xl overflow-hidden transition-all ${f?"border-amber-300 bg-amber-50":"border-slate-200 bg-white"}`,children:[_.jsxs("div",{onClick:n,className:"p-4 flex items-center justify-between cursor-pointer hover:bg-slate-50/50 transition-colors",children:[_.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("p",{className:"font-medium text-slate-800 truncate",children:t.scheduleName}),e?_.jsxs("p",{className:`text-sm truncate ${f?"text-amber-600":"text-green-600"}`,children:[" ",H3(e),t.isFromStorage&&_.jsx("span",{className:"text-blue-500 ml-2",children:"(saved)"}),f&&_.jsx("span",{className:"text-amber-500 ml-2",children:"(review)"})]}):_.jsx("p",{className:"text-sm text-red-600",children:"Error: No referee in database"})]}),t.matchedReferee&&_.jsx("div",{className:"flex items-center gap-2",children:_.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${t.confidence>=80?"bg-green-100 text-green-700":t.confidence>=60?"bg-yellow-100 text-yellow-700":"bg-orange-100 text-orange-700"}`,children:[Math.round(t.confidence),"% match"]})})]}),_.jsx("div",{className:"ml-4",children:r?_.jsx(ky,{className:"w-5 h-5 text-slate-400"}):_.jsx(Lm,{className:"w-5 h-5 text-slate-400"})})]}),_.jsx(ws,{children:r&&_.jsx(Pt.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-200 bg-slate-50",children:_.jsxs("div",{className:"p-4 space-y-3",children:[_.jsxs("div",{className:"relative",children:[_.jsx(cv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),_.jsx("input",{type:"text",placeholder:"Search referees...",value:i,onChange:h=>l(h.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500"})]}),t.suggestions.length>0&&!i&&_.jsxs("div",{className:"space-y-1",children:[_.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase",children:"Suggested Matches"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:t.suggestions.map(({referee:h,confidence:m})=>_.jsxs("button",{onClick:()=>a(h),className:`px-3 py-1.5 text-sm rounded-lg border transition-all ${(e==null?void 0:e.employeeNumber)===h.employeeNumber?"bg-primary-100 border-primary-300 text-primary-700":"bg-white border-slate-200 hover:border-primary-300 hover:bg-primary-50"}`,children:[h.fullName,_.jsxs("span",{className:"text-slate-400 ml-1",children:["(",h.employeeNumber,")"]}),_.jsxs("span",{className:`ml-2 text-xs ${m>=70?"text-green-600":"text-amber-600"}`,children:[Math.round(m),"%"]})]},h.employeeNumber))})]}),_.jsxs("div",{className:"space-y-1",children:[_.jsx("p",{className:"text-xs font-medium text-slate-500 uppercase",children:i?"Search Results":"All Referees"}),_.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 border border-slate-200 rounded-lg bg-white",children:u.length===0?_.jsx("p",{className:"p-4 text-center text-slate-400 text-sm",children:"No referees found"}):u.map(h=>_.jsxs("button",{onClick:()=>a(h),className:`w-full px-4 py-2 text-left text-sm transition-all flex justify-between items-center ${(e==null?void 0:e.employeeNumber)===h.employeeNumber?"bg-primary-100 text-primary-700":"hover:bg-slate-50"}`,children:[_.jsx("span",{children:h.fullName}),_.jsx("span",{className:"text-slate-400",children:h.employeeNumber})]},h.employeeNumber))})]})]})})})]}),_X=()=>{};var Tb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},EX=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const i=t[r++];e[n++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=t[r++],l=t[r++],u=t[r++],f=((a&7)<<18|(i&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const i=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(i&63)<<6|l&63)}}return e.join("")},Q3={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const i=t[a],l=a+1<t.length,u=l?t[a+1]:0,f=a+2<t.length,h=f?t[a+2]:0,m=i>>2,x=(i&3)<<4|u>>4;let v=(u&15)<<2|h>>6,E=h&63;f||(E=64,l||(v=64)),n.push(r[m],r[x],r[v],r[E])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Y3(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):EX(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const i=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const h=a<t.length?r[t.charAt(a)]:64;++a;const x=a<t.length?r[t.charAt(a)]:64;if(++a,i==null||u==null||h==null||x==null)throw new TX;const v=i<<2|u>>4;if(n.push(v),h!==64){const E=u<<4&240|h>>2;if(n.push(E),x!==64){const w=h<<6&192|x;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class TX extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wX=function(t){const e=Y3(t);return Q3.encodeByteArray(e,!0)},rp=function(t){return wX(t).replace(/\./g,"")},J3=function(t){try{return Q3.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SX(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AX=()=>SX().__FIREBASE_DEFAULTS__,bX=()=>{if(typeof process>"u"||typeof Tb>"u")return;const t=Tb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},NX=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&J3(t[1]);return e&&JSON.parse(e)},Lp=()=>{try{return _X()||AX()||bX()||NX()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Z3=t=>{var e,r;return(r=(e=Lp())==null?void 0:e.emulatorHosts)==null?void 0:r[t]},CX=t=>{const e=Z3(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},eR=()=>{var t;return(t=Lp())==null?void 0:t.config},tR=t=>{var e;return(e=Lp())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kX{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function rR(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RX(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[rp(JSON.stringify(r)),rp(JSON.stringify(l)),""].join(".")}const xh={};function DX(){const t={prod:[],emulator:[]};for(const e of Object.keys(xh))xh[e]?t.emulator.push(e):t.prod.push(e);return t}function IX(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let wb=!1;function nR(t,e){if(typeof window>"u"||typeof document>"u"||!ju(window.location.host)||xh[t]===e||xh[t]||wb)return;xh[t]=e;function r(v){return`__firebase__banner__${v}`}const n="__firebase__banner",i=DX().prod.length>0;function l(){const v=document.getElementById(n);v&&v.remove()}function u(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function f(v,E){v.setAttribute("width","24"),v.setAttribute("id",E),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function h(){const v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{wb=!0,l()},v}function m(v,E){v.setAttribute("id",E),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function x(){const v=IX(n),E=r("text"),w=document.getElementById(E)||document.createElement("span"),T=r("learnmore"),A=document.getElementById(T)||document.createElement("a"),I=r("preprendIcon"),O=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){const D=v.element;u(D),m(A,T);const q=h();f(O,I),D.append(O,w,A,q),document.body.appendChild(D)}i?(w.innerText="Preview backend disconnected.",O.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(O.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function FX(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(zn())}function OX(){var e;const t=(e=Lp())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function MX(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PX(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function LX(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function VX(){const t=zn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function BX(){return!OX()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jX(){try{return typeof indexedDB=="object"}catch{return!1}}function UX(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var i;e(((i=a.error)==null?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zX="FirebaseError";class qi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=zX,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,x0.prototype.create)}}class x0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,i=this.errors[e],l=i?HX(i,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new qi(a,u,n)}}function HX(t,e){return t.replace(GX,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const GX=/\{\$([^}]+)}/g;function qX(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ql(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const i=t[a],l=e[a];if(Sb(i)&&Sb(l)){if(!Ql(i,l))return!1}else if(i!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Sb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function WX(t,e){const r=new XX(t,e);return r.subscribe.bind(r)}class XX{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");$X(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=Nx),a.error===void 0&&(a.error=Nx),a.complete===void 0&&(a.complete=Nx);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function $X(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Nx(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t){return t&&t._delegate?t._delegate:t}class Jl{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KX{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new kX;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(QX(e))try{this.getOrInitializeService({instanceIdentifier:Rl})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:a});n.resolve(i)}catch{}}}}clearInstance(e=Rl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rl){return this.instances.has(e)}getOptions(e=Rl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);n===u&&l.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const i=this.instances.get(n);return i&&e(i,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:YX(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Rl){return this.component?this.component.multipleInstances?e:Rl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YX(t){return t===Rl?void 0:t}function QX(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JX{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new KX(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Dt||(Dt={}));const ZX={debug:Dt.DEBUG,verbose:Dt.VERBOSE,info:Dt.INFO,warn:Dt.WARN,error:Dt.ERROR,silent:Dt.SILENT},e$=Dt.INFO,t$={[Dt.DEBUG]:"log",[Dt.VERBOSE]:"log",[Dt.INFO]:"info",[Dt.WARN]:"warn",[Dt.ERROR]:"error"},r$=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=t$[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class A_{constructor(e){this.name=e,this._logLevel=e$,this._logHandler=r$,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ZX[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dt.DEBUG,...e),this._logHandler(this,Dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dt.VERBOSE,...e),this._logHandler(this,Dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dt.INFO,...e),this._logHandler(this,Dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dt.WARN,...e),this._logHandler(this,Dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dt.ERROR,...e),this._logHandler(this,Dt.ERROR,...e)}}const n$=(t,e)=>e.some(r=>t instanceof r);let Ab,bb;function a$(){return Ab||(Ab=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s$(){return bb||(bb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aR=new WeakMap,Sv=new WeakMap,sR=new WeakMap,Cx=new WeakMap,b_=new WeakMap;function i$(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",i),t.removeEventListener("error",l)},i=()=>{r(Oo(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",i),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&aR.set(r,t)}).catch(()=>{}),b_.set(e,t),e}function o$(t){if(Sv.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",l),t.removeEventListener("abort",l)},i=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",i),t.addEventListener("error",l),t.addEventListener("abort",l)});Sv.set(t,e)}let Av={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Sv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||sR.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Oo(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function l$(t){Av=t(Av)}function c$(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(kx(this),e,...r);return sR.set(n,e.sort?e.sort():[e]),Oo(n)}:s$().includes(t)?function(...e){return t.apply(kx(this),e),Oo(aR.get(this))}:function(...e){return Oo(t.apply(kx(this),e))}}function u$(t){return typeof t=="function"?c$(t):(t instanceof IDBTransaction&&o$(t),n$(t,a$())?new Proxy(t,Av):t)}function Oo(t){if(t instanceof IDBRequest)return i$(t);if(Cx.has(t))return Cx.get(t);const e=u$(t);return e!==t&&(Cx.set(t,e),b_.set(e,t)),e}const kx=t=>b_.get(t);function f$(t,e,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const l=indexedDB.open(t,e),u=Oo(l);return n&&l.addEventListener("upgradeneeded",f=>{n(Oo(l.result),f.oldVersion,f.newVersion,Oo(l.transaction),f)}),r&&l.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),u.then(f=>{i&&f.addEventListener("close",()=>i()),a&&f.addEventListener("versionchange",h=>a(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const h$=["get","getKey","getAll","getAllKeys","count"],d$=["put","add","delete","clear"],Rx=new Map;function Nb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Rx.get(e))return Rx.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=d$.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||h$.includes(r)))return;const i=async function(l,...u){const f=this.transaction(l,a?"readwrite":"readonly");let h=f.store;return n&&(h=h.index(u.shift())),(await Promise.all([h[r](...u),a&&f.done]))[0]};return Rx.set(e,i),i}l$(t=>({...t,get:(e,r,n)=>Nb(e,r)||t.get(e,r,n),has:(e,r)=>!!Nb(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m${constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(p$(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function p$(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const bv="@firebase/app",Cb="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi=new A_("@firebase/app"),g$="@firebase/app-compat",x$="@firebase/analytics-compat",v$="@firebase/analytics",y$="@firebase/app-check-compat",_$="@firebase/app-check",E$="@firebase/auth",T$="@firebase/auth-compat",w$="@firebase/database",S$="@firebase/data-connect",A$="@firebase/database-compat",b$="@firebase/functions",N$="@firebase/functions-compat",C$="@firebase/installations",k$="@firebase/installations-compat",R$="@firebase/messaging",D$="@firebase/messaging-compat",I$="@firebase/performance",F$="@firebase/performance-compat",O$="@firebase/remote-config",M$="@firebase/remote-config-compat",P$="@firebase/storage",L$="@firebase/storage-compat",V$="@firebase/firestore",B$="@firebase/ai",j$="@firebase/firestore-compat",U$="firebase",z$="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv="[DEFAULT]",H$={[bv]:"fire-core",[g$]:"fire-core-compat",[v$]:"fire-analytics",[x$]:"fire-analytics-compat",[_$]:"fire-app-check",[y$]:"fire-app-check-compat",[E$]:"fire-auth",[T$]:"fire-auth-compat",[w$]:"fire-rtdb",[S$]:"fire-data-connect",[A$]:"fire-rtdb-compat",[b$]:"fire-fn",[N$]:"fire-fn-compat",[C$]:"fire-iid",[k$]:"fire-iid-compat",[R$]:"fire-fcm",[D$]:"fire-fcm-compat",[I$]:"fire-perf",[F$]:"fire-perf-compat",[O$]:"fire-rc",[M$]:"fire-rc-compat",[P$]:"fire-gcs",[L$]:"fire-gcs-compat",[V$]:"fire-fst",[j$]:"fire-fst-compat",[B$]:"fire-vertex","fire-js":"fire-js",[U$]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np=new Map,G$=new Map,Cv=new Map;function kb(t,e){try{t.container.addComponent(e)}catch(r){Vi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Au(t){const e=t.name;if(Cv.has(e))return Vi.debug(`There were multiple attempts to register component ${e}.`),!1;Cv.set(e,t);for(const r of np.values())kb(r,t);for(const r of G$.values())kb(r,t);return!0}function N_(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function vs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mo=new x0("app","Firebase",q$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W${constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=z$;function iR(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Nv,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Mo.create("bad-app-name",{appName:String(a)});if(r||(r=eR()),!r)throw Mo.create("no-options");const i=np.get(a);if(i){if(Ql(r,i.options)&&Ql(n,i.config))return i;throw Mo.create("duplicate-app",{appName:a})}const l=new JX(a);for(const f of Cv.values())l.addComponent(f);const u=new W$(r,n,l);return np.set(a,u),u}function oR(t=Nv){const e=np.get(t);if(!e&&t===Nv&&eR())return iR();if(!e)throw Mo.create("no-app",{appName:t});return e}function Po(t,e,r){let n=H$[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const l=[`Unable to register library "${n}" with version "${e}":`];a&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&i&&l.push("and"),i&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vi.warn(l.join(" "));return}Au(new Jl(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X$="firebase-heartbeat-database",$$=1,Xh="firebase-heartbeat-store";let Dx=null;function lR(){return Dx||(Dx=f$(X$,$$,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xh)}catch(r){console.warn(r)}}}}).catch(t=>{throw Mo.create("idb-open",{originalErrorMessage:t.message})})),Dx}async function K$(t){try{const r=(await lR()).transaction(Xh),n=await r.objectStore(Xh).get(cR(t));return await r.done,n}catch(e){if(e instanceof qi)Vi.warn(e.message);else{const r=Mo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vi.warn(r.message)}}}async function Rb(t,e){try{const n=(await lR()).transaction(Xh,"readwrite");await n.objectStore(Xh).put(e,cR(t)),await n.done}catch(r){if(r instanceof qi)Vi.warn(r.message);else{const n=Mo.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Vi.warn(n.message)}}}function cR(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y$=1024,Q$=30;class J${constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new eK(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Db();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)==null?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:a}),this._heartbeatsCache.heartbeats.length>Q$){const l=tK(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Vi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Db(),{heartbeatsToSend:n,unsentEntries:a}=Z$(this._heartbeatsCache.heartbeats),i=rp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Vi.warn(r),""}}}function Db(){return new Date().toISOString().substring(0,10)}function Z$(t,e=Y$){const r=[];let n=t.slice();for(const a of t){const i=r.find(l=>l.agent===a.agent);if(i){if(i.dates.push(a.date),Ib(r)>e){i.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Ib(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class eK{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jX()?UX().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await K$(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Rb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Rb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Ib(t){return rp(JSON.stringify({version:2,heartbeats:t})).length}function tK(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rK(t){Au(new Jl("platform-logger",e=>new m$(e),"PRIVATE")),Au(new Jl("heartbeat",e=>new J$(e),"PRIVATE")),Po(bv,Cb,t),Po(bv,Cb,"esm2020"),Po("fire-js","")}rK("");function uR(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nK=uR,fR=new x0("auth","Firebase",uR());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap=new A_("@firebase/auth");function aK(t,...e){ap.logLevel<=Dt.WARN&&ap.warn(`Auth (${Uu}): ${t}`,...e)}function _m(t,...e){ap.logLevel<=Dt.ERROR&&ap.error(`Auth (${Uu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(t,...e){throw k_(t,...e)}function bs(t,...e){return k_(t,...e)}function C_(t,e,r){const n={...nK(),[e]:r};return new x0("auth","Firebase",n).create(e,{appName:t.name})}function Hl(t){return C_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sK(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Ys(t,"argument-error"),C_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function k_(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return fR.create(t,...e)}function mt(t,e,...r){if(!t)throw k_(e,...r)}function Ni(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _m(e),new Error(e)}function Bi(t,e){t||Ni(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kv(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function iK(){return Fb()==="http:"||Fb()==="https:"}function Fb(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oK(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(iK()||PX()||"connection"in navigator)?navigator.onLine:!0}function lK(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Bi(r>e,"Short delay should be less than long delay!"),this.isMobile=FX()||LX()}get(){return oK()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(t,e){Bi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cK={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uK=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],fK=new y0(3e4,6e4);function D_(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function zu(t,e,r,n,a={}){return dR(t,a,async()=>{let i={},l={};n&&(e==="GET"?l=n:i={body:JSON.stringify(n)});const u=v0({key:t.config.apiKey,...l}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:f,...i};return MX()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&ju(t.emulatorConfig.host)&&(h.credentials="include"),hR.fetch()(await mR(t,t.config.apiHost,r,u),h)})}async function dR(t,e,r){t._canInitEmulator=!1;const n={...cK,...e};try{const a=new dK(t),i=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const l=await i.json();if("needConfirmation"in l)throw lm(t,"account-exists-with-different-credential",l);if(i.ok&&!("errorMessage"in l))return l;{const u=i.ok?l.errorMessage:l.error.message,[f,h]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw lm(t,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw lm(t,"email-already-in-use",l);if(f==="USER_DISABLED")throw lm(t,"user-disabled",l);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw C_(t,m,h);Ys(t,m)}}catch(a){if(a instanceof qi)throw a;Ys(t,"network-request-failed",{message:String(a)})}}async function hK(t,e,r,n,a={}){const i=await zu(t,e,r,n,a);return"mfaPendingCredential"in i&&Ys(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function mR(t,e,r,n){const a=`${e}${r}?${n}`,i=t,l=i.config.emulator?R_(t.config,a):`${t.config.apiScheme}://${a}`;return uK.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(l).toString():l}class dK{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(bs(this.auth,"network-request-failed")),fK.get())})}}function lm(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=bs(t,e,n);return a.customData._tokenResponse=r,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mK(t,e){return zu(t,"POST","/v1/accounts:delete",e)}async function sp(t,e){return zu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pK(t,e=!1){const r=rs(t),n=await r.getIdToken(e),a=I_(n);mt(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const i=typeof a.firebase=="object"?a.firebase:void 0,l=i==null?void 0:i.sign_in_provider;return{claims:a,token:n,authTime:vh(Ix(a.auth_time)),issuedAtTime:vh(Ix(a.iat)),expirationTime:vh(Ix(a.exp)),signInProvider:l||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ix(t){return Number(t)*1e3}function I_(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return _m("JWT malformed, contained fewer than 3 sections"),null;try{const a=J3(r);return a?JSON.parse(a):(_m("Failed to decode base64 JWT payload"),null)}catch(a){return _m("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Ob(t){const e=I_(t);return mt(e,"internal-error"),mt(typeof e.exp<"u","internal-error"),mt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $h(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof qi&&gK(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function gK({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xK{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=vh(this.lastLoginAt),this.creationTime=vh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ip(t){var x;const e=t.auth,r=await t.getIdToken(),n=await $h(t,sp(e,{idToken:r}));mt(n==null?void 0:n.users.length,e,"internal-error");const a=n.users[0];t._notifyReloadListener(a);const i=(x=a.providerUserInfo)!=null&&x.length?pR(a.providerUserInfo):[],l=yK(t.providerData,i),u=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!(l!=null&&l.length),h=u?f:!1,m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Rv(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(t,m)}async function vK(t){const e=rs(t);await ip(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yK(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function pR(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _K(t,e){const r=await dR(t,{},async()=>{const n=v0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:i}=t.config,l=await mR(t,a,"/v1/token",`key=${i}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return t.emulatorConfig&&ju(t.emulatorConfig.host)&&(f.credentials="include"),hR.fetch()(l,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function EK(t,e){return zu(t,"POST","/v2/accounts:revokeToken",D_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){mt(e.idToken,"internal-error"),mt(typeof e.idToken<"u","internal-error"),mt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ob(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){mt(e.length!==0,"internal-error");const r=Ob(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(mt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:i}=await _K(e,r);this.updateTokensAndExpiration(n,a,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:i}=r,l=new gu;return n&&(mt(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),a&&(mt(typeof a=="string","internal-error",{appName:e}),l.accessToken=a),i&&(mt(typeof i=="number","internal-error",{appName:e}),l.expirationTime=i),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gu,this.toJSON())}_performRefresh(){return Ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(t,e){mt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Es{constructor({uid:e,auth:r,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new xK(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Rv(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await $h(this,this.stsTokenManager.getToken(this.auth,e));return mt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return pK(this,e)}reload(){return vK(this)}_assign(e){this!==e&&(mt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Es({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){mt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await ip(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vs(this.auth.app))return Promise.reject(Hl(this.auth));const e=await this.getIdToken();return await $h(this,mK(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,a=r.email??void 0,i=r.phoneNumber??void 0,l=r.photoURL??void 0,u=r.tenantId??void 0,f=r._redirectEventId??void 0,h=r.createdAt??void 0,m=r.lastLoginAt??void 0,{uid:x,emailVerified:v,isAnonymous:E,providerData:w,stsTokenManager:T}=r;mt(x&&T,e,"internal-error");const A=gu.fromJSON(this.name,T);mt(typeof x=="string",e,"internal-error"),bo(n,e.name),bo(a,e.name),mt(typeof v=="boolean",e,"internal-error"),mt(typeof E=="boolean",e,"internal-error"),bo(i,e.name),bo(l,e.name),bo(u,e.name),bo(f,e.name),bo(h,e.name),bo(m,e.name);const I=new Es({uid:x,auth:e,email:a,emailVerified:v,displayName:n,isAnonymous:E,photoURL:l,phoneNumber:i,tenantId:u,stsTokenManager:A,createdAt:h,lastLoginAt:m});return w&&Array.isArray(w)&&(I.providerData=w.map(O=>({...O}))),f&&(I._redirectEventId=f),I}static async _fromIdTokenResponse(e,r,n=!1){const a=new gu;a.updateFromServerResponse(r);const i=new Es({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await ip(i),i}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];mt(a.localId!==void 0,"internal-error");const i=a.providerUserInfo!==void 0?pR(a.providerUserInfo):[],l=!(a.email&&a.passwordHash)&&!(i!=null&&i.length),u=new gu;u.updateFromIdToken(n);const f=new Es({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:l}),h={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new Rv(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(i!=null&&i.length)};return Object.assign(f,h),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mb=new Map;function Ci(t){Bi(t instanceof Function,"Expected a class definition");let e=Mb.get(t);return e?(Bi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Mb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}gR.type="NONE";const Pb=gR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Em(t,e,r){return`firebase:${t}:${e}:${r}`}class xu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:i}=this.auth;this.fullUserKey=Em(this.userKey,a.apiKey,i),this.fullPersistenceKey=Em("persistence",a.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await sp(this.auth,{idToken:e}).catch(()=>{});return r?Es._fromGetAccountInfoResponse(this.auth,r,e):null}return Es._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new xu(Ci(Pb),e,n);const a=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=a[0]||Ci(Pb);const l=Em(n,e.config.apiKey,e.name);let u=null;for(const h of r)try{const m=await h._get(l);if(m){let x;if(typeof m=="string"){const v=await sp(e,{idToken:m}).catch(()=>{});if(!v)break;x=await Es._fromGetAccountInfoResponse(e,v,m)}else x=Es._fromJSON(e,m);h!==i&&(u=x),i=h;break}}catch{}const f=a.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!f.length?new xu(i,e,n):(i=f[0],u&&await i._set(l,u.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(l)}catch{}})),new xu(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_R(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(TR(e))return"Blackberry";if(wR(e))return"Webos";if(vR(e))return"Safari";if((e.includes("chrome/")||yR(e))&&!e.includes("edge/"))return"Chrome";if(ER(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function xR(t=zn()){return/firefox\//i.test(t)}function vR(t=zn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yR(t=zn()){return/crios\//i.test(t)}function _R(t=zn()){return/iemobile/i.test(t)}function ER(t=zn()){return/android/i.test(t)}function TR(t=zn()){return/blackberry/i.test(t)}function wR(t=zn()){return/webos/i.test(t)}function F_(t=zn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function TK(t=zn()){var e;return F_(t)&&!!((e=window.navigator)!=null&&e.standalone)}function wK(){return VX()&&document.documentMode===10}function SR(t=zn()){return F_(t)||ER(t)||wR(t)||TR(t)||/windows phone/i.test(t)||_R(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AR(t,e=[]){let r;switch(t){case"Browser":r=Lb(zn());break;case"Worker":r=`${Lb(zn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Uu}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SK{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((l,u)=>{try{const f=e(i);l(f)}catch(f){u(f)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AK(t,e={}){return zu(t,"GET","/v2/passwordPolicy",D_(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bK=6;class NK{constructor(e){var n;const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??bK,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CK{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Vb(this),this.idTokenSubscription=new Vb(this),this.beforeStateQueue=new SK(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ci(r)),this._initializationPromise=this.queue(async()=>{var n,a,i;if(!this._deleted&&(this.persistenceManager=await xu.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await sp(this,{idToken:e}),n=await Es._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(vs(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(i=this.redirectUser)==null?void 0:i._redirectEventId,u=n==null?void 0:n._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===u)&&(f!=null&&f.user)&&(n=f.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(l){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return mt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await ip(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=lK()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vs(this.app))return Promise.reject(Hl(this));const r=e?rs(e):null;return r&&mt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&mt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vs(this.app)?Promise.reject(Hl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vs(this.app)?Promise.reject(Hl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ci(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await AK(this),r=new NK(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new x0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await EK(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ci(e)||this._popupRedirectResolver;mt(r,this,"argument-error"),this.redirectPersistenceManager=await xu.create(this,[Ci(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)==null?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((r=this.currentUser)==null?void 0:r.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let l=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(mt(u,this,"internal-error"),u.then(()=>{l||i(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,a);return()=>{l=!0,f()}}else{const f=e.addObserver(r);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return mt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=AR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var r;if(vs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((r=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getToken());return e!=null&&e.error&&aK(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Vp(t){return rs(t)}class Vb{constructor(e){this.auth=e,this.observer=null,this.addObserver=WX(r=>this.observer=r)}get next(){return mt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O_={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kK(t){O_=t}function RK(t){return O_.loadJS(t)}function DK(){return O_.gapiScript}function IK(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FK(t,e){const r=N_(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),i=r.getOptions();if(Ql(i,e??{}))return a;Ys(a,"already-initialized")}return r.initialize({options:e})}function OK(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ci);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function MK(t,e,r){const n=Vp(t);mt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,i=bR(e),{host:l,port:u}=PK(e),f=u===null?"":`:${u}`,h={url:`${i}//${l}${f}/`},m=Object.freeze({host:l,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){mt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),mt(Ql(h,n.config.emulator)&&Ql(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,ju(l)?(rR(`${i}//${l}${f}`),nR("Auth",!0)):LK()}function bR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function PK(t){const e=bR(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const i=a[1];return{host:i,port:Bb(n.substr(i.length+1))}}else{const[i,l]=n.split(":");return{host:i,port:Bb(l)}}}function Bb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function LK(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ni("not implemented")}_getIdTokenResponse(e){return Ni("not implemented")}_linkToIdToken(e,r){return Ni("not implemented")}_getReauthenticationResolver(e){return Ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vu(t,e){return hK(t,"POST","/v1/accounts:signInWithIdp",D_(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VK="http://localhost";class Zl extends NR{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Zl(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ys("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...i}=r;if(!n||!a)return null;const l=new Zl(n,a);return l.idToken=i.idToken||void 0,l.accessToken=i.accessToken||void 0,l.secret=i.secret,l.nonce=i.nonce,l.pendingToken=i.pendingToken||null,l}_getIdTokenResponse(e){const r=this.buildRequest();return vu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,vu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,vu(e,r)}buildRequest(){const e={requestUri:VK,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=v0(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0 extends M_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co extends _0{constructor(){super("facebook.com")}static credential(e){return Zl._fromParams({providerId:Co.PROVIDER_ID,signInMethod:Co.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Co.credentialFromTaggedObject(e)}static credentialFromError(e){return Co.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Co.credential(e.oauthAccessToken)}catch{return null}}}Co.FACEBOOK_SIGN_IN_METHOD="facebook.com";Co.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai extends _0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Zl._fromParams({providerId:Ai.PROVIDER_ID,signInMethod:Ai.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Ai.credentialFromTaggedObject(e)}static credentialFromError(e){return Ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Ai.credential(r,n)}catch{return null}}}Ai.GOOGLE_SIGN_IN_METHOD="google.com";Ai.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko extends _0{constructor(){super("github.com")}static credential(e){return Zl._fromParams({providerId:ko.PROVIDER_ID,signInMethod:ko.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ko.credentialFromTaggedObject(e)}static credentialFromError(e){return ko.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ko.credential(e.oauthAccessToken)}catch{return null}}}ko.GITHUB_SIGN_IN_METHOD="github.com";ko.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro extends _0{constructor(){super("twitter.com")}static credential(e,r){return Zl._fromParams({providerId:Ro.PROVIDER_ID,signInMethod:Ro.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ro.credentialFromTaggedObject(e)}static credentialFromError(e){return Ro.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ro.credential(r,n)}catch{return null}}}Ro.TWITTER_SIGN_IN_METHOD="twitter.com";Ro.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const i=await Es._fromIdTokenResponse(e,n,a),l=jb(n);return new bu({user:i,providerId:l,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=jb(n);return new bu({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function jb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op extends qi{constructor(e,r,n,a){super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,op.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new op(e,r,n,a)}}function CR(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?op._fromErrorAndOperation(t,i,e,n):i})}async function BK(t,e,r=!1){const n=await $h(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return bu._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jK(t,e,r=!1){const{auth:n}=t;if(vs(n.app))return Promise.reject(Hl(n));const a="reauthenticate";try{const i=await $h(t,CR(n,a,e,t),r);mt(i.idToken,n,"internal-error");const l=I_(i.idToken);mt(l,n,"internal-error");const{sub:u}=l;return mt(t.uid===u,n,"user-mismatch"),bu._forOperation(t,a,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ys(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UK(t,e,r=!1){if(vs(t.app))return Promise.reject(Hl(t));const n="signIn",a=await CR(t,n,e),i=await bu._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(i.user),i}function zK(t,e,r,n){return rs(t).onIdTokenChanged(e,r,n)}function HK(t,e,r){return rs(t).beforeAuthStateChanged(e,r)}function GK(t,e,r,n){return rs(t).onAuthStateChanged(e,r,n)}function qK(t){return rs(t).signOut()}const lp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(lp,"1"),this.storage.removeItem(lp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WK=1e3,XK=10;class RR extends kR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=SR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((l,u,f)=>{this.notifyListeners(l,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const l=this.storage.getItem(n);!r&&this.localCache[n]===l||this.notifyListeners(n,l)},i=this.storage.getItem(n);wK()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,XK):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},WK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}RR.type="LOCAL";const $K=RR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR extends kR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}DR.type="SESSION";const IR=DR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KK(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new Bp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:i}=r.data,l=this.handlersMap[a];if(!(l!=null&&l.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(l).map(async h=>h(r.origin,i)),f=await KK(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Bp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YK{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,l;return new Promise((u,f)=>{const h=P_("",20);a.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);l={messageChannel:a,onMessage(x){const v=x;if(v.data.eventId===h)switch(v.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(v.data.response);break;default:clearTimeout(m),clearTimeout(i),f(new Error("invalid_response"));break}}},this.handlers.add(l),a.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[a.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(){return window}function QK(t){qs().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(){return typeof qs().WorkerGlobalScope<"u"&&typeof qs().importScripts=="function"}async function JK(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ZK(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function eY(){return FR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="firebaseLocalStorageDb",tY=1,cp="firebaseLocalStorage",MR="fbase_key";class E0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function jp(t,e){return t.transaction([cp],e?"readwrite":"readonly").objectStore(cp)}function rY(){const t=indexedDB.deleteDatabase(OR);return new E0(t).toPromise()}function Dv(){const t=indexedDB.open(OR,tY);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(cp,{keyPath:MR})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(cp)?e(n):(n.close(),await rY(),e(await Dv()))})})}async function Ub(t,e,r){const n=jp(t,!0).put({[MR]:e,value:r});return new E0(n).toPromise()}async function nY(t,e){const r=jp(t,!1).get(e),n=await new E0(r).toPromise();return n===void 0?null:n.value}function zb(t,e){const r=jp(t,!0).delete(e);return new E0(r).toPromise()}const aY=800,sY=3;class PR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dv(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>sY)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return FR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Bp._getInstance(eY()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var r,n;if(this.activeServiceWorker=await JK(),!this.activeServiceWorker)return;this.sender=new YK(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(r=e[0])!=null&&r.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ZK()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dv();return await Ub(e,lp,"1"),await zb(e,lp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ub(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>nY(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>zb(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const i=jp(a,!1).getAll();return new E0(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:i}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),aY)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}PR.type="LOCAL";const iY=PR;new y0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(t,e){return e?Ci(e):(mt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_ extends NR{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return vu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return vu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function oY(t){return UK(t.auth,new L_(t),t.bypassAuthState)}function lY(t){const{auth:e,user:r}=t;return mt(r,e,"internal-error"),jK(r,new L_(t),t.bypassAuthState)}async function cY(t){const{auth:e,user:r}=t;return mt(r,e,"internal-error"),BK(r,new L_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,r,n,a,i=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:i,error:l,type:u}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return oY;case"linkViaPopup":case"linkViaRedirect":return cY;case"reauthViaPopup":case"reauthViaRedirect":return lY;default:Ys(this.auth,"internal-error")}}resolve(e){Bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uY=new y0(2e3,1e4);async function fY(t,e,r){if(vs(t.app))return Promise.reject(bs(t,"operation-not-supported-in-this-environment"));const n=Vp(t);sK(t,e,M_);const a=LR(n,r);return new Ml(n,"signInViaPopup",e,a).executeNotNull()}class Ml extends VR{constructor(e,r,n,a,i){super(e,r,a,i),this.provider=n,this.authWindow=null,this.pollId=null,Ml.currentPopupAction&&Ml.currentPopupAction.cancel(),Ml.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return mt(e,this.auth,"internal-error"),e}async onExecution(){Bi(this.filter.length===1,"Popup operations only handle one event");const e=P_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(bs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(bs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ml.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if((n=(r=this.authWindow)==null?void 0:r.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(bs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,uY.get())};e()}}Ml.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hY="pendingRedirect",Tm=new Map;class dY extends VR{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Tm.get(this.auth._key());if(!e){try{const n=await mY(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Tm.set(this.auth._key(),e)}return this.bypassAuthState||Tm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mY(t,e){const r=xY(e),n=gY(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function pY(t,e){Tm.set(t._key(),e)}function gY(t){return Ci(t._redirectPersistence)}function xY(t){return Em(hY,t.config.apiKey,t.name)}async function vY(t,e,r=!1){if(vs(t.app))return Promise.reject(Hl(t));const n=Vp(t),a=LR(n,e),l=await new dY(n,a,r).execute();return l&&!r&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yY=600*1e3;class _Y{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!EY(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!BR(e)){const a=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";r.onError(bs(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=yY&&this.cachedEventUids.clear(),this.cachedEventUids.has(Hb(e))}saveEventToCache(e){this.cachedEventUids.add(Hb(e)),this.lastProcessedEventTime=Date.now()}}function Hb(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function BR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function EY(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return BR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TY(t,e={}){return zu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wY=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,SY=/^https?/;async function AY(t){if(t.config.emulator)return;const{authorizedDomains:e}=await TY(t);for(const r of e)try{if(bY(r))return}catch{}Ys(t,"unauthorized-domain")}function bY(t){const e=kv(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&l.hostname===n}if(!SY.test(r))return!1;if(wY.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NY=new y0(3e4,6e4);function Gb(){const t=qs().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function CY(t){return new Promise((e,r)=>{var a,i,l;function n(){Gb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Gb(),r(bs(t,"network-request-failed"))},timeout:NY.get()})}if((i=(a=qs().gapi)==null?void 0:a.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((l=qs().gapi)!=null&&l.load)n();else{const u=IK("iframefcb");return qs()[u]=()=>{gapi.load?n():r(bs(t,"network-request-failed"))},RK(`${DK()}?onload=${u}`).catch(f=>r(f))}}).catch(e=>{throw wm=null,e})}let wm=null;function kY(t){return wm=wm||CY(t),wm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RY=new y0(5e3,15e3),DY="__/auth/iframe",IY="emulator/auth/iframe",FY={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OY=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MY(t){const e=t.config;mt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?R_(e,IY):`https://${t.config.authDomain}/${DY}`,n={apiKey:e.apiKey,appName:t.name,v:Uu},a=OY.get(t.config.apiHost);a&&(n.eid=a);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${v0(n).slice(1)}`}async function PY(t){const e=await kY(t),r=qs().gapi;return mt(r,t,"internal-error"),e.open({where:document.body,url:MY(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:FY,dontclear:!0},n=>new Promise(async(a,i)=>{await n.restyle({setHideOnLeave:!1});const l=bs(t,"network-request-failed"),u=qs().setTimeout(()=>{i(l)},RY.get());function f(){qs().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{i(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LY={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VY=500,BY=600,jY="_blank",UY="http://localhost";class qb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function zY(t,e,r,n=VY,a=BY){const i=Math.max((window.screen.availHeight-a)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...LY,width:n.toString(),height:a.toString(),top:i,left:l},h=zn().toLowerCase();r&&(u=yR(h)?jY:r),xR(h)&&(e=e||UY,f.scrollbars="yes");const m=Object.entries(f).reduce((v,[E,w])=>`${v}${E}=${w},`,"");if(TK(h)&&u!=="_self")return HY(e||"",u),new qb(null);const x=window.open(e||"",u,m);mt(x,t,"popup-blocked");try{x.focus()}catch{}return new qb(x)}function HY(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GY="__/auth/handler",qY="emulator/auth/handler",WY=encodeURIComponent("fac");async function Wb(t,e,r,n,a,i){mt(t.config.authDomain,t,"auth-domain-config-required"),mt(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Uu,eventId:a};if(e instanceof M_){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",qX(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,x]of Object.entries({}))l[m]=x}if(e instanceof _0){const m=e.getScopes().filter(x=>x!=="");m.length>0&&(l.scopes=m.join(","))}t.tenantId&&(l.tid=t.tenantId);const u=l;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const f=await t._getAppCheckToken(),h=f?`#${WY}=${encodeURIComponent(f)}`:"";return`${XY(t)}?${v0(u).slice(1)}${h}`}function XY({config:t}){return t.emulator?R_(t,qY):`https://${t.authDomain}/${GY}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="webStorageSupport";class $Y{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=IR,this._completeRedirectFn=vY,this._overrideRedirectResult=pY}async _openPopup(e,r,n,a){var l;Bi((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const i=await Wb(e,r,n,kv(),a);return zY(e,i,P_())}async _openRedirect(e,r,n,a){await this._originValidation(e);const i=await Wb(e,r,n,kv(),a);return QK(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:i}=this.eventManagers[r];return a?Promise.resolve(a):(Bi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await PY(e),n=new _Y(e);return r.register("authEvent",a=>(mt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Fx,{type:Fx},a=>{var l;const i=(l=a==null?void 0:a[0])==null?void 0:l[Fx];i!==void 0&&r(!!i),Ys(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=AY(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return SR()||vR()||F_()}}const KY=$Y;var Xb="@firebase/auth",$b="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YY{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){mt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QY(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JY(t){Au(new Jl("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:l,authDomain:u}=n.options;mt(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:l,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:AR(t)},h=new CK(n,a,i,f);return OK(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Au(new Jl("auth-internal",e=>{const r=Vp(e.getProvider("auth").getImmediate());return(n=>new YY(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Po(Xb,$b,QY(t)),Po(Xb,$b,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZY=300,eQ=tR("authIdTokenMaxAge")||ZY;let Kb=null;const tQ=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>eQ)return;const a=r==null?void 0:r.token;Kb!==a&&(Kb=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function rQ(t=oR()){const e=N_(t,"auth");if(e.isInitialized())return e.getImmediate();const r=FK(t,{popupRedirectResolver:KY,persistence:[iY,$K,IR]}),n=tR("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const l=tQ(i.toString());HK(r,l,()=>l(r.currentUser)),zK(r,u=>l(u))}}const a=Z3("auth");return a&&MK(r,`http://${a}`),r}function nQ(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}kK({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const i=bs("internal-error");i.customData=a,r(i)},n.type="text/javascript",n.charset="UTF-8",nQ().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JY("Browser");var aQ="firebase",sQ="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Po(aQ,sQ,"app");var Yb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Lo,jR;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,b){function k(){}k.prototype=b.prototype,N.F=b.prototype,N.prototype=new k,N.prototype.constructor=N,N.D=function(F,P,M){for(var j=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)j[Le-2]=arguments[Le];return b.prototype[P].apply(F,j)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(N,b,k){k||(k=0);const F=Array(16);if(typeof b=="string")for(var P=0;P<16;++P)F[P]=b.charCodeAt(k++)|b.charCodeAt(k++)<<8|b.charCodeAt(k++)<<16|b.charCodeAt(k++)<<24;else for(P=0;P<16;++P)F[P]=b[k++]|b[k++]<<8|b[k++]<<16|b[k++]<<24;b=N.g[0],k=N.g[1],P=N.g[2];let M=N.g[3],j;j=b+(M^k&(P^M))+F[0]+3614090360&4294967295,b=k+(j<<7&4294967295|j>>>25),j=M+(P^b&(k^P))+F[1]+3905402710&4294967295,M=b+(j<<12&4294967295|j>>>20),j=P+(k^M&(b^k))+F[2]+606105819&4294967295,P=M+(j<<17&4294967295|j>>>15),j=k+(b^P&(M^b))+F[3]+3250441966&4294967295,k=P+(j<<22&4294967295|j>>>10),j=b+(M^k&(P^M))+F[4]+4118548399&4294967295,b=k+(j<<7&4294967295|j>>>25),j=M+(P^b&(k^P))+F[5]+1200080426&4294967295,M=b+(j<<12&4294967295|j>>>20),j=P+(k^M&(b^k))+F[6]+2821735955&4294967295,P=M+(j<<17&4294967295|j>>>15),j=k+(b^P&(M^b))+F[7]+4249261313&4294967295,k=P+(j<<22&4294967295|j>>>10),j=b+(M^k&(P^M))+F[8]+1770035416&4294967295,b=k+(j<<7&4294967295|j>>>25),j=M+(P^b&(k^P))+F[9]+2336552879&4294967295,M=b+(j<<12&4294967295|j>>>20),j=P+(k^M&(b^k))+F[10]+4294925233&4294967295,P=M+(j<<17&4294967295|j>>>15),j=k+(b^P&(M^b))+F[11]+2304563134&4294967295,k=P+(j<<22&4294967295|j>>>10),j=b+(M^k&(P^M))+F[12]+1804603682&4294967295,b=k+(j<<7&4294967295|j>>>25),j=M+(P^b&(k^P))+F[13]+4254626195&4294967295,M=b+(j<<12&4294967295|j>>>20),j=P+(k^M&(b^k))+F[14]+2792965006&4294967295,P=M+(j<<17&4294967295|j>>>15),j=k+(b^P&(M^b))+F[15]+1236535329&4294967295,k=P+(j<<22&4294967295|j>>>10),j=b+(P^M&(k^P))+F[1]+4129170786&4294967295,b=k+(j<<5&4294967295|j>>>27),j=M+(k^P&(b^k))+F[6]+3225465664&4294967295,M=b+(j<<9&4294967295|j>>>23),j=P+(b^k&(M^b))+F[11]+643717713&4294967295,P=M+(j<<14&4294967295|j>>>18),j=k+(M^b&(P^M))+F[0]+3921069994&4294967295,k=P+(j<<20&4294967295|j>>>12),j=b+(P^M&(k^P))+F[5]+3593408605&4294967295,b=k+(j<<5&4294967295|j>>>27),j=M+(k^P&(b^k))+F[10]+38016083&4294967295,M=b+(j<<9&4294967295|j>>>23),j=P+(b^k&(M^b))+F[15]+3634488961&4294967295,P=M+(j<<14&4294967295|j>>>18),j=k+(M^b&(P^M))+F[4]+3889429448&4294967295,k=P+(j<<20&4294967295|j>>>12),j=b+(P^M&(k^P))+F[9]+568446438&4294967295,b=k+(j<<5&4294967295|j>>>27),j=M+(k^P&(b^k))+F[14]+3275163606&4294967295,M=b+(j<<9&4294967295|j>>>23),j=P+(b^k&(M^b))+F[3]+4107603335&4294967295,P=M+(j<<14&4294967295|j>>>18),j=k+(M^b&(P^M))+F[8]+1163531501&4294967295,k=P+(j<<20&4294967295|j>>>12),j=b+(P^M&(k^P))+F[13]+2850285829&4294967295,b=k+(j<<5&4294967295|j>>>27),j=M+(k^P&(b^k))+F[2]+4243563512&4294967295,M=b+(j<<9&4294967295|j>>>23),j=P+(b^k&(M^b))+F[7]+1735328473&4294967295,P=M+(j<<14&4294967295|j>>>18),j=k+(M^b&(P^M))+F[12]+2368359562&4294967295,k=P+(j<<20&4294967295|j>>>12),j=b+(k^P^M)+F[5]+4294588738&4294967295,b=k+(j<<4&4294967295|j>>>28),j=M+(b^k^P)+F[8]+2272392833&4294967295,M=b+(j<<11&4294967295|j>>>21),j=P+(M^b^k)+F[11]+1839030562&4294967295,P=M+(j<<16&4294967295|j>>>16),j=k+(P^M^b)+F[14]+4259657740&4294967295,k=P+(j<<23&4294967295|j>>>9),j=b+(k^P^M)+F[1]+2763975236&4294967295,b=k+(j<<4&4294967295|j>>>28),j=M+(b^k^P)+F[4]+1272893353&4294967295,M=b+(j<<11&4294967295|j>>>21),j=P+(M^b^k)+F[7]+4139469664&4294967295,P=M+(j<<16&4294967295|j>>>16),j=k+(P^M^b)+F[10]+3200236656&4294967295,k=P+(j<<23&4294967295|j>>>9),j=b+(k^P^M)+F[13]+681279174&4294967295,b=k+(j<<4&4294967295|j>>>28),j=M+(b^k^P)+F[0]+3936430074&4294967295,M=b+(j<<11&4294967295|j>>>21),j=P+(M^b^k)+F[3]+3572445317&4294967295,P=M+(j<<16&4294967295|j>>>16),j=k+(P^M^b)+F[6]+76029189&4294967295,k=P+(j<<23&4294967295|j>>>9),j=b+(k^P^M)+F[9]+3654602809&4294967295,b=k+(j<<4&4294967295|j>>>28),j=M+(b^k^P)+F[12]+3873151461&4294967295,M=b+(j<<11&4294967295|j>>>21),j=P+(M^b^k)+F[15]+530742520&4294967295,P=M+(j<<16&4294967295|j>>>16),j=k+(P^M^b)+F[2]+3299628645&4294967295,k=P+(j<<23&4294967295|j>>>9),j=b+(P^(k|~M))+F[0]+4096336452&4294967295,b=k+(j<<6&4294967295|j>>>26),j=M+(k^(b|~P))+F[7]+1126891415&4294967295,M=b+(j<<10&4294967295|j>>>22),j=P+(b^(M|~k))+F[14]+2878612391&4294967295,P=M+(j<<15&4294967295|j>>>17),j=k+(M^(P|~b))+F[5]+4237533241&4294967295,k=P+(j<<21&4294967295|j>>>11),j=b+(P^(k|~M))+F[12]+1700485571&4294967295,b=k+(j<<6&4294967295|j>>>26),j=M+(k^(b|~P))+F[3]+2399980690&4294967295,M=b+(j<<10&4294967295|j>>>22),j=P+(b^(M|~k))+F[10]+4293915773&4294967295,P=M+(j<<15&4294967295|j>>>17),j=k+(M^(P|~b))+F[1]+2240044497&4294967295,k=P+(j<<21&4294967295|j>>>11),j=b+(P^(k|~M))+F[8]+1873313359&4294967295,b=k+(j<<6&4294967295|j>>>26),j=M+(k^(b|~P))+F[15]+4264355552&4294967295,M=b+(j<<10&4294967295|j>>>22),j=P+(b^(M|~k))+F[6]+2734768916&4294967295,P=M+(j<<15&4294967295|j>>>17),j=k+(M^(P|~b))+F[13]+1309151649&4294967295,k=P+(j<<21&4294967295|j>>>11),j=b+(P^(k|~M))+F[4]+4149444226&4294967295,b=k+(j<<6&4294967295|j>>>26),j=M+(k^(b|~P))+F[11]+3174756917&4294967295,M=b+(j<<10&4294967295|j>>>22),j=P+(b^(M|~k))+F[2]+718787259&4294967295,P=M+(j<<15&4294967295|j>>>17),j=k+(M^(P|~b))+F[9]+3951481745&4294967295,N.g[0]=N.g[0]+b&4294967295,N.g[1]=N.g[1]+(P+(j<<21&4294967295|j>>>11))&4294967295,N.g[2]=N.g[2]+P&4294967295,N.g[3]=N.g[3]+M&4294967295}n.prototype.v=function(N,b){b===void 0&&(b=N.length);const k=b-this.blockSize,F=this.C;let P=this.h,M=0;for(;M<b;){if(P==0)for(;M<=k;)a(this,N,M),M+=this.blockSize;if(typeof N=="string"){for(;M<b;)if(F[P++]=N.charCodeAt(M++),P==this.blockSize){a(this,F),P=0;break}}else for(;M<b;)if(F[P++]=N[M++],P==this.blockSize){a(this,F),P=0;break}}this.h=P,this.o+=b},n.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var b=1;b<N.length-8;++b)N[b]=0;b=this.o*8;for(var k=N.length-8;k<N.length;++k)N[k]=b&255,b/=256;for(this.v(N),N=Array(16),b=0,k=0;k<4;++k)for(let F=0;F<32;F+=8)N[b++]=this.g[k]>>>F&255;return N};function i(N,b){var k=u;return Object.prototype.hasOwnProperty.call(k,N)?k[N]:k[N]=b(N)}function l(N,b){this.h=b;const k=[];let F=!0;for(let P=N.length-1;P>=0;P--){const M=N[P]|0;F&&M==b||(k[P]=M,F=!1)}this.g=k}var u={};function f(N){return-128<=N&&N<128?i(N,function(b){return new l([b|0],b<0?-1:0)}):new l([N|0],N<0?-1:0)}function h(N){if(isNaN(N)||!isFinite(N))return x;if(N<0)return A(h(-N));const b=[];let k=1;for(let F=0;N>=k;F++)b[F]=N/k|0,k*=4294967296;return new l(b,0)}function m(N,b){if(N.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(N.charAt(0)=="-")return A(m(N.substring(1),b));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=h(Math.pow(b,8));let F=x;for(let M=0;M<N.length;M+=8){var P=Math.min(8,N.length-M);const j=parseInt(N.substring(M,M+P),b);P<8?(P=h(Math.pow(b,P)),F=F.j(P).add(h(j))):(F=F.j(k),F=F.add(h(j)))}return F}var x=f(0),v=f(1),E=f(16777216);t=l.prototype,t.m=function(){if(T(this))return-A(this).m();let N=0,b=1;for(let k=0;k<this.g.length;k++){const F=this.i(k);N+=(F>=0?F:4294967296+F)*b,b*=4294967296}return N},t.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(w(this))return"0";if(T(this))return"-"+A(this).toString(N);const b=h(Math.pow(N,6));var k=this;let F="";for(;;){const P=q(k,b).g;k=I(k,P.j(b));let M=((k.g.length>0?k.g[0]:k.h)>>>0).toString(N);if(k=P,w(k))return M+F;for(;M.length<6;)M="0"+M;F=M+F}},t.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function w(N){if(N.h!=0)return!1;for(let b=0;b<N.g.length;b++)if(N.g[b]!=0)return!1;return!0}function T(N){return N.h==-1}t.l=function(N){return N=I(this,N),T(N)?-1:w(N)?0:1};function A(N){const b=N.g.length,k=[];for(let F=0;F<b;F++)k[F]=~N.g[F];return new l(k,~N.h).add(v)}t.abs=function(){return T(this)?A(this):this},t.add=function(N){const b=Math.max(this.g.length,N.g.length),k=[];let F=0;for(let P=0;P<=b;P++){let M=F+(this.i(P)&65535)+(N.i(P)&65535),j=(M>>>16)+(this.i(P)>>>16)+(N.i(P)>>>16);F=j>>>16,M&=65535,j&=65535,k[P]=j<<16|M}return new l(k,k[k.length-1]&-2147483648?-1:0)};function I(N,b){return N.add(A(b))}t.j=function(N){if(w(this)||w(N))return x;if(T(this))return T(N)?A(this).j(A(N)):A(A(this).j(N));if(T(N))return A(this.j(A(N)));if(this.l(E)<0&&N.l(E)<0)return h(this.m()*N.m());const b=this.g.length+N.g.length,k=[];for(var F=0;F<2*b;F++)k[F]=0;for(F=0;F<this.g.length;F++)for(let P=0;P<N.g.length;P++){const M=this.i(F)>>>16,j=this.i(F)&65535,Le=N.i(P)>>>16,De=N.i(P)&65535;k[2*F+2*P]+=j*De,O(k,2*F+2*P),k[2*F+2*P+1]+=M*De,O(k,2*F+2*P+1),k[2*F+2*P+1]+=j*Le,O(k,2*F+2*P+1),k[2*F+2*P+2]+=M*Le,O(k,2*F+2*P+2)}for(N=0;N<b;N++)k[N]=k[2*N+1]<<16|k[2*N];for(N=b;N<2*b;N++)k[N]=0;return new l(k,0)};function O(N,b){for(;(N[b]&65535)!=N[b];)N[b+1]+=N[b]>>>16,N[b]&=65535,b++}function D(N,b){this.g=N,this.h=b}function q(N,b){if(w(b))throw Error("division by zero");if(w(N))return new D(x,x);if(T(N))return b=q(A(N),b),new D(A(b.g),A(b.h));if(T(b))return b=q(N,A(b)),new D(A(b.g),b.h);if(N.g.length>30){if(T(N)||T(b))throw Error("slowDivide_ only works with positive integers.");for(var k=v,F=b;F.l(N)<=0;)k=Y(k),F=Y(F);var P=W(k,1),M=W(F,1);for(F=W(F,2),k=W(k,2);!w(F);){var j=M.add(F);j.l(N)<=0&&(P=P.add(k),M=j),F=W(F,1),k=W(k,1)}return b=I(N,P.j(b)),new D(P,b)}for(P=x;N.l(b)>=0;){for(k=Math.max(1,Math.floor(N.m()/b.m())),F=Math.ceil(Math.log(k)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),M=h(k),j=M.j(b);T(j)||j.l(N)>0;)k-=F,M=h(k),j=M.j(b);w(M)&&(M=v),P=P.add(M),N=I(N,j)}return new D(P,N)}t.B=function(N){return q(this,N).h},t.and=function(N){const b=Math.max(this.g.length,N.g.length),k=[];for(let F=0;F<b;F++)k[F]=this.i(F)&N.i(F);return new l(k,this.h&N.h)},t.or=function(N){const b=Math.max(this.g.length,N.g.length),k=[];for(let F=0;F<b;F++)k[F]=this.i(F)|N.i(F);return new l(k,this.h|N.h)},t.xor=function(N){const b=Math.max(this.g.length,N.g.length),k=[];for(let F=0;F<b;F++)k[F]=this.i(F)^N.i(F);return new l(k,this.h^N.h)};function Y(N){const b=N.g.length+1,k=[];for(let F=0;F<b;F++)k[F]=N.i(F)<<1|N.i(F-1)>>>31;return new l(k,N.h)}function W(N,b){const k=b>>5;b%=32;const F=N.g.length-k,P=[];for(let M=0;M<F;M++)P[M]=b>0?N.i(M+k)>>>b|N.i(M+k+1)<<32-b:N.i(M+k);return new l(P,N.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,jR=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=h,l.fromString=m,Lo=l}).apply(typeof Yb<"u"?Yb:typeof self<"u"?self:typeof window<"u"?window:{});var cm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UR,Zf,zR,Sm,Iv,HR,GR,qR;(function(){var t,e=Object.defineProperty;function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof cm=="object"&&cm];for(var S=0;S<p.length;++S){var R=p[S];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var n=r(this);function a(p,S){if(S)e:{var R=n;p=p.split(".");for(var H=0;H<p.length-1;H++){var ue=p[H];if(!(ue in R))break e;R=R[ue]}p=p[p.length-1],H=R[p],S=S(H),S!=H&&S!=null&&e(R,p,{configurable:!0,writable:!0,value:S})}}a("Symbol.dispose",function(p){return p||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(p){return p||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(p){return p||function(S){var R=[],H;for(H in S)Object.prototype.hasOwnProperty.call(S,H)&&R.push([H,S[H]]);return R}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},l=this||self;function u(p){var S=typeof p;return S=="object"&&p!=null||S=="function"}function f(p,S,R){return p.call.apply(p.bind,arguments)}function h(p,S,R){return h=f,h.apply(null,arguments)}function m(p,S){var R=Array.prototype.slice.call(arguments,1);return function(){var H=R.slice();return H.push.apply(H,arguments),p.apply(this,H)}}function x(p,S){function R(){}R.prototype=S.prototype,p.Z=S.prototype,p.prototype=new R,p.prototype.constructor=p,p.Ob=function(H,ue,Ee){for(var Xe=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)Xe[yt-2]=arguments[yt];return S.prototype[ue].apply(H,Xe)}}var v=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?p=>p&&AsyncContext.Snapshot.wrap(p):p=>p;function E(p){const S=p.length;if(S>0){const R=Array(S);for(let H=0;H<S;H++)R[H]=p[H];return R}return[]}function w(p,S){for(let H=1;H<arguments.length;H++){const ue=arguments[H];var R=typeof ue;if(R=R!="object"?R:ue?Array.isArray(ue)?"array":R:"null",R=="array"||R=="object"&&typeof ue.length=="number"){R=p.length||0;const Ee=ue.length||0;p.length=R+Ee;for(let Xe=0;Xe<Ee;Xe++)p[R+Xe]=ue[Xe]}else p.push(ue)}}class T{constructor(S,R){this.i=S,this.j=R,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function A(p){l.setTimeout(()=>{throw p},0)}function I(){var p=N;let S=null;return p.g&&(S=p.g,p.g=p.g.next,p.g||(p.h=null),S.next=null),S}class O{constructor(){this.h=this.g=null}add(S,R){const H=D.get();H.set(S,R),this.h?this.h.next=H:this.g=H,this.h=H}}var D=new T(()=>new q,p=>p.reset());class q{constructor(){this.next=this.g=this.h=null}set(S,R){this.h=S,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,W=!1,N=new O,b=()=>{const p=Promise.resolve(void 0);Y=()=>{p.then(k)}};function k(){for(var p;p=I();){try{p.h.call(p.g)}catch(R){A(R)}var S=D;S.j(p),S.h<100&&(S.h++,p.next=S.g,S.g=p)}W=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(p,S){this.type=p,this.g=this.target=S,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var M=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var p=!1,S=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const R=()=>{};l.addEventListener("test",R,S),l.removeEventListener("test",R,S)}catch{}return p})();function j(p){return/^[\s\xa0]*$/.test(p)}function Le(p,S){P.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p&&this.init(p,S)}x(Le,P),Le.prototype.init=function(p,S){const R=this.type=p.type,H=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;this.target=p.target||p.srcElement,this.g=S,S=p.relatedTarget,S||(R=="mouseover"?S=p.fromElement:R=="mouseout"&&(S=p.toElement)),this.relatedTarget=S,H?(this.clientX=H.clientX!==void 0?H.clientX:H.pageX,this.clientY=H.clientY!==void 0?H.clientY:H.pageY,this.screenX=H.screenX||0,this.screenY=H.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=p.pointerType,this.state=p.state,this.i=p,p.defaultPrevented&&Le.Z.h.call(this)},Le.prototype.h=function(){Le.Z.h.call(this);const p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var De="closure_listenable_"+(Math.random()*1e6|0),ne=0;function ae(p,S,R,H,ue){this.listener=p,this.proxy=null,this.src=S,this.type=R,this.capture=!!H,this.ha=ue,this.key=++ne,this.da=this.fa=!1}function fe(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ie(p,S,R){for(const H in p)S.call(R,p[H],H,p)}function Fe(p,S){for(const R in p)S.call(void 0,p[R],R,p)}function ee(p){const S={};for(const R in p)S[R]=p[R];return S}const B="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(p,S){let R,H;for(let ue=1;ue<arguments.length;ue++){H=arguments[ue];for(R in H)p[R]=H[R];for(let Ee=0;Ee<B.length;Ee++)R=B[Ee],Object.prototype.hasOwnProperty.call(H,R)&&(p[R]=H[R])}}function J(p){this.src=p,this.g={},this.h=0}J.prototype.add=function(p,S,R,H,ue){const Ee=p.toString();p=this.g[Ee],p||(p=this.g[Ee]=[],this.h++);const Xe=ce(p,S,H,ue);return Xe>-1?(S=p[Xe],R||(S.fa=!1)):(S=new ae(S,this.src,Ee,!!H,ue),S.fa=R,p.push(S)),S};function te(p,S){const R=S.type;if(R in p.g){var H=p.g[R],ue=Array.prototype.indexOf.call(H,S,void 0),Ee;(Ee=ue>=0)&&Array.prototype.splice.call(H,ue,1),Ee&&(fe(S),p.g[R].length==0&&(delete p.g[R],p.h--))}}function ce(p,S,R,H){for(let ue=0;ue<p.length;++ue){const Ee=p[ue];if(!Ee.da&&Ee.listener==S&&Ee.capture==!!R&&Ee.ha==H)return ue}return-1}var Se="closure_lm_"+(Math.random()*1e6|0),Oe={};function ke(p,S,R,H,ue){if(Array.isArray(S)){for(let Ee=0;Ee<S.length;Ee++)ke(p,S[Ee],R,H,ue);return null}return R=qe(R),p&&p[De]?p.J(S,R,u(H)?!!H.capture:!1,ue):se(p,S,R,!1,H,ue)}function se(p,S,R,H,ue,Ee){if(!S)throw Error("Invalid event type");const Xe=u(ue)?!!ue.capture:!!ue;let yt=Ye(p);if(yt||(p[Se]=yt=new J(p)),R=yt.add(S,R,H,Xe,Ee),R.proxy)return R;if(H=Me(),R.proxy=H,H.src=p,H.listener=R,p.addEventListener)M||(ue=Xe),ue===void 0&&(ue=!1),p.addEventListener(S.toString(),H,ue);else if(p.attachEvent)p.attachEvent(Ae(S.toString()),H);else if(p.addListener&&p.removeListener)p.addListener(H);else throw Error("addEventListener and attachEvent are unavailable.");return R}function Me(){function p(R){return S.call(p.src,p.listener,R)}const S=Je;return p}function V(p,S,R,H,ue){if(Array.isArray(S))for(var Ee=0;Ee<S.length;Ee++)V(p,S[Ee],R,H,ue);else H=u(H)?!!H.capture:!!H,R=qe(R),p&&p[De]?(p=p.i,Ee=String(S).toString(),Ee in p.g&&(S=p.g[Ee],R=ce(S,R,H,ue),R>-1&&(fe(S[R]),Array.prototype.splice.call(S,R,1),S.length==0&&(delete p.g[Ee],p.h--)))):p&&(p=Ye(p))&&(S=p.g[S.toString()],p=-1,S&&(p=ce(S,R,H,ue)),(R=p>-1?S[p]:null)&&we(R))}function we(p){if(typeof p!="number"&&p&&!p.da){var S=p.src;if(S&&S[De])te(S.i,p);else{var R=p.type,H=p.proxy;S.removeEventListener?S.removeEventListener(R,H,p.capture):S.detachEvent?S.detachEvent(Ae(R),H):S.addListener&&S.removeListener&&S.removeListener(H),(R=Ye(S))?(te(R,p),R.h==0&&(R.src=null,S[Se]=null)):fe(p)}}}function Ae(p){return p in Oe?Oe[p]:Oe[p]="on"+p}function Je(p,S){if(p.da)p=!0;else{S=new Le(S,this);const R=p.listener,H=p.ha||p.src;p.fa&&we(p),p=R.call(H,S)}return p}function Ye(p){return p=p[Se],p instanceof J?p:null}var ge="__closure_events_fn_"+(Math.random()*1e9>>>0);function qe(p){return typeof p=="function"?p:(p[ge]||(p[ge]=function(S){return p.handleEvent(S)}),p[ge])}function Be(){F.call(this),this.i=new J(this),this.M=this,this.G=null}x(Be,F),Be.prototype[De]=!0,Be.prototype.removeEventListener=function(p,S,R,H){V(this,p,S,R,H)};function Qe(p,S){var R,H=p.G;if(H)for(R=[];H;H=H.G)R.push(H);if(p=p.M,H=S.type||S,typeof S=="string")S=new P(S,p);else if(S instanceof P)S.target=S.target||p;else{var ue=S;S=new P(H,p),Q(S,ue)}ue=!0;let Ee,Xe;if(R)for(Xe=R.length-1;Xe>=0;Xe--)Ee=S.g=R[Xe],ue=zt(Ee,H,!0,S)&&ue;if(Ee=S.g=p,ue=zt(Ee,H,!0,S)&&ue,ue=zt(Ee,H,!1,S)&&ue,R)for(Xe=0;Xe<R.length;Xe++)Ee=S.g=R[Xe],ue=zt(Ee,H,!1,S)&&ue}Be.prototype.N=function(){if(Be.Z.N.call(this),this.i){var p=this.i;for(const S in p.g){const R=p.g[S];for(let H=0;H<R.length;H++)fe(R[H]);delete p.g[S],p.h--}}this.G=null},Be.prototype.J=function(p,S,R,H){return this.i.add(String(p),S,!1,R,H)},Be.prototype.K=function(p,S,R,H){return this.i.add(String(p),S,!0,R,H)};function zt(p,S,R,H){if(S=p.i.g[String(S)],!S)return!0;S=S.concat();let ue=!0;for(let Ee=0;Ee<S.length;++Ee){const Xe=S[Ee];if(Xe&&!Xe.da&&Xe.capture==R){const yt=Xe.listener,Pr=Xe.ha||Xe.src;Xe.fa&&te(p.i,Xe),ue=yt.call(Pr,H)!==!1&&ue}}return ue&&!H.defaultPrevented}function Wt(p,S){if(typeof p!="function")if(p&&typeof p.handleEvent=="function")p=h(p.handleEvent,p);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:l.setTimeout(p,S||0)}function rr(p){p.g=Wt(()=>{p.g=null,p.i&&(p.i=!1,rr(p))},p.l);const S=p.h;p.h=null,p.m.apply(null,S)}class ft extends F{constructor(S,R){super(),this.m=S,this.l=R,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:rr(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lr(p){F.call(this),this.h=p,this.g={}}x(lr,F);var en=[];function ha(p){ie(p.g,function(S,R){this.g.hasOwnProperty(R)&&we(S)},p),p.g={}}lr.prototype.N=function(){lr.Z.N.call(this),ha(this)},lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yr=l.JSON.stringify,Zn=l.JSON.parse,vt=class{stringify(p){return l.JSON.stringify(p,void 0)}parse(p){return l.JSON.parse(p,void 0)}};function fr(){}function pn(){}var Ht={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function hr(){P.call(this,"d")}x(hr,P);function Gn(){P.call(this,"c")}x(Gn,P);var wr={},hc=null;function ti(){return hc=hc||new Be}wr.Ia="serverreachability";function rl(p){P.call(this,wr.Ia,p)}x(rl,P);function da(p){const S=ti();Qe(S,new rl(S))}wr.STAT_EVENT="statevent";function ri(p,S){P.call(this,wr.STAT_EVENT,p),this.stat=S}x(ri,P);function kr(p){const S=ti();Qe(S,new ri(S,p))}wr.Ja="timingevent";function qn(p,S){P.call(this,wr.Ja,p),this.size=S}x(qn,P);function Ra(p,S){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){p()},S)}function ma(){this.g=!0}ma.prototype.ua=function(){this.g=!1};function Yu(p,S,R,H,ue,Ee){p.info(function(){if(p.g)if(Ee){var Xe="",yt=Ee.split("&");for(let Gt=0;Gt<yt.length;Gt++){var Pr=yt[Gt].split("=");if(Pr.length>1){const _r=Pr[0];Pr=Pr[1];const Oa=_r.split("_");Xe=Oa.length>=2&&Oa[1]=="type"?Xe+(_r+"="+Pr+"&"):Xe+(_r+"=redacted&")}}}else Xe=null;else Xe=Ee;return"XMLHTTP REQ ("+H+") [attempt "+ue+"]: "+S+`
`+R+`
`+Xe})}function dc(p,S,R,H,ue,Ee,Xe){p.info(function(){return"XMLHTTP RESP ("+H+") [ attempt "+ue+"]: "+S+`
`+R+`
`+Ee+" "+Xe})}function Da(p,S,R,H){p.info(function(){return"XMLHTTP TEXT ("+S+"): "+Qu(p,R)+(H?" "+H:"")})}function ni(p,S){p.info(function(){return"TIMEOUT: "+S})}ma.prototype.info=function(){};function Qu(p,S){if(!p.g)return S;if(!S)return null;try{const Ee=JSON.parse(S);if(Ee){for(p=0;p<Ee.length;p++)if(Array.isArray(Ee[p])){var R=Ee[p];if(!(R.length<2)){var H=R[1];if(Array.isArray(H)&&!(H.length<1)){var ue=H[0];if(ue!="noop"&&ue!="stop"&&ue!="close")for(let Xe=1;Xe<H.length;Xe++)H[Xe]=""}}}}return yr(Ee)}catch{return S}}var ai={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},si={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},nl;function ii(){}x(ii,fr),ii.prototype.g=function(){return new XMLHttpRequest},nl=new ii;function as(p){return encodeURIComponent(String(p))}function L(p){var S=1;p=p.split(":");const R=[];for(;S>0&&p.length;)R.push(p.shift()),S--;return p.length&&R.push(p.join(":")),R}function K(p,S,R,H){this.j=p,this.i=S,this.l=R,this.S=H||1,this.V=new lr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new z}function z(){this.i=null,this.g="",this.h=!1}var G={},X={};function Z(p,S,R){p.M=1,p.A=al(Hr(S)),p.u=R,p.R=!0,de(p,null)}function de(p,S){p.F=Date.now(),ve(p),p.B=Hr(p.A);var R=p.B,H=p.S;Array.isArray(H)||(H=[String(H)]),pc(R.i,"t",H),p.C=0,R=p.j.L,p.h=new z,p.g=V0(p.j,R?S:null,!p.u),p.P>0&&(p.O=new ft(h(p.Y,p,p.g),p.P)),S=p.V,R=p.g,H=p.ba;var ue="readystatechange";Array.isArray(ue)||(ue&&(en[0]=ue.toString()),ue=en);for(let Ee=0;Ee<ue.length;Ee++){const Xe=ke(R,ue[Ee],H||S.handleEvent,!1,S.h||S);if(!Xe)break;S.g[Xe.key]=Xe}S=p.J?ee(p.J):{},p.u?(p.v||(p.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.B,p.v,p.u,S)):(p.v="GET",p.g.ea(p.B,p.v,null,S)),da(),Yu(p.i,p.v,p.B,p.l,p.S,p.u)}K.prototype.ba=function(p){p=p.target;const S=this.O;S&&cs(p)==3?S.j():this.Y(p)},K.prototype.Y=function(p){try{if(p==this.g)e:{const yt=cs(this.g),Pr=this.g.ya(),Gt=this.g.ca();if(!(yt<3)&&(yt!=3||this.g&&(this.h.h||this.g.la()||gn(this.g)))){this.K||yt!=4||Pr==7||(Pr==8||Gt<=0?da(3):da(2)),He(this);var S=this.g.ca();this.X=S;var R=Ne(this);if(this.o=S==200,dc(this.i,this.v,this.B,this.l,this.S,yt,S),this.o){if(this.U&&!this.L){t:{if(this.g){var H,ue=this.g;if((H=ue.g?ue.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(H)){var Ee=H;break t}}Ee=null}if(p=Ee)Da(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$e(this,p);else{this.o=!1,this.m=3,kr(12),je(this),Ke(this);break e}}if(this.R){p=!0;let _r;for(;!this.K&&this.C<R.length;)if(_r=ye(this,R),_r==X){yt==4&&(this.m=4,kr(14),p=!1),Da(this.i,this.l,null,"[Incomplete Response]");break}else if(_r==G){this.m=4,kr(15),Da(this.i,this.l,R,"[Invalid Chunk]"),p=!1;break}else Da(this.i,this.l,_r,null),$e(this,_r);if(me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),yt!=4||R.length!=0||this.h.h||(this.m=1,kr(16),p=!1),this.o=this.o&&p,!p)Da(this.i,this.l,R,"[Invalid Chunked Response]"),je(this),Ke(this);else if(R.length>0&&!this.W){this.W=!0;var Xe=this.j;Xe.g==this&&Xe.aa&&!Xe.P&&(Xe.j.info("Great, no buffering proxy detected. Bytes received: "+R.length),lf(Xe),Xe.P=!0,kr(11))}}else Da(this.i,this.l,R,null),$e(this,R);yt==4&&je(this),this.o&&!this.K&&(yt==4?O0(this.j,this):(this.o=!1,ve(this)))}else li(this.g),S==400&&R.indexOf("Unknown SID")>0?(this.m=3,kr(12)):(this.m=0,kr(13)),je(this),Ke(this)}}}catch{}finally{}};function Ne(p){if(!me(p))return p.g.la();const S=gn(p.g);if(S==="")return"";let R="";const H=S.length,ue=cs(p.g)==4;if(!p.h.i){if(typeof TextDecoder>"u")return je(p),Ke(p),"";p.h.i=new l.TextDecoder}for(let Ee=0;Ee<H;Ee++)p.h.h=!0,R+=p.h.i.decode(S[Ee],{stream:!(ue&&Ee==H-1)});return S.length=0,p.h.g+=R,p.C=0,p.h.g}function me(p){return p.g?p.v=="GET"&&p.M!=2&&p.j.Aa:!1}function ye(p,S){var R=p.C,H=S.indexOf(`
`,R);return H==-1?X:(R=Number(S.substring(R,H)),isNaN(R)?G:(H+=1,H+R>S.length?X:(S=S.slice(H,H+R),p.C=H+R,S)))}K.prototype.cancel=function(){this.K=!0,je(this)};function ve(p){p.T=Date.now()+p.H,ze(p,p.H)}function ze(p,S){if(p.D!=null)throw Error("WatchDog timer not null");p.D=Ra(h(p.aa,p),S)}function He(p){p.D&&(l.clearTimeout(p.D),p.D=null)}K.prototype.aa=function(){this.D=null;const p=Date.now();p-this.T>=0?(ni(this.i,this.B),this.M!=2&&(da(),kr(17)),je(this),this.m=2,Ke(this)):ze(this,this.T-p)};function Ke(p){p.j.I==0||p.K||O0(p.j,p)}function je(p){He(p);var S=p.O;S&&typeof S.dispose=="function"&&S.dispose(),p.O=null,ha(p.V),p.g&&(S=p.g,p.g=null,S.abort(),S.dispose())}function $e(p,S){try{var R=p.j;if(R.I!=0&&(R.g==p||Cn(R.h,p))){if(!p.L&&Cn(R.h,p)&&R.I==3){try{var H=R.Ba.g.parse(S)}catch{H=null}if(Array.isArray(H)&&H.length==3){var ue=H;if(ue[0]==0){e:if(!R.v){if(R.g)if(R.g.F+3e3<p.F)_c(R),eo(R);else break e;fl(R),kr(18)}}else R.xa=ue[1],0<R.xa-R.K&&ue[2]<37500&&R.F&&R.A==0&&!R.C&&(R.C=Ra(h(R.Va,R),6e3));cr(R.h)<=1&&R.ta&&(R.ta=void 0)}else Is(R,11)}else if((p.L||R.g==p)&&_c(R),!j(S))for(ue=R.Ba.g.parse(S),S=0;S<ue.length;S++){let Gt=ue[S];const _r=Gt[0];if(!(_r<=R.K))if(R.K=_r,Gt=Gt[1],R.I==2)if(Gt[0]=="c"){R.M=Gt[1],R.ba=Gt[2];const Oa=Gt[3];Oa!=null&&(R.ka=Oa,R.j.info("VER="+R.ka));const Fs=Gt[4];Fs!=null&&(R.za=Fs,R.j.info("SVER="+R.za));const us=Gt[5];us!=null&&typeof us=="number"&&us>0&&(H=1.5*us,R.O=H,R.j.info("backChannelRequestTimeoutMs_="+H)),H=R;const fs=p.g;if(fs){const hl=fs.g?fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(hl){var Ee=H.h;Ee.g||hl.indexOf("spdy")==-1&&hl.indexOf("quic")==-1&&hl.indexOf("h2")==-1||(Ee.j=Ee.l,Ee.g=new Set,Ee.h&&(ss(Ee,Ee.h),Ee.h=null))}if(H.G){const Ec=fs.g?fs.g.getResponseHeader("X-HTTP-Session-Id"):null;Ec&&(H.wa=Ec,Yt(H.J,H.G,Ec))}}R.I=3,R.l&&R.l.ra(),R.aa&&(R.T=Date.now()-p.F,R.j.info("Handshake RTT: "+R.T+"ms")),H=R;var Xe=p;if(H.na=L0(H,H.L?H.ba:null,H.W),Xe.L){is(H.h,Xe);var yt=Xe,Pr=H.O;Pr&&(yt.H=Pr),yt.D&&(He(yt),ve(yt)),H.g=Xe}else I0(H);R.i.length>0&&Ds(R)}else Gt[0]!="stop"&&Gt[0]!="close"||Is(R,7);else R.I==3&&(Gt[0]=="stop"||Gt[0]=="close"?Gt[0]=="stop"?Is(R,7):sf(R):Gt[0]!="noop"&&R.l&&R.l.qa(Gt),R.A=0)}}da(4)}catch{}}var tt=class{constructor(p,S){this.g=p,this.map=S}};function $t(p){this.l=p||10,l.PerformanceNavigationTiming?(p=l.performance.getEntriesByType("navigation"),p=p.length>0&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Kt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function cr(p){return p.h?1:p.g?p.g.size:0}function Cn(p,S){return p.h?p.h==S:p.g?p.g.has(S):!1}function ss(p,S){p.g?p.g.add(S):p.h=S}function is(p,S){p.h&&p.h==S?p.h=null:p.g&&p.g.has(S)&&p.g.delete(S)}$t.prototype.cancel=function(){if(this.i=pa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function pa(p){if(p.h!=null)return p.i.concat(p.h.G);if(p.g!=null&&p.g.size!==0){let S=p.i;for(const R of p.g.values())S=S.concat(R.G);return S}return E(p.i)}var Wi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function kn(p,S){if(p){p=p.split("&");for(let R=0;R<p.length;R++){const H=p[R].indexOf("=");let ue,Ee=null;H>=0?(ue=p[R].substring(0,H),Ee=p[R].substring(H+1)):ue=p[R],S(ue,Ee?decodeURIComponent(Ee.replace(/\+/g," ")):"")}}}function ga(p){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;p instanceof ga?(this.l=p.l,ln(this,p.j),this.o=p.o,this.g=p.g,Xi(this,p.u),this.h=p.h,Ju(this,R0(p.i)),this.m=p.m):p&&(S=String(p).match(Wi))?(this.l=!1,ln(this,S[1]||"",!0),this.o=Ns(S[2]||""),this.g=Ns(S[3]||"",!0),Xi(this,S[4]),this.h=Ns(S[5]||"",!0),Ju(this,S[6]||"",!0),this.m=Ns(S[7]||"")):(this.l=!1,this.i=new Ki(null,this.l))}ga.prototype.toString=function(){const p=[];var S=this.j;S&&p.push(sl(S,mc,!0),":");var R=this.g;return(R||S=="file")&&(p.push("//"),(S=this.o)&&p.push(sl(S,mc,!0),"@"),p.push(as(R).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.u,R!=null&&p.push(":",String(R))),(R=this.h)&&(this.g&&R.charAt(0)!="/"&&p.push("/"),p.push(sl(R,R.charAt(0)=="/"?Zu:N0,!0))),(R=this.i.toString())&&p.push("?",R),(R=this.m)&&p.push("#",sl(R,C0)),p.join("")},ga.prototype.resolve=function(p){const S=Hr(this);let R=!!p.j;R?ln(S,p.j):R=!!p.o,R?S.o=p.o:R=!!p.g,R?S.g=p.g:R=p.u!=null;var H=p.h;if(R)Xi(S,p.u);else if(R=!!p.h){if(H.charAt(0)!="/")if(this.g&&!this.h)H="/"+H;else{var ue=S.h.lastIndexOf("/");ue!=-1&&(H=S.h.slice(0,ue+1)+H)}if(ue=H,ue==".."||ue==".")H="";else if(ue.indexOf("./")!=-1||ue.indexOf("/.")!=-1){H=ue.lastIndexOf("/",0)==0,ue=ue.split("/");const Ee=[];for(let Xe=0;Xe<ue.length;){const yt=ue[Xe++];yt=="."?H&&Xe==ue.length&&Ee.push(""):yt==".."?((Ee.length>1||Ee.length==1&&Ee[0]!="")&&Ee.pop(),H&&Xe==ue.length&&Ee.push("")):(Ee.push(yt),H=!0)}H=Ee.join("/")}else H=ue}return R?S.h=H:R=p.i.toString()!=="",R?Ju(S,R0(p.i)):R=!!p.m,R&&(S.m=p.m),S};function Hr(p){return new ga(p)}function ln(p,S,R){p.j=R?Ns(S,!0):S,p.j&&(p.j=p.j.replace(/:$/,""))}function Xi(p,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);p.u=S}else p.u=null}function Ju(p,S,R){S instanceof Ki?(p.i=S,gc(p.i,p.l)):(R||(S=sl(S,$i)),p.i=new Ki(S,p.l))}function Yt(p,S,R){p.i.set(S,R)}function al(p){return Yt(p,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),p}function Ns(p,S){return p?S?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function sl(p,S,R){return typeof p=="string"?(p=encodeURI(p).replace(S,ea),R&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function ea(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var mc=/[#\/\?@]/g,N0=/[#\?:]/g,Zu=/[#\?]/g,$i=/[#\?@]/g,C0=/#/g;function Ki(p,S){this.h=this.g=null,this.i=p||null,this.j=!!S}function ta(p){p.g||(p.g=new Map,p.h=0,p.i&&kn(p.i,function(S,R){p.add(decodeURIComponent(S.replace(/\+/g," ")),R)}))}t=Ki.prototype,t.add=function(p,S){ta(this),this.i=null,p=Yi(this,p);let R=this.g.get(p);return R||this.g.set(p,R=[]),R.push(S),this.h+=1,this};function k0(p,S){ta(p),S=Yi(p,S),p.g.has(S)&&(p.i=null,p.h-=p.g.get(S).length,p.g.delete(S))}function ef(p,S){return ta(p),S=Yi(p,S),p.g.has(S)}t.forEach=function(p,S){ta(this),this.g.forEach(function(R,H){R.forEach(function(ue){p.call(S,ue,H,this)},this)},this)};function tf(p,S){ta(p);let R=[];if(typeof S=="string")ef(p,S)&&(R=R.concat(p.g.get(Yi(p,S))));else for(p=Array.from(p.g.values()),S=0;S<p.length;S++)R=R.concat(p[S]);return R}t.set=function(p,S){return ta(this),this.i=null,p=Yi(this,p),ef(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[S]),this.h+=1,this},t.get=function(p,S){return p?(p=tf(this,p),p.length>0?String(p[0]):S):S};function pc(p,S,R){k0(p,S),R.length>0&&(p.i=null,p.g.set(Yi(p,S),E(R)),p.h+=R.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],S=Array.from(this.g.keys());for(let H=0;H<S.length;H++){var R=S[H];const ue=as(R);R=tf(this,R);for(let Ee=0;Ee<R.length;Ee++){let Xe=ue;R[Ee]!==""&&(Xe+="="+as(R[Ee])),p.push(Xe)}}return this.i=p.join("&")};function R0(p){const S=new Ki;return S.i=p.i,p.g&&(S.g=new Map(p.g),S.h=p.h),S}function Yi(p,S){return S=String(S),p.j&&(S=S.toLowerCase()),S}function gc(p,S){S&&!p.j&&(ta(p),p.i=null,p.g.forEach(function(R,H){const ue=H.toLowerCase();H!=ue&&(k0(this,H),pc(this,ue,R))},p)),p.j=S}function os(p,S){const R=new ma;if(l.Image){const H=new Image;H.onload=m(Ia,R,"TestLoadImage: loaded",!0,S,H),H.onerror=m(Ia,R,"TestLoadImage: error",!1,S,H),H.onabort=m(Ia,R,"TestLoadImage: abort",!1,S,H),H.ontimeout=m(Ia,R,"TestLoadImage: timeout",!1,S,H),l.setTimeout(function(){H.ontimeout&&H.ontimeout()},1e4),H.src=p}else S(!1)}function rf(p,S){const R=new ma,H=new AbortController,ue=setTimeout(()=>{H.abort(),Ia(R,"TestPingServer: timeout",!1,S)},1e4);fetch(p,{signal:H.signal}).then(Ee=>{clearTimeout(ue),Ee.ok?Ia(R,"TestPingServer: ok",!0,S):Ia(R,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(ue),Ia(R,"TestPingServer: error",!1,S)})}function Ia(p,S,R,H,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),H(R)}catch{}}function Qi(){this.g=new vt}function Cs(p){this.i=p.Sb||null,this.h=p.ab||!1}x(Cs,fr),Cs.prototype.g=function(){return new il(this.i,this.h)};function il(p,S){Be.call(this),this.H=p,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(il,Be),t=il.prototype,t.open=function(p,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=p,this.D=S,this.readyState=1,ls(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};p&&(S.body=p),(this.H||l).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ji(this)),this.readyState=0},t.Pa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ls(this)),this.g&&(this.readyState=3,ls(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xc(this)}else p.text().then(this.Oa.bind(this),this.ga.bind(this))};function xc(p){p.j.read().then(p.Ma.bind(p)).catch(p.ga.bind(p))}t.Ma=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var S=p.value?p.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!p.done}))&&(this.response=this.responseText+=S)}p.done?Ji(this):ls(this),this.readyState==3&&xc(this)}},t.Oa=function(p){this.g&&(this.response=this.responseText=p,Ji(this))},t.Na=function(p){this.g&&(this.response=p,Ji(this))},t.ga=function(){this.g&&Ji(this)};function Ji(p){p.readyState=4,p.l=null,p.j=null,p.B=null,ls(p)}t.setRequestHeader=function(p,S){this.A.append(p,S)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],S=this.h.entries();for(var R=S.next();!R.done;)R=R.value,p.push(R[0]+": "+R[1]),R=S.next();return p.join(`\r
`)};function ls(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(il.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Fa(p){let S="";return ie(p,function(R,H){S+=H,S+=":",S+=R,S+=`\r
`}),S}function ol(p,S,R){e:{for(H in R){var H=!1;break e}H=!0}H||(R=Fa(R),typeof p=="string"?R!=null&&as(R):Yt(p,S,R))}function nr(p){Be.call(this),this.headers=new Map,this.L=p||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(nr,Be);var ks=/^https?$/i,nf=["POST","PUT"];t=nr.prototype,t.Fa=function(p){this.H=p},t.ea=function(p,S,R,H){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);S=S?S.toUpperCase():"GET",this.D=p,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():nl.g(),this.g.onreadystatechange=v(h(this.Ca,this));try{this.B=!0,this.g.open(S,String(p),!0),this.B=!1}catch(Ee){ll(this,Ee);return}if(p=R||"",R=new Map(this.headers),H)if(Object.getPrototypeOf(H)===Object.prototype)for(var ue in H)R.set(ue,H[ue]);else if(typeof H.keys=="function"&&typeof H.get=="function")for(const Ee of H.keys())R.set(Ee,H.get(Ee));else throw Error("Unknown input type for opt_headers: "+String(H));H=Array.from(R.keys()).find(Ee=>Ee.toLowerCase()=="content-type"),ue=l.FormData&&p instanceof l.FormData,!(Array.prototype.indexOf.call(nf,S,void 0)>=0)||H||ue||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ee,Xe]of R)this.g.setRequestHeader(Ee,Xe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(p),this.v=!1}catch(Ee){ll(this,Ee)}};function ll(p,S){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=S,p.o=5,af(p),oi(p)}function af(p){p.A||(p.A=!0,Qe(p,"complete"),Qe(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=p||7,Qe(this,"complete"),Qe(this,"abort"),oi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),oi(this,!0)),nr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?cl(this):this.Xa())},t.Xa=function(){cl(this)};function cl(p){if(p.h&&typeof i<"u"){if(p.v&&cs(p)==4)setTimeout(p.Ca.bind(p),0);else if(Qe(p,"readystatechange"),cs(p)==4){p.h=!1;try{const Ee=p.ca();e:switch(Ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var R;if(!(R=S)){var H;if(H=Ee===0){let Xe=String(p.D).match(Wi)[1]||null;!Xe&&l.self&&l.self.location&&(Xe=l.self.location.protocol.slice(0,-1)),H=!ks.test(Xe?Xe.toLowerCase():"")}R=H}if(R)Qe(p,"complete"),Qe(p,"success");else{p.o=6;try{var ue=cs(p)>2?p.g.statusText:""}catch{ue=""}p.l=ue+" ["+p.ca()+"]",af(p)}}finally{oi(p)}}}}function oi(p,S){if(p.g){p.m&&(clearTimeout(p.m),p.m=null);const R=p.g;p.g=null,S||Qe(p,"ready");try{R.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function cs(p){return p.g?p.g.readyState:0}t.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(p){if(this.g){var S=this.g.responseText;return p&&S.indexOf(p)==0&&(S=S.substring(p.length)),Zn(S)}};function gn(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.F){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function li(p){const S={};p=(p.g&&cs(p)>=2&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let H=0;H<p.length;H++){if(j(p[H]))continue;var R=L(p[H]);const ue=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const Ee=S[ue]||[];S[ue]=Ee,Ee.push(R)}Fe(S,function(H){return H.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Rs(p,S,R){return R&&R.internalChannelParams&&R.internalChannelParams[p]||S}function Zi(p){this.za=0,this.i=[],this.j=new ma,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Rs("failFast",!1,p),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Rs("baseRetryDelayMs",5e3,p),this.Za=Rs("retryDelaySeedMs",1e4,p),this.Ta=Rs("forwardChannelMaxRetries",2,p),this.va=Rs("forwardChannelRequestTimeoutMs",2e4,p),this.ma=p&&p.xmlHttpFactory||void 0,this.Ua=p&&p.Rb||void 0,this.Aa=p&&p.useFetchStreams||!1,this.O=void 0,this.L=p&&p.supportsCrossDomainXhr||!1,this.M="",this.h=new $t(p&&p.concurrentRequestLimit),this.Ba=new Qi,this.S=p&&p.fastHandshake||!1,this.R=p&&p.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=p&&p.Pb||!1,p&&p.ua&&this.j.ua(),p&&p.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&p&&p.detectBufferingProxy||!1,this.ia=void 0,p&&p.longPollingTimeout&&p.longPollingTimeout>0&&(this.ia=p.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Zi.prototype,t.ka=8,t.I=1,t.connect=function(p,S,R,H){kr(0),this.W=p,this.H=S||{},R&&H!==void 0&&(this.H.OSID=R,this.H.OAID=H),this.F=this.X,this.J=L0(this,null,this.W),Ds(this)};function sf(p){if(vc(p),p.I==3){var S=p.V++,R=Hr(p.J);if(Yt(R,"SID",p.M),Yt(R,"RID",S),Yt(R,"TYPE","terminate"),ul(p,R),S=new K(p,p.j,S),S.M=2,S.A=al(Hr(R)),R=!1,l.navigator&&l.navigator.sendBeacon)try{R=l.navigator.sendBeacon(S.A.toString(),"")}catch{}!R&&l.Image&&(new Image().src=S.A,R=!0),R||(S.g=V0(S.j,null),S.g.ea(S.A)),S.F=Date.now(),ve(S)}P0(p)}function eo(p){p.g&&(lf(p),p.g.cancel(),p.g=null)}function vc(p){eo(p),p.v&&(l.clearTimeout(p.v),p.v=null),_c(p),p.h.cancel(),p.m&&(typeof p.m=="number"&&l.clearTimeout(p.m),p.m=null)}function Ds(p){if(!Kt(p.h)&&!p.m){p.m=!0;var S=p.Ea;Y||b(),W||(Y(),W=!0),N.add(S,p),p.D=0}}function yc(p,S){return cr(p.h)>=p.h.j-(p.m?1:0)?!1:p.m?(p.i=S.G.concat(p.i),!0):p.I==1||p.I==2||p.D>=(p.Sa?0:p.Ta)?!1:(p.m=Ra(h(p.Ea,p,S),M0(p,p.D)),p.D++,!0)}t.Ea=function(p){if(this.m)if(this.m=null,this.I==1){if(!p){this.V=Math.floor(Math.random()*1e5),p=this.V++;const ue=new K(this,this.j,p);let Ee=this.o;if(this.U&&(Ee?(Ee=ee(Ee),Q(Ee,this.U)):Ee=this.U),this.u!==null||this.R||(ue.J=Ee,Ee=null),this.S)e:{for(var S=0,R=0;R<this.i.length;R++){t:{var H=this.i[R];if("__data__"in H.map&&(H=H.map.__data__,typeof H=="string")){H=H.length;break t}H=void 0}if(H===void 0)break;if(S+=H,S>4096){S=R;break e}if(S===4096||R===this.i.length-1){S=R+1;break e}}S=1e3}else S=1e3;S=D0(this,ue,S),R=Hr(this.J),Yt(R,"RID",p),Yt(R,"CVER",22),this.G&&Yt(R,"X-HTTP-Session-Id",this.G),ul(this,R),Ee&&(this.R?S="headers="+as(Fa(Ee))+"&"+S:this.u&&ol(R,this.u,Ee)),ss(this.h,ue),this.Ra&&Yt(R,"TYPE","init"),this.S?(Yt(R,"$req",S),Yt(R,"SID","null"),ue.U=!0,Z(ue,R,null)):Z(ue,R,S),this.I=2}}else this.I==3&&(p?of(this,p):this.i.length==0||Kt(this.h)||of(this))};function of(p,S){var R;S?R=S.l:R=p.V++;const H=Hr(p.J);Yt(H,"SID",p.M),Yt(H,"RID",R),Yt(H,"AID",p.K),ul(p,H),p.u&&p.o&&ol(H,p.u,p.o),R=new K(p,p.j,R,p.D+1),p.u===null&&(R.J=p.o),S&&(p.i=S.G.concat(p.i)),S=D0(p,R,1e3),R.H=Math.round(p.va*.5)+Math.round(p.va*.5*Math.random()),ss(p.h,R),Z(R,H,S)}function ul(p,S){p.H&&ie(p.H,function(R,H){Yt(S,H,R)}),p.l&&ie({},function(R,H){Yt(S,H,R)})}function D0(p,S,R){R=Math.min(p.i.length,R);const H=p.l?h(p.l.Ka,p.l,p):null;e:{var ue=p.i;let yt=-1;for(;;){const Pr=["count="+R];yt==-1?R>0?(yt=ue[0].g,Pr.push("ofs="+yt)):yt=0:Pr.push("ofs="+yt);let Gt=!0;for(let _r=0;_r<R;_r++){var Ee=ue[_r].g;const Oa=ue[_r].map;if(Ee-=yt,Ee<0)yt=Math.max(0,ue[_r].g-100),Gt=!1;else try{Ee="req"+Ee+"_"||"";try{var Xe=Oa instanceof Map?Oa:Object.entries(Oa);for(const[Fs,us]of Xe){let fs=us;u(us)&&(fs=yr(us)),Pr.push(Ee+Fs+"="+encodeURIComponent(fs))}}catch(Fs){throw Pr.push(Ee+"type="+encodeURIComponent("_badmap")),Fs}}catch{H&&H(Oa)}}if(Gt){Xe=Pr.join("&");break e}}Xe=void 0}return p=p.i.splice(0,R),S.G=p,Xe}function I0(p){if(!p.g&&!p.v){p.Y=1;var S=p.Da;Y||b(),W||(Y(),W=!0),N.add(S,p),p.A=0}}function fl(p){return p.g||p.v||p.A>=3?!1:(p.Y++,p.v=Ra(h(p.Da,p),M0(p,p.A)),p.A++,!0)}t.Da=function(){if(this.v=null,F0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var p=4*this.T;this.j.info("BP detection timer enabled: "+p),this.B=Ra(h(this.Wa,this),p)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,kr(10),eo(this),F0(this))};function lf(p){p.B!=null&&(l.clearTimeout(p.B),p.B=null)}function F0(p){p.g=new K(p,p.j,"rpc",p.Y),p.u===null&&(p.g.J=p.o),p.g.P=0;var S=Hr(p.na);Yt(S,"RID","rpc"),Yt(S,"SID",p.M),Yt(S,"AID",p.K),Yt(S,"CI",p.F?"0":"1"),!p.F&&p.ia&&Yt(S,"TO",p.ia),Yt(S,"TYPE","xmlhttp"),ul(p,S),p.u&&p.o&&ol(S,p.u,p.o),p.O&&(p.g.H=p.O);var R=p.g;p=p.ba,R.M=1,R.A=al(Hr(S)),R.u=null,R.R=!0,de(R,p)}t.Va=function(){this.C!=null&&(this.C=null,eo(this),fl(this),kr(19))};function _c(p){p.C!=null&&(l.clearTimeout(p.C),p.C=null)}function O0(p,S){var R=null;if(p.g==S){_c(p),lf(p),p.g=null;var H=2}else if(Cn(p.h,S))R=S.G,is(p.h,S),H=1;else return;if(p.I!=0){if(S.o)if(H==1){R=S.u?S.u.length:0,S=Date.now()-S.F;var ue=p.D;H=ti(),Qe(H,new qn(H,R)),Ds(p)}else I0(p);else if(ue=S.m,ue==3||ue==0&&S.X>0||!(H==1&&yc(p,S)||H==2&&fl(p)))switch(R&&R.length>0&&(S=p.h,S.i=S.i.concat(R)),ue){case 1:Is(p,5);break;case 4:Is(p,10);break;case 3:Is(p,6);break;default:Is(p,2)}}}function M0(p,S){let R=p.Qa+Math.floor(Math.random()*p.Za);return p.isActive()||(R*=2),R*S}function Is(p,S){if(p.j.info("Error code "+S),S==2){var R=h(p.bb,p),H=p.Ua;const ue=!H;H=new ga(H||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ln(H,"https"),al(H),ue?os(H.toString(),R):rf(H.toString(),R)}else kr(2);p.I=0,p.l&&p.l.pa(S),P0(p),vc(p)}t.bb=function(p){p?(this.j.info("Successfully pinged google.com"),kr(2)):(this.j.info("Failed to ping google.com"),kr(1))};function P0(p){if(p.I=0,p.ja=[],p.l){const S=pa(p.h);(S.length!=0||p.i.length!=0)&&(w(p.ja,S),w(p.ja,p.i),p.h.i.length=0,E(p.i),p.i.length=0),p.l.oa()}}function L0(p,S,R){var H=R instanceof ga?Hr(R):new ga(R);if(H.g!="")S&&(H.g=S+"."+H.g),Xi(H,H.u);else{var ue=l.location;H=ue.protocol,S=S?S+"."+ue.hostname:ue.hostname,ue=+ue.port;const Ee=new ga(null);H&&ln(Ee,H),S&&(Ee.g=S),ue&&Xi(Ee,ue),R&&(Ee.h=R),H=Ee}return R=p.G,S=p.wa,R&&S&&Yt(H,R,S),Yt(H,"VER",p.ka),ul(p,H),H}function V0(p,S,R){if(S&&!p.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=p.Aa&&!p.ma?new nr(new Cs({ab:R})):new nr(p.ma),S.Fa(p.L),S}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function B0(){}t=B0.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function to(){}to.prototype.g=function(p,S){return new Wn(p,S)};function Wn(p,S){Be.call(this),this.g=new Zi(S),this.l=p,this.h=S&&S.messageUrlParams||null,p=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(p?p["X-WebChannel-Content-Type"]=S.messageContentType:p={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(p?p["X-WebChannel-Client-Profile"]=S.sa:p={"X-WebChannel-Client-Profile":S.sa}),this.g.U=p,(p=S&&S.Qb)&&!j(p)&&(this.g.u=p),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!j(S)&&(this.g.G=S,p=this.h,p!==null&&S in p&&(p=this.h,S in p&&delete p[S])),this.j=new ci(this)}x(Wn,Be),Wn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Wn.prototype.close=function(){sf(this.g)},Wn.prototype.o=function(p){var S=this.g;if(typeof p=="string"){var R={};R.__data__=p,p=R}else this.v&&(R={},R.__data__=yr(p),p=R);S.i.push(new tt(S.Ya++,p)),S.I==3&&Ds(S)},Wn.prototype.N=function(){this.g.l=null,delete this.j,sf(this.g),delete this.g,Wn.Z.N.call(this)};function j0(p){hr.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var S=p.__sm__;if(S){e:{for(const R in S){p=R;break e}p=void 0}(this.i=p)&&(p=this.i,S=S!==null&&p in S?S[p]:void 0),this.data=S}else this.data=p}x(j0,hr);function U0(){Gn.call(this),this.status=1}x(U0,Gn);function ci(p){this.g=p}x(ci,B0),ci.prototype.ra=function(){Qe(this.g,"a")},ci.prototype.qa=function(p){Qe(this.g,new j0(p))},ci.prototype.pa=function(p){Qe(this.g,new U0)},ci.prototype.oa=function(){Qe(this.g,"b")},to.prototype.createWebChannel=to.prototype.g,Wn.prototype.send=Wn.prototype.o,Wn.prototype.open=Wn.prototype.m,Wn.prototype.close=Wn.prototype.close,qR=function(){return new to},GR=function(){return ti()},HR=wr,Iv={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ai.NO_ERROR=0,ai.TIMEOUT=8,ai.HTTP_ERROR=6,Sm=ai,si.COMPLETE="complete",zR=si,pn.EventType=Ht,Ht.OPEN="a",Ht.CLOSE="b",Ht.ERROR="c",Ht.MESSAGE="d",Be.prototype.listen=Be.prototype.J,Zf=pn,nr.prototype.listenOnce=nr.prototype.K,nr.prototype.getLastError=nr.prototype.Ha,nr.prototype.getLastErrorCode=nr.prototype.ya,nr.prototype.getStatus=nr.prototype.ca,nr.prototype.getResponseJson=nr.prototype.La,nr.prototype.getResponseText=nr.prototype.la,nr.prototype.send=nr.prototype.ea,nr.prototype.setWithCredentials=nr.prototype.Fa,UR=nr}).apply(typeof cm<"u"?cm:typeof self<"u"?self:typeof window<"u"?window:{});const Qb="@firebase/firestore",Jb="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}On.UNAUTHENTICATED=new On(null),On.GOOGLE_CREDENTIALS=new On("google-credentials-uid"),On.FIRST_PARTY=new On("first-party-uid"),On.MOCK_USER=new On("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hu="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec=new A_("@firebase/firestore");function tu(){return ec.logLevel}function Ze(t,...e){if(ec.logLevel<=Dt.DEBUG){const r=e.map(V_);ec.debug(`Firestore (${Hu}): ${t}`,...r)}}function ji(t,...e){if(ec.logLevel<=Dt.ERROR){const r=e.map(V_);ec.error(`Firestore (${Hu}): ${t}`,...r)}}function Nu(t,...e){if(ec.logLevel<=Dt.WARN){const r=e.map(V_);ec.warn(`Firestore (${Hu}): ${t}`,...r)}}function V_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(r){return JSON.stringify(r)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,WR(t,n,r)}function WR(t,e,r){let n=`FIRESTORE (${Hu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ji(n),new Error(n)}function Xt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||WR(e,a,n)}function xt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends qi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vo{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(On.UNAUTHENTICATED)))}shutdown(){}}class oQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class lQ{constructor(e){this.t=e,this.currentUser=On.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xt(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let i=new Vo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Vo,e.enqueueRetryable((()=>a(this.currentUser)))};const l=()=>{const f=i;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},u=f=>{Ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Vo)}}),0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xt(typeof n.accessToken=="string",31837,{l:n}),new XR(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string",2055,{h:e}),new On(e)}}class cQ{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=On.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class uQ{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new cQ(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(On.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Zb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fQ{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Xt(this.o===void 0,3512);const n=i=>{i.error!=null&&Ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const l=i.token!==this.m;return this.m=i.token,Ze("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const a=i=>{Ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>a(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?a(i):Ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Zb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Xt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Zb(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hQ(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=hQ(40);for(let i=0;i<a.length;++i)n.length<20&&a[i]<r&&(n+=e.charAt(a[i]%62))}return n}}function It(t,e){return t<e?-1:t>e?1:0}function Fv(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),i=e.charAt(n);if(a!==i)return Ox(a)===Ox(i)?It(a,i):Ox(a)?1:-1}return It(t.length,e.length)}const dQ=55296,mQ=57343;function Ox(t){const e=t.charCodeAt(0);return e>=dQ&&e<=mQ}function Cu(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e4="__name__";class Us{constructor(e,r,n){r===void 0?r=0:r>e.length&&ut(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ut(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Us.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Us?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const i=Us.compareSegments(e.get(a),r.get(a));if(i!==0)return i}return It(e.length,r.length)}static compareSegments(e,r){const n=Us.isNumericId(e),a=Us.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Us.extractNumericId(e).compare(Us.extractNumericId(r)):Fv(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Lo.fromString(e.substring(4,e.length-2))}}class Sr extends Us{construct(e,r,n){return new Sr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new nt(Ue.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new Sr(r)}static emptyPath(){return new Sr([])}}const pQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bn extends Us{construct(e,r,n){return new bn(e,r,n)}static isValidIdentifier(e){return pQ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===e4}static keyField(){return new bn([e4])}static fromServerFormat(e){const r=[];let n="",a=0;const i=()=>{if(n.length===0)throw new nt(Ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new nt(Ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new nt(Ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(i(),a++)}if(i(),l)throw new nt(Ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bn(r)}static emptyPath(){return new bn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.path=e}static fromPath(e){return new it(Sr.fromString(e))}static fromName(e){return new it(Sr.fromString(e).popFirst(5))}static empty(){return new it(Sr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Sr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Sr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new it(new Sr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gQ(t,e,r){if(!r)throw new nt(Ue.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function xQ(t,e,r,n){if(e===!0&&n===!0)throw new nt(Ue.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function t4(t){if(!it.isDocumentKey(t))throw new nt(Ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $R(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function j_(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ut(12329,{type:typeof t})}function Kh(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new nt(Ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=j_(t);throw new nt(Ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(t,e){const r={typeString:t};return e&&(r.value=e),r}function T0(t,e){if(!$R(t))throw new nt(Ue.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(a&&typeof l!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(i!==void 0&&l!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new nt(Ue.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r4=-62135596800,n4=1e6;class gr{static now(){return gr.fromMillis(Date.now())}static fromDate(e){return gr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*n4);return new gr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new nt(Ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new nt(Ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<r4)throw new nt(Ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(Ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/n4}_compareTo(e){return this.seconds===e.seconds?It(this.nanoseconds,e.nanoseconds):It(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(T0(e,gr._jsonSchema))return new gr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-r4;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gr._jsonSchemaVersion="firestore/timestamp/1.0",gr._jsonSchema={type:Zr("string",gr._jsonSchemaVersion),seconds:Zr("number"),nanoseconds:Zr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{static fromTimestamp(e){return new pt(e)}static min(){return new pt(new gr(0,0))}static max(){return new pt(new gr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh=-1;function vQ(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=pt.fromTimestamp(n===1e9?new gr(r+1,0):new gr(r,n));return new qo(a,it.empty(),e)}function yQ(t){return new qo(t.readTime,t.key,Yh)}class qo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new qo(pt.min(),it.empty(),Yh)}static max(){return new qo(pt.max(),it.empty(),Yh)}}function _Q(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=it.comparator(t.documentKey,e.documentKey),r!==0?r:It(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EQ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class TQ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gu(t){if(t.code!==Ue.FAILED_PRECONDITION||t.message!==EQ)throw t;Ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ut(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Pe(((n,a)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,a)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Pe?r:Pe.resolve(r)}catch(r){return Pe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Pe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Pe.reject(r)}static resolve(e){return new Pe(((r,n)=>{r(e)}))}static reject(e){return new Pe(((r,n)=>{n(e)}))}static waitFor(e){return new Pe(((r,n)=>{let a=0,i=0,l=!1;e.forEach((u=>{++a,u.next((()=>{++i,l&&i===a&&r()}),(f=>n(f)))})),l=!0,i===a&&r()}))}static or(e){let r=Pe.resolve(!1);for(const n of e)r=r.next((a=>a?Pe.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,i)=>{n.push(r.call(this,a,i))})),this.waitFor(n)}static mapArray(e,r){return new Pe(((n,a)=>{const i=e.length,l=new Array(i);let u=0;for(let f=0;f<i;f++){const h=f;r(e[h]).next((m=>{l[h]=m,++u,u===i&&n(l)}),(m=>a(m)))}}))}static doWhile(e,r){return new Pe(((n,a)=>{const i=()=>{e()===!0?r().next((()=>{i()}),a):n()};i()}))}}function wQ(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function qu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Up.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U_=-1;function zp(t){return t==null}function up(t){return t===0&&1/t==-1/0}function SQ(t){return typeof t=="number"&&Number.isInteger(t)&&!up(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR="";function AQ(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=a4(e)),e=bQ(t.get(r),e);return a4(e)}function bQ(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const i=t.charAt(a);switch(i){case"\0":r+="";break;case KR:r+="";break;default:r+=i}}return r}function a4(t){return t+KR+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function lc(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function YR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,r){this.comparator=e,this.root=r||wn.EMPTY}insert(e,r){return new Cr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,wn.BLACK,null,null))}remove(e){return new Cr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new um(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new um(this.root,e,this.comparator,!1)}getReverseIterator(){return new um(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new um(this.root,e,this.comparator,!0)}}class um{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wn{constructor(e,r,n,a,i){this.key=e,this.value=r,this.color=n??wn.RED,this.left=a??wn.EMPTY,this.right=i??wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,i){return new wn(e??this.key,r??this.value,n??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const i=n(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,r,n),null):i===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return wn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ut(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ut(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ut(27949);return e+(this.isRed()?0:1)}}wn.EMPTY=null,wn.RED=!0,wn.BLACK=!1;wn.EMPTY=new class{constructor(){this.size=0}get key(){throw ut(57766)}get value(){throw ut(16141)}get color(){throw ut(16727)}get left(){throw ut(29726)}get right(){throw ut(36894)}copy(e,r,n,a,i){return this}insert(e,r,n){return new wn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.comparator=e,this.data=new Cr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new i4(this.data.getIterator())}getIteratorFrom(e){return new i4(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new sn(this.comparator);return r.data=e,r}}class i4{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new Ts([])}unionWith(e){let r=new sn(bn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ts(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Cu(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new QR("Invalid base64 string: "+i):i}})(e);return new Nn(r)}static fromUint8Array(e){const r=(function(a){let i="";for(let l=0;l<a.length;++l)i+=String.fromCharCode(a[l]);return i})(e);return new Nn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return It(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nn.EMPTY_BYTE_STRING=new Nn("");const NQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Wo(t){if(Xt(!!t,39018),typeof t=="string"){let e=0;const r=NQ.exec(t);if(Xt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:jr(t.seconds),nanos:jr(t.nanos)}}function jr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Xo(t){return typeof t=="string"?Nn.fromBase64String(t):Nn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR="server_timestamp",ZR="__type__",eD="__previous_value__",tD="__local_write_time__";function z_(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[ZR])==null?void 0:n.stringValue)===JR}function Hp(t){const e=t.mapValue.fields[eD];return z_(e)?Hp(e):e}function Qh(t){const e=Wo(t.mapValue.fields[tD].timestampValue);return new gr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CQ{constructor(e,r,n,a,i,l,u,f,h,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=i,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=h,this.isUsingEmulator=m}}const fp="(default)";class Jh{constructor(e,r){this.projectId=e,this.database=r||fp}static empty(){return new Jh("","")}get isDefaultDatabase(){return this.database===fp}isEqual(e){return e instanceof Jh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD="__type__",kQ="__max__",fm={mapValue:{}},nD="__vector__",hp="value";function $o(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?z_(t)?4:DQ(t)?9007199254740991:RQ(t)?10:11:ut(28295,{value:t})}function Qs(t,e){if(t===e)return!0;const r=$o(t);if(r!==$o(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qh(t).isEqual(Qh(e));case 3:return(function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const l=Wo(a.timestampValue),u=Wo(i.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,i){return Xo(a.bytesValue).isEqual(Xo(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,i){return jr(a.geoPointValue.latitude)===jr(i.geoPointValue.latitude)&&jr(a.geoPointValue.longitude)===jr(i.geoPointValue.longitude)})(t,e);case 2:return(function(a,i){if("integerValue"in a&&"integerValue"in i)return jr(a.integerValue)===jr(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const l=jr(a.doubleValue),u=jr(i.doubleValue);return l===u?up(l)===up(u):isNaN(l)&&isNaN(u)}return!1})(t,e);case 9:return Cu(t.arrayValue.values||[],e.arrayValue.values||[],Qs);case 10:case 11:return(function(a,i){const l=a.mapValue.fields||{},u=i.mapValue.fields||{};if(s4(l)!==s4(u))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(u[f]===void 0||!Qs(l[f],u[f])))return!1;return!0})(t,e);default:return ut(52216,{left:t})}}function Zh(t,e){return(t.values||[]).find((r=>Qs(r,e)))!==void 0}function ku(t,e){if(t===e)return 0;const r=$o(t),n=$o(e);if(r!==n)return It(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return It(t.booleanValue,e.booleanValue);case 2:return(function(i,l){const u=jr(i.integerValue||i.doubleValue),f=jr(l.integerValue||l.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(t,e);case 3:return o4(t.timestampValue,e.timestampValue);case 4:return o4(Qh(t),Qh(e));case 5:return Fv(t.stringValue,e.stringValue);case 6:return(function(i,l){const u=Xo(i),f=Xo(l);return u.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(i,l){const u=i.split("/"),f=l.split("/");for(let h=0;h<u.length&&h<f.length;h++){const m=It(u[h],f[h]);if(m!==0)return m}return It(u.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,l){const u=It(jr(i.latitude),jr(l.latitude));return u!==0?u:It(jr(i.longitude),jr(l.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return l4(t.arrayValue,e.arrayValue);case 10:return(function(i,l){var v,E,w,T;const u=i.fields||{},f=l.fields||{},h=(v=u[hp])==null?void 0:v.arrayValue,m=(E=f[hp])==null?void 0:E.arrayValue,x=It(((w=h==null?void 0:h.values)==null?void 0:w.length)||0,((T=m==null?void 0:m.values)==null?void 0:T.length)||0);return x!==0?x:l4(h,m)})(t.mapValue,e.mapValue);case 11:return(function(i,l){if(i===fm.mapValue&&l===fm.mapValue)return 0;if(i===fm.mapValue)return 1;if(l===fm.mapValue)return-1;const u=i.fields||{},f=Object.keys(u),h=l.fields||{},m=Object.keys(h);f.sort(),m.sort();for(let x=0;x<f.length&&x<m.length;++x){const v=Fv(f[x],m[x]);if(v!==0)return v;const E=ku(u[f[x]],h[m[x]]);if(E!==0)return E}return It(f.length,m.length)})(t.mapValue,e.mapValue);default:throw ut(23264,{he:r})}}function o4(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return It(t,e);const r=Wo(t),n=Wo(e),a=It(r.seconds,n.seconds);return a!==0?a:It(r.nanos,n.nanos)}function l4(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const i=ku(r[a],n[a]);if(i)return i}return It(r.length,n.length)}function Ru(t){return Ov(t)}function Ov(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=Wo(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Xo(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return it.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const i of r.values||[])a?a=!1:n+=",",n+=Ov(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",i=!0;for(const l of n)i?i=!1:a+=",",a+=`${l}:${Ov(r.fields[l])}`;return a+"}"})(t.mapValue):ut(61005,{value:t})}function Am(t){switch($o(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Hp(t);return e?16+Am(e):16;case 5:return 2*t.stringValue.length;case 6:return Xo(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,i)=>a+Am(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return lc(n.fields,((i,l)=>{a+=i.length+Am(l)})),a})(t.mapValue);default:throw ut(13486,{value:t})}}function Mv(t){return!!t&&"integerValue"in t}function H_(t){return!!t&&"arrayValue"in t}function c4(t){return!!t&&"nullValue"in t}function u4(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function bm(t){return!!t&&"mapValue"in t}function RQ(t){var r,n;return((n=(((r=t==null?void 0:t.mapValue)==null?void 0:r.fields)||{})[rD])==null?void 0:n.stringValue)===nD}function yh(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return lc(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=yh(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=yh(t.arrayValue.values[r]);return e}return{...t}}function DQ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===kQ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{constructor(e){this.value=e}static empty(){return new Ya({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!bm(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=yh(r)}setAll(e){let r=bn.emptyPath(),n={},a=[];e.forEach(((l,u)=>{if(!r.isImmediateParentOf(u)){const f=this.getFieldsMap(r);this.applyChanges(f,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=yh(l):a.push(u.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,a)}delete(e){const r=this.field(e.popLast());bm(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Qs(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];bm(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){lc(r,((a,i)=>e[a]=i));for(const a of n)delete e[a]}clone(){return new Ya(yh(this.value))}}function aD(t){const e=[];return lc(t.fields,((r,n)=>{const a=new bn([r]);if(bm(n)){const i=aD(n.mapValue).fields;if(i.length===0)e.push(a);else for(const l of i)e.push(a.child(l))}else e.push(a)})),new Ts(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,r,n,a,i,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=i,this.data=l,this.documentState=u}static newInvalidDocument(e){return new Ln(e,0,pt.min(),pt.min(),pt.min(),Ya.empty(),0)}static newFoundDocument(e,r,n,a){return new Ln(e,1,r,pt.min(),n,a,0)}static newNoDocument(e,r){return new Ln(e,2,r,pt.min(),pt.min(),Ya.empty(),0)}static newUnknownDocument(e,r){return new Ln(e,3,r,pt.min(),pt.min(),Ya.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ya.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ya.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,r){this.position=e,this.inclusive=r}}function f4(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const i=e[a],l=t.position[a];if(i.field.isKeyField()?n=it.comparator(it.fromName(l.referenceValue),r.key):n=ku(l,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function h4(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Qs(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e,r="asc"){this.field=e,this.dir=r}}function IQ(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{}class an extends sD{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new OQ(e,r,n):r==="array-contains"?new LQ(e,n):r==="in"?new VQ(e,n):r==="not-in"?new BQ(e,n):r==="array-contains-any"?new jQ(e,n):new an(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new MQ(e,n):new PQ(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(ku(r,this.value)):r!==null&&$o(this.value)===$o(r)&&this.matchesComparison(ku(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ut(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Js extends sD{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Js(e,r)}matches(e){return iD(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function iD(t){return t.op==="and"}function oD(t){return FQ(t)&&iD(t)}function FQ(t){for(const e of t.filters)if(e instanceof Js)return!1;return!0}function Pv(t){if(t instanceof an)return t.field.canonicalString()+t.op.toString()+Ru(t.value);if(oD(t))return t.filters.map((e=>Pv(e))).join(",");{const e=t.filters.map((r=>Pv(r))).join(",");return`${t.op}(${e})`}}function lD(t,e){return t instanceof an?(function(n,a){return a instanceof an&&n.op===a.op&&n.field.isEqual(a.field)&&Qs(n.value,a.value)})(t,e):t instanceof Js?(function(n,a){return a instanceof Js&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((i,l,u)=>i&&lD(l,a.filters[u])),!0):!1})(t,e):void ut(19439)}function cD(t){return t instanceof an?(function(r){return`${r.field.canonicalString()} ${r.op} ${Ru(r.value)}`})(t):t instanceof Js?(function(r){return r.op.toString()+" {"+r.getFilters().map(cD).join(" ,")+"}"})(t):"Filter"}class OQ extends an{constructor(e,r,n){super(e,r,n),this.key=it.fromName(n.referenceValue)}matches(e){const r=it.comparator(e.key,this.key);return this.matchesComparison(r)}}class MQ extends an{constructor(e,r){super(e,"in",r),this.keys=uD("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class PQ extends an{constructor(e,r){super(e,"not-in",r),this.keys=uD("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function uD(t,e){var r;return(((r=e.arrayValue)==null?void 0:r.values)||[]).map((n=>it.fromName(n.referenceValue)))}class LQ extends an{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return H_(r)&&Zh(r.arrayValue,this.value)}}class VQ extends an{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Zh(this.value.arrayValue,r)}}class BQ extends an{constructor(e,r){super(e,"not-in",r)}matches(e){if(Zh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!Zh(this.value.arrayValue,r)}}class jQ extends an{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!H_(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>Zh(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UQ{constructor(e,r=null,n=[],a=[],i=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=i,this.startAt=l,this.endAt=u,this.Te=null}}function d4(t,e=null,r=[],n=[],a=null,i=null,l=null){return new UQ(t,e,r,n,a,i,l)}function G_(t){const e=xt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>Pv(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),zp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>Ru(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>Ru(n))).join(",")),e.Te=r}return e.Te}function q_(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!IQ(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!lD(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!h4(t.startAt,e.startAt)&&h4(t.endAt,e.endAt)}function Lv(t){return it.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gp{constructor(e,r=null,n=[],a=[],i=null,l="F",u=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=i,this.limitType=l,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zQ(t,e,r,n,a,i,l,u){return new Gp(t,e,r,n,a,i,l,u)}function W_(t){return new Gp(t)}function m4(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function HQ(t){return t.collectionGroup!==null}function _h(t){const e=xt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new sn(bn.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((h=>{h.isInequality()&&(u=u.add(h.field))}))})),u})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new mp(i,n))})),r.has(bn.keyField().canonicalString())||e.Ie.push(new mp(bn.keyField(),n))}return e.Ie}function Ws(t){const e=xt(t);return e.Ee||(e.Ee=GQ(e,_h(t))),e.Ee}function GQ(t,e){if(t.limitType==="F")return d4(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const i=a.dir==="desc"?"asc":"desc";return new mp(a.field,i)}));const r=t.endAt?new dp(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new dp(t.startAt.position,t.startAt.inclusive):null;return d4(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Vv(t,e,r){return new Gp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function qp(t,e){return q_(Ws(t),Ws(e))&&t.limitType===e.limitType}function fD(t){return`${G_(Ws(t))}|lt:${t.limitType}`}function ru(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>cD(a))).join(", ")}]`),zp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>Ru(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>Ru(a))).join(",")),`Target(${n})`})(Ws(t))}; limitType=${t.limitType})`}function Wp(t,e){return e.isFoundDocument()&&(function(n,a){const i=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):it.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,a){for(const i of _h(n))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const i of n.filters)if(!i.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(l,u,f){const h=f4(l,u,f);return l.inclusive?h<=0:h<0})(n.startAt,_h(n),a)||n.endAt&&!(function(l,u,f){const h=f4(l,u,f);return l.inclusive?h>=0:h>0})(n.endAt,_h(n),a))})(t,e)}function qQ(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hD(t){return(e,r)=>{let n=!1;for(const a of _h(t)){const i=WQ(a,e,r);if(i!==0)return i;n=n||a.field.isKeyField()}return 0}}function WQ(t,e,r){const n=t.field.isKeyField()?it.comparator(e.key,r.key):(function(i,l,u){const f=l.data.field(i),h=u.data.field(i);return f!==null&&h!==null?ku(f,h):ut(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ut(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,i]of n)if(this.equalsFn(a,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){lc(this.inner,((r,n)=>{for(const[a,i]of n)e(a,i)}))}isEmpty(){return YR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XQ=new Cr(it.comparator);function Ui(){return XQ}const dD=new Cr(it.comparator);function eh(...t){let e=dD;for(const r of t)e=e.insert(r.key,r);return e}function mD(t){let e=dD;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Pl(){return Eh()}function pD(){return Eh()}function Eh(){return new cc((t=>t.toString()),((t,e)=>t.isEqual(e)))}const $Q=new Cr(it.comparator),KQ=new sn(it.comparator);function Ft(...t){let e=KQ;for(const r of t)e=e.add(r);return e}const YQ=new sn(It);function QQ(){return YQ}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:up(e)?"-0":e}}function gD(t){return{integerValue:""+t}}function JQ(t,e){return SQ(e)?gD(e):X_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(){this._=void 0}}function ZQ(t,e,r){return t instanceof pp?(function(a,i){const l={fields:{[ZR]:{stringValue:JR},[tD]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&z_(i)&&(i=Hp(i)),i&&(l.fields[eD]=i),{mapValue:l}})(r,e):t instanceof e0?vD(t,e):t instanceof t0?yD(t,e):(function(a,i){const l=xD(a,i),u=p4(l)+p4(a.Ae);return Mv(l)&&Mv(a.Ae)?gD(u):X_(a.serializer,u)})(t,e)}function eJ(t,e,r){return t instanceof e0?vD(t,e):t instanceof t0?yD(t,e):r}function xD(t,e){return t instanceof gp?(function(n){return Mv(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class pp extends Xp{}class e0 extends Xp{constructor(e){super(),this.elements=e}}function vD(t,e){const r=_D(e);for(const n of t.elements)r.some((a=>Qs(a,n)))||r.push(n);return{arrayValue:{values:r}}}class t0 extends Xp{constructor(e){super(),this.elements=e}}function yD(t,e){let r=_D(e);for(const n of t.elements)r=r.filter((a=>!Qs(a,n)));return{arrayValue:{values:r}}}class gp extends Xp{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function p4(t){return jr(t.integerValue||t.doubleValue)}function _D(t){return H_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function tJ(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof e0&&a instanceof e0||n instanceof t0&&a instanceof t0?Cu(n.elements,a.elements,Qs):n instanceof gp&&a instanceof gp?Qs(n.Ae,a.Ae):n instanceof pp&&a instanceof pp})(t.transform,e.transform)}class rJ{constructor(e,r){this.version=e,this.transformResults=r}}class Fi{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Fi}static exists(e){return new Fi(void 0,e)}static updateTime(e){return new Fi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class $p{}function ED(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new wD(t.key,Fi.none()):new w0(t.key,t.data,Fi.none());{const r=t.data,n=Ya.empty();let a=new sn(bn.comparator);for(let i of e.fields)if(!a.has(i)){let l=r.field(i);l===null&&i.length>1&&(i=i.popLast(),l=r.field(i)),l===null?n.delete(i):n.set(i,l),a=a.add(i)}return new uc(t.key,n,new Ts(a.toArray()),Fi.none())}}function nJ(t,e,r){t instanceof w0?(function(a,i,l){const u=a.value.clone(),f=x4(a.fieldTransforms,i,l.transformResults);u.setAll(f),i.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(t,e,r):t instanceof uc?(function(a,i,l){if(!Nm(a.precondition,i))return void i.convertToUnknownDocument(l.version);const u=x4(a.fieldTransforms,i,l.transformResults),f=i.data;f.setAll(TD(a)),f.setAll(u),i.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(t,e,r):(function(a,i,l){i.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,r)}function Th(t,e,r,n){return t instanceof w0?(function(i,l,u,f){if(!Nm(i.precondition,l))return u;const h=i.value.clone(),m=v4(i.fieldTransforms,f,l);return h.setAll(m),l.convertToFoundDocument(l.version,h).setHasLocalMutations(),null})(t,e,r,n):t instanceof uc?(function(i,l,u,f){if(!Nm(i.precondition,l))return u;const h=v4(i.fieldTransforms,f,l),m=l.data;return m.setAll(TD(i)),m.setAll(h),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((x=>x.field)))})(t,e,r,n):(function(i,l,u){return Nm(i.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(t,e,r)}function aJ(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),i=xD(n.transform,a||null);i!=null&&(r===null&&(r=Ya.empty()),r.set(n.field,i))}return r||null}function g4(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&Cu(n,a,((i,l)=>tJ(i,l)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class w0 extends $p{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class uc extends $p{constructor(e,r,n,a,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function TD(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function x4(t,e,r){const n=new Map;Xt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const i=t[a],l=i.transform,u=e.data.field(i.field);n.set(i.field,eJ(l,u,r[a]))}return n}function v4(t,e,r){const n=new Map;for(const a of t){const i=a.transform,l=r.data.field(a.field);n.set(a.field,ZQ(i,l,e))}return n}class wD extends $p{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sJ extends $p{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iJ{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(e.key)&&nJ(i,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Th(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Th(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=pD();return this.mutations.forEach((a=>{const i=e.get(a.key),l=i.overlayedDocument;let u=this.applyToLocalView(l,i.mutatedFields);u=r.has(a.key)?null:u;const f=ED(l,u);f!==null&&n.set(a.key,f),l.isValidDocument()||l.convertToNoDocument(pt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Ft())}isEqual(e){return this.batchId===e.batchId&&Cu(this.mutations,e.mutations,((r,n)=>g4(r,n)))&&Cu(this.baseMutations,e.baseMutations,((r,n)=>g4(r,n)))}}class $_{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Xt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return $Q})();const i=e.mutations;for(let l=0;l<i.length;l++)a=a.insert(i[l].key,n[l].version);return new $_(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oJ{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lJ{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kr,Mt;function cJ(t){switch(t){case Ue.OK:return ut(64938);case Ue.CANCELLED:case Ue.UNKNOWN:case Ue.DEADLINE_EXCEEDED:case Ue.RESOURCE_EXHAUSTED:case Ue.INTERNAL:case Ue.UNAVAILABLE:case Ue.UNAUTHENTICATED:return!1;case Ue.INVALID_ARGUMENT:case Ue.NOT_FOUND:case Ue.ALREADY_EXISTS:case Ue.PERMISSION_DENIED:case Ue.FAILED_PRECONDITION:case Ue.ABORTED:case Ue.OUT_OF_RANGE:case Ue.UNIMPLEMENTED:case Ue.DATA_LOSS:return!0;default:return ut(15467,{code:t})}}function SD(t){if(t===void 0)return ji("GRPC error has no .code"),Ue.UNKNOWN;switch(t){case Kr.OK:return Ue.OK;case Kr.CANCELLED:return Ue.CANCELLED;case Kr.UNKNOWN:return Ue.UNKNOWN;case Kr.DEADLINE_EXCEEDED:return Ue.DEADLINE_EXCEEDED;case Kr.RESOURCE_EXHAUSTED:return Ue.RESOURCE_EXHAUSTED;case Kr.INTERNAL:return Ue.INTERNAL;case Kr.UNAVAILABLE:return Ue.UNAVAILABLE;case Kr.UNAUTHENTICATED:return Ue.UNAUTHENTICATED;case Kr.INVALID_ARGUMENT:return Ue.INVALID_ARGUMENT;case Kr.NOT_FOUND:return Ue.NOT_FOUND;case Kr.ALREADY_EXISTS:return Ue.ALREADY_EXISTS;case Kr.PERMISSION_DENIED:return Ue.PERMISSION_DENIED;case Kr.FAILED_PRECONDITION:return Ue.FAILED_PRECONDITION;case Kr.ABORTED:return Ue.ABORTED;case Kr.OUT_OF_RANGE:return Ue.OUT_OF_RANGE;case Kr.UNIMPLEMENTED:return Ue.UNIMPLEMENTED;case Kr.DATA_LOSS:return Ue.DATA_LOSS;default:return ut(39323,{code:t})}}(Mt=Kr||(Kr={}))[Mt.OK=0]="OK",Mt[Mt.CANCELLED=1]="CANCELLED",Mt[Mt.UNKNOWN=2]="UNKNOWN",Mt[Mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mt[Mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mt[Mt.NOT_FOUND=5]="NOT_FOUND",Mt[Mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mt[Mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mt[Mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mt[Mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mt[Mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mt[Mt.ABORTED=10]="ABORTED",Mt[Mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mt[Mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mt[Mt.INTERNAL=13]="INTERNAL",Mt[Mt.UNAVAILABLE=14]="UNAVAILABLE",Mt[Mt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uJ(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fJ=new Lo([4294967295,4294967295],0);function y4(t){const e=uJ().encode(t),r=new jR;return r.update(e),new Uint8Array(r.digest())}function _4(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Lo([r,n],0),new Lo([a,i],0)]}class K_{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new th(`Invalid padding: ${r}`);if(n<0)throw new th(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new th(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new th(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Lo.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(Lo.fromNumber(n)));return a.compare(fJ)===1&&(a=new Lo([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=y4(e),[n,a]=_4(r);for(let i=0;i<this.hashCount;i++){const l=this.ye(n,a,i);if(!this.we(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),l=new K_(i,a,r);return n.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const r=y4(e),[n,a]=_4(r);for(let i=0;i<this.hashCount;i++){const l=this.ye(n,a,i);this.Se(l)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class th extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,r,n,a,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,S0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new Kp(pt.min(),a,new Cr(It),Ui(),Ft())}}class S0{constructor(e,r,n,a,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new S0(n,r,Ft(),Ft(),Ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class AD{constructor(e,r){this.targetId=e,this.Ce=r}}class bD{constructor(e,r,n=Nn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class E4{constructor(){this.ve=0,this.Fe=T4(),this.Me=Nn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ft(),r=Ft(),n=Ft();return this.Fe.forEach(((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ut(38017,{changeType:i})}})),new S0(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=T4()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Xt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class hJ{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ui(),this.Je=hm(),this.He=hm(),this.Ye=new Cr(It)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ut(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const i=a.target;if(Lv(i))if(n===0){const l=new it(i.path);this.et(r,l,Ln.newNoDocument(l,pt.min()))}else Xt(n===1,20013,{expectedCount:n});else{const l=this._t(r);if(l!==n){const u=this.ut(e),f=u?this.ct(u,e,l):1;if(f!==0){this.it(r);const h=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:i=0}=r;let l,u;try{l=Xo(n).toUint8Array()}catch(f){if(f instanceof QR)return Nu("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new K_(l,a,i)}catch(f){return Nu(f instanceof th?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((i=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(r,i,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((i,l)=>{const u=this.ot(l);if(u){if(i.current&&Lv(u.target)){const f=new it(u.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,Ln.newNoDocument(f,e))}i.Be&&(r.set(l,i.ke()),i.qe())}}));let n=Ft();this.He.forEach(((i,l)=>{let u=!0;l.forEachWhile((f=>{const h=this.ot(f);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(i))})),this.je.forEach(((i,l)=>l.setReadTime(e)));const a=new Kp(e,r,this.Ye,this.je,n);return this.je=Ui(),this.Je=hm(),this.He=hm(),this.Ye=new Cr(It),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new E4,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new sn(It),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new sn(It),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ze("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new E4),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function hm(){return new Cr(it.comparator)}function T4(){return new Cr(it.comparator)}const dJ={asc:"ASCENDING",desc:"DESCENDING"},mJ={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pJ={and:"AND",or:"OR"};class gJ{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Bv(t,e){return t.useProto3Json||zp(e)?e:{value:e}}function xp(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ND(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function xJ(t,e){return xp(t,e.toTimestamp())}function Xs(t){return Xt(!!t,49232),pt.fromTimestamp((function(r){const n=Wo(r);return new gr(n.seconds,n.nanos)})(t))}function Y_(t,e){return jv(t,e).canonicalString()}function jv(t,e){const r=(function(a){return new Sr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function CD(t){const e=Sr.fromString(t);return Xt(FD(e),10190,{key:e.toString()}),e}function Uv(t,e){return Y_(t.databaseId,e.path)}function Mx(t,e){const r=CD(e);if(r.get(1)!==t.databaseId.projectId)throw new nt(Ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new nt(Ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new it(RD(r))}function kD(t,e){return Y_(t.databaseId,e)}function vJ(t){const e=CD(t);return e.length===4?Sr.emptyPath():RD(e)}function zv(t){return new Sr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function RD(t){return Xt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function w4(t,e,r){return{name:Uv(t,e),fields:r.value.mapValue.fields}}function yJ(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ut(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=(function(h,m){return h.useProto3Json?(Xt(m===void 0||typeof m=="string",58123),Nn.fromBase64String(m||"")):(Xt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Nn.fromUint8Array(m||new Uint8Array))})(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(h){const m=h.code===void 0?Ue.UNKNOWN:SD(h.code);return new nt(m,h.message||"")})(l);r=new bD(n,a,i,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=Mx(t,n.document.name),i=Xs(n.document.updateTime),l=n.document.createTime?Xs(n.document.createTime):pt.min(),u=new Ya({mapValue:{fields:n.document.fields}}),f=Ln.newFoundDocument(a,i,l,u),h=n.targetIds||[],m=n.removedTargetIds||[];r=new Cm(h,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=Mx(t,n.document),i=n.readTime?Xs(n.readTime):pt.min(),l=Ln.newNoDocument(a,i),u=n.removedTargetIds||[];r=new Cm([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=Mx(t,n.document),i=n.removedTargetIds||[];r=new Cm([],i,a,null)}else{if(!("filter"in e))return ut(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:i}=n,l=new lJ(a,i),u=n.targetId;r=new AD(u,l)}}return r}function _J(t,e){let r;if(e instanceof w0)r={update:w4(t,e.key,e.value)};else if(e instanceof wD)r={delete:Uv(t,e.key)};else if(e instanceof uc)r={update:w4(t,e.key,e.data),updateMask:kJ(e.fieldMask)};else{if(!(e instanceof sJ))return ut(16599,{Vt:e.type});r={verify:Uv(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,l){const u=l.transform;if(u instanceof pp)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof e0)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof t0)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof gp)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw ut(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,i){return i.updateTime!==void 0?{updateTime:xJ(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ut(27497)})(t,e.precondition)),r}function EJ(t,e){return t&&t.length>0?(Xt(e!==void 0,14353),t.map((r=>(function(a,i){let l=a.updateTime?Xs(a.updateTime):Xs(i);return l.isEqual(pt.min())&&(l=Xs(i)),new rJ(l,a.transformResults||[])})(r,e)))):[]}function TJ(t,e){return{documents:[kD(t,e.path)]}}function wJ(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=kD(t,a);const i=(function(h){if(h.length!==0)return ID(Js.create(h,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const l=(function(h){if(h.length!==0)return h.map((m=>(function(v){return{field:nu(v.field),direction:bJ(v.dir)}})(m)))})(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=Bv(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:r,parent:a}}function SJ(t){let e=vJ(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Xt(n===1,65062);const m=r.from[0];m.allDescendants?a=m.collectionId:e=e.child(m.collectionId)}let i=[];r.where&&(i=(function(x){const v=DD(x);return v instanceof Js&&oD(v)?v.getFilters():[v]})(r.where));let l=[];r.orderBy&&(l=(function(x){return x.map((v=>(function(w){return new mp(au(w.field),(function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(v)))})(r.orderBy));let u=null;r.limit&&(u=(function(x){let v;return v=typeof x=="object"?x.value:x,zp(v)?null:v})(r.limit));let f=null;r.startAt&&(f=(function(x){const v=!!x.before,E=x.values||[];return new dp(E,v)})(r.startAt));let h=null;return r.endAt&&(h=(function(x){const v=!x.before,E=x.values||[];return new dp(E,v)})(r.endAt)),zQ(e,a,l,i,u,"F",f,h)}function AJ(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ut(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function DD(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=au(r.unaryFilter.field);return an.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=au(r.unaryFilter.field);return an.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=au(r.unaryFilter.field);return an.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=au(r.unaryFilter.field);return an.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ut(61313);default:return ut(60726)}})(t):t.fieldFilter!==void 0?(function(r){return an.create(au(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ut(58110);default:return ut(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Js.create(r.compositeFilter.filters.map((n=>DD(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ut(1026)}})(r.compositeFilter.op))})(t):ut(30097,{filter:t})}function bJ(t){return dJ[t]}function NJ(t){return mJ[t]}function CJ(t){return pJ[t]}function nu(t){return{fieldPath:t.canonicalString()}}function au(t){return bn.fromServerFormat(t.fieldPath)}function ID(t){return t instanceof an?(function(r){if(r.op==="=="){if(u4(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NAN"}};if(c4(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(u4(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NOT_NAN"}};if(c4(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nu(r.field),op:NJ(r.op),value:r.value}}})(t):t instanceof Js?(function(r){const n=r.getFilters().map((a=>ID(a)));return n.length===1?n[0]:{compositeFilter:{op:CJ(r.op),filters:n}}})(t):ut(54877,{filter:t})}function kJ(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function FD(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,r,n,a,i=pt.min(),l=pt.min(),u=Nn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new Fo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RJ{constructor(e){this.yt=e}}function DJ(t){const e=SJ({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Vv(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(){this.Cn=new FJ}addToCollectionParentIndex(e,r){return this.Cn.add(r),Pe.resolve()}getCollectionParents(e,r){return Pe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Pe.resolve()}deleteFieldIndex(e,r){return Pe.resolve()}deleteAllFieldIndexes(e){return Pe.resolve()}createTargetIndexes(e,r){return Pe.resolve()}getDocumentsMatchingTarget(e,r){return Pe.resolve(null)}getIndexType(e,r){return Pe.resolve(0)}getFieldIndexes(e,r){return Pe.resolve([])}getNextCollectionGroupToUpdate(e){return Pe.resolve(null)}getMinOffset(e,r){return Pe.resolve(qo.min())}getMinOffsetFromCollectionGroup(e,r){return Pe.resolve(qo.min())}updateCollectionGroup(e,r,n){return Pe.resolve()}updateIndexEntries(e,r){return Pe.resolve()}}class FJ{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new sn(Sr.comparator),i=!a.has(n);return this.index[r]=a.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new sn(Sr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},OD=41943040;class la{static withCacheSize(e){return new la(e,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */la.DEFAULT_COLLECTION_PERCENTILE=10,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,la.DEFAULT=new la(OD,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),la.DISABLED=new la(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Du(0)}static cr(){return new Du(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4="LruGarbageCollector",OJ=1048576;function b4([t,e],[r,n]){const a=It(t,r);return a===0?It(e,n):a}class MJ{constructor(e){this.Ir=e,this.buffer=new sn(b4),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();b4(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class PJ{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ze(A4,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){qu(r)?Ze(A4,"Ignoring IndexedDB error during garbage collection: ",r):await Gu(r)}await this.Vr(3e5)}))}}class LJ{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Pe.resolve(Up.ce);const n=new MJ(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ze("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(S4)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),S4):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,i,l,u,f,h;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,l=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(n=x,u=Date.now(),this.removeTargets(e,n,r)))).next((x=>(i=x,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((x=>(h=Date.now(),tu()<=Dt.DEBUG&&Ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-m}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${i} targets in `+(f-u)+`ms
	Removed ${x} documents in `+(h-f)+`ms
Total Duration: ${h-m}ms`),Pe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:i,documentsRemoved:x}))))}}function VJ(t,e){return new LJ(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BJ{constructor(){this.changes=new cc((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ln.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Pe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jJ{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UJ{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&Th(n.mutation,a,Ts.empty(),gr.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Ft()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Ft()){const a=Pl();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((i=>{let l=eh();return i.forEach(((u,f)=>{l=l.insert(u,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,r){const n=Pl();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Ft())))}populateOverlays(e,r,n){const a=[];return n.forEach((i=>{r.has(i)||a.push(i)})),this.documentOverlayCache.getOverlays(e,a).next((i=>{i.forEach(((l,u)=>{r.set(l,u)}))}))}computeViews(e,r,n,a){let i=Ui();const l=Eh(),u=(function(){return Eh()})();return r.forEach(((f,h)=>{const m=n.get(h.key);a.has(h.key)&&(m===void 0||m.mutation instanceof uc)?i=i.insert(h.key,h):m!==void 0?(l.set(h.key,m.mutation.getFieldMask()),Th(m.mutation,h,m.mutation.getFieldMask(),gr.now())):l.set(h.key,Ts.empty())})),this.recalculateAndSaveOverlays(e,i).next((f=>(f.forEach(((h,m)=>l.set(h,m))),r.forEach(((h,m)=>u.set(h,new jJ(m,l.get(h)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Eh();let a=new Cr(((l,u)=>l-u)),i=Ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((l=>{for(const u of l)u.keys().forEach((f=>{const h=r.get(f);if(h===null)return;let m=n.get(f)||Ts.empty();m=u.applyToLocalView(h,m),n.set(f,m);const x=(a.get(u.batchId)||Ft()).add(f);a=a.insert(u.batchId,x)}))})).next((()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),h=f.key,m=f.value,x=pD();m.forEach((v=>{if(!i.has(v)){const E=ED(r.get(v),n.get(v));E!==null&&x.set(v,E),i=i.add(v)}})),l.push(this.documentOverlayCache.saveOverlays(e,h,x))}return Pe.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(l){return it.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):HQ(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((i=>{const l=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-i.size):Pe.resolve(Pl());let u=Yh,f=i;return l.next((h=>Pe.forEach(h,((m,x)=>(u<x.largestBatchId&&(u=x.largestBatchId),i.get(m)?Pe.resolve():this.remoteDocumentCache.getEntry(e,m).next((v=>{f=f.insert(m,v)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,f,h,Ft()))).next((m=>({batchId:u,changes:mD(m)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new it(r)).next((n=>{let a=eh();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const i=r.collectionGroup;let l=eh();return this.indexManager.getCollectionParents(e,i).next((u=>Pe.forEach(u,(f=>{const h=(function(x,v){return new Gp(v,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(r,f.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,a).next((m=>{m.forEach(((x,v)=>{l=l.insert(x,v)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((l=>(i=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,a)))).next((l=>{i.forEach(((f,h)=>{const m=h.getKey();l.get(m)===null&&(l=l.insert(m,Ln.newInvalidDocument(m)))}));let u=eh();return l.forEach(((f,h)=>{const m=i.get(f);m!==void 0&&Th(m.mutation,h,Ts.empty(),gr.now()),Wp(r,h)&&(u=u.insert(f,h))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zJ{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Pe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:Xs(a.createTime)}})(r)),Pe.resolve()}getNamedQuery(e,r){return Pe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:DJ(a.bundledQuery),readTime:Xs(a.readTime)}})(r)),Pe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HJ{constructor(){this.overlays=new Cr(it.comparator),this.qr=new Map}getOverlay(e,r){return Pe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Pl();return Pe.forEach(r,(a=>this.getOverlay(e,a).next((i=>{i!==null&&n.set(a,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,i)=>{this.St(e,r,i)})),Pe.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),Pe.resolve()}getOverlaysForCollection(e,r,n){const a=Pl(),i=r.length+1,l=new it(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const f=u.getNext().value,h=f.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&f.largestBatchId>n&&a.set(f.getKey(),f)}return Pe.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let i=new Cr(((h,m)=>h-m));const l=this.overlays.getIterator();for(;l.hasNext();){const h=l.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let m=i.get(h.largestBatchId);m===null&&(m=Pl(),i=i.insert(h.largestBatchId,m)),m.set(h.getKey(),h)}}const u=Pl(),f=i.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((h,m)=>u.set(h,m))),!(u.size()>=a)););return Pe.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new oJ(r,n));let i=this.qr.get(r);i===void 0&&(i=Ft(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GJ{constructor(){this.sessionToken=Nn.EMPTY_BYTE_STRING}getSessionToken(e){return Pe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Pe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(){this.Qr=new sn(fn.$r),this.Ur=new sn(fn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new fn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new fn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new it(new Sr([])),n=new fn(r,e),a=new fn(r,e+1),i=[];return this.Ur.forEachInRange([n,a],(l=>{this.Gr(l),i.push(l.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new it(new Sr([])),n=new fn(r,e),a=new fn(r,e+1);let i=Ft();return this.Ur.forEachInRange([n,a],(l=>{i=i.add(l.key)})),i}containsKey(e){const r=new fn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class fn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return it.comparator(e.key,r.key)||It(e.Yr,r.Yr)}static Kr(e,r){return It(e.Yr,r.Yr)||it.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qJ{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new sn(fn.$r)}checkEmpty(e){return Pe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new iJ(i,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Zr=this.Zr.add(new fn(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Pe.resolve(l)}lookupMutationBatch(e,r){return Pe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),i=a<0?0:a;return Pe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Pe.resolve(this.mutationQueue.length===0?U_:this.tr-1)}getAllMutationBatches(e){return Pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new fn(r,0),a=new fn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,a],(l=>{const u=this.Xr(l.Yr);i.push(u)})),Pe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new sn(It);return r.forEach((a=>{const i=new fn(a,0),l=new fn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,l],(u=>{n=n.add(u.Yr)}))})),Pe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let i=n;it.isDocumentKey(i)||(i=i.child(""));const l=new fn(new it(i),0);let u=new sn(It);return this.Zr.forEachWhile((f=>{const h=f.key.path;return!!n.isPrefixOf(h)&&(h.length===a&&(u=u.add(f.Yr)),!0)}),l),Pe.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){Xt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Pe.forEach(r.mutations,(a=>{const i=new fn(a.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new fn(r,0),a=this.Zr.firstAfterOrEqual(n);return Pe.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WJ{constructor(e){this.ri=e,this.docs=(function(){return new Cr(it.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),i=a?a.size:0,l=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Pe.resolve(n?n.document.mutableCopy():Ln.newInvalidDocument(r))}getEntries(e,r){let n=Ui();return r.forEach((a=>{const i=this.docs.get(a);n=n.insert(a,i?i.document.mutableCopy():Ln.newInvalidDocument(a))})),Pe.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let i=Ui();const l=r.path,u=new it(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:h,value:{document:m}}=f.getNext();if(!l.isPrefixOf(h.path))break;h.path.length>l.length+1||_Q(yQ(m),n)<=0||(a.has(m.key)||Wp(r,m))&&(i=i.insert(m.key,m.mutableCopy()))}return Pe.resolve(i)}getAllFromCollectionGroup(e,r,n,a){ut(9500)}ii(e,r){return Pe.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new XJ(this)}getSize(e){return Pe.resolve(this.size)}}class XJ extends BJ{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),Pe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $J{constructor(e){this.persistence=e,this.si=new cc((r=>G_(r)),q_),this.lastRemoteSnapshotVersion=pt.min(),this.highestTargetId=0,this.oi=0,this._i=new Q_,this.targetCount=0,this.ai=Du.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),Pe.resolve()}getLastRemoteSnapshotVersion(e){return Pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Pe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Pe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new Du(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Pe.resolve()}updateTargetData(e,r){return this.Pr(r),Pe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Pe.resolve()}removeTargets(e,r,n){let a=0;const i=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(l),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),Pe.waitFor(i).next((()=>a))}getTargetCount(e){return Pe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Pe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Pe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,i=[];return a&&r.forEach((l=>{i.push(a.markPotentiallyOrphaned(e,l))})),Pe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Pe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Pe.resolve(n)}containsKey(e,r){return Pe.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,r){this.ui={},this.overlays={},this.ci=new Up(0),this.li=!1,this.li=!0,this.hi=new GJ,this.referenceDelegate=e(this),this.Pi=new $J(this),this.indexManager=new IJ,this.remoteDocumentCache=(function(a){return new WJ(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new RJ(r),this.Ii=new zJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new HJ,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new qJ(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ze("MemoryPersistence","Starting transaction:",e);const a=new KJ(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((i=>this.referenceDelegate.di(a).next((()=>i)))).toPromise().then((i=>(a.raiseOnCommittedEvent(),i)))}Ai(e,r){return Pe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class KJ extends TQ{constructor(e){super(),this.currentSequenceNumber=e}}class J_{constructor(e){this.persistence=e,this.Ri=new Q_,this.Vi=null}static mi(e){return new J_(e)}get fi(){if(this.Vi)return this.Vi;throw ut(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Pe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Pe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Pe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pe.forEach(this.fi,(n=>{const a=it.fromPath(n);return this.gi(e,a).next((i=>{i||r.removeEntry(a,pt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Pe.or([()=>Pe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class vp{constructor(e,r){this.persistence=e,this.pi=new cc((n=>AQ(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=VJ(this,r)}static mi(e,r){return new vp(e,r)}Ei(){}di(e){return Pe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Pe.forEach(this.pi,((n,a)=>this.br(e,n,a).next((i=>i?Pe.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),i=a.newChangeBuffer();return a.ii(e,(l=>this.br(e,l,r).next((u=>{u||(n++,i.removeEntry(l,pt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Pe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Pe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Pe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Pe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Am(e.data.value)),r}br(e,r,n){return Pe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return Pe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Ft(),a=Ft();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new Z_(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QJ{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return BX()?8:wQ(zn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const i={result:null};return this.ys(e,r).next((l=>{i.result=l})).next((()=>{if(!i.result)return this.ws(e,r,a,n).next((l=>{i.result=l}))})).next((()=>{if(i.result)return;const l=new YJ;return this.Ss(e,r,l).next((u=>{if(i.result=u,this.Vs)return this.bs(e,r,l,u.size)}))})).next((()=>i.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(tu()<=Dt.DEBUG&&Ze("QueryEngine","SDK will not create cache indexes for query:",ru(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Pe.resolve()):(tu()<=Dt.DEBUG&&Ze("QueryEngine","Query:",ru(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(tu()<=Dt.DEBUG&&Ze("QueryEngine","The SDK decides to create cache indexes for query:",ru(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ws(r))):Pe.resolve())}ys(e,r){if(m4(r))return Pe.resolve(null);let n=Ws(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=Vv(r,null,"F"),n=Ws(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const l=Ft(...i);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const h=this.Ds(r,u);return this.Cs(r,h,l,f.readTime)?this.ys(e,Vv(r,null,"F")):this.vs(e,h,r,f)}))))})))))}ws(e,r,n,a){return m4(r)||a.isEqual(pt.min())?Pe.resolve(null):this.ps.getDocuments(e,n).next((i=>{const l=this.Ds(r,i);return this.Cs(r,l,n,a)?Pe.resolve(null):(tu()<=Dt.DEBUG&&Ze("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ru(r)),this.vs(e,l,r,vQ(a,Yh)).next((u=>u)))}))}Ds(e,r){let n=new sn(hD(e));return r.forEach(((a,i)=>{Wp(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Ss(e,r,n){return tu()<=Dt.DEBUG&&Ze("QueryEngine","Using full collection scan to execute query:",ru(r)),this.ps.getDocumentsMatchingQuery(e,r,qo.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((i=>(r.forEach((l=>{i=i.insert(l.key,l)})),i)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2="LocalStore",JJ=3e8;class ZJ{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new Cr(It),this.xs=new cc((i=>G_(i)),q_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new UJ(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function eZ(t,e,r,n){return new ZJ(t,e,r,n)}async function PD(t,e){const r=xt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((i=>(a=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const l=[],u=[];let f=Ft();for(const h of a){l.push(h.batchId);for(const m of h.mutations)f=f.add(m.key)}for(const h of i){u.push(h.batchId);for(const m of h.mutations)f=f.add(m.key)}return r.localDocuments.getDocuments(n,f).next((h=>({Ls:h,removedBatchIds:l,addedBatchIds:u})))}))}))}function tZ(t,e){const r=xt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,h,m){const x=h.batch,v=x.keys();let E=Pe.resolve();return v.forEach((w=>{E=E.next((()=>m.getEntry(f,w))).next((T=>{const A=h.docVersions.get(w);Xt(A!==null,48541),T.version.compareTo(A)<0&&(x.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),m.addEntry(T)))}))})),E.next((()=>u.mutationQueue.removeMutationBatch(f,x)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=Ft();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(f=f.add(u.batch.mutations[h].key));return f})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function LD(t){const e=xt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function rZ(t,e){const r=xt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const l=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((m,x)=>{const v=a.get(x);if(!v)return;u.push(r.Pi.removeMatchingKeys(i,m.removedDocuments,x).next((()=>r.Pi.addMatchingKeys(i,m.addedDocuments,x))));let E=v.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(x)!==null?E=E.withResumeToken(Nn.EMPTY_BYTE_STRING,pt.min()).withLastLimboFreeSnapshotVersion(pt.min()):m.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(m.resumeToken,n)),a=a.insert(x,E),(function(T,A,I){return T.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=JJ?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0})(v,E,m)&&u.push(r.Pi.updateTargetData(i,E))}));let f=Ui(),h=Ft();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(i,m))})),u.push(nZ(i,l,e.documentUpdates).next((m=>{f=m.ks,h=m.qs}))),!n.isEqual(pt.min())){const m=r.Pi.getLastRemoteSnapshotVersion(i).next((x=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));u.push(m)}return Pe.waitFor(u).next((()=>l.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,f,h))).next((()=>f))})).then((i=>(r.Ms=a,i)))}function nZ(t,e,r){let n=Ft(),a=Ft();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let l=Ui();return r.forEach(((u,f)=>{const h=i.get(u);f.isFoundDocument()!==h.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(pt.min())?(e.removeEntry(u,f.readTime),l=l.insert(u,f)):!h.isValidDocument()||f.version.compareTo(h.version)>0||f.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(f),l=l.insert(u,f)):Ze(e2,"Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",f.version)})),{ks:l,qs:a}}))}function aZ(t,e){const r=xt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=U_),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function sZ(t,e){const r=xt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((i=>i?(a=i,Pe.resolve(a)):r.Pi.allocateTargetId(n).next((l=>(a=new Fo(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function Hv(t,e,r){const n=xt(t),a=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(l=>n.persistence.referenceDelegate.removeTarget(l,a)))}catch(l){if(!qu(l))throw l;Ze(e2,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function N4(t,e,r){const n=xt(t);let a=pt.min(),i=Ft();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,h,m){const x=xt(f),v=x.xs.get(m);return v!==void 0?Pe.resolve(x.Ms.get(v)):x.Pi.getTargetData(h,m)})(n,l,Ws(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((f=>{i=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,r?a:pt.min(),r?i:Ft()))).next((u=>(iZ(n,qQ(e),u),{documents:u,Qs:i})))))}function iZ(t,e,r){let n=t.Os.get(e)||pt.min();r.forEach(((a,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class C4{constructor(){this.activeTargetIds=QQ()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class oZ{constructor(){this.Mo=new C4,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new C4,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lZ{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4="ConnectivityMonitor";class R4{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ze(k4,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ze(k4,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dm=null;function Gv(){return dm===null?dm=(function(){return 268435456+Math.round(2147483648*Math.random())})():dm++,"0x"+dm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="RestConnection",cZ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class uZ{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===fp?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,i){const l=Gv(),u=this.zo(e,r.toUriEncodedString());Ze(Px,`Sending RPC '${e}' ${l}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,i);const{host:h}=new URL(u),m=ju(h);return this.Jo(e,u,f,n,m).then((x=>(Ze(Px,`Received RPC '${e}' ${l}: `,x),x)),(x=>{throw Nu(Px,`RPC '${e}' ${l} failed with error: `,x,"url: ",u,"request:",n),x}))}Ho(e,r,n,a,i,l){return this.Go(e,r,n,a,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Hu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,i)=>e[i]=a)),n&&n.headers.forEach(((a,i)=>e[i]=a))}zo(e,r){const n=cZ[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fZ{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="WebChannelConnection";class hZ extends uZ{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,i){const l=Gv();return new Promise(((u,f)=>{const h=new UR;h.setWithCredentials(!0),h.listenOnce(zR.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Sm.NO_ERROR:const x=h.getResponseJson();Ze(In,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(x)),u(x);break;case Sm.TIMEOUT:Ze(In,`RPC '${e}' ${l} timed out`),f(new nt(Ue.DEADLINE_EXCEEDED,"Request time out"));break;case Sm.HTTP_ERROR:const v=h.getStatus();if(Ze(In,`RPC '${e}' ${l} failed with status:`,v,"response text:",h.getResponseText()),v>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const w=E==null?void 0:E.error;if(w&&w.status&&w.message){const T=(function(I){const O=I.toLowerCase().replace(/_/g,"-");return Object.values(Ue).indexOf(O)>=0?O:Ue.UNKNOWN})(w.status);f(new nt(T,w.message))}else f(new nt(Ue.UNKNOWN,"Server responded with status "+h.getStatus()))}else f(new nt(Ue.UNAVAILABLE,"Connection failed."));break;default:ut(9055,{l_:e,streamId:l,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ze(In,`RPC '${e}' ${l} completed.`)}}));const m=JSON.stringify(a);Ze(In,`RPC '${e}' ${l} sending request:`,a),h.send(r,"POST",m,n,15)}))}T_(e,r,n){const a=Gv(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=qR(),u=GR(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(f.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const m=i.join("");Ze(In,`Creating RPC '${e}' stream ${a}: ${m}`,f);const x=l.createWebChannel(m,f);this.I_(x);let v=!1,E=!1;const w=new fZ({Yo:A=>{E?Ze(In,`Not sending because RPC '${e}' stream ${a} is closed:`,A):(v||(Ze(In,`Opening RPC '${e}' stream ${a} transport.`),x.open(),v=!0),Ze(In,`RPC '${e}' stream ${a} sending:`,A),x.send(A))},Zo:()=>x.close()}),T=(A,I,O)=>{A.listen(I,(D=>{try{O(D)}catch(q){setTimeout((()=>{throw q}),0)}}))};return T(x,Zf.EventType.OPEN,(()=>{E||(Ze(In,`RPC '${e}' stream ${a} transport opened.`),w.o_())})),T(x,Zf.EventType.CLOSE,(()=>{E||(E=!0,Ze(In,`RPC '${e}' stream ${a} transport closed`),w.a_(),this.E_(x))})),T(x,Zf.EventType.ERROR,(A=>{E||(E=!0,Nu(In,`RPC '${e}' stream ${a} transport errored. Name:`,A.name,"Message:",A.message),w.a_(new nt(Ue.UNAVAILABLE,"The operation could not be completed")))})),T(x,Zf.EventType.MESSAGE,(A=>{var I;if(!E){const O=A.data[0];Xt(!!O,16349);const D=O,q=(D==null?void 0:D.error)||((I=D[0])==null?void 0:I.error);if(q){Ze(In,`RPC '${e}' stream ${a} received error:`,q);const Y=q.status;let W=(function(k){const F=Kr[k];if(F!==void 0)return SD(F)})(Y),N=q.message;W===void 0&&(W=Ue.INTERNAL,N="Unknown error status: "+Y+" with message "+q.message),E=!0,w.a_(new nt(W,N)),x.close()}else Ze(In,`RPC '${e}' stream ${a} received:`,O),w.u_(O)}})),T(u,HR.STAT_EVENT,(A=>{A.stat===Iv.PROXY?Ze(In,`RPC '${e}' stream ${a} detected buffering proxy`):A.stat===Iv.NOPROXY&&Ze(In,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function Lx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(t){return new gJ(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e,r,n=1e3,a=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&Ze("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="PersistentStream";class BD{constructor(e,r,n,a,i,l,u,f){this.Mi=e,this.S_=n,this.b_=a,this.connection=i,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new VD(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ue.RESOURCE_EXHAUSTED?(ji(r.toString()),ji("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new nt(Ue.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ze(D4,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Ze(D4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dZ extends BD{constructor(e,r,n,a,i,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=yJ(this.serializer,e),n=(function(i){if(!("targetChange"in i))return pt.min();const l=i.targetChange;return l.targetIds&&l.targetIds.length?pt.min():l.readTime?Xs(l.readTime):pt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=zv(this.serializer),r.addTarget=(function(i,l){let u;const f=l.target;if(u=Lv(f)?{documents:TJ(i,f)}:{query:wJ(i,f).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=ND(i,l.resumeToken);const h=Bv(i,l.expectedCount);h!==null&&(u.expectedCount=h)}else if(l.snapshotVersion.compareTo(pt.min())>0){u.readTime=xp(i,l.snapshotVersion.toTimestamp());const h=Bv(i,l.expectedCount);h!==null&&(u.expectedCount=h)}return u})(this.serializer,e);const n=AJ(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=zv(this.serializer),r.removeTarget=e,this.q_(r)}}class mZ extends BD{constructor(e,r,n,a,i,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Xt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Xt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=EJ(e.writeResults,e.commitTime),n=Xs(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=zv(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>_J(this.serializer,n)))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pZ{}class gZ extends pZ{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new nt(Ue.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,l])=>this.connection.Go(e,jv(r,n),a,i,l))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new nt(Ue.UNKNOWN,i.toString())}))}Ho(e,r,n,a,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,jv(r,n),a,l,u,i))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new nt(Ue.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class xZ{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ji(r),this.aa=!1):Ze("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc="RemoteStore";class vZ{constructor(e,r,n,a,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{fc(this)&&(Ze(tc,"Restarting streams for network reachability change."),await(async function(f){const h=xt(f);h.Ea.add(4),await A0(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Qp(h)})(this))}))})),this.Ra=new xZ(n,a)}}async function Qp(t){if(fc(t))for(const e of t.da)await e(!0)}async function A0(t){for(const e of t.da)await e(!1)}function jD(t,e){const r=xt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),a2(r)?n2(r):Wu(r).O_()&&r2(r,e))}function t2(t,e){const r=xt(t),n=Wu(r);r.Ia.delete(e),n.O_()&&UD(r,e),r.Ia.size===0&&(n.O_()?n.L_():fc(r)&&r.Ra.set("Unknown"))}function r2(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Wu(t).Y_(e)}function UD(t,e){t.Va.Ue(e),Wu(t).Z_(e)}function n2(t){t.Va=new hJ({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Wu(t).start(),t.Ra.ua()}function a2(t){return fc(t)&&!Wu(t).x_()&&t.Ia.size>0}function fc(t){return xt(t).Ea.size===0}function zD(t){t.Va=void 0}async function yZ(t){t.Ra.set("Online")}async function _Z(t){t.Ia.forEach(((e,r)=>{r2(t,e)}))}async function EZ(t,e){zD(t),a2(t)?(t.Ra.ha(e),n2(t)):t.Ra.set("Unknown")}async function TZ(t,e,r){if(t.Ra.set("Online"),e instanceof bD&&e.state===2&&e.cause)try{await(async function(a,i){const l=i.cause;for(const u of i.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){Ze(tc,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await yp(t,n)}else if(e instanceof Cm?t.Va.Ze(e):e instanceof AD?t.Va.st(e):t.Va.tt(e),!r.isEqual(pt.min()))try{const n=await LD(t.localStore);r.compareTo(n)>=0&&await(function(i,l){const u=i.Va.Tt(l);return u.targetChanges.forEach(((f,h)=>{if(f.resumeToken.approximateByteSize()>0){const m=i.Ia.get(h);m&&i.Ia.set(h,m.withResumeToken(f.resumeToken,l))}})),u.targetMismatches.forEach(((f,h)=>{const m=i.Ia.get(f);if(!m)return;i.Ia.set(f,m.withResumeToken(Nn.EMPTY_BYTE_STRING,m.snapshotVersion)),UD(i,f);const x=new Fo(m.target,f,h,m.sequenceNumber);r2(i,x)})),i.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){Ze(tc,"Failed to raise snapshot:",n),await yp(t,n)}}async function yp(t,e,r){if(!qu(e))throw e;t.Ea.add(1),await A0(t),t.Ra.set("Offline"),r||(r=()=>LD(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ze(tc,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await Qp(t)}))}function HD(t,e){return e().catch((r=>yp(t,r,e)))}async function Jp(t){const e=xt(t),r=Ko(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:U_;for(;wZ(e);)try{const a=await aZ(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,SZ(e,a)}catch(a){await yp(e,a)}GD(e)&&qD(e)}function wZ(t){return fc(t)&&t.Ta.length<10}function SZ(t,e){t.Ta.push(e);const r=Ko(t);r.O_()&&r.X_&&r.ea(e.mutations)}function GD(t){return fc(t)&&!Ko(t).x_()&&t.Ta.length>0}function qD(t){Ko(t).start()}async function AZ(t){Ko(t).ra()}async function bZ(t){const e=Ko(t);for(const r of t.Ta)e.ea(r.mutations)}async function NZ(t,e,r){const n=t.Ta.shift(),a=$_.from(n,e,r);await HD(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await Jp(t)}async function CZ(t,e){e&&Ko(t).X_&&await(async function(n,a){if((function(l){return cJ(l)&&l!==Ue.ABORTED})(a.code)){const i=n.Ta.shift();Ko(n).B_(),await HD(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,a))),await Jp(n)}})(t,e),GD(t)&&qD(t)}async function I4(t,e){const r=xt(t);r.asyncQueue.verifyOperationInProgress(),Ze(tc,"RemoteStore received new credentials");const n=fc(r);r.Ea.add(3),await A0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await Qp(r)}async function kZ(t,e){const r=xt(t);e?(r.Ea.delete(2),await Qp(r)):e||(r.Ea.add(2),await A0(r),r.Ra.set("Unknown"))}function Wu(t){return t.ma||(t.ma=(function(r,n,a){const i=xt(r);return i.sa(),new dZ(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:yZ.bind(null,t),t_:_Z.bind(null,t),r_:EZ.bind(null,t),H_:TZ.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),a2(t)?n2(t):t.Ra.set("Unknown")):(await t.ma.stop(),zD(t))}))),t.ma}function Ko(t){return t.fa||(t.fa=(function(r,n,a){const i=xt(r);return i.sa(),new mZ(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:AZ.bind(null,t),r_:CZ.bind(null,t),ta:bZ.bind(null,t),na:NZ.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await Jp(t)):(await t.fa.stop(),t.Ta.length>0&&(Ze(tc,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e,r,n,a,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=i,this.deferred=new Vo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,i){const l=Date.now()+n,u=new s2(e,r,l,a,i);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(Ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function i2(t,e){if(ji("AsyncQueue",`${e}: ${t}`),qu(t))return new nt(Ue.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{static emptySet(e){return new yu(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||it.comparator(r.key,n.key):(r,n)=>it.comparator(r.key,n.key),this.keyedMap=eh(),this.sortedSet=new Cr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof yu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new yu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(){this.ga=new Cr(it.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ut(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class Iu{constructor(e,r,n,a,i,l,u,f,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=i,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,a,i){const l=[];return r.forEach((u=>{l.push({type:0,doc:u})})),new Iu(e,r,yu.emptySet(r),l,n,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RZ{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class DZ{constructor(){this.queries=O4(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=xt(r),i=a.queries;a.queries=O4(),i.forEach(((l,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new nt(Ue.ABORTED,"Firestore shutting down"))}}function O4(){return new cc((t=>fD(t)),qp)}async function IZ(t,e){const r=xt(t);let n=3;const a=e.query;let i=r.queries.get(a);i?!i.ba()&&e.Da()&&(n=2):(i=new RZ,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(a,!0);break;case 1:i.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=i2(l,`Initialization of query '${ru(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&o2(r)}async function FZ(t,e){const r=xt(t),n=e.query;let a=3;const i=r.queries.get(n);if(i){const l=i.Sa.indexOf(e);l>=0&&(i.Sa.splice(l,1),i.Sa.length===0?a=e.Da()?0:1:!i.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function OZ(t,e){const r=xt(t);let n=!1;for(const a of e){const i=a.query,l=r.queries.get(i);if(l){for(const u of l.Sa)u.Fa(a)&&(n=!0);l.wa=a}}n&&o2(r)}function MZ(t,e,r){const n=xt(t),a=n.queries.get(e);if(a)for(const i of a.Sa)i.onError(r);n.queries.delete(e)}function o2(t){t.Ca.forEach((e=>{e.next()}))}var qv,M4;(M4=qv||(qv={})).Ma="default",M4.Cache="cache";class PZ{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Iu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Iu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e){this.key=e}}class XD{constructor(e){this.key=e}}class LZ{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ft(),this.mutatedKeys=Ft(),this.eu=hD(e),this.tu=new yu(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new F4,a=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,h=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((m,x)=>{const v=a.get(m),E=Wp(this.query,x)?x:null,w=!!v&&this.mutatedKeys.has(v.key),T=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let A=!1;v&&E?v.data.isEqual(E.data)?w!==T&&(n.track({type:3,doc:E}),A=!0):this.su(v,E)||(n.track({type:2,doc:E}),A=!0,(f&&this.eu(E,f)>0||h&&this.eu(E,h)<0)&&(u=!0)):!v&&E?(n.track({type:0,doc:E}),A=!0):v&&!E&&(n.track({type:1,doc:v}),A=!0,(f||h)&&(u=!0)),A&&(E?(l=l.add(E),i=T?i.add(m):i.delete(m)):(l=l.delete(m),i=i.delete(m)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const m=this.query.limitType==="F"?l.last():l.first();l=l.delete(m.key),i=i.delete(m.key),n.track({type:1,doc:m})}return{tu:l,iu:n,Cs:u,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((m,x)=>(function(E,w){const T=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ut(20277,{Rt:A})}};return T(E)-T(w)})(m.type,x.type)||this.eu(m.doc,x.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,h=f!==this.Za;return this.Za=f,l.length!==0||h?{snapshot:new Iu(this.query,e.tu,i,l,e.mutatedKeys,f===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new F4,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ft(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new XD(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new WD(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Ft();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Iu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const l2="SyncEngine";class VZ{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class BZ{constructor(e){this.key=e,this.hu=!1}}class jZ{constructor(e,r,n,a,i,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new cc((u=>fD(u)),qp),this.Iu=new Map,this.Eu=new Set,this.du=new Cr(it.comparator),this.Au=new Map,this.Ru=new Q_,this.Vu={},this.mu=new Map,this.fu=Du.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function UZ(t,e,r=!0){const n=ZD(t);let a;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await $D(n,e,r,!0),a}async function zZ(t,e){const r=ZD(t);await $D(r,e,!0,!1)}async function $D(t,e,r,n){const a=await sZ(t.localStore,Ws(e)),i=a.targetId,l=t.sharedClientState.addLocalQueryTarget(i,r);let u;return n&&(u=await HZ(t,e,i,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&jD(t.remoteStore,a),u}async function HZ(t,e,r,n,a){t.pu=(x,v,E)=>(async function(T,A,I,O){let D=A.view.ru(I);D.Cs&&(D=await N4(T.localStore,A.query,!1).then((({documents:N})=>A.view.ru(N,D))));const q=O&&O.targetChanges.get(A.targetId),Y=O&&O.targetMismatches.get(A.targetId)!=null,W=A.view.applyChanges(D,T.isPrimaryClient,q,Y);return L4(T,A.targetId,W.au),W.snapshot})(t,x,v,E);const i=await N4(t.localStore,e,!0),l=new LZ(e,i.Qs),u=l.ru(i.documents),f=S0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),h=l.applyChanges(u,t.isPrimaryClient,f);L4(t,r,h.au);const m=new VZ(e,r,l);return t.Tu.set(e,m),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function GZ(t,e,r){const n=xt(t),a=n.Tu.get(e),i=n.Iu.get(a.targetId);if(i.length>1)return n.Iu.set(a.targetId,i.filter((l=>!qp(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Hv(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&t2(n.remoteStore,a.targetId),Wv(n,a.targetId)})).catch(Gu)):(Wv(n,a.targetId),await Hv(n.localStore,a.targetId,!0))}async function qZ(t,e){const r=xt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),t2(r.remoteStore,n.targetId))}async function WZ(t,e,r){const n=ZZ(t);try{const a=await(function(l,u){const f=xt(l),h=gr.now(),m=u.reduce(((E,w)=>E.add(w.key)),Ft());let x,v;return f.persistence.runTransaction("Locally write mutations","readwrite",(E=>{let w=Ui(),T=Ft();return f.Ns.getEntries(E,m).next((A=>{w=A,w.forEach(((I,O)=>{O.isValidDocument()||(T=T.add(I))}))})).next((()=>f.localDocuments.getOverlayedDocuments(E,w))).next((A=>{x=A;const I=[];for(const O of u){const D=aJ(O,x.get(O.key).overlayedDocument);D!=null&&I.push(new uc(O.key,D,aD(D.value.mapValue),Fi.exists(!0)))}return f.mutationQueue.addMutationBatch(E,h,I,u)})).next((A=>{v=A;const I=A.applyToLocalDocumentSet(x,T);return f.documentOverlayCache.saveOverlays(E,A.batchId,I)}))})).then((()=>({batchId:v.batchId,changes:mD(x)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(l,u,f){let h=l.Vu[l.currentUser.toKey()];h||(h=new Cr(It)),h=h.insert(u,f),l.Vu[l.currentUser.toKey()]=h})(n,a.batchId,r),await b0(n,a.changes),await Jp(n.remoteStore)}catch(a){const i=i2(a,"Failed to persist write");r.reject(i)}}async function KD(t,e){const r=xt(t);try{const n=await rZ(r.localStore,e);e.targetChanges.forEach(((a,i)=>{const l=r.Au.get(i);l&&(Xt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.hu=!0:a.modifiedDocuments.size>0?Xt(l.hu,14607):a.removedDocuments.size>0&&(Xt(l.hu,42227),l.hu=!1))})),await b0(r,n,e)}catch(n){await Gu(n)}}function P4(t,e,r){const n=xt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((i,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(l,u){const f=xt(l);f.onlineState=u;let h=!1;f.queries.forEach(((m,x)=>{for(const v of x.Sa)v.va(u)&&(h=!0)})),h&&o2(f)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function XZ(t,e,r){const n=xt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),i=a&&a.key;if(i){let l=new Cr(it.comparator);l=l.insert(i,Ln.newNoDocument(i,pt.min()));const u=Ft().add(i),f=new Kp(pt.min(),new Map,new Cr(It),l,u);await KD(n,f),n.du=n.du.remove(i),n.Au.delete(e),c2(n)}else await Hv(n.localStore,e,!1).then((()=>Wv(n,e,r))).catch(Gu)}async function $Z(t,e){const r=xt(t),n=e.batch.batchId;try{const a=await tZ(r.localStore,e);QD(r,n,null),YD(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await b0(r,a)}catch(a){await Gu(a)}}async function KZ(t,e,r){const n=xt(t);try{const a=await(function(l,u){const f=xt(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let m;return f.mutationQueue.lookupMutationBatch(h,u).next((x=>(Xt(x!==null,37113),m=x.keys(),f.mutationQueue.removeMutationBatch(h,x)))).next((()=>f.mutationQueue.performConsistencyCheck(h))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(h,m,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,m))).next((()=>f.localDocuments.getDocuments(h,m)))}))})(n.localStore,e);QD(n,e,r),YD(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await b0(n,a)}catch(a){await Gu(a)}}function YD(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function QD(t,e,r){const n=xt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const i=a.get(e);i&&(r?i.reject(r):i.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function Wv(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||JD(t,n)}))}function JD(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(t2(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),c2(t))}function L4(t,e,r){for(const n of r)n instanceof WD?(t.Ru.addReference(n.key,e),YZ(t,n)):n instanceof XD?(Ze(l2,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||JD(t,n.key)):ut(19791,{wu:n})}function YZ(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ze(l2,"New document in limbo: "+r),t.Eu.add(n),c2(t))}function c2(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new it(Sr.fromString(e)),n=t.fu.next();t.Au.set(n,new BZ(r)),t.du=t.du.insert(r,n),jD(t.remoteStore,new Fo(Ws(W_(r.path)),n,"TargetPurposeLimboResolution",Up.ce))}}async function b0(t,e,r){const n=xt(t),a=[],i=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{l.push(n.pu(f,e,r).then((h=>{var m;if((h||r)&&n.isPrimaryClient){const x=h?!h.fromCache:(m=r==null?void 0:r.targetChanges.get(f.targetId))==null?void 0:m.current;n.sharedClientState.updateQueryState(f.targetId,x?"current":"not-current")}if(h){a.push(h);const x=Z_.As(f.targetId,h);i.push(x)}})))})),await Promise.all(l),n.Pu.H_(a),await(async function(f,h){const m=xt(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>Pe.forEach(h,(v=>Pe.forEach(v.Es,(E=>m.persistence.referenceDelegate.addReference(x,v.targetId,E))).next((()=>Pe.forEach(v.ds,(E=>m.persistence.referenceDelegate.removeReference(x,v.targetId,E)))))))))}catch(x){if(!qu(x))throw x;Ze(e2,"Failed to update sequence numbers: "+x)}for(const x of h){const v=x.targetId;if(!x.fromCache){const E=m.Ms.get(v),w=E.snapshotVersion,T=E.withLastLimboFreeSnapshotVersion(w);m.Ms=m.Ms.insert(v,T)}}})(n.localStore,i))}async function QZ(t,e){const r=xt(t);if(!r.currentUser.isEqual(e)){Ze(l2,"User change. New user:",e.toKey());const n=await PD(r.localStore,e);r.currentUser=e,(function(i,l){i.mu.forEach((u=>{u.forEach((f=>{f.reject(new nt(Ue.CANCELLED,l))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await b0(r,n.Ls)}}function JZ(t,e){const r=xt(t),n=r.Au.get(e);if(n&&n.hu)return Ft().add(n.key);{let a=Ft();const i=r.Iu.get(e);if(!i)return a;for(const l of i){const u=r.Tu.get(l);a=a.unionWith(u.view.nu)}return a}}function ZD(t){const e=xt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=KD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JZ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XZ.bind(null,e),e.Pu.H_=OZ.bind(null,e.eventManager),e.Pu.yu=MZ.bind(null,e.eventManager),e}function ZZ(t){const e=xt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$Z.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KZ.bind(null,e),e}class _p{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Yp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return eZ(this.persistence,new QJ,e.initialUser,this.serializer)}Cu(e){return new MD(J_.mi,this.serializer)}Du(e){return new oZ}async terminate(){var e,r;(e=this.gcScheduler)==null||e.stop(),(r=this.indexBackfillerScheduler)==null||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_p.provider={build:()=>new _p};class eee extends _p{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Xt(this.persistence.referenceDelegate instanceof vp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new PJ(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?la.withCacheSize(this.cacheSizeBytes):la.DEFAULT;return new MD((n=>vp.mi(n,r)),this.serializer)}}class Xv{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>P4(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=QZ.bind(null,this.syncEngine),await kZ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new DZ})()}createDatastore(e){const r=Yp(e.databaseInfo.databaseId),n=(function(i){return new hZ(i)})(e.databaseInfo);return(function(i,l,u,f){return new gZ(i,l,u,f)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,i,l,u){return new vZ(n,a,i,l,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>P4(this.syncEngine,r,0)),(function(){return R4.v()?new R4:new lZ})())}createSyncEngine(e,r){return(function(a,i,l,u,f,h,m){const x=new jZ(a,i,l,u,f,h);return m&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await(async function(a){const i=xt(a);Ze(tc,"RemoteStore shutting down."),i.Ea.add(5),await A0(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(r=this.eventManager)==null||r.terminate()}}Xv.provider={build:()=>new Xv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tee{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ji("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo="FirestoreClient";class ree{constructor(e,r,n,a,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=On.UNAUTHENTICATED,this.clientId=B_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async l=>{Ze(Yo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(Ze(Yo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=i2(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Vx(t,e){t.asyncQueue.verifyOperationInProgress(),Ze(Yo,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await PD(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function V4(t,e){t.asyncQueue.verifyOperationInProgress();const r=await nee(t);Ze(Yo,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>I4(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>I4(e.remoteStore,a))),t._onlineComponents=e}async function nee(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ze(Yo,"Using user provided OfflineComponentProvider");try{await Vx(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Ue.FAILED_PRECONDITION||a.code===Ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;Nu("Error using user provided cache. Falling back to memory cache: "+r),await Vx(t,new _p)}}else Ze(Yo,"Using default OfflineComponentProvider"),await Vx(t,new eee(void 0));return t._offlineComponents}async function eI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ze(Yo,"Using user provided OnlineComponentProvider"),await V4(t,t._uninitializedComponentsProvider._online)):(Ze(Yo,"Using default OnlineComponentProvider"),await V4(t,new Xv))),t._onlineComponents}function aee(t){return eI(t).then((e=>e.syncEngine))}async function see(t){const e=await eI(t),r=e.eventManager;return r.onListen=UZ.bind(null,e.syncEngine),r.onUnlisten=GZ.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=zZ.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=qZ.bind(null,e.syncEngine),r}function iee(t,e,r={}){const n=new Vo;return t.asyncQueue.enqueueAndForget((async()=>(function(i,l,u,f,h){const m=new tee({next:v=>{m.Nu(),l.enqueueAndForget((()=>FZ(i,x)));const E=v.docs.has(u);!E&&v.fromCache?h.reject(new nt(Ue.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&v.fromCache&&f&&f.source==="server"?h.reject(new nt(Ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(v)},error:v=>h.reject(v)}),x=new PZ(W_(u.path),m,{includeMetadataChanges:!0,qa:!0});return IZ(i,x)})(await see(t),t.asyncQueue,e,r,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="firestore.googleapis.com",j4=!0;class U4{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new nt(Ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=rI,this.ssl=j4}else this.host=e.host,this.ssl=e.ssl??j4;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=OD;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<OJ)throw new nt(Ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tI(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new nt(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new nt(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new nt(Ue.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class u2{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new U4({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(Ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(Ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new U4(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new iQ;switch(n.type){case"firstParty":return new uQ(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new nt(Ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=B4.get(r);n&&(Ze("ComponentProvider","Removing Datastore"),B4.delete(r),n.terminate())})(this),Promise.resolve()}}function oee(t,e,r,n={}){var h;t=Kh(t,u2);const a=ju(e),i=t._getSettings(),l={...i,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(rR(`https://${u}`),nR("Firestore",!0)),i.host!==rI&&i.host!==u&&Nu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...i,host:u,ssl:a,emulatorOptions:n};if(!Ql(f,l)&&(t._setSettings(f),n.mockUserToken)){let m,x;if(typeof n.mockUserToken=="string")m=n.mockUserToken,x=On.MOCK_USER;else{m=RX(n.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new nt(Ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new On(v)}t._authCredentials=new oQ(new XR(m,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new f2(this.firestore,e,this._query)}}class mn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new r0(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mn(this.firestore,e,this._key)}toJSON(){return{type:mn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(T0(r,mn._jsonSchema))return new mn(e,n||null,new it(Sr.fromString(r.referencePath)))}}mn._jsonSchemaVersion="firestore/documentReference/1.0",mn._jsonSchema={type:Zr("string",mn._jsonSchemaVersion),referencePath:Zr("string")};class r0 extends f2{constructor(e,r,n){super(e,r,W_(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new it(e))}withConverter(e){return new r0(this.firestore,e,this._path)}}function Xu(t,e,...r){if(t=rs(t),arguments.length===1&&(e=B_.newId()),gQ("doc","path",e),t instanceof u2){const n=Sr.fromString(e,...r);return t4(n),new mn(t,null,new it(n))}{if(!(t instanceof mn||t instanceof r0))throw new nt(Ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Sr.fromString(e,...r));return t4(n),new mn(t.firestore,t instanceof r0?t.converter:null,new it(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z4="AsyncQueue";class H4{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new VD(this,"async_queue_retry"),this._c=()=>{const n=Lx();n&&Ze(z4,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Lx();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Lx();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new Vo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qu(e))throw e;Ze(z4,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ji("INTERNAL UNHANDLED ERROR: ",G4(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=s2.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(a),a}uc(){this.nc&&ut(47125,{Pc:G4(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function G4(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class h2 extends u2{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new H4,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new H4(e),this._firestoreClient=void 0,await e}}}function lee(t,e){const r=typeof t=="object"?t:oR(),n=typeof t=="string"?t:fp,a=N_(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const i=CX("firestore");i&&oee(a,...i)}return a}function nI(t){if(t._terminated)throw new nt(Ue.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||cee(t),t._firestoreClient}function cee(t){var n,a,i;const e=t._freezeSettings(),r=(function(u,f,h,m){return new CQ(u,f,h,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,tI(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)})(t._databaseId,((n=t._app)==null?void 0:n.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new ree(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(u){const f=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(f),_online:f}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qa(Nn.fromBase64String(e))}catch(r){throw new nt(Ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Qa(Nn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(T0(e,Qa._jsonSchema))return Qa.fromBase64String(e.bytes)}}Qa._jsonSchemaVersion="firestore/bytes/1.0",Qa._jsonSchema={type:Zr("string",Qa._jsonSchemaVersion),bytes:Zr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new nt(Ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new nt(Ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new nt(Ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return It(this._lat,e._lat)||It(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$s._jsonSchemaVersion}}static fromJSON(e){if(T0(e,$s._jsonSchema))return new $s(e.latitude,e.longitude)}}$s._jsonSchemaVersion="firestore/geoPoint/1.0",$s._jsonSchema={type:Zr("string",$s._jsonSchemaVersion),latitude:Zr("number"),longitude:Zr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==a[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ks._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(T0(e,Ks._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Ks(e.vectorValues);throw new nt(Ue.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ks._jsonSchemaVersion="firestore/vectorValue/1.0",Ks._jsonSchema={type:Zr("string",Ks._jsonSchemaVersion),vectorValues:Zr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uee=/^__.*__$/;class fee{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new uc(e,this.data,this.fieldMask,r,this.fieldTransforms):new w0(e,this.data,r,this.fieldTransforms)}}function sI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ut(40011,{Ac:t})}}class m2{constructor(e,r,n,a,i,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new m2({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var a;const r=(a=this.path)==null?void 0:a.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){var a;const r=(a=this.path)==null?void 0:a.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Ep(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(sI(this.Ac)&&uee.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hee{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Yp(e)}Cc(e,r,n,a=!1){return new m2({Ac:e,methodName:r,Dc:n,path:bn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dee(t){const e=t._freezeSettings(),r=Yp(t._databaseId);return new hee(t._databaseId,!!e.ignoreUndefinedProperties,r)}function mee(t,e,r,n,a,i={}){const l=t.Cc(i.merge||i.mergeFields?2:0,e,r,a);cI("Data must be an object, but it was:",l,n);const u=oI(n,l);let f,h;if(i.merge)f=new Ts(l.fieldMask),h=l.fieldTransforms;else if(i.mergeFields){const m=[];for(const x of i.mergeFields){const v=pee(e,x,r);if(!l.contains(v))throw new nt(Ue.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);xee(m,v)||m.push(v)}f=new Ts(m),h=l.fieldTransforms.filter((x=>f.covers(x.field)))}else f=null,h=l.fieldTransforms;return new fee(new Ya(u),f,h)}function iI(t,e){if(lI(t=rs(t)))return cI("Unsupported field value:",e,t),oI(t,e);if(t instanceof aI)return(function(n,a){if(!sI(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(a);i&&a.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const i=[];let l=0;for(const u of n){let f=iI(u,a.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),i.push(f),l++}return{arrayValue:{values:i}}})(t,e)}return(function(n,a){if((n=rs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return JQ(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=gr.fromDate(n);return{timestampValue:xp(a.serializer,i)}}if(n instanceof gr){const i=new gr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:xp(a.serializer,i)}}if(n instanceof $s)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Qa)return{bytesValue:ND(a.serializer,n._byteString)};if(n instanceof mn){const i=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(i))throw a.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Y_(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Ks)return(function(l,u){return{mapValue:{fields:{[rD]:{stringValue:nD},[hp]:{arrayValue:{values:l.toArray().map((h=>{if(typeof h!="number")throw u.Sc("VectorValues must only contain numeric values.");return X_(u.serializer,h)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${j_(n)}`)})(t,e)}function oI(t,e){const r={};return YR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):lc(t,((n,a)=>{const i=iI(a,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function lI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gr||t instanceof $s||t instanceof Qa||t instanceof mn||t instanceof aI||t instanceof Ks)}function cI(t,e,r){if(!lI(r)||!$R(r)){const n=j_(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function pee(t,e,r){if((e=rs(e))instanceof d2)return e._internalPath;if(typeof e=="string")return uI(t,e);throw Ep("Field path arguments must be of type string or ",t,!1,void 0,r)}const gee=new RegExp("[~\\*/\\[\\]]");function uI(t,e,r){if(e.search(gee)>=0)throw Ep(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new d2(...e.split("."))._internalPath}catch{throw Ep(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ep(t,e,r,n,a){const i=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(i||l)&&(f+=" (found",i&&(f+=` in field ${n}`),l&&(f+=` in document ${a}`),f+=")"),new nt(Ue.INVALID_ARGUMENT,u+t+f)}function xee(t,e){return t.some((r=>r.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e,r,n,a,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vee(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(hI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class vee extends fI{data(){return super.data()}}function hI(t,e){return typeof e=="string"?uI(t,e):e instanceof d2?e._internalPath:e._delegate._internalPath}class yee{convertValue(e,r="none"){switch($o(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Xo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ut(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return lc(e,((a,i)=>{n[a]=this.convertValue(i,r)})),n}convertVectorValue(e){var n,a,i;const r=(i=(a=(n=e.fields)==null?void 0:n[hp].arrayValue)==null?void 0:a.values)==null?void 0:i.map((l=>jr(l.doubleValue)));return new Ks(r)}convertGeoPoint(e){return new $s(jr(e.latitude),jr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Hp(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Qh(e));default:return null}}convertTimestamp(e){const r=Wo(e);return new gr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Sr.fromString(e);Xt(FD(n),9688,{name:e});const a=new Jh(n.get(1),n.get(3)),i=new it(n.popFirst(5));return a.isEqual(r)||ji(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _ee(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class rh{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Gl extends fI{constructor(e,r,n,a,i,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new km(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(hI("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Ue.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Gl._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Gl._jsonSchemaVersion="firestore/documentSnapshot/1.0",Gl._jsonSchema={type:Zr("string",Gl._jsonSchemaVersion),bundleSource:Zr("string","DocumentSnapshot"),bundleName:Zr("string"),bundle:Zr("string")};class km extends Gl{data(e={}){return super.data(e)}}class wh{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new rh(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new km(this._firestore,this._userDataWriter,n.key,n,new rh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new nt(Ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,i){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map((u=>{const f=new km(a._firestore,a._userDataWriter,u.doc.key,u.doc,new rh(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const f=new km(a._firestore,a._userDataWriter,u.doc.key,u.doc,new rh(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let h=-1,m=-1;return u.type!==0&&(h=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),m=l.indexOf(u.doc.key)),{type:Eee(u.type),doc:f,oldIndex:h,newIndex:m}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new nt(Ue.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=wh._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=B_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),a.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Eee(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ut(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(t){t=Kh(t,mn);const e=Kh(t.firestore,h2);return iee(nI(e),t._key).then((r=>See(e,t,r)))}wh._jsonSchemaVersion="firestore/querySnapshot/1.0",wh._jsonSchema={type:Zr("string",wh._jsonSchemaVersion),bundleSource:Zr("string","QuerySnapshot"),bundleName:Zr("string"),bundle:Zr("string")};class Tee extends yee{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qa(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,r)}}function g2(t,e,r){t=Kh(t,mn);const n=Kh(t.firestore,h2),a=_ee(t.converter,e,r);return wee(n,[mee(dee(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Fi.none())])}function wee(t,e){return(function(n,a){const i=new Vo;return n.asyncQueue.enqueueAndForget((async()=>WZ(await aee(n),a,i))),i.promise})(nI(t),e)}function See(t,e,r){const n=r.docs.get(e._key),a=new Tee(t);return new Gl(t,a,e._key,n,new rh(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(a){Hu=a})(Uu),Au(new Jl("firestore",((n,{instanceIdentifier:a,options:i})=>{const l=n.getProvider("app").getImmediate(),u=new h2(new lQ(n.getProvider("auth-internal")),new fQ(l,n.getProvider("app-check-internal")),(function(h,m){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new nt(Ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jh(h.options.projectId,m)})(l,a),l);return i={useFetchStreams:r,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),Po(Qb,Jb,e),Po(Qb,Jb,"esm2020")})();const Aee={apiKey:"AIzaSyDcxK25ZJwzcPiDexSrh8RcWhb2bHRcfQc",authDomain:"refereepay-5afd9.firebaseapp.com",projectId:"refereepay-5afd9",storageBucket:"refereepay-5afd9.firebasestorage.app",messagingSenderId:"860495632892",appId:"1:860495632892:web:c06db3f0a28d129ee33a79",measurementId:"G-CNXFDFTDMH"},dI=iR(Aee),Bx=rQ(dI),bee=new Ai,$u=lee(dI),mI=xe.createContext(void 0),Nee=({children:t})=>{const[e,r]=xe.useState(null),[n,a]=xe.useState(!0);xe.useEffect(()=>GK(Bx,f=>{r(f),a(!1)}),[]);const i=async()=>{try{await fY(Bx,bee)}catch(u){console.error("Error signing in with Google",u)}},l=async()=>{try{await qK(Bx)}catch(u){console.error("Error signing out",u)}};return _.jsx(mI.Provider,{value:{user:e,loading:n,signInWithGoogle:i,logout:l},children:t})},pI=()=>{const t=xe.useContext(mI);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Cee=({onStartNew:t,onViewHistory:e,onViewMonth:r})=>{var N,b,k;const{user:n}=pI(),[a,i]=xe.useState([]),[l,u]=xe.useState(null),[f,h]=xe.useState(null),[m,x]=xe.useState(""),[v,E]=xe.useState(null);xe.useEffect(()=>{i(Jn());const F=()=>i(Jn());return window.addEventListener("payroll-updated",F),()=>window.removeEventListener("payroll-updated",F)},[]);const w=xe.useMemo(()=>{const F=new Date().getFullYear(),P=new Date().getMonth();let M=0,j=0,Le=new Set,De=0;return a.forEach(ne=>{const ae=new Date(ne.timestamp);ae.getFullYear()===F&&(M+=ne.totals.netPay,ae.getMonth()===P&&(j+=ne.totals.netPay)),ne.referees.forEach(fe=>Le.add(fe.employeeNumber)),De+=ne.totals.totalGames}),{ytdPayout:M,monthPayout:j,uniqueReferees:Le.size,totalGames:De}},[a]),T=a.slice(0,3),A=xe.useMemo(()=>ym().slice(0,3),[a]),I=xe.useMemo(()=>wv(),[a]),O=F=>{u(P=>P===F?null:F)},D=F=>{h(F.id),x(F.name||`${F.dateRange.start} - ${F.dateRange.end}`)},q=()=>{if(!f)return;const P=m.trim()||m;i(M=>M.map(j=>j.id===f?{...j,name:P}:j)),cX(f,P),h(null),x("")},Y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},W={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}};return _.jsxs(Pt.div,{variants:Y,initial:"hidden",animate:"visible",className:"w-full max-w-5xl mx-auto space-y-8 py-6",children:[_.jsxs(Pt.div,{variants:W,className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 border-b border-slate-200 pb-6",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-extrabold text-slate-900 tracking-tight flex items-center gap-2",children:_.jsx("span",{className:"text-black",children:"OFFICIAL'S PAYROLL"})}),_.jsxs("p",{className:"text-slate-500 font-medium",children:["Welcome back, ",((N=n==null?void 0:n.displayName)==null?void 0:N.split(" ")[0])||"Official"]})]}),_.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-6 py-3 bg-slate-900 hover:bg-slate-800 text-white rounded-xl font-bold shadow-lg shadow-slate-900/20 transition-all group",children:[_.jsx(Ry,{className:"w-5 h-5"}),"NEW RUN",_.jsx(Pm,{className:"w-4 h-4 opacity-50 group-hover:translate-x-1 transition-transform"})]})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[_.jsx(jx,{title:"This Month",value:`$${w.monthPayout.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:Rh,color:"bg-blue-500",subtitle:"Net Payout"}),_.jsx(jx,{title:"YTD Payout",value:`$${w.ytdPayout.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:NC,color:"bg-green-500",subtitle:`${new Date().getFullYear()} Total`}),_.jsx(jx,{title:"Active Referees",value:w.uniqueReferees.toString(),icon:jm,color:"bg-purple-500",subtitle:`Across ${a.length} batches`})]}),_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[_.jsxs(Pt.div,{variants:W,className:"lg:col-span-2 bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden",children:[_.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[_.jsxs("h3",{className:"font-bold text-slate-800 flex items-center gap-2",children:[_.jsx(AC,{className:"w-5 h-5 text-slate-400"}),"Recent Batches"]}),_.jsx("button",{onClick:e,className:"text-sm text-primary-600 font-medium hover:text-primary-700",children:"View All"})]}),_.jsx("div",{className:"divide-y divide-slate-50",children:T.length>0?T.map(F=>{const P=l===F.id;return _.jsxs("div",{className:"p-4 hover:bg-slate-50 transition-colors flex flex-col gap-3 group cursor-pointer",role:"button",tabIndex:0,onClick:()=>O(F.id),onKeyDown:M=>{(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),O(F.id))},children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600",children:_.jsx(bp,{className:"w-5 h-5"})}),_.jsxs("div",{className:"flex flex-col gap-1",children:[f===F.id?_.jsx("input",{value:m,autoFocus:!0,onChange:M=>x(M.target.value),onClick:M=>M.stopPropagation(),onKeyDown:M=>{M.key==="Enter"?(M.preventDefault(),q()):M.key==="Escape"&&(M.preventDefault(),h(null),x(""))},onBlur:q,className:"border border-slate-200 rounded-lg px-2 py-1 text-sm text-slate-800 focus:ring-2 focus:ring-primary-500/30 focus:border-primary-500"}):_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("p",{className:"font-semibold text-slate-800",children:F.name||`${F.dateRange.start} - ${F.dateRange.end}`}),_.jsx("button",{onClick:M=>{M.stopPropagation(),D(F)},className:"p-1 rounded hover:bg-slate-100 text-slate-400 hover:text-primary-600 transition-colors",title:"Rename batch",children:_.jsx(gP,{className:"w-3.5 h-3.5"})})]}),_.jsxs("p",{className:"text-xs text-slate-500",children:[new Date(F.timestamp).toLocaleDateString(),"  ",F.referees.length," referees"]})]})]}),_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsxs("p",{className:"font-bold text-slate-700",children:["$",F.totals.netPay.toFixed(2)]}),_.jsx(lA,{className:`w-5 h-5 text-slate-300 transition-transform transition-colors group-hover:text-primary-500 ${P?"rotate-90 text-primary-500":""}`})]})]}),P&&_.jsxs("div",{className:"pl-14 pr-2 text-sm text-slate-600 space-y-1",children:[_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{children:"Total games"}),_.jsx("span",{className:"font-semibold text-slate-800",children:F.totals.totalGames})]}),_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{children:"Gross pay"}),_.jsxs("span",{className:"font-semibold text-slate-800",children:["$",F.totals.grossPay.toFixed(2)]})]}),_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{children:"Net pay"}),_.jsxs("span",{className:"font-semibold text-slate-800",children:["$",F.totals.netPay.toFixed(2)]})]})]})]},F.id)}):_.jsx("div",{className:"p-8 text-center text-slate-500",children:"No payroll batches processed yet."})})]}),_.jsxs(Pt.div,{variants:W,className:"space-y-4",children:[_.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 shadow-sm",children:[_.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Quick Stats"}),_.jsxs("div",{className:"space-y-3",children:[_.jsxs("div",{className:"flex justify-between text-sm",children:[_.jsx("span",{className:"text-slate-500",children:"Total Games"}),_.jsx("span",{className:"font-medium text-slate-900",children:w.totalGames})]}),_.jsx("div",{className:"w-full bg-slate-100 h-1.5 rounded-full overflow-hidden",children:_.jsx("div",{className:"bg-primary-500 h-full rounded-full",style:{width:"100%"}})}),_.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"Total games processed all time"})]})]}),_.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-6 shadow-sm",children:[_.jsx("h3",{className:"font-bold text-slate-800 mb-4",children:"Quick Navigation"}),_.jsxs("div",{className:"flex gap-3",children:[_.jsxs("button",{onClick:t,className:"flex-1 flex flex-col items-center justify-center p-4 rounded-xl border border-slate-200 hover:border-blue-500 hover:bg-blue-50 transition-all group",children:[_.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 group-hover:bg-blue-100 flex items-center justify-center mb-2 transition-colors",children:_.jsx(CC,{className:"w-5 h-5 text-slate-600 group-hover:text-blue-600"})}),_.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"Upload"})]}),_.jsxs("button",{onClick:e,className:"flex-1 flex flex-col items-center justify-center p-4 rounded-xl border border-slate-200 hover:border-blue-500 hover:bg-blue-50 transition-all group",children:[_.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 group-hover:bg-blue-100 flex items-center justify-center mb-2 transition-colors",children:_.jsx(Bm,{className:"w-5 h-5 text-slate-600 group-hover:text-blue-600"})}),_.jsx("span",{className:"font-semibold text-slate-800 text-sm",children:"History"})]})]})]})]})]}),_.jsxs(Pt.div,{variants:W,className:"bg-white rounded-2xl shadow-sm border border-slate-100 p-6",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(oA,{className:"w-5 h-5 text-primary-500"}),_.jsx("h3",{className:"font-bold text-slate-800",children:"Recent Monthly Performance"})]}),_.jsxs("span",{className:"text-xs text-slate-400",children:["Last ",A.length," months"]})]}),A.length>0?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:A.map(F=>{const P=v===F.month;return _.jsxs("div",{className:"relative group",children:[_.jsxs("button",{onClick:()=>E(M=>M===F.month?null:F.month),className:`w-full border border-slate-100 rounded-xl p-4 text-left hover:border-primary-200 transition-colors ${P?"border-primary-200 bg-primary-50/40":"bg-white"}`,children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("p",{className:"text-xs uppercase text-slate-400",children:F.monthLabel}),_.jsxs("p",{className:"text-lg font-bold text-slate-900 mt-1",children:["$",F.totalNet.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),_.jsx(lA,{className:`w-5 h-5 text-slate-300 transition-transform ${P?"rotate-90 text-primary-500":""}`})]}),_.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[F.refereeCount," referees  ",F.totalGames," games"]})]}),_.jsx("button",{onClick:M=>{M.stopPropagation(),r(F.month)},className:`absolute top-2 right-2 p-1.5 bg-white border border-slate-200 rounded-lg shadow-sm text-slate-400 hover:text-primary-600 hover:border-primary-200 transition-all opacity-0 group-hover:opacity-100 ${P?"opacity-100":""}`,title:"View full dashboard",children:_.jsx(oA,{className:"w-4 h-4"})})]},F.month)})}),v&&_.jsx("div",{className:"mt-6 border border-slate-100 rounded-xl p-4 bg-slate-50",children:A.find(F=>F.month===v)?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsxs("div",{children:[_.jsx("p",{className:"text-xs uppercase text-slate-400",children:"Month"}),_.jsx("p",{className:"font-semibold text-slate-800",children:(b=A.find(F=>F.month===v))==null?void 0:b.monthLabel})]}),_.jsxs("button",{onClick:()=>r(v),className:"text-sm font-medium text-primary-600 hover:text-primary-700 flex items-center gap-1",children:["View Dashboard ",_.jsx(Pm,{className:"w-4 h-4"})]})]}),_.jsx("div",{className:"divide-y divide-slate-200 bg-white rounded-xl border border-slate-100 overflow-hidden",children:(k=A.find(F=>F.month===v))==null?void 0:k.batches.map(F=>_.jsxs("div",{className:"p-3 flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("p",{className:"font-semibold text-slate-800",children:F.name||`${F.dateRange.start} - ${F.dateRange.end}`}),_.jsxs("p",{className:"text-xs text-slate-500",children:[F.dateRange.start,"  ",F.dateRange.end]})]}),_.jsxs("div",{className:"text-right",children:[_.jsxs("p",{className:"font-bold text-slate-800",children:["$",F.totals.netPay.toFixed(2)]}),_.jsxs("p",{className:"text-xs text-slate-500",children:[F.totals.totalGames," games"]})]})]},F.id))}),_.jsxs("div",{className:"mt-4",children:[_.jsx("h4",{className:"text-sm font-semibold text-slate-700 mb-2",children:"Employee payroll for this month"}),_.jsx("div",{className:"bg-white rounded-xl border border-slate-100 divide-y divide-slate-200 overflow-hidden",children:I.filter(F=>F.months[v]).map(F=>_.jsxs("div",{className:"p-3 flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("p",{className:"font-medium text-slate-800",children:F.refereeName}),_.jsxs("p",{className:"text-xs text-slate-500",children:["Emp #",F.employeeNumber]})]}),_.jsxs("div",{className:"text-right",children:[_.jsxs("p",{className:"font-semibold text-slate-800",children:["$",F.months[v].netPay.toFixed(2)]}),_.jsxs("p",{className:"text-xs text-slate-500",children:[F.months[v].games," games"]})]})]},F.employeeNumber))})]})]}):_.jsx("p",{className:"text-sm text-slate-500",children:"Select a month to view details."})})]}):_.jsx("p",{className:"text-sm text-slate-500",children:"No monthly data yet. Run a payroll to see summaries."})]})]})},jx=({title:t,value:e,icon:r,color:n,subtitle:a})=>_.jsxs(Pt.div,{variants:{hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-sm",children:[_.jsxs("div",{className:"flex items-start justify-between mb-4",children:[_.jsxs("div",{children:[_.jsx("p",{className:"text-slate-500 text-sm font-medium mb-1",children:t}),_.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:e})]}),_.jsx("div",{className:`p-3 rounded-xl ${n} bg-opacity-10 text-${n.split("-")[1]}-600`,children:_.jsx(r,{className:`w-6 h-6 text-${n.split("-")[1]}-500`})})]}),_.jsx("p",{className:"text-xs text-slate-400",children:a})]}),Ku="users",kee=async(t,e)=>{try{const r=Xu($u,Ku,t);await g2(r,{history:e,lastUpdated:Date.now()},{merge:!0})}catch(r){console.error("Error saving history to Firestore:",r)}},Ree=async t=>{try{const e=Xu($u,Ku,t),r=await p2(e);return r.exists()?r.data().history||[]:[]}catch(e){return console.error("Error loading history from Firestore:",e),[]}},Dee=async(t,e)=>{try{const r=Xu($u,Ku,t,"data","payroll_history");await g2(r,{batches:e,lastUpdated:Date.now()})}catch(r){console.error("Error saving payroll history:",r)}},Iee=async t=>{try{const e=Xu($u,Ku,t,"data","payroll_history"),r=await p2(e);return r.exists()?r.data().batches||[]:[]}catch(e){return console.error("Error loading payroll history:",e),[]}},Fee=async t=>{try{const e=Xu($u,Ku,t,"config","settings"),r=await p2(e);return r.exists()?r.data():null}catch(e){return console.error("Error loading settings",e),null}},Oee=async(t,e)=>{try{const r=Xu($u,Ku,t,"config","settings");await g2(r,e)}catch(r){console.error("Error saving settings",r)}};function Mee(){const{user:t,signInWithGoogle:e,logout:r,loading:n}=pI(),[a,i]=xe.useState("overview"),[l,u]=xe.useState(!1),[f,h]=xe.useState(!1),[m,x]=xe.useState(!1),[v,E]=xe.useState(0),[w,T]=xe.useState(!1),[A,I]=xe.useState([]),[O,D]=xe.useState({start:"",end:""}),[q,Y]=xe.useState(null),[W,N]=xe.useState({}),[b,k]=xe.useState([]),[F,P]=xe.useState(!1),[M,j]=xe.useState(()=>{const V=fX();return(V==null?void 0:V.history)||[]}),[Le,De]=xe.useState(null),[ne,ae]=xe.useState("");xe.useEffect(()=>{aX(qW)},[]),xe.useEffect(()=>{n||i(t?V=>V==="overview"||V==="upload"?"overview":V:V=>V==="overview"?"upload":V)},[t,n]),xe.useEffect(()=>{hX({history:M,lastUpdated:Date.now()}),t&&!m&&kee(t.uid,M)},[M,t]),xe.useEffect(()=>{n||(async()=>{if(t){x(!0),console.log("Syncing down for user:",t.uid);try{const we=await Ree(t.uid);we&&we.length>0&&j(we);const Ae=await Iee(t.uid);Ae&&Ae.length>0&&localStorage.setItem("payroll_history",JSON.stringify(Ae));const Je=await Fee(t.uid);Je&&g0(Je),E(Ye=>Ye+1)}catch(we){console.error("Error syncing down:",we)}finally{x(!1)}}})()},[t,n]),xe.useEffect(()=>{const V=async()=>{if(t){const Ae=Jn();await Dee(t.uid,Ae)}E(Ae=>Ae+1)},we=async()=>{if(t){const Ae=tl();await Oee(t.uid,Ae)}};return window.addEventListener("payroll-updated",V),window.addEventListener("settings-updated",we),()=>{window.removeEventListener("payroll-updated",V),window.removeEventListener("settings-updated",we)}},[t]);const fe=V=>rX(V),ie=V=>{I(we=>{const Ae=V.filter(Je=>!we.some(Ye=>Ye.name===Je.name&&Ye.size===Je.size));return[...we,...Ae]})},Fe=V=>{I(we=>we.filter((Ae,Je)=>Je!==V))},ee=()=>{A.length>0&&i("date")},B=async V=>{V.preventDefault(),u(!0);try{await new Promise(Wt=>setTimeout(Wt,500));let we=[];const Ae=new Set,Je=new Set;for(const Wt of A){const rr=await ZW(Wt);rr.allCategories.forEach(ft=>Ae.add(ft)),rr.scheduleNames.forEach(ft=>Je.add(ft)),rr.arbitrators.forEach(ft=>{const lr=we.find(en=>en.name===ft.name);lr?(Object.entries(ft.categories).forEach(([en,ha])=>{lr.categories[en]=(lr.categories[en]||0)+ha}),lr.total+=ft.total):we.push(ft)})}const Ye=Array.from(Ae).sort((Wt,rr)=>{const ft=lr=>lr.endsWith("u")?parseInt(lr.slice(0,-1)):lr.endsWith("uF")?parseInt(lr.slice(0,-2))+.5:0;return ft(Wt)-ft(rr)}),ge={};Ye.forEach(Wt=>{ge[Wt]=fe(Wt)}),Y({arbitrators:we,categories:Ye}),N(ge);const qe=`${O.start} to ${O.end}`,{matched:Be,unmatched:Qe}=YW(Array.from(Je),qe),zt=[...Qe,...Be];k(zt),P(!0),i("matching")}catch(we){console.error("Error processing files:",we),alert("Error processing files.")}finally{u(!1)}},Q=V=>{if(!q)return;const we=q.arbitrators.map(Be=>{const Qe=V.get(Be.name);return Qe?{...Be,matchedReferee:Qe,employeeNumber:Qe.employeeNumber,displayName:H3(Qe)}:Be}),Ae={...q,arbitrators:we};Y(Ae),P(!1);const Je=A.map(Be=>Be.name).sort().join(","),Ye=M.find(Be=>Be.dateRange.start===O.start&&Be.dateRange.end===O.end&&Be.files.sort().join(",")===Je),ge=Ye?Ye.id:Date.now().toString(),qe={id:ge,timestamp:Ye?Ye.timestamp:Date.now(),dateRange:O,files:A.map(Be=>Be.name),data:Ae,rates:W};j(Be=>Ye?Be.map(Qe=>Qe.id===ge?qe:Qe):[qe,...Be]),De(qe.id),i("dashboard")},J=()=>{P(!1),i("date")},te=(V,we)=>{N(Ae=>({...Ae,[V]:we}))},ce=V=>{if(N(V),q){const we=A.map(ge=>ge.name).sort().join(","),Ae=M.find(ge=>ge.dateRange.start===O.start&&ge.dateRange.end===O.end&&ge.files.sort().join(",")===we),Je=Ae?Ae.id:Date.now().toString(),Ye={id:Je,timestamp:Ae?Ae.timestamp:Date.now(),dateRange:O,files:A.map(ge=>ge.name),data:q,rates:V};j(ge=>Ae?ge.map(qe=>qe.id===Je?Ye:qe):[Ye,...ge]),De(Ye.id)}i("dashboard")},Se=()=>{i("upload"),I([]),D({start:"",end:""}),Y(null),N({}),De(null),ae(""),k([]),P(!1)},Oe=()=>{t?(i("overview"),ae("")):Se()},ke=V=>{De(V.id),Y(V.data),N(V.rates),D(V.dateRange),ae(""),i("dashboard")},se=V=>{ae(V),i("dashboard")},Me=(V,we)=>{we.stopPropagation(),j(Ae=>Ae.filter(Je=>Je.id!==V)),Le===V&&Se()};return _.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-900 font-sans selection:bg-primary-100 selection:text-primary-700",children:[_.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden pointer-events-none",children:[_.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-primary-200/20 rounded-full blur-3xl mix-blend-multiply animate-blob"}),_.jsx("div",{className:"absolute top-0 right-1/4 w-96 h-96 bg-purple-200/20 rounded-full blur-3xl mix-blend-multiply animate-blob animation-delay-2000"}),_.jsx("div",{className:"absolute -bottom-8 left-1/3 w-96 h-96 bg-pink-200/20 rounded-full blur-3xl mix-blend-multiply animate-blob animation-delay-4000"})]}),_.jsxs("div",{className:"relative z-10 w-full px-6 py-8",children:[_.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-center mb-10 gap-6",children:[_.jsxs("div",{className:"text-center md:text-left",children:[_.jsxs(Pt.h1,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"text-3xl md:text-4xl font-extrabold tracking-tight text-slate-900 cursor-pointer",onClick:Oe,role:"button",children:["Referee",_.jsx("span",{className:"text-primary-600",children:"Pay"})]}),_.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Automated Payroll System"})]}),_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsxs(Pt.button,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},onClick:()=>T(!0),className:"flex items-center gap-2 px-4 py-2.5 bg-white text-slate-600 rounded-xl hover:bg-slate-50 hover:text-primary-600 transition-colors border border-slate-200 font-medium shadow-sm",children:[_.jsx(Iy,{className:"w-5 h-5"}),"Settings"]}),t?_.jsxs("div",{className:"flex items-center gap-3 mr-4 bg-white rounded-xl p-1 pr-4 border border-slate-200 shadow-sm",children:[_.jsxs("div",{className:"flex items-center gap-2 bg-slate-100 px-3 py-1.5 rounded-lg",children:[t.photoURL?_.jsx("img",{src:t.photoURL,alt:"User",className:"w-6 h-6 rounded-full"}):_.jsx(Fy,{className:"w-4 h-4 text-slate-500"}),_.jsx("span",{className:"text-sm font-medium text-slate-700 hidden sm:inline",children:t.displayName||"User"})]}),m&&_.jsx(cA,{className:"w-4 h-4 animate-spin text-slate-400"}),_.jsx("button",{onClick:r,className:"text-slate-400 hover:text-red-500 transition-colors",title:"Sign Out",children:_.jsx(hP,{className:"w-4 h-4"})})]}):_.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2.5 bg-white text-slate-700 rounded-xl hover:bg-slate-50 hover:text-primary-600 transition-colors border border-slate-200 font-medium shadow-sm mr-2",children:[_.jsx(uP,{className:"w-4 h-4"}),"Sign In"]}),(M.length>0||a==="dashboard")&&a!=="overview"&&_.jsxs(Pt.button,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2.5 bg-white text-slate-600 rounded-xl hover:bg-slate-50 hover:text-primary-600 transition-colors border border-slate-200 font-medium shadow-sm",children:[_.jsx(Bm,{className:"w-5 h-5"}),"History"]}),a==="dashboard"&&_.jsxs(Pt.button,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},onClick:Se,className:"flex items-center gap-2 px-5 py-2.5 bg-primary-600 text-white rounded-xl hover:bg-primary-700 transition-colors shadow-lg shadow-primary-600/20",children:[_.jsx(Ry,{className:"w-5 h-5"}),"New Process"]})]})]}),_.jsxs("main",{className:"w-full min-h-[600px]",children:[_.jsx(vX,{isOpen:f,onClose:()=>h(!1),history:M,selectedId:Le,onSelect:ke,onDelete:Me}),_.jsx(K3,{isOpen:w,onClose:()=>T(!1),onSettingsChange:()=>E(V=>V+1)}),_.jsx(yX,{isOpen:F,matchResults:b,dateProcessed:`${O.start} to ${O.end}`,onConfirm:Q,onCancel:J}),_.jsx("div",{className:"w-full max-w-full",children:_.jsx(ws,{mode:"wait",children:l?_.jsxs(Pt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex flex-col items-center justify-center h-96 gap-4",children:[_.jsx(cA,{className:"w-12 h-12 text-primary-500 animate-spin"}),_.jsx("p",{className:"text-slate-500 font-medium",children:"Processing schedule..."})]},"loading"):a==="overview"?_.jsx(Cee,{onStartNew:Se,onViewHistory:()=>h(!0),onViewMonth:se}):a==="upload"?_.jsxs(Pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"w-full py-12",children:[_.jsxs("div",{className:"text-center mb-12",children:[_.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Upload Schedules"}),_.jsx("p",{className:"text-slate-500",children:"Select or drop files to add them to the batch."})]}),_.jsx(BP,{onFileSelect:ie}),_.jsx(ws,{children:A.length>0&&_.jsx(Pt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-8 max-w-xl mx-auto",children:_.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[_.jsx("div",{className:"p-4 bg-slate-50 border-b border-slate-100 flex justify-between items-center",children:_.jsxs("h3",{className:"font-semibold text-slate-700 flex items-center gap-2",children:[_.jsx(oh,{className:"w-4 h-4"}),"Selected Files (",A.length,")"]})}),_.jsx("div",{className:"divide-y divide-slate-100 max-h-60 overflow-y-auto",children:A.map((V,we)=>{var Ae;return _.jsxs("div",{className:"p-4 flex justify-between items-center hover:bg-slate-50 transition-colors",children:[_.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[_.jsx("div",{className:"w-8 h-8 rounded-lg bg-primary-100 flex items-center justify-center text-primary-600 flex-shrink-0",children:_.jsx("span",{className:"text-xs font-bold",children:(Ae=V.name.split(".").pop())==null?void 0:Ae.toUpperCase().slice(0,3)})}),_.jsxs("div",{className:"min-w-0",children:[_.jsx("p",{className:"text-sm font-medium text-slate-800 truncate",children:V.name}),_.jsxs("p",{className:"text-xs text-slate-400",children:[(V.size/1024).toFixed(1)," KB"]})]})]}),_.jsx("button",{onClick:()=>Fe(we),className:"p-2 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",children:_.jsx(Dh,{className:"w-4 h-4"})})]},`${V.name}-${we}`)})}),_.jsx("div",{className:"p-4 bg-slate-50 border-t border-slate-100",children:_.jsxs("button",{onClick:ee,className:"w-full py-3 bg-primary-600 hover:bg-primary-700 text-white rounded-xl font-semibold shadow-lg shadow-primary-600/20 flex items-center justify-center gap-2 transition-all group",children:["Continue to Date Selection",_.jsx(Pm,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})})]})})})]},"upload"):a==="date"?_.jsxs(Pt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full max-w-lg mx-auto bg-white rounded-3xl p-8 shadow-xl shadow-slate-200/50 border border-slate-100",children:[_.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3",children:[_.jsx(Rh,{className:"w-6 h-6 text-primary-500"}),"Select Date Range"]}),_.jsxs("form",{onSubmit:B,className:"space-y-6",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Start Date"}),_.jsx("input",{type:"date",required:!0,className:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all",value:O.start,onChange:V=>D(we=>({...we,start:V.target.value}))})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"End Date"}),_.jsx("input",{type:"date",required:!0,className:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 outline-none transition-all",value:O.end,onChange:V=>D(we=>({...we,end:V.target.value}))})]}),_.jsxs("div",{className:"pt-4 flex gap-3",children:[_.jsx("button",{type:"button",onClick:()=>i("upload"),className:"flex-1 px-6 py-3 rounded-xl font-semibold text-slate-600 hover:bg-slate-50 border border-transparent hover:border-slate-200 transition-all",children:"Back"}),_.jsxs("button",{type:"submit",className:"flex-1 px-6 py-3 rounded-xl bg-primary-600 text-white font-semibold hover:bg-primary-700 shadow-lg shadow-primary-600/20 transition-all",children:["Process ",A.length," File",A.length!==1?"s":""]})]})]})]},"date"):a==="config"&&q?_.jsx(Pt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"w-full",children:_.jsx(jP,{categories:q.categories,onConfirm:ce,initialRates:W})},"config"):a==="dashboard"&&(q||ne)?_.jsx(Pt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:1.05},className:"w-full",children:_.jsx(mX,{arbitrators:(q==null?void 0:q.arbitrators)||[],categories:(q==null?void 0:q.categories)||[],rates:q?W:{},dateRange:q?O:void 0,batchId:Le||Date.now().toString(),onRateChange:te,onReset:Oe,initialMonth:ne})},`dashboard-${v}`):null})})]})]})]})}n5.createRoot(document.getElementById("root")).render(_.jsx(xe.StrictMode,{children:_.jsx(Nee,{children:_.jsx(Mee,{})})}));
